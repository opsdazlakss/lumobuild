function q6(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(t,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function Kd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function G6(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var Qv={exports:{}},Wu={};var dw;function Y6(){if(dw)return Wu;dw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,o){var u=null;if(o!==void 0&&(u=""+o),a.key!==void 0&&(u=""+a.key),"key"in a){o={};for(var h in a)h!=="key"&&(o[h]=a[h])}else o=a;return a=o.ref,{$$typeof:t,type:r,key:u,ref:a!==void 0?a:null,props:o}}return Wu.Fragment=e,Wu.jsx=n,Wu.jsxs=n,Wu}var hw;function K6(){return hw||(hw=1,Qv.exports=Y6()),Qv.exports}var c=K6(),Xv={exports:{}},gt={};var fw;function Q6(){if(fw)return gt;fw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),x=Symbol.iterator;function k($){return $===null||typeof $!="object"?null:($=x&&$[x]||$["@@iterator"],typeof $=="function"?$:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,N={};function V($,X,re){this.props=$,this.context=X,this.refs=N,this.updater=re||I}V.prototype.isReactComponent={},V.prototype.setState=function($,X){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,X,"setState")},V.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function F(){}F.prototype=V.prototype;function j($,X,re){this.props=$,this.context=X,this.refs=N,this.updater=re||I}var O=j.prototype=new F;O.constructor=j,A(O,V.prototype),O.isPureReactComponent=!0;var B=Array.isArray;function H(){}var w={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function R($,X,re){var he=re.ref;return{$$typeof:t,type:$,key:X,ref:he!==void 0?he:null,props:re}}function D($,X){return R($.type,X,$.props)}function L($){return typeof $=="object"&&$!==null&&$.$$typeof===t}function U($){var X={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(re){return X[re]})}var P=/\/+/g;function ne($,X){return typeof $=="object"&&$!==null&&$.key!=null?U(""+$.key):X.toString(36)}function oe($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(H,H):($.status="pending",$.then(function(X){$.status==="pending"&&($.status="fulfilled",$.value=X)},function(X){$.status==="pending"&&($.status="rejected",$.reason=X)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function G($,X,re,he,Te){var Ue=typeof $;(Ue==="undefined"||Ue==="boolean")&&($=null);var te=!1;if($===null)te=!0;else switch(Ue){case"bigint":case"string":case"number":te=!0;break;case"object":switch($.$$typeof){case t:case e:te=!0;break;case y:return te=$._init,G(te($._payload),X,re,he,Te)}}if(te)return Te=Te($),te=he===""?"."+ne($,0):he,B(Te)?(re="",te!=null&&(re=te.replace(P,"$&/")+"/"),G(Te,X,re,"",function(We){return We})):Te!=null&&(L(Te)&&(Te=D(Te,re+(Te.key==null||$&&$.key===Te.key?"":(""+Te.key).replace(P,"$&/")+"/")+te)),X.push(Te)),1;te=0;var Oe=he===""?".":he+":";if(B($))for(var Ie=0;Ie<$.length;Ie++)he=$[Ie],Ue=Oe+ne(he,Ie),te+=G(he,X,re,Ue,Te);else if(Ie=k($),typeof Ie=="function")for($=Ie.call($),Ie=0;!(he=$.next()).done;)he=he.value,Ue=Oe+ne(he,Ie++),te+=G(he,X,re,Ue,Te);else if(Ue==="object"){if(typeof $.then=="function")return G(oe($),X,re,he,Te);throw X=String($),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return te}function Z($,X,re){if($==null)return $;var he=[],Te=0;return G($,he,"","",function(Ue){return X.call(re,Ue,Te++)}),he}function J($){if($._status===-1){var X=$._result;X=X(),X.then(function(re){($._status===0||$._status===-1)&&($._status=1,$._result=re)},function(re){($._status===0||$._status===-1)&&($._status=2,$._result=re)}),$._status===-1&&($._status=0,$._result=X)}if($._status===1)return $._result.default;throw $._result}var Se=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Le={map:Z,forEach:function($,X,re){Z($,function(){X.apply(this,arguments)},re)},count:function($){var X=0;return Z($,function(){X++}),X},toArray:function($){return Z($,function(X){return X})||[]},only:function($){if(!L($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return gt.Activity=b,gt.Children=Le,gt.Component=V,gt.Fragment=n,gt.Profiler=a,gt.PureComponent=j,gt.StrictMode=r,gt.Suspense=f,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,gt.__COMPILER_RUNTIME={__proto__:null,c:function($){return w.H.useMemoCache($)}},gt.cache=function($){return function(){return $.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function($,X,re){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var he=A({},$.props),Te=$.key;if(X!=null)for(Ue in X.key!==void 0&&(Te=""+X.key),X)!S.call(X,Ue)||Ue==="key"||Ue==="__self"||Ue==="__source"||Ue==="ref"&&X.ref===void 0||(he[Ue]=X[Ue]);var Ue=arguments.length-2;if(Ue===1)he.children=re;else if(1<Ue){for(var te=Array(Ue),Oe=0;Oe<Ue;Oe++)te[Oe]=arguments[Oe+2];he.children=te}return R($.type,Te,he)},gt.createContext=function($){return $={$$typeof:u,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:o,_context:$},$},gt.createElement=function($,X,re){var he,Te={},Ue=null;if(X!=null)for(he in X.key!==void 0&&(Ue=""+X.key),X)S.call(X,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(Te[he]=X[he]);var te=arguments.length-2;if(te===1)Te.children=re;else if(1<te){for(var Oe=Array(te),Ie=0;Ie<te;Ie++)Oe[Ie]=arguments[Ie+2];Te.children=Oe}if($&&$.defaultProps)for(he in te=$.defaultProps,te)Te[he]===void 0&&(Te[he]=te[he]);return R($,Ue,Te)},gt.createRef=function(){return{current:null}},gt.forwardRef=function($){return{$$typeof:h,render:$}},gt.isValidElement=L,gt.lazy=function($){return{$$typeof:y,_payload:{_status:-1,_result:$},_init:J}},gt.memo=function($,X){return{$$typeof:p,type:$,compare:X===void 0?null:X}},gt.startTransition=function($){var X=w.T,re={};w.T=re;try{var he=$(),Te=w.S;Te!==null&&Te(re,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(H,Se)}catch(Ue){Se(Ue)}finally{X!==null&&re.types!==null&&(X.types=re.types),w.T=X}},gt.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},gt.use=function($){return w.H.use($)},gt.useActionState=function($,X,re){return w.H.useActionState($,X,re)},gt.useCallback=function($,X){return w.H.useCallback($,X)},gt.useContext=function($){return w.H.useContext($)},gt.useDebugValue=function(){},gt.useDeferredValue=function($,X){return w.H.useDeferredValue($,X)},gt.useEffect=function($,X){return w.H.useEffect($,X)},gt.useEffectEvent=function($){return w.H.useEffectEvent($)},gt.useId=function(){return w.H.useId()},gt.useImperativeHandle=function($,X,re){return w.H.useImperativeHandle($,X,re)},gt.useInsertionEffect=function($,X){return w.H.useInsertionEffect($,X)},gt.useLayoutEffect=function($,X){return w.H.useLayoutEffect($,X)},gt.useMemo=function($,X){return w.H.useMemo($,X)},gt.useOptimistic=function($,X){return w.H.useOptimistic($,X)},gt.useReducer=function($,X,re){return w.H.useReducer($,X,re)},gt.useRef=function($){return w.H.useRef($)},gt.useState=function($){return w.H.useState($)},gt.useSyncExternalStore=function($,X,re){return w.H.useSyncExternalStore($,X,re)},gt.useTransition=function(){return w.H.useTransition()},gt.version="19.2.3",gt}var mw;function lo(){return mw||(mw=1,Xv.exports=Q6()),Xv.exports}var T=lo();const ve=Kd(T);var Wv={exports:{}},Ju={},Jv={exports:{}},Zv={};var pw;function X6(){return pw||(pw=1,(function(t){function e(G,Z){var J=G.length;G.push(Z);e:for(;0<J;){var Se=J-1>>>1,Le=G[Se];if(0<a(Le,Z))G[Se]=Z,G[J]=Le,J=Se;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],J=G.pop();if(J!==Z){G[0]=J;e:for(var Se=0,Le=G.length,$=Le>>>1;Se<$;){var X=2*(Se+1)-1,re=G[X],he=X+1,Te=G[he];if(0>a(re,J))he<Le&&0>a(Te,re)?(G[Se]=Te,G[he]=J,Se=he):(G[Se]=re,G[X]=J,Se=X);else if(he<Le&&0>a(Te,J))G[Se]=Te,G[he]=J,Se=he;else break e}}return Z}function a(G,Z){var J=G.sortIndex-Z.sortIndex;return J!==0?J:G.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();t.unstable_now=function(){return u.now()-h}}var f=[],p=[],y=1,b=null,x=3,k=!1,I=!1,A=!1,N=!1,V=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function O(G){for(var Z=n(p);Z!==null;){if(Z.callback===null)r(p);else if(Z.startTime<=G)r(p),Z.sortIndex=Z.expirationTime,e(f,Z);else break;Z=n(p)}}function B(G){if(A=!1,O(G),!I)if(n(f)!==null)I=!0,H||(H=!0,U());else{var Z=n(p);Z!==null&&oe(B,Z.startTime-G)}}var H=!1,w=-1,S=5,R=-1;function D(){return N?!0:!(t.unstable_now()-R<S)}function L(){if(N=!1,H){var G=t.unstable_now();R=G;var Z=!0;try{e:{I=!1,A&&(A=!1,F(w),w=-1),k=!0;var J=x;try{t:{for(O(G),b=n(f);b!==null&&!(b.expirationTime>G&&D());){var Se=b.callback;if(typeof Se=="function"){b.callback=null,x=b.priorityLevel;var Le=Se(b.expirationTime<=G);if(G=t.unstable_now(),typeof Le=="function"){b.callback=Le,O(G),Z=!0;break t}b===n(f)&&r(f),O(G)}else r(f);b=n(f)}if(b!==null)Z=!0;else{var $=n(p);$!==null&&oe(B,$.startTime-G),Z=!1}}break e}finally{b=null,x=J,k=!1}Z=void 0}}finally{Z?U():H=!1}}}var U;if(typeof j=="function")U=function(){j(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,ne=P.port2;P.port1.onmessage=L,U=function(){ne.postMessage(null)}}else U=function(){V(L,0)};function oe(G,Z){w=V(function(){G(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var J=x;x=Z;try{return G()}finally{x=J}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var J=x;x=G;try{return Z()}finally{x=J}},t.unstable_scheduleCallback=function(G,Z,J){var Se=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?Se+J:Se):J=Se,G){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=J+Le,G={id:y++,callback:Z,priorityLevel:G,startTime:J,expirationTime:Le,sortIndex:-1},J>Se?(G.sortIndex=J,e(p,G),n(f)===null&&G===n(p)&&(A?(F(w),w=-1):A=!0,oe(B,J-Se))):(G.sortIndex=Le,e(f,G),I||k||(I=!0,H||(H=!0,U()))),G},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(G){var Z=x;return function(){var J=x;x=Z;try{return G.apply(this,arguments)}finally{x=J}}}})(Zv)),Zv}var gw;function W6(){return gw||(gw=1,Jv.exports=X6()),Jv.exports}var e0={exports:{}},mr={};var vw;function J6(){if(vw)return mr;vw=1;var t=lo();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,p,y){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:f,containerInfo:p,implementation:y}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return mr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,mr.createPortal=function(f,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(f,p,null,y)},mr.flushSync=function(f){var p=u.T,y=r.p;try{if(u.T=null,r.p=2,f)return f()}finally{u.T=p,r.p=y,r.d.f()}},mr.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(f,p))},mr.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},mr.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var y=p.as,b=h(y,p.crossOrigin),x=typeof p.integrity=="string"?p.integrity:void 0,k=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;y==="style"?r.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:k}):y==="script"&&r.d.X(f,{crossOrigin:b,integrity:x,fetchPriority:k,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},mr.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var y=h(p.as,p.crossOrigin);r.d.M(f,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(f)},mr.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var y=p.as,b=h(y,p.crossOrigin);r.d.L(f,y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},mr.preloadModule=function(f,p){if(typeof f=="string")if(p){var y=h(p.as,p.crossOrigin);r.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(f)},mr.requestFormReset=function(f){r.d.r(f)},mr.unstable_batchedUpdates=function(f,p){return f(p)},mr.useFormState=function(f,p,y){return u.H.useFormState(f,p,y)},mr.useFormStatus=function(){return u.H.useHostTransitionStatus()},mr.version="19.2.3",mr}var yw;function Gy(){if(yw)return e0.exports;yw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),e0.exports=J6(),e0.exports}var bw;function Z6(){if(bw)return Ju;bw=1;var t=W6(),e=lo(),n=Gy();function r(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function u(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function h(s){if(s.tag===31){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(o(s)!==s)throw Error(r(188))}function p(s){var i=s.alternate;if(!i){if(i=o(s),i===null)throw Error(r(188));return i!==s?null:s}for(var l=s,d=i;;){var g=l.return;if(g===null)break;var v=g.alternate;if(v===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===l)return f(g),s;if(v===d)return f(g),i;v=v.sibling}throw Error(r(188))}if(l.return!==d.return)l=g,d=v;else{for(var E=!1,M=g.child;M;){if(M===l){E=!0,l=g,d=v;break}if(M===d){E=!0,d=g,l=v;break}M=M.sibling}if(!E){for(M=v.child;M;){if(M===l){E=!0,l=v,d=g;break}if(M===d){E=!0,d=v,l=g;break}M=M.sibling}if(!E)throw Error(r(189))}}if(l.alternate!==d)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?s:i}function y(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=y(s),i!==null)return i;s=s.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),j=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case V:return"Profiler";case N:return"StrictMode";case B:return"Suspense";case H:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case I:return"Portal";case j:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case O:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case w:return i=s.displayName||null,i!==null?i:ne(s.type)||"Memo";case S:i=s._payload,s=s._init;try{return ne(s(i))}catch{}}return null}var oe=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},Se=[],Le=-1;function $(s){return{current:s}}function X(s){0>Le||(s.current=Se[Le],Se[Le]=null,Le--)}function re(s,i){Le++,Se[Le]=s.current,s.current=i}var he=$(null),Te=$(null),Ue=$(null),te=$(null);function Oe(s,i){switch(re(Ue,i),re(Te,s),re(he,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?P_(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=P_(i),s=M_(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}X(he),re(he,s)}function Ie(){X(he),X(Te),X(Ue)}function We(s){s.memoizedState!==null&&re(te,s);var i=he.current,l=M_(i,s.type);i!==l&&(re(Te,s),re(he,l))}function ke(s){Te.current===s&&(X(he),X(Te)),te.current===s&&(X(te),Yu._currentValue=J)}var fe,Re;function dt(s){if(fe===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);fe=i&&i[1]||"",Re=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+s+Re}var ye=!1;function Ve(s,i){if(!s||ye)return"";ye=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(de){var ae=de}Reflect.construct(s,[],_e)}else{try{_e.call()}catch(de){ae=de}s.call(_e.prototype)}}else{try{throw Error()}catch(de){ae=de}(_e=s())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(de){if(de&&ae&&typeof de.stack=="string")return[de.stack,ae.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),E=v[0],M=v[1];if(E&&M){var q=E.split(`
`),ie=M.split(`
`);for(g=d=0;d<q.length&&!q[d].includes("DetermineComponentFrameRoot");)d++;for(;g<ie.length&&!ie[g].includes("DetermineComponentFrameRoot");)g++;if(d===q.length||g===ie.length)for(d=q.length-1,g=ie.length-1;1<=d&&0<=g&&q[d]!==ie[g];)g--;for(;1<=d&&0<=g;d--,g--)if(q[d]!==ie[g]){if(d!==1||g!==1)do if(d--,g--,0>g||q[d]!==ie[g]){var ge=`
`+q[d].replace(" at new "," at ");return s.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",s.displayName)),ge}while(1<=d&&0<=g);break}}}finally{ye=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?dt(l):""}function De(s,i){switch(s.tag){case 26:case 27:case 5:return dt(s.type);case 16:return dt("Lazy");case 13:return s.child!==i&&i!==null?dt("Suspense Fallback"):dt("Suspense");case 19:return dt("SuspenseList");case 0:case 15:return Ve(s.type,!1);case 11:return Ve(s.type.render,!1);case 1:return Ve(s.type,!0);case 31:return dt("Activity");default:return""}}function K(s){try{var i="",l=null;do i+=De(s,l),l=s,s=s.return;while(s);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var ue=Object.prototype.hasOwnProperty,je=t.unstable_scheduleCallback,me=t.unstable_cancelCallback,Ae=t.unstable_shouldYield,xe=t.unstable_requestPaint,W=t.unstable_now,He=t.unstable_getCurrentPriorityLevel,ct=t.unstable_ImmediatePriority,on=t.unstable_UserBlockingPriority,Ee=t.unstable_NormalPriority,$e=t.unstable_LowPriority,lt=t.unstable_IdlePriority,yt=t.log,Vt=t.unstable_setDisableYieldValue,kt=null,nt=null;function Rt(s){if(typeof yt=="function"&&Vt(s),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(kt,s)}catch{}}var Xt=Math.clz32?Math.clz32:Ze,Fe=Math.log,Ce=Math.LN2;function Ze(s){return s>>>=0,s===0?32:31-(Fe(s)/Ce|0)|0}var et=256,bt=262144,mt=4194304;function At(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function $t(s,i,l){var d=s.pendingLanes;if(d===0)return 0;var g=0,v=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var M=d&134217727;return M!==0?(d=M&~v,d!==0?g=At(d):(E&=M,E!==0?g=At(E):l||(l=M&~s,l!==0&&(g=At(l))))):(M=d&~v,M!==0?g=At(M):E!==0?g=At(E):l||(l=d&~s,l!==0&&(g=At(l)))),g===0?0:i!==0&&i!==g&&(i&v)===0&&(v=g&-g,l=i&-i,v>=l||v===32&&(l&4194048)!==0)?i:g}function St(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function ln(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qn(){var s=mt;return mt<<=1,(mt&62914560)===0&&(mt=4194304),s}function qe(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function xt(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function qt(s,i,l,d,g,v){var E=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var M=s.entanglements,q=s.expirationTimes,ie=s.hiddenUpdates;for(l=E&~l;0<l;){var ge=31-Xt(l),_e=1<<ge;M[ge]=0,q[ge]=-1;var ae=ie[ge];if(ae!==null)for(ie[ge]=null,ge=0;ge<ae.length;ge++){var de=ae[ge];de!==null&&(de.lane&=-536870913)}l&=~_e}d!==0&&rr(s,d,0),v!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=v&~(E&~i))}function rr(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var d=31-Xt(i);s.entangledLanes|=i,s.entanglements[d]=s.entanglements[d]|1073741824|l&261930}function oa(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var d=31-Xt(l),g=1<<d;g&i|s[d]&i&&(s[d]|=i),l&=~g}}function Zc(s,i){var l=i&-i;return l=(l&42)!==0?1:ho(l),(l&(s.suspendedLanes|i))!==0?0:l}function ho(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function gi(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function mh(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:sw(s.type))}function vs(s,i){var l=Z.p;try{return Z.p=s,i()}finally{Z.p=l}}var ys=Math.random().toString(36).slice(2),Rn="__reactFiber$"+ys,Jn="__reactProps$"+ys,Os="__reactContainer$"+ys,ml="__reactEvents$"+ys,tg="__reactListeners$"+ys,ph="__reactHandles$"+ys,gh="__reactResources$"+ys,Ls="__reactMarker$"+ys;function pl(s){delete s[Rn],delete s[Jn],delete s[ml],delete s[tg],delete s[ph]}function Vs(s){var i=s[Rn];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Os]||l[Rn]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=F_(s);s!==null;){if(l=s[Rn])return l;s=F_(s)}return i}s=l,l=s.parentNode}return null}function ns(s){if(s=s[Rn]||s[Os]){var i=s.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return s}return null}function Hr(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(r(33))}function Us(s){var i=s[gh];return i||(i=s[gh]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function In(s){s[Ls]=!0}var eu=new Set,tu={};function zs(s,i){Bs(s,i),Bs(s+"Capture",i)}function Bs(s,i){for(tu[s]=i,s=0;s<i.length;s++)eu.add(i[s])}var nu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ru={},su={};function vh(s){return ue.call(su,s)?!0:ue.call(ru,s)?!1:nu.test(s)?su[s]=!0:(ru[s]=!0,!1)}function gl(s,i,l){if(vh(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function $r(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function jn(s,i,l,d){if(d===null)s.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+d)}}function Zn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function la(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function iu(s,i,l){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,i);if(!s.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,v=d.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return g.call(this)},set:function(E){l=""+E,v.call(this,E)}}),Object.defineProperty(s,i,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(E){l=""+E},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Wt(s){if(!s._valueTracker){var i=la(s)?"checked":"value";s._valueTracker=iu(s,i,""+s[i])}}function fo(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),d="";return s&&(d=la(s)?s.checked?"true":"false":s.value),s=d,s!==l?(i.setValue(s),!0):!1}function Fs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var mo=/[\n"\\]/g;function Ar(s){return s.replace(mo,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function vl(s,i,l,d,g,v,E,M){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),i!=null?E==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+Zn(i)):s.value!==""+Zn(i)&&(s.value=""+Zn(i)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),i!=null?au(s,E,Zn(i)):l!=null?au(s,E,Zn(l)):d!=null&&s.removeAttribute("value"),g==null&&v!=null&&(s.defaultChecked=!!v),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?s.name=""+Zn(M):s.removeAttribute("name")}function yh(s,i,l,d,g,v,E,M){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),i!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){Wt(s);return}l=l!=null?""+Zn(l):"",i=i!=null?""+Zn(i):l,M||i===s.value||(s.value=i),s.defaultValue=i}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=M?s.checked:!!d,s.defaultChecked=!!d,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E),Wt(s)}function au(s,i,l){i==="number"&&Fs(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ca(s,i,l,d){if(s=s.options,i){i={};for(var g=0;g<l.length;g++)i["$"+l[g]]=!0;for(l=0;l<s.length;l++)g=i.hasOwnProperty("$"+s[l].value),s[l].selected!==g&&(s[l].selected=g),g&&d&&(s[l].defaultSelected=!0)}else{for(l=""+Zn(l),i=null,g=0;g<s.length;g++){if(s[g].value===l){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}i!==null||s[g].disabled||(i=s[g])}i!==null&&(i.selected=!0)}}function bh(s,i,l){if(i!=null&&(i=""+Zn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+Zn(l):""}function ua(s,i,l,d){if(i==null){if(d!=null){if(l!=null)throw Error(r(92));if(oe(d)){if(1<d.length)throw Error(r(93));d=d[0]}l=d}l==null&&(l=""),i=l}l=Zn(i),s.defaultValue=l,d=s.textContent,d===l&&d!==""&&d!==null&&(s.value=d),Wt(s)}function Rr(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var xh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ou(s,i,l){var d=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":d?s.setProperty(i,l):typeof l!="number"||l===0||xh.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function lu(s,i,l){if(i!=null&&typeof i!="object")throw Error(r(62));if(s=s.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var g in i)d=i[g],i.hasOwnProperty(g)&&l[g]!==d&&ou(s,g,d)}else for(var v in i)i.hasOwnProperty(v)&&ou(s,v,i[v])}function yl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _h=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),da=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bl(s){return da.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function bs(){}var cu=null;function rs(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ha=null,Hs=null;function po(s){var i=ns(s);if(i&&(s=i.stateNode)){var l=s[Jn]||null;e:switch(s=i.stateNode,i.type){case"input":if(vl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ar(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var d=l[i];if(d!==s&&d.form===s.form){var g=d[Jn]||null;if(!g)throw Error(r(90));vl(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<l.length;i++)d=l[i],d.form===s.form&&fo(d)}break e;case"textarea":bh(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&ca(s,!!l.multiple,i,!1)}}}var xl=!1;function fa(s,i,l){if(xl)return s(i,l);xl=!0;try{var d=s(i);return d}finally{if(xl=!1,(ha!==null||Hs!==null)&&(pf(),ha&&(i=ha,s=Hs,Hs=ha=null,po(i),s)))for(i=0;i<s.length;i++)po(s[i])}}function xs(s,i){var l=s.stateNode;if(l===null)return null;var d=l[Jn]||null;if(d===null)return null;l=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(r(231,i,typeof l));return l}var ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),go=!1;if(ss)try{var en={};Object.defineProperty(en,"passive",{get:function(){go=!0}}),window.addEventListener("test",en,en),window.removeEventListener("test",en,en)}catch{go=!1}var $s=null,uu=null,vo=null;function du(){if(vo)return vo;var s,i=uu,l=i.length,d,g="value"in $s?$s.value:$s.textContent,v=g.length;for(s=0;s<l&&i[s]===g[s];s++);var E=l-s;for(d=1;d<=E&&i[l-d]===g[v-d];d++);return vo=g.slice(s,1<d?1-d:void 0)}function yo(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function vi(){return!0}function _s(){return!1}function sr(s){function i(l,d,g,v,E){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var M in s)s.hasOwnProperty(M)&&(l=s[M],this[M]=l?l(v):v[M]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?vi:_s,this.isPropagationStopped=_s,this}return b(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=vi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=vi)},persist:function(){},isPersistent:vi}),i}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qs=sr(yi),ma=b({},yi,{view:0,detail:0}),hu=sr(ma),pa,_l,Gs,wl=b({},ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Gs&&(Gs&&s.type==="mousemove"?(pa=s.screenX-Gs.screenX,_l=s.screenY-Gs.screenY):_l=pa=0,Gs=s),pa)},movementY:function(s){return"movementY"in s?s.movementY:_l}}),fu=sr(wl),bo=b({},wl,{dataTransfer:0}),wh=sr(bo),Eh=b({},ma,{relatedTarget:0}),xo=sr(Eh),mu=b({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Sh=sr(mu),El=b({},yi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Th=sr(El),Ch=b({},yi,{data:0}),Ys=sr(Ch),kh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ah={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rh(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Ah[s])?!!i[s]:!1}function ga(){return Rh}var wr=b({},ma,{key:function(s){if(s.key){var i=kh[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=yo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(s){return s.type==="keypress"?yo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?yo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ih=sr(wr),jh=b({},wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bi=sr(jh),m=b({},ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga}),_=sr(m),C=b({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),z=sr(C),ee=b({},wl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=sr(ee),ze=b({},yi,{newState:0,oldState:0}),wt=sr(ze),Tn=[9,13,27,32],Gt=ss&&"CompositionEvent"in window,pn=null;ss&&"documentMode"in document&&(pn=document.documentMode);var is=ss&&"TextEvent"in window&&!pn,Ks=ss&&(!Gt||pn&&8<pn&&11>=pn),ws=" ",Es=!1;function _o(s,i){switch(s){case"keyup":return Tn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Tl=!1;function pR(s,i){switch(s){case"compositionend":return Sl(i);case"keypress":return i.which!==32?null:(Es=!0,ws);case"textInput":return s=i.data,s===ws&&Es?null:s;default:return null}}function gR(s,i){if(Tl)return s==="compositionend"||!Gt&&_o(s,i)?(s=du(),vo=uu=$s=null,Tl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ks&&i.locale!=="ko"?null:i.data;default:return null}}var vR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qb(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!vR[s.type]:i==="textarea"}function Gb(s,i,l,d){ha?Hs?Hs.push(d):Hs=[d]:ha=d,i=wf(i,"onChange"),0<i.length&&(l=new qs("onChange","change",null,l,d),s.push({event:l,listeners:i}))}var pu=null,gu=null;function yR(s){N_(s,0)}function Dh(s){var i=Hr(s);if(fo(i))return s}function Yb(s,i){if(s==="change")return i}var Kb=!1;if(ss){var ng;if(ss){var rg="oninput"in document;if(!rg){var Qb=document.createElement("div");Qb.setAttribute("oninput","return;"),rg=typeof Qb.oninput=="function"}ng=rg}else ng=!1;Kb=ng&&(!document.documentMode||9<document.documentMode)}function Xb(){pu&&(pu.detachEvent("onpropertychange",Wb),gu=pu=null)}function Wb(s){if(s.propertyName==="value"&&Dh(gu)){var i=[];Gb(i,gu,s,rs(s)),fa(yR,i)}}function bR(s,i,l){s==="focusin"?(Xb(),pu=i,gu=l,pu.attachEvent("onpropertychange",Wb)):s==="focusout"&&Xb()}function xR(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Dh(gu)}function _R(s,i){if(s==="click")return Dh(i)}function wR(s,i){if(s==="input"||s==="change")return Dh(i)}function ER(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var qr=typeof Object.is=="function"?Object.is:ER;function vu(s,i){if(qr(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),d=Object.keys(i);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!ue.call(i,g)||!qr(s[g],i[g]))return!1}return!0}function Jb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Zb(s,i){var l=Jb(s);s=0;for(var d;l;){if(l.nodeType===3){if(d=s+l.textContent.length,s<=i&&d>=i)return{node:l,offset:i-s};s=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Jb(l)}}function ex(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?ex(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function tx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Fs(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Fs(s.document)}return i}function sg(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var SR=ss&&"documentMode"in document&&11>=document.documentMode,Cl=null,ig=null,yu=null,ag=!1;function nx(s,i,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ag||Cl==null||Cl!==Fs(d)||(d=Cl,"selectionStart"in d&&sg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),yu&&vu(yu,d)||(yu=d,d=wf(ig,"onSelect"),0<d.length&&(i=new qs("onSelect","select",null,i,l),s.push({event:i,listeners:d}),i.target=Cl)))}function wo(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var kl={animationend:wo("Animation","AnimationEnd"),animationiteration:wo("Animation","AnimationIteration"),animationstart:wo("Animation","AnimationStart"),transitionrun:wo("Transition","TransitionRun"),transitionstart:wo("Transition","TransitionStart"),transitioncancel:wo("Transition","TransitionCancel"),transitionend:wo("Transition","TransitionEnd")},og={},rx={};ss&&(rx=document.createElement("div").style,"AnimationEvent"in window||(delete kl.animationend.animation,delete kl.animationiteration.animation,delete kl.animationstart.animation),"TransitionEvent"in window||delete kl.transitionend.transition);function Eo(s){if(og[s])return og[s];if(!kl[s])return s;var i=kl[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in rx)return og[s]=i[l];return s}var sx=Eo("animationend"),ix=Eo("animationiteration"),ax=Eo("animationstart"),TR=Eo("transitionrun"),CR=Eo("transitionstart"),kR=Eo("transitioncancel"),ox=Eo("transitionend"),lx=new Map,lg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lg.push("scrollEnd");function Ss(s,i){lx.set(s,i),zs(i,[s])}var Ph=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},as=[],Nl=0,cg=0;function Mh(){for(var s=Nl,i=cg=Nl=0;i<s;){var l=as[i];as[i++]=null;var d=as[i];as[i++]=null;var g=as[i];as[i++]=null;var v=as[i];if(as[i++]=null,d!==null&&g!==null){var E=d.pending;E===null?g.next=g:(g.next=E.next,E.next=g),d.pending=g}v!==0&&cx(l,g,v)}}function Oh(s,i,l,d){as[Nl++]=s,as[Nl++]=i,as[Nl++]=l,as[Nl++]=d,cg|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function ug(s,i,l,d){return Oh(s,i,l,d),Lh(s)}function So(s,i){return Oh(s,null,null,i),Lh(s)}function cx(s,i,l){s.lanes|=l;var d=s.alternate;d!==null&&(d.lanes|=l);for(var g=!1,v=s.return;v!==null;)v.childLanes|=l,d=v.alternate,d!==null&&(d.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(g=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,g&&i!==null&&(g=31-Xt(l),s=v.hiddenUpdates,d=s[g],d===null?s[g]=[i]:d.push(i),i.lane=l|536870912),v):null}function Lh(s){if(50<zu)throw zu=0,bv=null,Error(r(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Al={};function NR(s,i,l,d){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gr(s,i,l,d){return new NR(s,i,l,d)}function dg(s){return s=s.prototype,!(!s||!s.isReactComponent)}function xi(s,i){var l=s.alternate;return l===null?(l=Gr(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function ux(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Vh(s,i,l,d,g,v){var E=0;if(d=s,typeof s=="function")dg(s)&&(E=1);else if(typeof s=="string")E=D6(s,l,he.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Gr(31,l,i,g),s.elementType=R,s.lanes=v,s;case A:return To(l.children,g,v,i);case N:E=8,g|=24;break;case V:return s=Gr(12,l,i,g|2),s.elementType=V,s.lanes=v,s;case B:return s=Gr(13,l,i,g),s.elementType=B,s.lanes=v,s;case H:return s=Gr(19,l,i,g),s.elementType=H,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case j:E=10;break e;case F:E=9;break e;case O:E=11;break e;case w:E=14;break e;case S:E=16,d=null;break e}E=29,l=Error(r(130,s===null?"null":typeof s,"")),d=null}return i=Gr(E,l,i,g),i.elementType=s,i.type=d,i.lanes=v,i}function To(s,i,l,d){return s=Gr(7,s,d,i),s.lanes=l,s}function hg(s,i,l){return s=Gr(6,s,null,i),s.lanes=l,s}function dx(s){var i=Gr(18,null,null,0);return i.stateNode=s,i}function fg(s,i,l){return i=Gr(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var hx=new WeakMap;function os(s,i){if(typeof s=="object"&&s!==null){var l=hx.get(s);return l!==void 0?l:(i={value:s,source:i,stack:K(i)},hx.set(s,i),i)}return{value:s,source:i,stack:K(i)}}var Rl=[],Il=0,Uh=null,bu=0,ls=[],cs=0,va=null,Qs=1,Xs="";function _i(s,i){Rl[Il++]=bu,Rl[Il++]=Uh,Uh=s,bu=i}function fx(s,i,l){ls[cs++]=Qs,ls[cs++]=Xs,ls[cs++]=va,va=s;var d=Qs;s=Xs;var g=32-Xt(d)-1;d&=~(1<<g),l+=1;var v=32-Xt(i)+g;if(30<v){var E=g-g%5;v=(d&(1<<E)-1).toString(32),d>>=E,g-=E,Qs=1<<32-Xt(i)+g|l<<g|d,Xs=v+s}else Qs=1<<v|l<<g|d,Xs=s}function mg(s){s.return!==null&&(_i(s,1),fx(s,1,0))}function pg(s){for(;s===Uh;)Uh=Rl[--Il],Rl[Il]=null,bu=Rl[--Il],Rl[Il]=null;for(;s===va;)va=ls[--cs],ls[cs]=null,Xs=ls[--cs],ls[cs]=null,Qs=ls[--cs],ls[cs]=null}function mx(s,i){ls[cs++]=Qs,ls[cs++]=Xs,ls[cs++]=va,Qs=i.id,Xs=i.overflow,va=s}var ir=null,cn=null,Ut=!1,ya=null,us=!1,gg=Error(r(519));function ba(s){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xu(os(i,s)),gg}function px(s){var i=s.stateNode,l=s.type,d=s.memoizedProps;switch(i[Rn]=s,i[Jn]=d,l){case"dialog":jt("cancel",i),jt("close",i);break;case"iframe":case"object":case"embed":jt("load",i);break;case"video":case"audio":for(l=0;l<Fu.length;l++)jt(Fu[l],i);break;case"source":jt("error",i);break;case"img":case"image":case"link":jt("error",i),jt("load",i);break;case"details":jt("toggle",i);break;case"input":jt("invalid",i),yh(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":jt("invalid",i);break;case"textarea":jt("invalid",i),ua(i,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||d.suppressHydrationWarning===!0||j_(i.textContent,l)?(d.popover!=null&&(jt("beforetoggle",i),jt("toggle",i)),d.onScroll!=null&&jt("scroll",i),d.onScrollEnd!=null&&jt("scrollend",i),d.onClick!=null&&(i.onclick=bs),i=!0):i=!1,i||ba(s,!0)}function gx(s){for(ir=s.return;ir;)switch(ir.tag){case 5:case 31:case 13:us=!1;return;case 27:case 3:us=!0;return;default:ir=ir.return}}function jl(s){if(s!==ir)return!1;if(!Ut)return gx(s),Ut=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Pv(s.type,s.memoizedProps)),l=!l),l&&cn&&ba(s),gx(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));cn=B_(s)}else if(i===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));cn=B_(s)}else i===27?(i=cn,Da(s.type)?(s=Uv,Uv=null,cn=s):cn=i):cn=ir?hs(s.stateNode.nextSibling):null;return!0}function Co(){cn=ir=null,Ut=!1}function vg(){var s=ya;return s!==null&&(Pr===null?Pr=s:Pr.push.apply(Pr,s),ya=null),s}function xu(s){ya===null?ya=[s]:ya.push(s)}var yg=$(null),ko=null,wi=null;function xa(s,i,l){re(yg,i._currentValue),i._currentValue=l}function Ei(s){s._currentValue=yg.current,X(yg)}function bg(s,i,l){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===l)break;s=s.return}}function xg(s,i,l,d){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var v=g.dependencies;if(v!==null){var E=g.child;v=v.firstContext;e:for(;v!==null;){var M=v;v=g;for(var q=0;q<i.length;q++)if(M.context===i[q]){v.lanes|=l,M=v.alternate,M!==null&&(M.lanes|=l),bg(v.return,l,s),d||(E=null);break e}v=M.next}}else if(g.tag===18){if(E=g.return,E===null)throw Error(r(341));E.lanes|=l,v=E.alternate,v!==null&&(v.lanes|=l),bg(E,l,s),E=null}else E=g.child;if(E!==null)E.return=g;else for(E=g;E!==null;){if(E===s){E=null;break}if(g=E.sibling,g!==null){g.return=E.return,E=g;break}E=E.return}g=E}}function Dl(s,i,l,d){s=null;for(var g=i,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var E=g.alternate;if(E===null)throw Error(r(387));if(E=E.memoizedProps,E!==null){var M=g.type;qr(g.pendingProps.value,E.value)||(s!==null?s.push(M):s=[M])}}else if(g===te.current){if(E=g.alternate,E===null)throw Error(r(387));E.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Yu):s=[Yu])}g=g.return}s!==null&&xg(i,s,l,d),i.flags|=262144}function zh(s){for(s=s.firstContext;s!==null;){if(!qr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function No(s){ko=s,wi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ar(s){return vx(ko,s)}function Bh(s,i){return ko===null&&No(s),vx(s,i)}function vx(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},wi===null){if(s===null)throw Error(r(308));wi=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else wi=wi.next=i;return l}var AR=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,d){s.push(d)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},RR=t.unstable_scheduleCallback,IR=t.unstable_NormalPriority,Dn={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _g(){return{controller:new AR,data:new Map,refCount:0}}function _u(s){s.refCount--,s.refCount===0&&RR(IR,function(){s.controller.abort()})}var wu=null,wg=0,Pl=0,Ml=null;function jR(s,i){if(wu===null){var l=wu=[];wg=0,Pl=Tv(),Ml={status:"pending",value:void 0,then:function(d){l.push(d)}}}return wg++,i.then(yx,yx),i}function yx(){if(--wg===0&&wu!==null){Ml!==null&&(Ml.status="fulfilled");var s=wu;wu=null,Pl=0,Ml=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function DR(s,i){var l=[],d={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return s.then(function(){d.status="fulfilled",d.value=i;for(var g=0;g<l.length;g++)(0,l[g])(i)},function(g){for(d.status="rejected",d.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),d}var bx=G.S;G.S=function(s,i){n_=W(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&jR(s,i),bx!==null&&bx(s,i)};var Ao=$(null);function Eg(){var s=Ao.current;return s!==null?s:sn.pooledCache}function Fh(s,i){i===null?re(Ao,Ao.current):re(Ao,i.pool)}function xx(){var s=Eg();return s===null?null:{parent:Dn._currentValue,pool:s}}var Ol=Error(r(460)),Sg=Error(r(474)),Hh=Error(r(542)),$h={then:function(){}};function _x(s){return s=s.status,s==="fulfilled"||s==="rejected"}function wx(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(bs,bs),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Sx(s),s;default:if(typeof i.status=="string")i.then(bs,bs);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=i,s.status="pending",s.then(function(d){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=d}},function(d){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Sx(s),s}throw Io=i,Ol}}function Ro(s){try{var i=s._init;return i(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Io=l,Ol):l}}var Io=null;function Ex(){if(Io===null)throw Error(r(459));var s=Io;return Io=null,s}function Sx(s){if(s===Ol||s===Hh)throw Error(r(483))}var Ll=null,Eu=0;function qh(s){var i=Eu;return Eu+=1,Ll===null&&(Ll=[]),wx(Ll,s,i)}function Su(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function Gh(s,i){throw i.$$typeof===x?Error(r(525)):(s=Object.prototype.toString.call(i),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Tx(s){function i(Q,Y){if(s){var se=Q.deletions;se===null?(Q.deletions=[Y],Q.flags|=16):se.push(Y)}}function l(Q,Y){if(!s)return null;for(;Y!==null;)i(Q,Y),Y=Y.sibling;return null}function d(Q){for(var Y=new Map;Q!==null;)Q.key!==null?Y.set(Q.key,Q):Y.set(Q.index,Q),Q=Q.sibling;return Y}function g(Q,Y){return Q=xi(Q,Y),Q.index=0,Q.sibling=null,Q}function v(Q,Y,se){return Q.index=se,s?(se=Q.alternate,se!==null?(se=se.index,se<Y?(Q.flags|=67108866,Y):se):(Q.flags|=67108866,Y)):(Q.flags|=1048576,Y)}function E(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function M(Q,Y,se,be){return Y===null||Y.tag!==6?(Y=hg(se,Q.mode,be),Y.return=Q,Y):(Y=g(Y,se),Y.return=Q,Y)}function q(Q,Y,se,be){var rt=se.type;return rt===A?ge(Q,Y,se.props.children,be,se.key):Y!==null&&(Y.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===S&&Ro(rt)===Y.type)?(Y=g(Y,se.props),Su(Y,se),Y.return=Q,Y):(Y=Vh(se.type,se.key,se.props,null,Q.mode,be),Su(Y,se),Y.return=Q,Y)}function ie(Q,Y,se,be){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==se.containerInfo||Y.stateNode.implementation!==se.implementation?(Y=fg(se,Q.mode,be),Y.return=Q,Y):(Y=g(Y,se.children||[]),Y.return=Q,Y)}function ge(Q,Y,se,be,rt){return Y===null||Y.tag!==7?(Y=To(se,Q.mode,be,rt),Y.return=Q,Y):(Y=g(Y,se),Y.return=Q,Y)}function _e(Q,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=hg(""+Y,Q.mode,se),Y.return=Q,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case k:return se=Vh(Y.type,Y.key,Y.props,null,Q.mode,se),Su(se,Y),se.return=Q,se;case I:return Y=fg(Y,Q.mode,se),Y.return=Q,Y;case S:return Y=Ro(Y),_e(Q,Y,se)}if(oe(Y)||U(Y))return Y=To(Y,Q.mode,se,null),Y.return=Q,Y;if(typeof Y.then=="function")return _e(Q,qh(Y),se);if(Y.$$typeof===j)return _e(Q,Bh(Q,Y),se);Gh(Q,Y)}return null}function ae(Q,Y,se,be){var rt=Y!==null?Y.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return rt!==null?null:M(Q,Y,""+se,be);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case k:return se.key===rt?q(Q,Y,se,be):null;case I:return se.key===rt?ie(Q,Y,se,be):null;case S:return se=Ro(se),ae(Q,Y,se,be)}if(oe(se)||U(se))return rt!==null?null:ge(Q,Y,se,be,null);if(typeof se.then=="function")return ae(Q,Y,qh(se),be);if(se.$$typeof===j)return ae(Q,Y,Bh(Q,se),be);Gh(Q,se)}return null}function de(Q,Y,se,be,rt){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return Q=Q.get(se)||null,M(Y,Q,""+be,rt);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case k:return Q=Q.get(be.key===null?se:be.key)||null,q(Y,Q,be,rt);case I:return Q=Q.get(be.key===null?se:be.key)||null,ie(Y,Q,be,rt);case S:return be=Ro(be),de(Q,Y,se,be,rt)}if(oe(be)||U(be))return Q=Q.get(se)||null,ge(Y,Q,be,rt,null);if(typeof be.then=="function")return de(Q,Y,se,qh(be),rt);if(be.$$typeof===j)return de(Q,Y,se,Bh(Y,be),rt);Gh(Y,be)}return null}function Ye(Q,Y,se,be){for(var rt=null,Bt=null,Je=Y,Tt=Y=0,Pt=null;Je!==null&&Tt<se.length;Tt++){Je.index>Tt?(Pt=Je,Je=null):Pt=Je.sibling;var Ft=ae(Q,Je,se[Tt],be);if(Ft===null){Je===null&&(Je=Pt);break}s&&Je&&Ft.alternate===null&&i(Q,Je),Y=v(Ft,Y,Tt),Bt===null?rt=Ft:Bt.sibling=Ft,Bt=Ft,Je=Pt}if(Tt===se.length)return l(Q,Je),Ut&&_i(Q,Tt),rt;if(Je===null){for(;Tt<se.length;Tt++)Je=_e(Q,se[Tt],be),Je!==null&&(Y=v(Je,Y,Tt),Bt===null?rt=Je:Bt.sibling=Je,Bt=Je);return Ut&&_i(Q,Tt),rt}for(Je=d(Je);Tt<se.length;Tt++)Pt=de(Je,Q,Tt,se[Tt],be),Pt!==null&&(s&&Pt.alternate!==null&&Je.delete(Pt.key===null?Tt:Pt.key),Y=v(Pt,Y,Tt),Bt===null?rt=Pt:Bt.sibling=Pt,Bt=Pt);return s&&Je.forEach(function(Va){return i(Q,Va)}),Ut&&_i(Q,Tt),rt}function ut(Q,Y,se,be){if(se==null)throw Error(r(151));for(var rt=null,Bt=null,Je=Y,Tt=Y=0,Pt=null,Ft=se.next();Je!==null&&!Ft.done;Tt++,Ft=se.next()){Je.index>Tt?(Pt=Je,Je=null):Pt=Je.sibling;var Va=ae(Q,Je,Ft.value,be);if(Va===null){Je===null&&(Je=Pt);break}s&&Je&&Va.alternate===null&&i(Q,Je),Y=v(Va,Y,Tt),Bt===null?rt=Va:Bt.sibling=Va,Bt=Va,Je=Pt}if(Ft.done)return l(Q,Je),Ut&&_i(Q,Tt),rt;if(Je===null){for(;!Ft.done;Tt++,Ft=se.next())Ft=_e(Q,Ft.value,be),Ft!==null&&(Y=v(Ft,Y,Tt),Bt===null?rt=Ft:Bt.sibling=Ft,Bt=Ft);return Ut&&_i(Q,Tt),rt}for(Je=d(Je);!Ft.done;Tt++,Ft=se.next())Ft=de(Je,Q,Tt,Ft.value,be),Ft!==null&&(s&&Ft.alternate!==null&&Je.delete(Ft.key===null?Tt:Ft.key),Y=v(Ft,Y,Tt),Bt===null?rt=Ft:Bt.sibling=Ft,Bt=Ft);return s&&Je.forEach(function($6){return i(Q,$6)}),Ut&&_i(Q,Tt),rt}function rn(Q,Y,se,be){if(typeof se=="object"&&se!==null&&se.type===A&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case k:e:{for(var rt=se.key;Y!==null;){if(Y.key===rt){if(rt=se.type,rt===A){if(Y.tag===7){l(Q,Y.sibling),be=g(Y,se.props.children),be.return=Q,Q=be;break e}}else if(Y.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===S&&Ro(rt)===Y.type){l(Q,Y.sibling),be=g(Y,se.props),Su(be,se),be.return=Q,Q=be;break e}l(Q,Y);break}else i(Q,Y);Y=Y.sibling}se.type===A?(be=To(se.props.children,Q.mode,be,se.key),be.return=Q,Q=be):(be=Vh(se.type,se.key,se.props,null,Q.mode,be),Su(be,se),be.return=Q,Q=be)}return E(Q);case I:e:{for(rt=se.key;Y!==null;){if(Y.key===rt)if(Y.tag===4&&Y.stateNode.containerInfo===se.containerInfo&&Y.stateNode.implementation===se.implementation){l(Q,Y.sibling),be=g(Y,se.children||[]),be.return=Q,Q=be;break e}else{l(Q,Y);break}else i(Q,Y);Y=Y.sibling}be=fg(se,Q.mode,be),be.return=Q,Q=be}return E(Q);case S:return se=Ro(se),rn(Q,Y,se,be)}if(oe(se))return Ye(Q,Y,se,be);if(U(se)){if(rt=U(se),typeof rt!="function")throw Error(r(150));return se=rt.call(se),ut(Q,Y,se,be)}if(typeof se.then=="function")return rn(Q,Y,qh(se),be);if(se.$$typeof===j)return rn(Q,Y,Bh(Q,se),be);Gh(Q,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Y!==null&&Y.tag===6?(l(Q,Y.sibling),be=g(Y,se),be.return=Q,Q=be):(l(Q,Y),be=hg(se,Q.mode,be),be.return=Q,Q=be),E(Q)):l(Q,Y)}return function(Q,Y,se,be){try{Eu=0;var rt=rn(Q,Y,se,be);return Ll=null,rt}catch(Je){if(Je===Ol||Je===Hh)throw Je;var Bt=Gr(29,Je,null,Q.mode);return Bt.lanes=be,Bt.return=Q,Bt}finally{}}}var jo=Tx(!0),Cx=Tx(!1),_a=!1;function Tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cg(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function wa(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ea(s,i,l){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Yt&2)!==0){var g=d.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),d.pending=i,i=Lh(s),cx(s,null,l),i}return Oh(s,d,i,l),Lh(s)}function Tu(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var d=i.lanes;d&=s.pendingLanes,l|=d,i.lanes=l,oa(s,l)}}function kg(s,i){var l=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?g=v=E:v=v.next=E,l=l.next}while(l!==null);v===null?g=v=i:v=v.next=i}else g=v=i;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var Ng=!1;function Cu(){if(Ng){var s=Ml;if(s!==null)throw s}}function ku(s,i,l,d){Ng=!1;var g=s.updateQueue;_a=!1;var v=g.firstBaseUpdate,E=g.lastBaseUpdate,M=g.shared.pending;if(M!==null){g.shared.pending=null;var q=M,ie=q.next;q.next=null,E===null?v=ie:E.next=ie,E=q;var ge=s.alternate;ge!==null&&(ge=ge.updateQueue,M=ge.lastBaseUpdate,M!==E&&(M===null?ge.firstBaseUpdate=ie:M.next=ie,ge.lastBaseUpdate=q))}if(v!==null){var _e=g.baseState;E=0,ge=ie=q=null,M=v;do{var ae=M.lane&-536870913,de=ae!==M.lane;if(de?(Dt&ae)===ae:(d&ae)===ae){ae!==0&&ae===Pl&&(Ng=!0),ge!==null&&(ge=ge.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Ye=s,ut=M;ae=i;var rn=l;switch(ut.tag){case 1:if(Ye=ut.payload,typeof Ye=="function"){_e=Ye.call(rn,_e,ae);break e}_e=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=ut.payload,ae=typeof Ye=="function"?Ye.call(rn,_e,ae):Ye,ae==null)break e;_e=b({},_e,ae);break e;case 2:_a=!0}}ae=M.callback,ae!==null&&(s.flags|=64,de&&(s.flags|=8192),de=g.callbacks,de===null?g.callbacks=[ae]:de.push(ae))}else de={lane:ae,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ge===null?(ie=ge=de,q=_e):ge=ge.next=de,E|=ae;if(M=M.next,M===null){if(M=g.shared.pending,M===null)break;de=M,M=de.next,de.next=null,g.lastBaseUpdate=de,g.shared.pending=null}}while(!0);ge===null&&(q=_e),g.baseState=q,g.firstBaseUpdate=ie,g.lastBaseUpdate=ge,v===null&&(g.shared.lanes=0),Na|=E,s.lanes=E,s.memoizedState=_e}}function kx(s,i){if(typeof s!="function")throw Error(r(191,s));s.call(i)}function Nx(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)kx(l[s],i)}var Vl=$(null),Yh=$(0);function Ax(s,i){s=ji,re(Yh,s),re(Vl,i),ji=s|i.baseLanes}function Ag(){re(Yh,ji),re(Vl,Vl.current)}function Rg(){ji=Yh.current,X(Vl),X(Yh)}var Yr=$(null),ds=null;function Sa(s){var i=s.alternate;re(Cn,Cn.current&1),re(Yr,s),ds===null&&(i===null||Vl.current!==null||i.memoizedState!==null)&&(ds=s)}function Ig(s){re(Cn,Cn.current),re(Yr,s),ds===null&&(ds=s)}function Rx(s){s.tag===22?(re(Cn,Cn.current),re(Yr,s),ds===null&&(ds=s)):Ta()}function Ta(){re(Cn,Cn.current),re(Yr,Yr.current)}function Kr(s){X(Yr),ds===s&&(ds=null),X(Cn)}var Cn=$(0);function Kh(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Lv(l)||Vv(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Si=0,Et=null,tn=null,Pn=null,Qh=!1,Ul=!1,Do=!1,Xh=0,Nu=0,zl=null,PR=0;function _n(){throw Error(r(321))}function jg(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!qr(s[l],i[l]))return!1;return!0}function Dg(s,i,l,d,g,v){return Si=v,Et=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,G.H=s===null||s.memoizedState===null?f2:Kg,Do=!1,v=l(d,g),Do=!1,Ul&&(v=jx(i,l,d,g)),Ix(s),v}function Ix(s){G.H=Iu;var i=tn!==null&&tn.next!==null;if(Si=0,Pn=tn=Et=null,Qh=!1,Nu=0,zl=null,i)throw Error(r(300));s===null||Mn||(s=s.dependencies,s!==null&&zh(s)&&(Mn=!0))}function jx(s,i,l,d){Et=s;var g=0;do{if(Ul&&(zl=null),Nu=0,Ul=!1,25<=g)throw Error(r(301));if(g+=1,Pn=tn=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}G.H=m2,v=i(l,d)}while(Ul);return v}function MR(){var s=G.H,i=s.useState()[0];return i=typeof i.then=="function"?Au(i):i,s=s.useState()[0],(tn!==null?tn.memoizedState:null)!==s&&(Et.flags|=1024),i}function Pg(){var s=Xh!==0;return Xh=0,s}function Mg(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function Og(s){if(Qh){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Qh=!1}Si=0,Pn=tn=Et=null,Ul=!1,Nu=Xh=0,zl=null}function Er(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?Et.memoizedState=Pn=s:Pn=Pn.next=s,Pn}function kn(){if(tn===null){var s=Et.alternate;s=s!==null?s.memoizedState:null}else s=tn.next;var i=Pn===null?Et.memoizedState:Pn.next;if(i!==null)Pn=i,tn=s;else{if(s===null)throw Et.alternate===null?Error(r(467)):Error(r(310));tn=s,s={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},Pn===null?Et.memoizedState=Pn=s:Pn=Pn.next=s}return Pn}function Wh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Au(s){var i=Nu;return Nu+=1,zl===null&&(zl=[]),s=wx(zl,s,i),i=Et,(Pn===null?i.memoizedState:Pn.next)===null&&(i=i.alternate,G.H=i===null||i.memoizedState===null?f2:Kg),s}function Jh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Au(s);if(s.$$typeof===j)return ar(s)}throw Error(r(438,String(s)))}function Lg(s){var i=null,l=Et.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var d=Et.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=Wh(),Et.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),d=0;d<s;d++)l[d]=D;return i.index++,l}function Ti(s,i){return typeof i=="function"?i(s):i}function Zh(s){var i=kn();return Vg(i,tn,s)}function Vg(s,i,l){var d=s.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=l;var g=s.baseQueue,v=d.pending;if(v!==null){if(g!==null){var E=g.next;g.next=v.next,v.next=E}i.baseQueue=g=v,d.pending=null}if(v=s.baseState,g===null)s.memoizedState=v;else{i=g.next;var M=E=null,q=null,ie=i,ge=!1;do{var _e=ie.lane&-536870913;if(_e!==ie.lane?(Dt&_e)===_e:(Si&_e)===_e){var ae=ie.revertLane;if(ae===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_e===Pl&&(ge=!0);else if((Si&ae)===ae){ie=ie.next,ae===Pl&&(ge=!0);continue}else _e={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},q===null?(M=q=_e,E=v):q=q.next=_e,Et.lanes|=ae,Na|=ae;_e=ie.action,Do&&l(v,_e),v=ie.hasEagerState?ie.eagerState:l(v,_e)}else ae={lane:_e,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},q===null?(M=q=ae,E=v):q=q.next=ae,Et.lanes|=_e,Na|=_e;ie=ie.next}while(ie!==null&&ie!==i);if(q===null?E=v:q.next=M,!qr(v,s.memoizedState)&&(Mn=!0,ge&&(l=Ml,l!==null)))throw l;s.memoizedState=v,s.baseState=E,s.baseQueue=q,d.lastRenderedState=v}return g===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Ug(s){var i=kn(),l=i.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=s;var d=l.dispatch,g=l.pending,v=i.memoizedState;if(g!==null){l.pending=null;var E=g=g.next;do v=s(v,E.action),E=E.next;while(E!==g);qr(v,i.memoizedState)||(Mn=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),l.lastRenderedState=v}return[v,d]}function Dx(s,i,l){var d=Et,g=kn(),v=Ut;if(v){if(l===void 0)throw Error(r(407));l=l()}else l=i();var E=!qr((tn||g).memoizedState,l);if(E&&(g.memoizedState=l,Mn=!0),g=g.queue,Fg(Ox.bind(null,d,g,s),[s]),g.getSnapshot!==i||E||Pn!==null&&Pn.memoizedState.tag&1){if(d.flags|=2048,Bl(9,{destroy:void 0},Mx.bind(null,d,g,l,i),null),sn===null)throw Error(r(349));v||(Si&127)!==0||Px(d,i,l)}return l}function Px(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Et.updateQueue,i===null?(i=Wh(),Et.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function Mx(s,i,l,d){i.value=l,i.getSnapshot=d,Lx(i)&&Vx(s)}function Ox(s,i,l){return l(function(){Lx(i)&&Vx(s)})}function Lx(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!qr(s,l)}catch{return!0}}function Vx(s){var i=So(s,2);i!==null&&Mr(i,s,2)}function zg(s){var i=Er();if(typeof s=="function"){var l=s;if(s=l(),Do){Rt(!0);try{l()}finally{Rt(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:s},i}function Ux(s,i,l,d){return s.baseState=l,Vg(s,tn,typeof d=="function"?d:Ti)}function OR(s,i,l,d,g){if(nf(s))throw Error(r(485));if(s=i.action,s!==null){var v={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};G.T!==null?l(!0):v.isTransition=!1,d(v),l=i.pending,l===null?(v.next=i.pending=v,zx(i,v)):(v.next=l.next,i.pending=l.next=v)}}function zx(s,i){var l=i.action,d=i.payload,g=s.state;if(i.isTransition){var v=G.T,E={};G.T=E;try{var M=l(g,d),q=G.S;q!==null&&q(E,M),Bx(s,i,M)}catch(ie){Bg(s,i,ie)}finally{v!==null&&E.types!==null&&(v.types=E.types),G.T=v}}else try{v=l(g,d),Bx(s,i,v)}catch(ie){Bg(s,i,ie)}}function Bx(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){Fx(s,i,d)},function(d){return Bg(s,i,d)}):Fx(s,i,l)}function Fx(s,i,l){i.status="fulfilled",i.value=l,Hx(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,zx(s,l)))}function Bg(s,i,l){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=l,Hx(i),i=i.next;while(i!==d)}s.action=null}function Hx(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function $x(s,i){return i}function qx(s,i){if(Ut){var l=sn.formState;if(l!==null){e:{var d=Et;if(Ut){if(cn){t:{for(var g=cn,v=us;g.nodeType!==8;){if(!v){g=null;break t}if(g=hs(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){cn=hs(g.nextSibling),d=g.data==="F!";break e}}ba(d)}d=!1}d&&(i=l[0])}}return l=Er(),l.memoizedState=l.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$x,lastRenderedState:i},l.queue=d,l=u2.bind(null,Et,d),d.dispatch=l,d=zg(!1),v=Yg.bind(null,Et,!1,d.queue),d=Er(),g={state:i,dispatch:null,action:s,pending:null},d.queue=g,l=OR.bind(null,Et,g,v,l),g.dispatch=l,d.memoizedState=s,[i,l,!1]}function Gx(s){var i=kn();return Yx(i,tn,s)}function Yx(s,i,l){if(i=Vg(s,i,$x)[0],s=Zh(Ti)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Au(i)}catch(E){throw E===Ol?Hh:E}else d=i;i=kn();var g=i.queue,v=g.dispatch;return l!==i.memoizedState&&(Et.flags|=2048,Bl(9,{destroy:void 0},LR.bind(null,g,l),null)),[d,v,s]}function LR(s,i){s.action=i}function Kx(s){var i=kn(),l=tn;if(l!==null)return Yx(i,l,s);kn(),i=i.memoizedState,l=kn();var d=l.queue.dispatch;return l.memoizedState=s,[i,d,!1]}function Bl(s,i,l,d){return s={tag:s,create:l,deps:d,inst:i,next:null},i=Et.updateQueue,i===null&&(i=Wh(),Et.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(d=l.next,l.next=s,s.next=d,i.lastEffect=s),s}function Qx(){return kn().memoizedState}function ef(s,i,l,d){var g=Er();Et.flags|=s,g.memoizedState=Bl(1|i,{destroy:void 0},l,d===void 0?null:d)}function tf(s,i,l,d){var g=kn();d=d===void 0?null:d;var v=g.memoizedState.inst;tn!==null&&d!==null&&jg(d,tn.memoizedState.deps)?g.memoizedState=Bl(i,v,l,d):(Et.flags|=s,g.memoizedState=Bl(1|i,v,l,d))}function Xx(s,i){ef(8390656,8,s,i)}function Fg(s,i){tf(2048,8,s,i)}function VR(s){Et.flags|=4;var i=Et.updateQueue;if(i===null)i=Wh(),Et.updateQueue=i,i.events=[s];else{var l=i.events;l===null?i.events=[s]:l.push(s)}}function Wx(s){var i=kn().memoizedState;return VR({ref:i,nextImpl:s}),function(){if((Yt&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Jx(s,i){return tf(4,2,s,i)}function Zx(s,i){return tf(4,4,s,i)}function e2(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function t2(s,i,l){l=l!=null?l.concat([s]):null,tf(4,4,e2.bind(null,i,s),l)}function Hg(){}function n2(s,i){var l=kn();i=i===void 0?null:i;var d=l.memoizedState;return i!==null&&jg(i,d[1])?d[0]:(l.memoizedState=[s,i],s)}function r2(s,i){var l=kn();i=i===void 0?null:i;var d=l.memoizedState;if(i!==null&&jg(i,d[1]))return d[0];if(d=s(),Do){Rt(!0);try{s()}finally{Rt(!1)}}return l.memoizedState=[d,i],d}function $g(s,i,l){return l===void 0||(Si&1073741824)!==0&&(Dt&261930)===0?s.memoizedState=i:(s.memoizedState=l,s=s_(),Et.lanes|=s,Na|=s,l)}function s2(s,i,l,d){return qr(l,i)?l:Vl.current!==null?(s=$g(s,l,d),qr(s,i)||(Mn=!0),s):(Si&42)===0||(Si&1073741824)!==0&&(Dt&261930)===0?(Mn=!0,s.memoizedState=l):(s=s_(),Et.lanes|=s,Na|=s,i)}function i2(s,i,l,d,g){var v=Z.p;Z.p=v!==0&&8>v?v:8;var E=G.T,M={};G.T=M,Yg(s,!1,i,l);try{var q=g(),ie=G.S;if(ie!==null&&ie(M,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ge=DR(q,d);Ru(s,i,ge,Wr(s))}else Ru(s,i,d,Wr(s))}catch(_e){Ru(s,i,{then:function(){},status:"rejected",reason:_e},Wr())}finally{Z.p=v,E!==null&&M.types!==null&&(E.types=M.types),G.T=E}}function UR(){}function qg(s,i,l,d){if(s.tag!==5)throw Error(r(476));var g=a2(s).queue;i2(s,g,i,J,l===null?UR:function(){return o2(s),l(d)})}function a2(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:J},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function o2(s){var i=a2(s);i.next===null&&(i=s.alternate.memoizedState),Ru(s,i.next.queue,{},Wr())}function Gg(){return ar(Yu)}function l2(){return kn().memoizedState}function c2(){return kn().memoizedState}function zR(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=Wr();s=wa(l);var d=Ea(i,s,l);d!==null&&(Mr(d,i,l),Tu(d,i,l)),i={cache:_g()},s.payload=i;return}i=i.return}}function BR(s,i,l){var d=Wr();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},nf(s)?d2(i,l):(l=ug(s,i,l,d),l!==null&&(Mr(l,s,d),h2(l,i,d)))}function u2(s,i,l){var d=Wr();Ru(s,i,l,d)}function Ru(s,i,l,d){var g={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(nf(s))d2(i,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var E=i.lastRenderedState,M=v(E,l);if(g.hasEagerState=!0,g.eagerState=M,qr(M,E))return Oh(s,i,g,0),sn===null&&Mh(),!1}catch{}finally{}if(l=ug(s,i,g,d),l!==null)return Mr(l,s,d),h2(l,i,d),!0}return!1}function Yg(s,i,l,d){if(d={lane:2,revertLane:Tv(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},nf(s)){if(i)throw Error(r(479))}else i=ug(s,l,d,2),i!==null&&Mr(i,s,2)}function nf(s){var i=s.alternate;return s===Et||i!==null&&i===Et}function d2(s,i){Ul=Qh=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function h2(s,i,l){if((l&4194048)!==0){var d=i.lanes;d&=s.pendingLanes,l|=d,i.lanes=l,oa(s,l)}}var Iu={readContext:ar,use:Jh,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n};Iu.useEffectEvent=_n;var f2={readContext:ar,use:Jh,useCallback:function(s,i){return Er().memoizedState=[s,i===void 0?null:i],s},useContext:ar,useEffect:Xx,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,ef(4194308,4,e2.bind(null,i,s),l)},useLayoutEffect:function(s,i){return ef(4194308,4,s,i)},useInsertionEffect:function(s,i){ef(4,2,s,i)},useMemo:function(s,i){var l=Er();i=i===void 0?null:i;var d=s();if(Do){Rt(!0);try{s()}finally{Rt(!1)}}return l.memoizedState=[d,i],d},useReducer:function(s,i,l){var d=Er();if(l!==void 0){var g=l(i);if(Do){Rt(!0);try{l(i)}finally{Rt(!1)}}}else g=i;return d.memoizedState=d.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},d.queue=s,s=s.dispatch=BR.bind(null,Et,s),[d.memoizedState,s]},useRef:function(s){var i=Er();return s={current:s},i.memoizedState=s},useState:function(s){s=zg(s);var i=s.queue,l=u2.bind(null,Et,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:Hg,useDeferredValue:function(s,i){var l=Er();return $g(l,s,i)},useTransition:function(){var s=zg(!1);return s=i2.bind(null,Et,s.queue,!0,!1),Er().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var d=Et,g=Er();if(Ut){if(l===void 0)throw Error(r(407));l=l()}else{if(l=i(),sn===null)throw Error(r(349));(Dt&127)!==0||Px(d,i,l)}g.memoizedState=l;var v={value:l,getSnapshot:i};return g.queue=v,Xx(Ox.bind(null,d,v,s),[s]),d.flags|=2048,Bl(9,{destroy:void 0},Mx.bind(null,d,v,l,i),null),l},useId:function(){var s=Er(),i=sn.identifierPrefix;if(Ut){var l=Xs,d=Qs;l=(d&~(1<<32-Xt(d)-1)).toString(32)+l,i="_"+i+"R_"+l,l=Xh++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=PR++,i="_"+i+"r_"+l.toString(32)+"_";return s.memoizedState=i},useHostTransitionStatus:Gg,useFormState:qx,useActionState:qx,useOptimistic:function(s){var i=Er();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=Yg.bind(null,Et,!0,l),l.dispatch=i,[s,i]},useMemoCache:Lg,useCacheRefresh:function(){return Er().memoizedState=zR.bind(null,Et)},useEffectEvent:function(s){var i=Er(),l={impl:s};return i.memoizedState=l,function(){if((Yt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}},Kg={readContext:ar,use:Jh,useCallback:n2,useContext:ar,useEffect:Fg,useImperativeHandle:t2,useInsertionEffect:Jx,useLayoutEffect:Zx,useMemo:r2,useReducer:Zh,useRef:Qx,useState:function(){return Zh(Ti)},useDebugValue:Hg,useDeferredValue:function(s,i){var l=kn();return s2(l,tn.memoizedState,s,i)},useTransition:function(){var s=Zh(Ti)[0],i=kn().memoizedState;return[typeof s=="boolean"?s:Au(s),i]},useSyncExternalStore:Dx,useId:l2,useHostTransitionStatus:Gg,useFormState:Gx,useActionState:Gx,useOptimistic:function(s,i){var l=kn();return Ux(l,tn,s,i)},useMemoCache:Lg,useCacheRefresh:c2};Kg.useEffectEvent=Wx;var m2={readContext:ar,use:Jh,useCallback:n2,useContext:ar,useEffect:Fg,useImperativeHandle:t2,useInsertionEffect:Jx,useLayoutEffect:Zx,useMemo:r2,useReducer:Ug,useRef:Qx,useState:function(){return Ug(Ti)},useDebugValue:Hg,useDeferredValue:function(s,i){var l=kn();return tn===null?$g(l,s,i):s2(l,tn.memoizedState,s,i)},useTransition:function(){var s=Ug(Ti)[0],i=kn().memoizedState;return[typeof s=="boolean"?s:Au(s),i]},useSyncExternalStore:Dx,useId:l2,useHostTransitionStatus:Gg,useFormState:Kx,useActionState:Kx,useOptimistic:function(s,i){var l=kn();return tn!==null?Ux(l,tn,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Lg,useCacheRefresh:c2};m2.useEffectEvent=Wx;function Qg(s,i,l,d){i=s.memoizedState,l=l(d,i),l=l==null?i:b({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Xg={enqueueSetState:function(s,i,l){s=s._reactInternals;var d=Wr(),g=wa(d);g.payload=i,l!=null&&(g.callback=l),i=Ea(s,g,d),i!==null&&(Mr(i,s,d),Tu(i,s,d))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var d=Wr(),g=wa(d);g.tag=1,g.payload=i,l!=null&&(g.callback=l),i=Ea(s,g,d),i!==null&&(Mr(i,s,d),Tu(i,s,d))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=Wr(),d=wa(l);d.tag=2,i!=null&&(d.callback=i),i=Ea(s,d,l),i!==null&&(Mr(i,s,l),Tu(i,s,l))}};function p2(s,i,l,d,g,v,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,v,E):i.prototype&&i.prototype.isPureReactComponent?!vu(l,d)||!vu(g,v):!0}function g2(s,i,l,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,d),i.state!==s&&Xg.enqueueReplaceState(i,i.state,null)}function Po(s,i){var l=i;if("ref"in i){l={};for(var d in i)d!=="ref"&&(l[d]=i[d])}if(s=s.defaultProps){l===i&&(l=b({},l));for(var g in s)l[g]===void 0&&(l[g]=s[g])}return l}function v2(s){Ph(s)}function y2(s){console.error(s)}function b2(s){Ph(s)}function rf(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function x2(s,i,l){try{var d=s.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Wg(s,i,l){return l=wa(l),l.tag=3,l.payload={element:null},l.callback=function(){rf(s,i)},l}function _2(s){return s=wa(s),s.tag=3,s}function w2(s,i,l,d){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=d.value;s.payload=function(){return g(v)},s.callback=function(){x2(i,l,d)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){x2(i,l,d),typeof g!="function"&&(Aa===null?Aa=new Set([this]):Aa.add(this));var M=d.stack;this.componentDidCatch(d.value,{componentStack:M!==null?M:""})})}function FR(s,i,l,d,g){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=l.alternate,i!==null&&Dl(i,l,g,!0),l=Yr.current,l!==null){switch(l.tag){case 31:case 13:return ds===null?gf():l.alternate===null&&wn===0&&(wn=3),l.flags&=-257,l.flags|=65536,l.lanes=g,d===$h?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([d]):i.add(d),wv(s,d,g)),!1;case 22:return l.flags|=65536,d===$h?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([d]):l.add(d)),wv(s,d,g)),!1}throw Error(r(435,l.tag))}return wv(s,d,g),gf(),!1}if(Ut)return i=Yr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,d!==gg&&(s=Error(r(422),{cause:d}),xu(os(s,l)))):(d!==gg&&(i=Error(r(423),{cause:d}),xu(os(i,l))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,d=os(d,l),g=Wg(s.stateNode,d,g),kg(s,g),wn!==4&&(wn=2)),!1;var v=Error(r(520),{cause:d});if(v=os(v,l),Uu===null?Uu=[v]:Uu.push(v),wn!==4&&(wn=2),i===null)return!0;d=os(d,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=g&-g,l.lanes|=s,s=Wg(l.stateNode,d,s),kg(l,s),!1;case 1:if(i=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Aa===null||!Aa.has(v))))return l.flags|=65536,g&=-g,l.lanes|=g,g=_2(g),w2(g,s,l,d),kg(l,g),!1}l=l.return}while(l!==null);return!1}var Jg=Error(r(461)),Mn=!1;function or(s,i,l,d){i.child=s===null?Cx(i,null,l,d):jo(i,s.child,l,d)}function E2(s,i,l,d,g){l=l.render;var v=i.ref;if("ref"in d){var E={};for(var M in d)M!=="ref"&&(E[M]=d[M])}else E=d;return No(i),d=Dg(s,i,l,E,v,g),M=Pg(),s!==null&&!Mn?(Mg(s,i,g),Ci(s,i,g)):(Ut&&M&&mg(i),i.flags|=1,or(s,i,d,g),i.child)}function S2(s,i,l,d,g){if(s===null){var v=l.type;return typeof v=="function"&&!dg(v)&&v.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=v,T2(s,i,v,d,g)):(s=Vh(l.type,null,d,i,i.mode,g),s.ref=i.ref,s.return=i,i.child=s)}if(v=s.child,!av(s,g)){var E=v.memoizedProps;if(l=l.compare,l=l!==null?l:vu,l(E,d)&&s.ref===i.ref)return Ci(s,i,g)}return i.flags|=1,s=xi(v,d),s.ref=i.ref,s.return=i,i.child=s}function T2(s,i,l,d,g){if(s!==null){var v=s.memoizedProps;if(vu(v,d)&&s.ref===i.ref)if(Mn=!1,i.pendingProps=d=v,av(s,g))(s.flags&131072)!==0&&(Mn=!0);else return i.lanes=s.lanes,Ci(s,i,g)}return Zg(s,i,l,d,g)}function C2(s,i,l,d){var g=d.children,v=s!==null?s.memoizedState:null;if(s===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|l:l,s!==null){for(d=i.child=s.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~v}else d=0,i.child=null;return k2(s,i,v,l,d)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Fh(i,v!==null?v.cachePool:null),v!==null?Ax(i,v):Ag(),Rx(i);else return d=i.lanes=536870912,k2(s,i,v!==null?v.baseLanes|l:l,l,d)}else v!==null?(Fh(i,v.cachePool),Ax(i,v),Ta(),i.memoizedState=null):(s!==null&&Fh(i,null),Ag(),Ta());return or(s,i,g,l),i.child}function ju(s,i){return s!==null&&s.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function k2(s,i,l,d,g){var v=Eg();return v=v===null?null:{parent:Dn._currentValue,pool:v},i.memoizedState={baseLanes:l,cachePool:v},s!==null&&Fh(i,null),Ag(),Rx(i),s!==null&&Dl(s,i,d,!0),i.childLanes=g,null}function sf(s,i){return i=of({mode:i.mode,children:i.children},s.mode),i.ref=s.ref,s.child=i,i.return=s,i}function N2(s,i,l){return jo(i,s.child,null,l),s=sf(i,i.pendingProps),s.flags|=2,Kr(i),i.memoizedState=null,s}function HR(s,i,l){var d=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,s===null){if(Ut){if(d.mode==="hidden")return s=sf(i,d),i.lanes=536870912,ju(null,s);if(Ig(i),(s=cn)?(s=z_(s,us),s=s!==null&&s.data==="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:va!==null?{id:Qs,overflow:Xs}:null,retryLane:536870912,hydrationErrors:null},l=dx(s),l.return=i,i.child=l,ir=i,cn=null)):s=null,s===null)throw ba(i);return i.lanes=536870912,null}return sf(i,d)}var v=s.memoizedState;if(v!==null){var E=v.dehydrated;if(Ig(i),g)if(i.flags&256)i.flags&=-257,i=N2(s,i,l);else if(i.memoizedState!==null)i.child=s.child,i.flags|=128,i=null;else throw Error(r(558));else if(Mn||Dl(s,i,l,!1),g=(l&s.childLanes)!==0,Mn||g){if(d=sn,d!==null&&(E=Zc(d,l),E!==0&&E!==v.retryLane))throw v.retryLane=E,So(s,E),Mr(d,s,E),Jg;gf(),i=N2(s,i,l)}else s=v.treeContext,cn=hs(E.nextSibling),ir=i,Ut=!0,ya=null,us=!1,s!==null&&mx(i,s),i=sf(i,d),i.flags|=4096;return i}return s=xi(s.child,{mode:d.mode,children:d.children}),s.ref=i.ref,i.child=s,s.return=i,s}function af(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function Zg(s,i,l,d,g){return No(i),l=Dg(s,i,l,d,void 0,g),d=Pg(),s!==null&&!Mn?(Mg(s,i,g),Ci(s,i,g)):(Ut&&d&&mg(i),i.flags|=1,or(s,i,l,g),i.child)}function A2(s,i,l,d,g,v){return No(i),i.updateQueue=null,l=jx(i,d,l,g),Ix(s),d=Pg(),s!==null&&!Mn?(Mg(s,i,v),Ci(s,i,v)):(Ut&&d&&mg(i),i.flags|=1,or(s,i,l,v),i.child)}function R2(s,i,l,d,g){if(No(i),i.stateNode===null){var v=Al,E=l.contextType;typeof E=="object"&&E!==null&&(v=ar(E)),v=new l(d,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Xg,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=d,v.state=i.memoizedState,v.refs={},Tg(i),E=l.contextType,v.context=typeof E=="object"&&E!==null?ar(E):Al,v.state=i.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(Qg(i,l,E,d),v.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&Xg.enqueueReplaceState(v,v.state,null),ku(i,d,v,g),Cu(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(s===null){v=i.stateNode;var M=i.memoizedProps,q=Po(l,M);v.props=q;var ie=v.context,ge=l.contextType;E=Al,typeof ge=="object"&&ge!==null&&(E=ar(ge));var _e=l.getDerivedStateFromProps;ge=typeof _e=="function"||typeof v.getSnapshotBeforeUpdate=="function",M=i.pendingProps!==M,ge||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(M||ie!==E)&&g2(i,v,d,E),_a=!1;var ae=i.memoizedState;v.state=ae,ku(i,d,v,g),Cu(),ie=i.memoizedState,M||ae!==ie||_a?(typeof _e=="function"&&(Qg(i,l,_e,d),ie=i.memoizedState),(q=_a||p2(i,l,q,d,ae,ie,E))?(ge||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=ie),v.props=d,v.state=ie,v.context=E,d=q):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{v=i.stateNode,Cg(s,i),E=i.memoizedProps,ge=Po(l,E),v.props=ge,_e=i.pendingProps,ae=v.context,ie=l.contextType,q=Al,typeof ie=="object"&&ie!==null&&(q=ar(ie)),M=l.getDerivedStateFromProps,(ie=typeof M=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==_e||ae!==q)&&g2(i,v,d,q),_a=!1,ae=i.memoizedState,v.state=ae,ku(i,d,v,g),Cu();var de=i.memoizedState;E!==_e||ae!==de||_a||s!==null&&s.dependencies!==null&&zh(s.dependencies)?(typeof M=="function"&&(Qg(i,l,M,d),de=i.memoizedState),(ge=_a||p2(i,l,ge,d,ae,de,q)||s!==null&&s.dependencies!==null&&zh(s.dependencies))?(ie||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,de,q),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,de,q)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&ae===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&ae===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=de),v.props=d,v.state=de,v.context=q,d=ge):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&ae===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&ae===s.memoizedState||(i.flags|=1024),d=!1)}return v=d,af(s,i),d=(i.flags&128)!==0,v||d?(v=i.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,s!==null&&d?(i.child=jo(i,s.child,null,g),i.child=jo(i,null,l,g)):or(s,i,l,g),i.memoizedState=v.state,s=i.child):s=Ci(s,i,g),s}function I2(s,i,l,d){return Co(),i.flags|=256,or(s,i,l,d),i.child}var ev={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tv(s){return{baseLanes:s,cachePool:xx()}}function nv(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=Xr),s}function j2(s,i,l){var d=i.pendingProps,g=!1,v=(i.flags&128)!==0,E;if((E=v)||(E=s!==null&&s.memoizedState===null?!1:(Cn.current&2)!==0),E&&(g=!0,i.flags&=-129),E=(i.flags&32)!==0,i.flags&=-33,s===null){if(Ut){if(g?Sa(i):Ta(),(s=cn)?(s=z_(s,us),s=s!==null&&s.data!=="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:va!==null?{id:Qs,overflow:Xs}:null,retryLane:536870912,hydrationErrors:null},l=dx(s),l.return=i,i.child=l,ir=i,cn=null)):s=null,s===null)throw ba(i);return Vv(s)?i.lanes=32:i.lanes=536870912,null}var M=d.children;return d=d.fallback,g?(Ta(),g=i.mode,M=of({mode:"hidden",children:M},g),d=To(d,g,l,null),M.return=i,d.return=i,M.sibling=d,i.child=M,d=i.child,d.memoizedState=tv(l),d.childLanes=nv(s,E,l),i.memoizedState=ev,ju(null,d)):(Sa(i),rv(i,M))}var q=s.memoizedState;if(q!==null&&(M=q.dehydrated,M!==null)){if(v)i.flags&256?(Sa(i),i.flags&=-257,i=sv(s,i,l)):i.memoizedState!==null?(Ta(),i.child=s.child,i.flags|=128,i=null):(Ta(),M=d.fallback,g=i.mode,d=of({mode:"visible",children:d.children},g),M=To(M,g,l,null),M.flags|=2,d.return=i,M.return=i,d.sibling=M,i.child=d,jo(i,s.child,null,l),d=i.child,d.memoizedState=tv(l),d.childLanes=nv(s,E,l),i.memoizedState=ev,i=ju(null,d));else if(Sa(i),Vv(M)){if(E=M.nextSibling&&M.nextSibling.dataset,E)var ie=E.dgst;E=ie,d=Error(r(419)),d.stack="",d.digest=E,xu({value:d,source:null,stack:null}),i=sv(s,i,l)}else if(Mn||Dl(s,i,l,!1),E=(l&s.childLanes)!==0,Mn||E){if(E=sn,E!==null&&(d=Zc(E,l),d!==0&&d!==q.retryLane))throw q.retryLane=d,So(s,d),Mr(E,s,d),Jg;Lv(M)||gf(),i=sv(s,i,l)}else Lv(M)?(i.flags|=192,i.child=s.child,i=null):(s=q.treeContext,cn=hs(M.nextSibling),ir=i,Ut=!0,ya=null,us=!1,s!==null&&mx(i,s),i=rv(i,d.children),i.flags|=4096);return i}return g?(Ta(),M=d.fallback,g=i.mode,q=s.child,ie=q.sibling,d=xi(q,{mode:"hidden",children:d.children}),d.subtreeFlags=q.subtreeFlags&65011712,ie!==null?M=xi(ie,M):(M=To(M,g,l,null),M.flags|=2),M.return=i,d.return=i,d.sibling=M,i.child=d,ju(null,d),d=i.child,M=s.child.memoizedState,M===null?M=tv(l):(g=M.cachePool,g!==null?(q=Dn._currentValue,g=g.parent!==q?{parent:q,pool:q}:g):g=xx(),M={baseLanes:M.baseLanes|l,cachePool:g}),d.memoizedState=M,d.childLanes=nv(s,E,l),i.memoizedState=ev,ju(s.child,d)):(Sa(i),l=s.child,s=l.sibling,l=xi(l,{mode:"visible",children:d.children}),l.return=i,l.sibling=null,s!==null&&(E=i.deletions,E===null?(i.deletions=[s],i.flags|=16):E.push(s)),i.child=l,i.memoizedState=null,l)}function rv(s,i){return i=of({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function of(s,i){return s=Gr(22,s,null,i),s.lanes=0,s}function sv(s,i,l){return jo(i,s.child,null,l),s=rv(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function D2(s,i,l){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),bg(s.return,i,l)}function iv(s,i,l,d,g,v){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g,treeForkCount:v}:(E.isBackwards=i,E.rendering=null,E.renderingStartTime=0,E.last=d,E.tail=l,E.tailMode=g,E.treeForkCount=v)}function P2(s,i,l){var d=i.pendingProps,g=d.revealOrder,v=d.tail;d=d.children;var E=Cn.current,M=(E&2)!==0;if(M?(E=E&1|2,i.flags|=128):E&=1,re(Cn,E),or(s,i,d,l),d=Ut?bu:0,!M&&s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&D2(s,l,i);else if(s.tag===19)D2(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(g){case"forwards":for(l=i.child,g=null;l!==null;)s=l.alternate,s!==null&&Kh(s)===null&&(g=l),l=l.sibling;l=g,l===null?(g=i.child,i.child=null):(g=l.sibling,l.sibling=null),iv(i,!1,g,l,v,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=i.child,i.child=null;g!==null;){if(s=g.alternate,s!==null&&Kh(s)===null){i.child=g;break}s=g.sibling,g.sibling=l,l=g,g=s}iv(i,!0,l,null,v,d);break;case"together":iv(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function Ci(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),Na|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(Dl(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(r(153));if(i.child!==null){for(s=i.child,l=xi(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=xi(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function av(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&zh(s)))}function $R(s,i,l){switch(i.tag){case 3:Oe(i,i.stateNode.containerInfo),xa(i,Dn,s.memoizedState.cache),Co();break;case 27:case 5:We(i);break;case 4:Oe(i,i.stateNode.containerInfo);break;case 10:xa(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Ig(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(Sa(i),i.flags|=128,null):(l&i.child.childLanes)!==0?j2(s,i,l):(Sa(i),s=Ci(s,i,l),s!==null?s.sibling:null);Sa(i);break;case 19:var g=(s.flags&128)!==0;if(d=(l&i.childLanes)!==0,d||(Dl(s,i,l,!1),d=(l&i.childLanes)!==0),g){if(d)return P2(s,i,l);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),re(Cn,Cn.current),d)break;return null;case 22:return i.lanes=0,C2(s,i,l,i.pendingProps);case 24:xa(i,Dn,s.memoizedState.cache)}return Ci(s,i,l)}function M2(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Mn=!0;else{if(!av(s,l)&&(i.flags&128)===0)return Mn=!1,$R(s,i,l);Mn=(s.flags&131072)!==0}else Mn=!1,Ut&&(i.flags&1048576)!==0&&fx(i,bu,i.index);switch(i.lanes=0,i.tag){case 16:e:{var d=i.pendingProps;if(s=Ro(i.elementType),i.type=s,typeof s=="function")dg(s)?(d=Po(s,d),i.tag=1,i=R2(null,i,s,d,l)):(i.tag=0,i=Zg(null,i,s,d,l));else{if(s!=null){var g=s.$$typeof;if(g===O){i.tag=11,i=E2(null,i,s,d,l);break e}else if(g===w){i.tag=14,i=S2(null,i,s,d,l);break e}}throw i=ne(s)||s,Error(r(306,i,""))}}return i;case 0:return Zg(s,i,i.type,i.pendingProps,l);case 1:return d=i.type,g=Po(d,i.pendingProps),R2(s,i,d,g,l);case 3:e:{if(Oe(i,i.stateNode.containerInfo),s===null)throw Error(r(387));d=i.pendingProps;var v=i.memoizedState;g=v.element,Cg(s,i),ku(i,d,null,l);var E=i.memoizedState;if(d=E.cache,xa(i,Dn,d),d!==v.cache&&xg(i,[Dn],l,!0),Cu(),d=E.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:E.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=I2(s,i,d,l);break e}else if(d!==g){g=os(Error(r(424)),i),xu(g),i=I2(s,i,d,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(cn=hs(s.firstChild),ir=i,Ut=!0,ya=null,us=!0,l=Cx(i,null,d,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Co(),d===g){i=Ci(s,i,l);break e}or(s,i,d,l)}i=i.child}return i;case 26:return af(s,i),s===null?(l=G_(i.type,null,i.pendingProps,null))?i.memoizedState=l:Ut||(l=i.type,s=i.pendingProps,d=Ef(Ue.current).createElement(l),d[Rn]=i,d[Jn]=s,lr(d,l,s),In(d),i.stateNode=d):i.memoizedState=G_(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return We(i),s===null&&Ut&&(d=i.stateNode=H_(i.type,i.pendingProps,Ue.current),ir=i,us=!0,g=cn,Da(i.type)?(Uv=g,cn=hs(d.firstChild)):cn=g),or(s,i,i.pendingProps.children,l),af(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Ut&&((g=d=cn)&&(d=x6(d,i.type,i.pendingProps,us),d!==null?(i.stateNode=d,ir=i,cn=hs(d.firstChild),us=!1,g=!0):g=!1),g||ba(i)),We(i),g=i.type,v=i.pendingProps,E=s!==null?s.memoizedProps:null,d=v.children,Pv(g,v)?d=null:E!==null&&Pv(g,E)&&(i.flags|=32),i.memoizedState!==null&&(g=Dg(s,i,MR,null,null,l),Yu._currentValue=g),af(s,i),or(s,i,d,l),i.child;case 6:return s===null&&Ut&&((s=l=cn)&&(l=_6(l,i.pendingProps,us),l!==null?(i.stateNode=l,ir=i,cn=null,s=!0):s=!1),s||ba(i)),null;case 13:return j2(s,i,l);case 4:return Oe(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=jo(i,null,d,l):or(s,i,d,l),i.child;case 11:return E2(s,i,i.type,i.pendingProps,l);case 7:return or(s,i,i.pendingProps,l),i.child;case 8:return or(s,i,i.pendingProps.children,l),i.child;case 12:return or(s,i,i.pendingProps.children,l),i.child;case 10:return d=i.pendingProps,xa(i,i.type,d.value),or(s,i,d.children,l),i.child;case 9:return g=i.type._context,d=i.pendingProps.children,No(i),g=ar(g),d=d(g),i.flags|=1,or(s,i,d,l),i.child;case 14:return S2(s,i,i.type,i.pendingProps,l);case 15:return T2(s,i,i.type,i.pendingProps,l);case 19:return P2(s,i,l);case 31:return HR(s,i,l);case 22:return C2(s,i,l,i.pendingProps);case 24:return No(i),d=ar(Dn),s===null?(g=Eg(),g===null&&(g=sn,v=_g(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=l),g=v),i.memoizedState={parent:d,cache:g},Tg(i),xa(i,Dn,g)):((s.lanes&l)!==0&&(Cg(s,i),ku(i,null,null,l),Cu()),g=s.memoizedState,v=i.memoizedState,g.parent!==d?(g={parent:d,cache:d},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),xa(i,Dn,d)):(d=v.cache,xa(i,Dn,d),d!==g.cache&&xg(i,[Dn],l,!0))),or(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function ki(s){s.flags|=4}function ov(s,i,l,d,g){if((i=(s.mode&32)!==0)&&(i=!1),i){if(s.flags|=16777216,(g&335544128)===g)if(s.stateNode.complete)s.flags|=8192;else if(l_())s.flags|=8192;else throw Io=$h,Sg}else s.flags&=-16777217}function O2(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!W_(i))if(l_())s.flags|=8192;else throw Io=$h,Sg}function lf(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?qn():536870912,s.lanes|=i,ql|=i)}function Du(s,i){if(!Ut)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function un(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,d=0;if(i)for(var g=s.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=l,i}function qR(s,i,l){var d=i.pendingProps;switch(pg(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(i),null;case 1:return un(i),null;case 3:return l=i.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Ei(Dn),Ie(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(jl(i)?ki(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,vg())),un(i),null;case 26:var g=i.type,v=i.memoizedState;return s===null?(ki(i),v!==null?(un(i),O2(i,v)):(un(i),ov(i,g,null,d,l))):v?v!==s.memoizedState?(ki(i),un(i),O2(i,v)):(un(i),i.flags&=-16777217):(s=s.memoizedProps,s!==d&&ki(i),un(i),ov(i,g,s,d,l)),null;case 27:if(ke(i),l=Ue.current,g=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==d&&ki(i);else{if(!d){if(i.stateNode===null)throw Error(r(166));return un(i),null}s=he.current,jl(i)?px(i):(s=H_(g,d,l),i.stateNode=s,ki(i))}return un(i),null;case 5:if(ke(i),g=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==d&&ki(i);else{if(!d){if(i.stateNode===null)throw Error(r(166));return un(i),null}if(v=he.current,jl(i))px(i);else{var E=Ef(Ue.current);switch(v){case 1:v=E.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=E.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=E.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=E.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=E.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof d.is=="string"?E.createElement("select",{is:d.is}):E.createElement("select"),d.multiple?v.multiple=!0:d.size&&(v.size=d.size);break;default:v=typeof d.is=="string"?E.createElement(g,{is:d.is}):E.createElement(g)}}v[Rn]=i,v[Jn]=d;e:for(E=i.child;E!==null;){if(E.tag===5||E.tag===6)v.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===i)break e;for(;E.sibling===null;){if(E.return===null||E.return===i)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}i.stateNode=v;e:switch(lr(v,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&ki(i)}}return un(i),ov(i,i.type,s===null?null:s.memoizedProps,i.pendingProps,l),null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==d&&ki(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(r(166));if(s=Ue.current,jl(i)){if(s=i.stateNode,l=i.memoizedProps,d=null,g=ir,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}s[Rn]=i,s=!!(s.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||j_(s.nodeValue,l)),s||ba(i,!0)}else s=Ef(s).createTextNode(d),s[Rn]=i,i.stateNode=s}return un(i),null;case 31:if(l=i.memoizedState,s===null||s.memoizedState!==null){if(d=jl(i),l!==null){if(s===null){if(!d)throw Error(r(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Rn]=i}else Co(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;un(i),s=!1}else l=vg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return i.flags&256?(Kr(i),i):(Kr(i),null);if((i.flags&128)!==0)throw Error(r(558))}return un(i),null;case 13:if(d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=jl(i),d!==null&&d.dehydrated!==null){if(s===null){if(!g)throw Error(r(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(r(317));g[Rn]=i}else Co(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;un(i),g=!1}else g=vg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(Kr(i),i):(Kr(i),null)}return Kr(i),(i.flags&128)!==0?(i.lanes=l,i):(l=d!==null,s=s!==null&&s.memoizedState!==null,l&&(d=i.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),v=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==g&&(d.flags|=2048)),l!==s&&l&&(i.child.flags|=8192),lf(i,i.updateQueue),un(i),null);case 4:return Ie(),s===null&&Av(i.stateNode.containerInfo),un(i),null;case 10:return Ei(i.type),un(i),null;case 19:if(X(Cn),d=i.memoizedState,d===null)return un(i),null;if(g=(i.flags&128)!==0,v=d.rendering,v===null)if(g)Du(d,!1);else{if(wn!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(v=Kh(s),v!==null){for(i.flags|=128,Du(d,!1),s=v.updateQueue,i.updateQueue=s,lf(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)ux(l,s),l=l.sibling;return re(Cn,Cn.current&1|2),Ut&&_i(i,d.treeForkCount),i.child}s=s.sibling}d.tail!==null&&W()>ff&&(i.flags|=128,g=!0,Du(d,!1),i.lanes=4194304)}else{if(!g)if(s=Kh(v),s!==null){if(i.flags|=128,g=!0,s=s.updateQueue,i.updateQueue=s,lf(i,s),Du(d,!0),d.tail===null&&d.tailMode==="hidden"&&!v.alternate&&!Ut)return un(i),null}else 2*W()-d.renderingStartTime>ff&&l!==536870912&&(i.flags|=128,g=!0,Du(d,!1),i.lanes=4194304);d.isBackwards?(v.sibling=i.child,i.child=v):(s=d.last,s!==null?s.sibling=v:i.child=v,d.last=v)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=W(),s.sibling=null,l=Cn.current,re(Cn,g?l&1|2:l&1),Ut&&_i(i,d.treeForkCount),s):(un(i),null);case 22:case 23:return Kr(i),Rg(),d=i.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(l&536870912)!==0&&(i.flags&128)===0&&(un(i),i.subtreeFlags&6&&(i.flags|=8192)):un(i),l=i.updateQueue,l!==null&&lf(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==l&&(i.flags|=2048),s!==null&&X(Ao),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),Ei(Dn),un(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function GR(s,i){switch(pg(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Ei(Dn),Ie(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return ke(i),null;case 31:if(i.memoizedState!==null){if(Kr(i),i.alternate===null)throw Error(r(340));Co()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 13:if(Kr(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Co()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return X(Cn),null;case 4:return Ie(),null;case 10:return Ei(i.type),null;case 22:case 23:return Kr(i),Rg(),s!==null&&X(Ao),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Ei(Dn),null;case 25:return null;default:return null}}function L2(s,i){switch(pg(i),i.tag){case 3:Ei(Dn),Ie();break;case 26:case 27:case 5:ke(i);break;case 4:Ie();break;case 31:i.memoizedState!==null&&Kr(i);break;case 13:Kr(i);break;case 19:X(Cn);break;case 10:Ei(i.type);break;case 22:case 23:Kr(i),Rg(),s!==null&&X(Ao);break;case 24:Ei(Dn)}}function Pu(s,i){try{var l=i.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&s)===s){d=void 0;var v=l.create,E=l.inst;d=v(),E.destroy=d}l=l.next}while(l!==g)}}catch(M){Zt(i,i.return,M)}}function Ca(s,i,l){try{var d=i.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var v=g.next;d=v;do{if((d.tag&s)===s){var E=d.inst,M=E.destroy;if(M!==void 0){E.destroy=void 0,g=i;var q=l,ie=M;try{ie()}catch(ge){Zt(g,q,ge)}}}d=d.next}while(d!==v)}}catch(ge){Zt(i,i.return,ge)}}function V2(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{Nx(i,l)}catch(d){Zt(s,s.return,d)}}}function U2(s,i,l){l.props=Po(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(d){Zt(s,i,d)}}function Mu(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof l=="function"?s.refCleanup=l(d):l.current=d}}catch(g){Zt(s,i,g)}}function Ws(s,i){var l=s.ref,d=s.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(g){Zt(s,i,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Zt(s,i,g)}else l.current=null}function z2(s){var i=s.type,l=s.memoizedProps,d=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(g){Zt(s,s.return,g)}}function lv(s,i,l){try{var d=s.stateNode;m6(d,s.type,l,i),d[Jn]=i}catch(g){Zt(s,s.return,g)}}function B2(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Da(s.type)||s.tag===4}function cv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||B2(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Da(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function uv(s,i,l){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=bs));else if(d!==4&&(d===27&&Da(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(uv(s,i,l),s=s.sibling;s!==null;)uv(s,i,l),s=s.sibling}function cf(s,i,l){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(d!==4&&(d===27&&Da(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(cf(s,i,l),s=s.sibling;s!==null;)cf(s,i,l),s=s.sibling}function F2(s){var i=s.stateNode,l=s.memoizedProps;try{for(var d=s.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);lr(i,d,l),i[Rn]=s,i[Jn]=l}catch(v){Zt(s,s.return,v)}}var Ni=!1,On=!1,dv=!1,H2=typeof WeakSet=="function"?WeakSet:Set,er=null;function YR(s,i){if(s=s.containerInfo,jv=Rf,s=tx(s),sg(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var E=0,M=-1,q=-1,ie=0,ge=0,_e=s,ae=null;t:for(;;){for(var de;_e!==l||g!==0&&_e.nodeType!==3||(M=E+g),_e!==v||d!==0&&_e.nodeType!==3||(q=E+d),_e.nodeType===3&&(E+=_e.nodeValue.length),(de=_e.firstChild)!==null;)ae=_e,_e=de;for(;;){if(_e===s)break t;if(ae===l&&++ie===g&&(M=E),ae===v&&++ge===d&&(q=E),(de=_e.nextSibling)!==null)break;_e=ae,ae=_e.parentNode}_e=de}l=M===-1||q===-1?null:{start:M,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Dv={focusedElem:s,selectionRange:l},Rf=!1,er=i;er!==null;)if(i=er,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,er=s;else for(;er!==null;){switch(i=er,v=i.alternate,s=i.flags,i.tag){case 0:if((s&4)!==0&&(s=i.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)g=s[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=i,g=v.memoizedProps,v=v.memoizedState,d=l.stateNode;try{var Ye=Po(l.type,g);s=d.getSnapshotBeforeUpdate(Ye,v),d.__reactInternalSnapshotBeforeUpdate=s}catch(ut){Zt(l,l.return,ut)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)Ov(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Ov(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=i.sibling,s!==null){s.return=i.return,er=s;break}er=i.return}}function $2(s,i,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:Ri(s,l),d&4&&Pu(5,l);break;case 1:if(Ri(s,l),d&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(E){Zt(l,l.return,E)}else{var g=Po(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(g,i,s.__reactInternalSnapshotBeforeUpdate)}catch(E){Zt(l,l.return,E)}}d&64&&V2(l),d&512&&Mu(l,l.return);break;case 3:if(Ri(s,l),d&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Nx(s,i)}catch(E){Zt(l,l.return,E)}}break;case 27:i===null&&d&4&&F2(l);case 26:case 5:Ri(s,l),i===null&&d&4&&z2(l),d&512&&Mu(l,l.return);break;case 12:Ri(s,l);break;case 31:Ri(s,l),d&4&&Y2(s,l);break;case 13:Ri(s,l),d&4&&K2(s,l),d&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=n6.bind(null,l),w6(s,l))));break;case 22:if(d=l.memoizedState!==null||Ni,!d){i=i!==null&&i.memoizedState!==null||On,g=Ni;var v=On;Ni=d,(On=i)&&!v?Ii(s,l,(l.subtreeFlags&8772)!==0):Ri(s,l),Ni=g,On=v}break;case 30:break;default:Ri(s,l)}}function q2(s){var i=s.alternate;i!==null&&(s.alternate=null,q2(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&pl(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var gn=null,Ir=!1;function Ai(s,i,l){for(l=l.child;l!==null;)G2(s,i,l),l=l.sibling}function G2(s,i,l){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(kt,l)}catch{}switch(l.tag){case 26:On||Ws(l,i),Ai(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:On||Ws(l,i);var d=gn,g=Ir;Da(l.type)&&(gn=l.stateNode,Ir=!1),Ai(s,i,l),$u(l.stateNode),gn=d,Ir=g;break;case 5:On||Ws(l,i);case 6:if(d=gn,g=Ir,gn=null,Ai(s,i,l),gn=d,Ir=g,gn!==null)if(Ir)try{(gn.nodeType===9?gn.body:gn.nodeName==="HTML"?gn.ownerDocument.body:gn).removeChild(l.stateNode)}catch(v){Zt(l,i,v)}else try{gn.removeChild(l.stateNode)}catch(v){Zt(l,i,v)}break;case 18:gn!==null&&(Ir?(s=gn,V_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Zl(s)):V_(gn,l.stateNode));break;case 4:d=gn,g=Ir,gn=l.stateNode.containerInfo,Ir=!0,Ai(s,i,l),gn=d,Ir=g;break;case 0:case 11:case 14:case 15:Ca(2,l,i),On||Ca(4,l,i),Ai(s,i,l);break;case 1:On||(Ws(l,i),d=l.stateNode,typeof d.componentWillUnmount=="function"&&U2(l,i,d)),Ai(s,i,l);break;case 21:Ai(s,i,l);break;case 22:On=(d=On)||l.memoizedState!==null,Ai(s,i,l),On=d;break;default:Ai(s,i,l)}}function Y2(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Zl(s)}catch(l){Zt(i,i.return,l)}}}function K2(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Zl(s)}catch(l){Zt(i,i.return,l)}}function KR(s){switch(s.tag){case 31:case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new H2),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new H2),i;default:throw Error(r(435,s.tag))}}function uf(s,i){var l=KR(s);i.forEach(function(d){if(!l.has(d)){l.add(d);var g=r6.bind(null,s,d);d.then(g,g)}})}function jr(s,i){var l=i.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d],v=s,E=i,M=E;e:for(;M!==null;){switch(M.tag){case 27:if(Da(M.type)){gn=M.stateNode,Ir=!1;break e}break;case 5:gn=M.stateNode,Ir=!1;break e;case 3:case 4:gn=M.stateNode.containerInfo,Ir=!0;break e}M=M.return}if(gn===null)throw Error(r(160));G2(v,E,g),gn=null,Ir=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Q2(i,s),i=i.sibling}var Ts=null;function Q2(s,i){var l=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:jr(i,s),Dr(s),d&4&&(Ca(3,s,s.return),Pu(3,s),Ca(5,s,s.return));break;case 1:jr(i,s),Dr(s),d&512&&(On||l===null||Ws(l,l.return)),d&64&&Ni&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var g=Ts;if(jr(i,s),Dr(s),d&512&&(On||l===null||Ws(l,l.return)),d&4){var v=l!==null?l.memoizedState:null;if(d=s.memoizedState,l===null)if(d===null)if(s.stateNode===null){e:{d=s.type,l=s.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":v=g.getElementsByTagName("title")[0],(!v||v[Ls]||v[Rn]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(d),g.head.insertBefore(v,g.querySelector("head > title"))),lr(v,d,l),v[Rn]=s,In(v),d=v;break e;case"link":var E=Q_("link","href",g).get(d+(l.href||""));if(E){for(var M=0;M<E.length;M++)if(v=E[M],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(M,1);break t}}v=g.createElement(d),lr(v,d,l),g.head.appendChild(v);break;case"meta":if(E=Q_("meta","content",g).get(d+(l.content||""))){for(M=0;M<E.length;M++)if(v=E[M],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(M,1);break t}}v=g.createElement(d),lr(v,d,l),g.head.appendChild(v);break;default:throw Error(r(468,d))}v[Rn]=s,In(v),d=v}s.stateNode=d}else X_(g,s.type,s.stateNode);else s.stateNode=K_(g,d,s.memoizedProps);else v!==d?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,d===null?X_(g,s.type,s.stateNode):K_(g,d,s.memoizedProps)):d===null&&s.stateNode!==null&&lv(s,s.memoizedProps,l.memoizedProps)}break;case 27:jr(i,s),Dr(s),d&512&&(On||l===null||Ws(l,l.return)),l!==null&&d&4&&lv(s,s.memoizedProps,l.memoizedProps);break;case 5:if(jr(i,s),Dr(s),d&512&&(On||l===null||Ws(l,l.return)),s.flags&32){g=s.stateNode;try{Rr(g,"")}catch(Ye){Zt(s,s.return,Ye)}}d&4&&s.stateNode!=null&&(g=s.memoizedProps,lv(s,g,l!==null?l.memoizedProps:g)),d&1024&&(dv=!0);break;case 6:if(jr(i,s),Dr(s),d&4){if(s.stateNode===null)throw Error(r(162));d=s.memoizedProps,l=s.stateNode;try{l.nodeValue=d}catch(Ye){Zt(s,s.return,Ye)}}break;case 3:if(Cf=null,g=Ts,Ts=Sf(i.containerInfo),jr(i,s),Ts=g,Dr(s),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Zl(i.containerInfo)}catch(Ye){Zt(s,s.return,Ye)}dv&&(dv=!1,X2(s));break;case 4:d=Ts,Ts=Sf(s.stateNode.containerInfo),jr(i,s),Dr(s),Ts=d;break;case 12:jr(i,s),Dr(s);break;case 31:jr(i,s),Dr(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,uf(s,d)));break;case 13:jr(i,s),Dr(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(hf=W()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,uf(s,d)));break;case 22:g=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,ie=Ni,ge=On;if(Ni=ie||g,On=ge||q,jr(i,s),On=ge,Ni=ie,Dr(s),d&8192)e:for(i=s.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(l===null||q||Ni||On||Mo(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){q=l=i;try{if(v=q.stateNode,g)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{M=q.stateNode;var _e=q.memoizedProps.style,ae=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;M.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Ye){Zt(q,q.return,Ye)}}}else if(i.tag===6){if(l===null){q=i;try{q.stateNode.nodeValue=g?"":q.memoizedProps}catch(Ye){Zt(q,q.return,Ye)}}}else if(i.tag===18){if(l===null){q=i;try{var de=q.stateNode;g?U_(de,!0):U_(q.stateNode,!1)}catch(Ye){Zt(q,q.return,Ye)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=s.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,uf(s,l))));break;case 19:jr(i,s),Dr(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,uf(s,d)));break;case 30:break;case 21:break;default:jr(i,s),Dr(s)}}function Dr(s){var i=s.flags;if(i&2){try{for(var l,d=s.return;d!==null;){if(B2(d)){l=d;break}d=d.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var g=l.stateNode,v=cv(s);cf(s,v,g);break;case 5:var E=l.stateNode;l.flags&32&&(Rr(E,""),l.flags&=-33);var M=cv(s);cf(s,M,E);break;case 3:case 4:var q=l.stateNode.containerInfo,ie=cv(s);uv(s,ie,q);break;default:throw Error(r(161))}}catch(ge){Zt(s,s.return,ge)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function X2(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;X2(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Ri(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)$2(s,i.alternate,i),i=i.sibling}function Mo(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Ca(4,i,i.return),Mo(i);break;case 1:Ws(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&U2(i,i.return,l),Mo(i);break;case 27:$u(i.stateNode);case 26:case 5:Ws(i,i.return),Mo(i);break;case 22:i.memoizedState===null&&Mo(i);break;case 30:Mo(i);break;default:Mo(i)}s=s.sibling}}function Ii(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,g=s,v=i,E=v.flags;switch(v.tag){case 0:case 11:case 15:Ii(g,v,l),Pu(4,v);break;case 1:if(Ii(g,v,l),d=v,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ie){Zt(d,d.return,ie)}if(d=v,g=d.updateQueue,g!==null){var M=d.stateNode;try{var q=g.shared.hiddenCallbacks;if(q!==null)for(g.shared.hiddenCallbacks=null,g=0;g<q.length;g++)kx(q[g],M)}catch(ie){Zt(d,d.return,ie)}}l&&E&64&&V2(v),Mu(v,v.return);break;case 27:F2(v);case 26:case 5:Ii(g,v,l),l&&d===null&&E&4&&z2(v),Mu(v,v.return);break;case 12:Ii(g,v,l);break;case 31:Ii(g,v,l),l&&E&4&&Y2(g,v);break;case 13:Ii(g,v,l),l&&E&4&&K2(g,v);break;case 22:v.memoizedState===null&&Ii(g,v,l),Mu(v,v.return);break;case 30:break;default:Ii(g,v,l)}i=i.sibling}}function hv(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&_u(l))}function fv(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&_u(s))}function Cs(s,i,l,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)W2(s,i,l,d),i=i.sibling}function W2(s,i,l,d){var g=i.flags;switch(i.tag){case 0:case 11:case 15:Cs(s,i,l,d),g&2048&&Pu(9,i);break;case 1:Cs(s,i,l,d);break;case 3:Cs(s,i,l,d),g&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&_u(s)));break;case 12:if(g&2048){Cs(s,i,l,d),s=i.stateNode;try{var v=i.memoizedProps,E=v.id,M=v.onPostCommit;typeof M=="function"&&M(E,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Zt(i,i.return,q)}}else Cs(s,i,l,d);break;case 31:Cs(s,i,l,d);break;case 13:Cs(s,i,l,d);break;case 23:break;case 22:v=i.stateNode,E=i.alternate,i.memoizedState!==null?v._visibility&2?Cs(s,i,l,d):Ou(s,i):v._visibility&2?Cs(s,i,l,d):(v._visibility|=2,Fl(s,i,l,d,(i.subtreeFlags&10256)!==0||!1)),g&2048&&hv(E,i);break;case 24:Cs(s,i,l,d),g&2048&&fv(i.alternate,i);break;default:Cs(s,i,l,d)}}function Fl(s,i,l,d,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=s,E=i,M=l,q=d,ie=E.flags;switch(E.tag){case 0:case 11:case 15:Fl(v,E,M,q,g),Pu(8,E);break;case 23:break;case 22:var ge=E.stateNode;E.memoizedState!==null?ge._visibility&2?Fl(v,E,M,q,g):Ou(v,E):(ge._visibility|=2,Fl(v,E,M,q,g)),g&&ie&2048&&hv(E.alternate,E);break;case 24:Fl(v,E,M,q,g),g&&ie&2048&&fv(E.alternate,E);break;default:Fl(v,E,M,q,g)}i=i.sibling}}function Ou(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,d=i,g=d.flags;switch(d.tag){case 22:Ou(l,d),g&2048&&hv(d.alternate,d);break;case 24:Ou(l,d),g&2048&&fv(d.alternate,d);break;default:Ou(l,d)}i=i.sibling}}var Lu=8192;function Hl(s,i,l){if(s.subtreeFlags&Lu)for(s=s.child;s!==null;)J2(s,i,l),s=s.sibling}function J2(s,i,l){switch(s.tag){case 26:Hl(s,i,l),s.flags&Lu&&s.memoizedState!==null&&P6(l,Ts,s.memoizedState,s.memoizedProps);break;case 5:Hl(s,i,l);break;case 3:case 4:var d=Ts;Ts=Sf(s.stateNode.containerInfo),Hl(s,i,l),Ts=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=Lu,Lu=16777216,Hl(s,i,l),Lu=d):Hl(s,i,l));break;default:Hl(s,i,l)}}function Z2(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Vu(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];er=d,t_(d,s)}Z2(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)e_(s),s=s.sibling}function e_(s){switch(s.tag){case 0:case 11:case 15:Vu(s),s.flags&2048&&Ca(9,s,s.return);break;case 3:Vu(s);break;case 12:Vu(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,df(s)):Vu(s);break;default:Vu(s)}}function df(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];er=d,t_(d,s)}Z2(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Ca(8,i,i.return),df(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,df(i));break;default:df(i)}s=s.sibling}}function t_(s,i){for(;er!==null;){var l=er;switch(l.tag){case 0:case 11:case 15:Ca(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:_u(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,er=d;else e:for(l=s;er!==null;){d=er;var g=d.sibling,v=d.return;if(q2(d),d===l){er=null;break e}if(g!==null){g.return=v,er=g;break e}er=v}}}var QR={getCacheForType:function(s){var i=ar(Dn),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l},cacheSignal:function(){return ar(Dn).controller.signal}},XR=typeof WeakMap=="function"?WeakMap:Map,Yt=0,sn=null,It=null,Dt=0,Jt=0,Qr=null,ka=!1,$l=!1,mv=!1,ji=0,wn=0,Na=0,Oo=0,pv=0,Xr=0,ql=0,Uu=null,Pr=null,gv=!1,hf=0,n_=0,ff=1/0,mf=null,Aa=null,Gn=0,Ra=null,Gl=null,Di=0,vv=0,yv=null,r_=null,zu=0,bv=null;function Wr(){return(Yt&2)!==0&&Dt!==0?Dt&-Dt:G.T!==null?Tv():mh()}function s_(){if(Xr===0)if((Dt&536870912)===0||Ut){var s=bt;bt<<=1,(bt&3932160)===0&&(bt=262144),Xr=s}else Xr=536870912;return s=Yr.current,s!==null&&(s.flags|=32),Xr}function Mr(s,i,l){(s===sn&&(Jt===2||Jt===9)||s.cancelPendingCommit!==null)&&(Yl(s,0),Ia(s,Dt,Xr,!1)),xt(s,l),((Yt&2)===0||s!==sn)&&(s===sn&&((Yt&2)===0&&(Oo|=l),wn===4&&Ia(s,Dt,Xr,!1)),Js(s))}function i_(s,i,l){if((Yt&6)!==0)throw Error(r(327));var d=!l&&(i&127)===0&&(i&s.expiredLanes)===0||St(s,i),g=d?ZR(s,i):_v(s,i,!0),v=d;do{if(g===0){$l&&!d&&Ia(s,i,0,!1);break}else{if(l=s.current.alternate,v&&!WR(l)){g=_v(s,i,!1),v=!1;continue}if(g===2){if(v=i,s.errorRecoveryDisabledLanes&v)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){i=E;e:{var M=s;g=Uu;var q=M.current.memoizedState.isDehydrated;if(q&&(Yl(M,E).flags|=256),E=_v(M,E,!1),E!==2){if(mv&&!q){M.errorRecoveryDisabledLanes|=v,Oo|=v,g=4;break e}v=Pr,Pr=g,v!==null&&(Pr===null?Pr=v:Pr.push.apply(Pr,v))}g=E}if(v=!1,g!==2)continue}}if(g===1){Yl(s,0),Ia(s,i,0,!0);break}e:{switch(d=s,v=g,v){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Ia(d,i,Xr,!ka);break e;case 2:Pr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(g=hf+300-W(),10<g)){if(Ia(d,i,Xr,!ka),$t(d,0,!0)!==0)break e;Di=i,d.timeoutHandle=O_(a_.bind(null,d,l,Pr,mf,gv,i,Xr,Oo,ql,ka,v,"Throttled",-0,0),g);break e}a_(d,l,Pr,mf,gv,i,Xr,Oo,ql,ka,v,null,-0,0)}}break}while(!0);Js(s)}function a_(s,i,l,d,g,v,E,M,q,ie,ge,_e,ae,de){if(s.timeoutHandle=-1,_e=i.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:bs},J2(i,v,_e);var Ye=(v&62914560)===v?hf-W():(v&4194048)===v?n_-W():0;if(Ye=M6(_e,Ye),Ye!==null){Di=v,s.cancelPendingCommit=Ye(m_.bind(null,s,i,v,l,d,g,E,M,q,ge,_e,null,ae,de)),Ia(s,v,E,!ie);return}}m_(s,i,v,l,d,g,E,M,q)}function WR(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var g=l[d],v=g.getSnapshot;g=g.value;try{if(!qr(v(),g))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ia(s,i,l,d){i&=~pv,i&=~Oo,s.suspendedLanes|=i,s.pingedLanes&=~i,d&&(s.warmLanes|=i),d=s.expirationTimes;for(var g=i;0<g;){var v=31-Xt(g),E=1<<v;d[v]=-1,g&=~E}l!==0&&rr(s,l,i)}function pf(){return(Yt&6)===0?(Bu(0),!1):!0}function xv(){if(It!==null){if(Jt===0)var s=It.return;else s=It,wi=ko=null,Og(s),Ll=null,Eu=0,s=It;for(;s!==null;)L2(s.alternate,s),s=s.return;It=null}}function Yl(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,v6(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Di=0,xv(),sn=s,It=l=xi(s.current,null),Dt=i,Jt=0,Qr=null,ka=!1,$l=St(s,i),mv=!1,ql=Xr=pv=Oo=Na=wn=0,Pr=Uu=null,gv=!1,(i&8)!==0&&(i|=i&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=i;0<d;){var g=31-Xt(d),v=1<<g;i|=s[g],d&=~v}return ji=i,Mh(),l}function o_(s,i){Et=null,G.H=Iu,i===Ol||i===Hh?(i=Ex(),Jt=3):i===Sg?(i=Ex(),Jt=4):Jt=i===Jg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Qr=i,It===null&&(wn=1,rf(s,os(i,s.current)))}function l_(){var s=Yr.current;return s===null?!0:(Dt&4194048)===Dt?ds===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?s===ds:!1}function c_(){var s=G.H;return G.H=Iu,s===null?Iu:s}function u_(){var s=G.A;return G.A=QR,s}function gf(){wn=4,ka||(Dt&4194048)!==Dt&&Yr.current!==null||($l=!0),(Na&134217727)===0&&(Oo&134217727)===0||sn===null||Ia(sn,Dt,Xr,!1)}function _v(s,i,l){var d=Yt;Yt|=2;var g=c_(),v=u_();(sn!==s||Dt!==i)&&(mf=null,Yl(s,i)),i=!1;var E=wn;e:do try{if(Jt!==0&&It!==null){var M=It,q=Qr;switch(Jt){case 8:xv(),E=6;break e;case 3:case 2:case 9:case 6:Yr.current===null&&(i=!0);var ie=Jt;if(Jt=0,Qr=null,Kl(s,M,q,ie),l&&$l){E=0;break e}break;default:ie=Jt,Jt=0,Qr=null,Kl(s,M,q,ie)}}JR(),E=wn;break}catch(ge){o_(s,ge)}while(!0);return i&&s.shellSuspendCounter++,wi=ko=null,Yt=d,G.H=g,G.A=v,It===null&&(sn=null,Dt=0,Mh()),E}function JR(){for(;It!==null;)d_(It)}function ZR(s,i){var l=Yt;Yt|=2;var d=c_(),g=u_();sn!==s||Dt!==i?(mf=null,ff=W()+500,Yl(s,i)):$l=St(s,i);e:do try{if(Jt!==0&&It!==null){i=It;var v=Qr;t:switch(Jt){case 1:Jt=0,Qr=null,Kl(s,i,v,1);break;case 2:case 9:if(_x(v)){Jt=0,Qr=null,h_(i);break}i=function(){Jt!==2&&Jt!==9||sn!==s||(Jt=7),Js(s)},v.then(i,i);break e;case 3:Jt=7;break e;case 4:Jt=5;break e;case 7:_x(v)?(Jt=0,Qr=null,h_(i)):(Jt=0,Qr=null,Kl(s,i,v,7));break;case 5:var E=null;switch(It.tag){case 26:E=It.memoizedState;case 5:case 27:var M=It;if(E?W_(E):M.stateNode.complete){Jt=0,Qr=null;var q=M.sibling;if(q!==null)It=q;else{var ie=M.return;ie!==null?(It=ie,vf(ie)):It=null}break t}}Jt=0,Qr=null,Kl(s,i,v,5);break;case 6:Jt=0,Qr=null,Kl(s,i,v,6);break;case 8:xv(),wn=6;break e;default:throw Error(r(462))}}e6();break}catch(ge){o_(s,ge)}while(!0);return wi=ko=null,G.H=d,G.A=g,Yt=l,It!==null?0:(sn=null,Dt=0,Mh(),wn)}function e6(){for(;It!==null&&!Ae();)d_(It)}function d_(s){var i=M2(s.alternate,s,ji);s.memoizedProps=s.pendingProps,i===null?vf(s):It=i}function h_(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=A2(l,i,i.pendingProps,i.type,void 0,Dt);break;case 11:i=A2(l,i,i.pendingProps,i.type.render,i.ref,Dt);break;case 5:Og(i);default:L2(l,i),i=It=ux(i,ji),i=M2(l,i,ji)}s.memoizedProps=s.pendingProps,i===null?vf(s):It=i}function Kl(s,i,l,d){wi=ko=null,Og(i),Ll=null,Eu=0;var g=i.return;try{if(FR(s,g,i,l,Dt)){wn=1,rf(s,os(l,s.current)),It=null;return}}catch(v){if(g!==null)throw It=g,v;wn=1,rf(s,os(l,s.current)),It=null;return}i.flags&32768?(Ut||d===1?s=!0:$l||(Dt&536870912)!==0?s=!1:(ka=s=!0,(d===2||d===9||d===3||d===6)&&(d=Yr.current,d!==null&&d.tag===13&&(d.flags|=16384))),f_(i,s)):vf(i)}function vf(s){var i=s;do{if((i.flags&32768)!==0){f_(i,ka);return}s=i.return;var l=qR(i.alternate,i,ji);if(l!==null){It=l;return}if(i=i.sibling,i!==null){It=i;return}It=i=s}while(i!==null);wn===0&&(wn=5)}function f_(s,i){do{var l=GR(s.alternate,s);if(l!==null){l.flags&=32767,It=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){It=s;return}It=s=l}while(s!==null);wn=6,It=null}function m_(s,i,l,d,g,v,E,M,q){s.cancelPendingCommit=null;do yf();while(Gn!==0);if((Yt&6)!==0)throw Error(r(327));if(i!==null){if(i===s.current)throw Error(r(177));if(v=i.lanes|i.childLanes,v|=cg,qt(s,l,v,E,M,q),s===sn&&(It=sn=null,Dt=0),Gl=i,Ra=s,Di=l,vv=v,yv=g,r_=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,s6(Ee,function(){return b_(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=G.T,G.T=null,g=Z.p,Z.p=2,E=Yt,Yt|=4;try{YR(s,i,l)}finally{Yt=E,Z.p=g,G.T=d}}Gn=1,p_(),g_(),v_()}}function p_(){if(Gn===1){Gn=0;var s=Ra,i=Gl,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=G.T,G.T=null;var d=Z.p;Z.p=2;var g=Yt;Yt|=4;try{Q2(i,s);var v=Dv,E=tx(s.containerInfo),M=v.focusedElem,q=v.selectionRange;if(E!==M&&M&&M.ownerDocument&&ex(M.ownerDocument.documentElement,M)){if(q!==null&&sg(M)){var ie=q.start,ge=q.end;if(ge===void 0&&(ge=ie),"selectionStart"in M)M.selectionStart=ie,M.selectionEnd=Math.min(ge,M.value.length);else{var _e=M.ownerDocument||document,ae=_e&&_e.defaultView||window;if(ae.getSelection){var de=ae.getSelection(),Ye=M.textContent.length,ut=Math.min(q.start,Ye),rn=q.end===void 0?ut:Math.min(q.end,Ye);!de.extend&&ut>rn&&(E=rn,rn=ut,ut=E);var Q=Zb(M,ut),Y=Zb(M,rn);if(Q&&Y&&(de.rangeCount!==1||de.anchorNode!==Q.node||de.anchorOffset!==Q.offset||de.focusNode!==Y.node||de.focusOffset!==Y.offset)){var se=_e.createRange();se.setStart(Q.node,Q.offset),de.removeAllRanges(),ut>rn?(de.addRange(se),de.extend(Y.node,Y.offset)):(se.setEnd(Y.node,Y.offset),de.addRange(se))}}}}for(_e=[],de=M;de=de.parentNode;)de.nodeType===1&&_e.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<_e.length;M++){var be=_e[M];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Rf=!!jv,Dv=jv=null}finally{Yt=g,Z.p=d,G.T=l}}s.current=i,Gn=2}}function g_(){if(Gn===2){Gn=0;var s=Ra,i=Gl,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=G.T,G.T=null;var d=Z.p;Z.p=2;var g=Yt;Yt|=4;try{$2(s,i.alternate,i)}finally{Yt=g,Z.p=d,G.T=l}}Gn=3}}function v_(){if(Gn===4||Gn===3){Gn=0,xe();var s=Ra,i=Gl,l=Di,d=r_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Gn=5:(Gn=0,Gl=Ra=null,y_(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(Aa=null),gi(l),i=i.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(kt,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=G.T,g=Z.p,Z.p=2,G.T=null;try{for(var v=s.onRecoverableError,E=0;E<d.length;E++){var M=d[E];v(M.value,{componentStack:M.stack})}}finally{G.T=i,Z.p=g}}(Di&3)!==0&&yf(),Js(s),g=s.pendingLanes,(l&261930)!==0&&(g&42)!==0?s===bv?zu++:(zu=0,bv=s):zu=0,Bu(0)}}function y_(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,_u(i)))}function yf(){return p_(),g_(),v_(),b_()}function b_(){if(Gn!==5)return!1;var s=Ra,i=vv;vv=0;var l=gi(Di),d=G.T,g=Z.p;try{Z.p=32>l?32:l,G.T=null,l=yv,yv=null;var v=Ra,E=Di;if(Gn=0,Gl=Ra=null,Di=0,(Yt&6)!==0)throw Error(r(331));var M=Yt;if(Yt|=4,e_(v.current),W2(v,v.current,E,l),Yt=M,Bu(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(kt,v)}catch{}return!0}finally{Z.p=g,G.T=d,y_(s,i)}}function x_(s,i,l){i=os(l,i),i=Wg(s.stateNode,i,2),s=Ea(s,i,2),s!==null&&(xt(s,2),Js(s))}function Zt(s,i,l){if(s.tag===3)x_(s,s,l);else for(;i!==null;){if(i.tag===3){x_(i,s,l);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Aa===null||!Aa.has(d))){s=os(l,s),l=_2(2),d=Ea(i,l,2),d!==null&&(w2(l,d,i,s),xt(d,2),Js(d));break}}i=i.return}}function wv(s,i,l){var d=s.pingCache;if(d===null){d=s.pingCache=new XR;var g=new Set;d.set(i,g)}else g=d.get(i),g===void 0&&(g=new Set,d.set(i,g));g.has(l)||(mv=!0,g.add(l),s=t6.bind(null,s,i,l),i.then(s,s))}function t6(s,i,l){var d=s.pingCache;d!==null&&d.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,sn===s&&(Dt&l)===l&&(wn===4||wn===3&&(Dt&62914560)===Dt&&300>W()-hf?(Yt&2)===0&&Yl(s,0):pv|=l,ql===Dt&&(ql=0)),Js(s)}function __(s,i){i===0&&(i=qn()),s=So(s,i),s!==null&&(xt(s,i),Js(s))}function n6(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),__(s,l)}function r6(s,i){var l=0;switch(s.tag){case 31:case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(r(314))}d!==null&&d.delete(i),__(s,l)}function s6(s,i){return je(s,i)}var bf=null,Ql=null,Ev=!1,xf=!1,Sv=!1,ja=0;function Js(s){s!==Ql&&s.next===null&&(Ql===null?bf=Ql=s:Ql=Ql.next=s),xf=!0,Ev||(Ev=!0,a6())}function Bu(s,i){if(!Sv&&xf){Sv=!0;do for(var l=!1,d=bf;d!==null;){if(s!==0){var g=d.pendingLanes;if(g===0)var v=0;else{var E=d.suspendedLanes,M=d.pingedLanes;v=(1<<31-Xt(42|s)+1)-1,v&=g&~(E&~M),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,T_(d,v))}else v=Dt,v=$t(d,d===sn?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||St(d,v)||(l=!0,T_(d,v));d=d.next}while(l);Sv=!1}}function i6(){w_()}function w_(){xf=Ev=!1;var s=0;ja!==0&&g6()&&(s=ja);for(var i=W(),l=null,d=bf;d!==null;){var g=d.next,v=E_(d,i);v===0?(d.next=null,l===null?bf=g:l.next=g,g===null&&(Ql=l)):(l=d,(s!==0||(v&3)!==0)&&(xf=!0)),d=g}Gn!==0&&Gn!==5||Bu(s),ja!==0&&(ja=0)}function E_(s,i){for(var l=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var E=31-Xt(v),M=1<<E,q=g[E];q===-1?((M&l)===0||(M&d)!==0)&&(g[E]=ln(M,i)):q<=i&&(s.expiredLanes|=M),v&=~M}if(i=sn,l=Dt,l=$t(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,l===0||s===i&&(Jt===2||Jt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&me(d),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||St(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(d!==null&&me(d),gi(l)){case 2:case 8:l=on;break;case 32:l=Ee;break;case 268435456:l=lt;break;default:l=Ee}return d=S_.bind(null,s),l=je(l,d),s.callbackPriority=i,s.callbackNode=l,i}return d!==null&&d!==null&&me(d),s.callbackPriority=2,s.callbackNode=null,2}function S_(s,i){if(Gn!==0&&Gn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(yf()&&s.callbackNode!==l)return null;var d=Dt;return d=$t(s,s===sn?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(i_(s,d,i),E_(s,W()),s.callbackNode!=null&&s.callbackNode===l?S_.bind(null,s):null)}function T_(s,i){if(yf())return null;i_(s,i,!0)}function a6(){y6(function(){(Yt&6)!==0?je(ct,i6):w_()})}function Tv(){if(ja===0){var s=Pl;s===0&&(s=et,et<<=1,(et&261888)===0&&(et=256)),ja=s}return ja}function C_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:bl(""+s)}function k_(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function o6(s,i,l,d,g){if(i==="submit"&&l&&l.stateNode===g){var v=C_((g[Jn]||null).action),E=d.submitter;E&&(i=(i=E[Jn]||null)?C_(i.formAction):E.getAttribute("formAction"),i!==null&&(v=i,E=null));var M=new qs("action","action",null,d,g);s.push({event:M,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ja!==0){var q=E?k_(g,E):new FormData(g);qg(l,{pending:!0,data:q,method:g.method,action:v},null,q)}}else typeof v=="function"&&(M.preventDefault(),q=E?k_(g,E):new FormData(g),qg(l,{pending:!0,data:q,method:g.method,action:v},v,q))},currentTarget:g}]})}}for(var Cv=0;Cv<lg.length;Cv++){var kv=lg[Cv],l6=kv.toLowerCase(),c6=kv[0].toUpperCase()+kv.slice(1);Ss(l6,"on"+c6)}Ss(sx,"onAnimationEnd"),Ss(ix,"onAnimationIteration"),Ss(ax,"onAnimationStart"),Ss("dblclick","onDoubleClick"),Ss("focusin","onFocus"),Ss("focusout","onBlur"),Ss(TR,"onTransitionRun"),Ss(CR,"onTransitionStart"),Ss(kR,"onTransitionCancel"),Ss(ox,"onTransitionEnd"),Bs("onMouseEnter",["mouseout","mouseover"]),Bs("onMouseLeave",["mouseout","mouseover"]),Bs("onPointerEnter",["pointerout","pointerover"]),Bs("onPointerLeave",["pointerout","pointerover"]),zs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),zs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),zs("onBeforeInput",["compositionend","keypress","textInput","paste"]),zs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),zs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),zs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fu));function N_(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var d=s[l],g=d.event;d=d.listeners;e:{var v=void 0;if(i)for(var E=d.length-1;0<=E;E--){var M=d[E],q=M.instance,ie=M.currentTarget;if(M=M.listener,q!==v&&g.isPropagationStopped())break e;v=M,g.currentTarget=ie;try{v(g)}catch(ge){Ph(ge)}g.currentTarget=null,v=q}else for(E=0;E<d.length;E++){if(M=d[E],q=M.instance,ie=M.currentTarget,M=M.listener,q!==v&&g.isPropagationStopped())break e;v=M,g.currentTarget=ie;try{v(g)}catch(ge){Ph(ge)}g.currentTarget=null,v=q}}}}function jt(s,i){var l=i[ml];l===void 0&&(l=i[ml]=new Set);var d=s+"__bubble";l.has(d)||(A_(i,s,2,!1),l.add(d))}function Nv(s,i,l){var d=0;i&&(d|=4),A_(l,s,d,i)}var _f="_reactListening"+Math.random().toString(36).slice(2);function Av(s){if(!s[_f]){s[_f]=!0,eu.forEach(function(l){l!=="selectionchange"&&(u6.has(l)||Nv(l,!1,s),Nv(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[_f]||(i[_f]=!0,Nv("selectionchange",!1,i))}}function A_(s,i,l,d){switch(sw(i)){case 2:var g=V6;break;case 8:g=U6;break;default:g=$v}l=g.bind(null,i,l,s),g=void 0,!go||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(i,l,{capture:!0,passive:g}):s.addEventListener(i,l,!0):g!==void 0?s.addEventListener(i,l,{passive:g}):s.addEventListener(i,l,!1)}function Rv(s,i,l,d,g){var v=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var E=d.tag;if(E===3||E===4){var M=d.stateNode.containerInfo;if(M===g)break;if(E===4)for(E=d.return;E!==null;){var q=E.tag;if((q===3||q===4)&&E.stateNode.containerInfo===g)return;E=E.return}for(;M!==null;){if(E=Vs(M),E===null)return;if(q=E.tag,q===5||q===6||q===26||q===27){d=v=E;continue e}M=M.parentNode}}d=d.return}fa(function(){var ie=v,ge=rs(l),_e=[];e:{var ae=lx.get(s);if(ae!==void 0){var de=qs,Ye=s;switch(s){case"keypress":if(yo(l)===0)break e;case"keydown":case"keyup":de=Ih;break;case"focusin":Ye="focus",de=xo;break;case"focusout":Ye="blur",de=xo;break;case"beforeblur":case"afterblur":de=xo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=fu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=wh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=_;break;case sx:case ix:case ax:de=Sh;break;case ox:de=z;break;case"scroll":case"scrollend":de=hu;break;case"wheel":de=ce;break;case"copy":case"cut":case"paste":de=Th;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=bi;break;case"toggle":case"beforetoggle":de=wt}var ut=(i&4)!==0,rn=!ut&&(s==="scroll"||s==="scrollend"),Q=ut?ae!==null?ae+"Capture":null:ae;ut=[];for(var Y=ie,se;Y!==null;){var be=Y;if(se=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||se===null||Q===null||(be=xs(Y,Q),be!=null&&ut.push(Hu(Y,be,se))),rn)break;Y=Y.return}0<ut.length&&(ae=new de(ae,Ye,null,l,ge),_e.push({event:ae,listeners:ut}))}}if((i&7)===0){e:{if(ae=s==="mouseover"||s==="pointerover",de=s==="mouseout"||s==="pointerout",ae&&l!==cu&&(Ye=l.relatedTarget||l.fromElement)&&(Vs(Ye)||Ye[Os]))break e;if((de||ae)&&(ae=ge.window===ge?ge:(ae=ge.ownerDocument)?ae.defaultView||ae.parentWindow:window,de?(Ye=l.relatedTarget||l.toElement,de=ie,Ye=Ye?Vs(Ye):null,Ye!==null&&(rn=o(Ye),ut=Ye.tag,Ye!==rn||ut!==5&&ut!==27&&ut!==6)&&(Ye=null)):(de=null,Ye=ie),de!==Ye)){if(ut=fu,be="onMouseLeave",Q="onMouseEnter",Y="mouse",(s==="pointerout"||s==="pointerover")&&(ut=bi,be="onPointerLeave",Q="onPointerEnter",Y="pointer"),rn=de==null?ae:Hr(de),se=Ye==null?ae:Hr(Ye),ae=new ut(be,Y+"leave",de,l,ge),ae.target=rn,ae.relatedTarget=se,be=null,Vs(ge)===ie&&(ut=new ut(Q,Y+"enter",Ye,l,ge),ut.target=se,ut.relatedTarget=rn,be=ut),rn=be,de&&Ye)t:{for(ut=d6,Q=de,Y=Ye,se=0,be=Q;be;be=ut(be))se++;be=0;for(var rt=Y;rt;rt=ut(rt))be++;for(;0<se-be;)Q=ut(Q),se--;for(;0<be-se;)Y=ut(Y),be--;for(;se--;){if(Q===Y||Y!==null&&Q===Y.alternate){ut=Q;break t}Q=ut(Q),Y=ut(Y)}ut=null}else ut=null;de!==null&&R_(_e,ae,de,ut,!1),Ye!==null&&rn!==null&&R_(_e,rn,Ye,ut,!0)}}e:{if(ae=ie?Hr(ie):window,de=ae.nodeName&&ae.nodeName.toLowerCase(),de==="select"||de==="input"&&ae.type==="file")var Bt=Yb;else if(qb(ae))if(Kb)Bt=wR;else{Bt=xR;var Je=bR}else de=ae.nodeName,!de||de.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?ie&&yl(ie.elementType)&&(Bt=Yb):Bt=_R;if(Bt&&(Bt=Bt(s,ie))){Gb(_e,Bt,l,ge);break e}Je&&Je(s,ae,ie),s==="focusout"&&ie&&ae.type==="number"&&ie.memoizedProps.value!=null&&au(ae,"number",ae.value)}switch(Je=ie?Hr(ie):window,s){case"focusin":(qb(Je)||Je.contentEditable==="true")&&(Cl=Je,ig=ie,yu=null);break;case"focusout":yu=ig=Cl=null;break;case"mousedown":ag=!0;break;case"contextmenu":case"mouseup":case"dragend":ag=!1,nx(_e,l,ge);break;case"selectionchange":if(SR)break;case"keydown":case"keyup":nx(_e,l,ge)}var Tt;if(Gt)e:{switch(s){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else Tl?_o(s,l)&&(Pt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Pt="onCompositionStart");Pt&&(Ks&&l.locale!=="ko"&&(Tl||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&Tl&&(Tt=du()):($s=ge,uu="value"in $s?$s.value:$s.textContent,Tl=!0)),Je=wf(ie,Pt),0<Je.length&&(Pt=new Ys(Pt,s,null,l,ge),_e.push({event:Pt,listeners:Je}),Tt?Pt.data=Tt:(Tt=Sl(l),Tt!==null&&(Pt.data=Tt)))),(Tt=is?pR(s,l):gR(s,l))&&(Pt=wf(ie,"onBeforeInput"),0<Pt.length&&(Je=new Ys("onBeforeInput","beforeinput",null,l,ge),_e.push({event:Je,listeners:Pt}),Je.data=Tt)),o6(_e,s,ie,l,ge)}N_(_e,i)})}function Hu(s,i,l){return{instance:s,listener:i,currentTarget:l}}function wf(s,i){for(var l=i+"Capture",d=[];s!==null;){var g=s,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=xs(s,l),g!=null&&d.unshift(Hu(s,g,v)),g=xs(s,i),g!=null&&d.push(Hu(s,g,v))),s.tag===3)return d;s=s.return}return[]}function d6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function R_(s,i,l,d,g){for(var v=i._reactName,E=[];l!==null&&l!==d;){var M=l,q=M.alternate,ie=M.stateNode;if(M=M.tag,q!==null&&q===d)break;M!==5&&M!==26&&M!==27||ie===null||(q=ie,g?(ie=xs(l,v),ie!=null&&E.unshift(Hu(l,ie,q))):g||(ie=xs(l,v),ie!=null&&E.push(Hu(l,ie,q)))),l=l.return}E.length!==0&&s.push({event:i,listeners:E})}var h6=/\r\n?/g,f6=/\u0000|\uFFFD/g;function I_(s){return(typeof s=="string"?s:""+s).replace(h6,`
`).replace(f6,"")}function j_(s,i){return i=I_(i),I_(s)===i}function nn(s,i,l,d,g,v){switch(l){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Rr(s,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Rr(s,""+d);break;case"className":$r(s,"class",d);break;case"tabIndex":$r(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":$r(s,l,d);break;case"style":lu(s,d,v);break;case"data":if(i!=="object"){$r(s,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(l);break}d=bl(""+d),s.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(i!=="input"&&nn(s,i,"name",g.name,g,null),nn(s,i,"formEncType",g.formEncType,g,null),nn(s,i,"formMethod",g.formMethod,g,null),nn(s,i,"formTarget",g.formTarget,g,null)):(nn(s,i,"encType",g.encType,g,null),nn(s,i,"method",g.method,g,null),nn(s,i,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(l);break}d=bl(""+d),s.setAttribute(l,d);break;case"onClick":d!=null&&(s.onclick=bs);break;case"onScroll":d!=null&&jt("scroll",s);break;case"onScrollEnd":d!=null&&jt("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(r(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(r(60));s.innerHTML=l}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}l=bl(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,""+d):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":d===!0?s.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,d):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(l,d):s.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(l):s.setAttribute(l,d);break;case"popover":jt("beforetoggle",s),jt("toggle",s),gl(s,"popover",d);break;case"xlinkActuate":jn(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":jn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":jn(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":jn(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":jn(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":jn(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":jn(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":jn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":jn(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":gl(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=_h.get(l)||l,gl(s,l,d))}}function Iv(s,i,l,d,g,v){switch(l){case"style":lu(s,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(r(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(r(60));s.innerHTML=l}}break;case"children":typeof d=="string"?Rr(s,d):(typeof d=="number"||typeof d=="bigint")&&Rr(s,""+d);break;case"onScroll":d!=null&&jt("scroll",s);break;case"onScrollEnd":d!=null&&jt("scrollend",s);break;case"onClick":d!=null&&(s.onclick=bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tu.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),i=l.slice(2,g?l.length-7:void 0),v=s[Jn]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(i,v,g),typeof d=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,d,g);break e}l in s?s[l]=d:d===!0?s.setAttribute(l,""):gl(s,l,d)}}}function lr(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":jt("error",s),jt("load",s);var d=!1,g=!1,v;for(v in l)if(l.hasOwnProperty(v)){var E=l[v];if(E!=null)switch(v){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:nn(s,i,v,E,l,null)}}g&&nn(s,i,"srcSet",l.srcSet,l,null),d&&nn(s,i,"src",l.src,l,null);return;case"input":jt("invalid",s);var M=v=E=g=null,q=null,ie=null;for(d in l)if(l.hasOwnProperty(d)){var ge=l[d];if(ge!=null)switch(d){case"name":g=ge;break;case"type":E=ge;break;case"checked":q=ge;break;case"defaultChecked":ie=ge;break;case"value":v=ge;break;case"defaultValue":M=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,i));break;default:nn(s,i,d,ge,l,null)}}yh(s,v,M,q,ie,E,g,!1);return;case"select":jt("invalid",s),d=E=v=null;for(g in l)if(l.hasOwnProperty(g)&&(M=l[g],M!=null))switch(g){case"value":v=M;break;case"defaultValue":E=M;break;case"multiple":d=M;default:nn(s,i,g,M,l,null)}i=v,l=E,s.multiple=!!d,i!=null?ca(s,!!d,i,!1):l!=null&&ca(s,!!d,l,!0);return;case"textarea":jt("invalid",s),v=g=d=null;for(E in l)if(l.hasOwnProperty(E)&&(M=l[E],M!=null))switch(E){case"value":d=M;break;case"defaultValue":g=M;break;case"children":v=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(r(91));break;default:nn(s,i,E,M,l,null)}ua(s,d,g,v);return;case"option":for(q in l)if(l.hasOwnProperty(q)&&(d=l[q],d!=null))switch(q){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:nn(s,i,q,d,l,null)}return;case"dialog":jt("beforetoggle",s),jt("toggle",s),jt("cancel",s),jt("close",s);break;case"iframe":case"object":jt("load",s);break;case"video":case"audio":for(d=0;d<Fu.length;d++)jt(Fu[d],s);break;case"image":jt("error",s),jt("load",s);break;case"details":jt("toggle",s);break;case"embed":case"source":case"link":jt("error",s),jt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in l)if(l.hasOwnProperty(ie)&&(d=l[ie],d!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:nn(s,i,ie,d,l,null)}return;default:if(yl(i)){for(ge in l)l.hasOwnProperty(ge)&&(d=l[ge],d!==void 0&&Iv(s,i,ge,d,l,void 0));return}}for(M in l)l.hasOwnProperty(M)&&(d=l[M],d!=null&&nn(s,i,M,d,l,null))}function m6(s,i,l,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,E=null,M=null,q=null,ie=null,ge=null;for(de in l){var _e=l[de];if(l.hasOwnProperty(de)&&_e!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":q=_e;default:d.hasOwnProperty(de)||nn(s,i,de,null,d,_e)}}for(var ae in d){var de=d[ae];if(_e=l[ae],d.hasOwnProperty(ae)&&(de!=null||_e!=null))switch(ae){case"type":v=de;break;case"name":g=de;break;case"checked":ie=de;break;case"defaultChecked":ge=de;break;case"value":E=de;break;case"defaultValue":M=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,i));break;default:de!==_e&&nn(s,i,ae,de,d,_e)}}vl(s,E,M,q,ie,ge,v,g);return;case"select":de=E=M=ae=null;for(v in l)if(q=l[v],l.hasOwnProperty(v)&&q!=null)switch(v){case"value":break;case"multiple":de=q;default:d.hasOwnProperty(v)||nn(s,i,v,null,d,q)}for(g in d)if(v=d[g],q=l[g],d.hasOwnProperty(g)&&(v!=null||q!=null))switch(g){case"value":ae=v;break;case"defaultValue":M=v;break;case"multiple":E=v;default:v!==q&&nn(s,i,g,v,d,q)}i=M,l=E,d=de,ae!=null?ca(s,!!l,ae,!1):!!d!=!!l&&(i!=null?ca(s,!!l,i,!0):ca(s,!!l,l?[]:"",!1));return;case"textarea":de=ae=null;for(M in l)if(g=l[M],l.hasOwnProperty(M)&&g!=null&&!d.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:nn(s,i,M,null,d,g)}for(E in d)if(g=d[E],v=l[E],d.hasOwnProperty(E)&&(g!=null||v!=null))switch(E){case"value":ae=g;break;case"defaultValue":de=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(r(91));break;default:g!==v&&nn(s,i,E,g,d,v)}bh(s,ae,de);return;case"option":for(var Ye in l)if(ae=l[Ye],l.hasOwnProperty(Ye)&&ae!=null&&!d.hasOwnProperty(Ye))switch(Ye){case"selected":s.selected=!1;break;default:nn(s,i,Ye,null,d,ae)}for(q in d)if(ae=d[q],de=l[q],d.hasOwnProperty(q)&&ae!==de&&(ae!=null||de!=null))switch(q){case"selected":s.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:nn(s,i,q,ae,d,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in l)ae=l[ut],l.hasOwnProperty(ut)&&ae!=null&&!d.hasOwnProperty(ut)&&nn(s,i,ut,null,d,ae);for(ie in d)if(ae=d[ie],de=l[ie],d.hasOwnProperty(ie)&&ae!==de&&(ae!=null||de!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,i));break;default:nn(s,i,ie,ae,d,de)}return;default:if(yl(i)){for(var rn in l)ae=l[rn],l.hasOwnProperty(rn)&&ae!==void 0&&!d.hasOwnProperty(rn)&&Iv(s,i,rn,void 0,d,ae);for(ge in d)ae=d[ge],de=l[ge],!d.hasOwnProperty(ge)||ae===de||ae===void 0&&de===void 0||Iv(s,i,ge,ae,d,de);return}}for(var Q in l)ae=l[Q],l.hasOwnProperty(Q)&&ae!=null&&!d.hasOwnProperty(Q)&&nn(s,i,Q,null,d,ae);for(_e in d)ae=d[_e],de=l[_e],!d.hasOwnProperty(_e)||ae===de||ae==null&&de==null||nn(s,i,_e,ae,d,de)}function D_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function p6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,i=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var g=l[d],v=g.transferSize,E=g.initiatorType,M=g.duration;if(v&&M&&D_(E)){for(E=0,M=g.responseEnd,d+=1;d<l.length;d++){var q=l[d],ie=q.startTime;if(ie>M)break;var ge=q.transferSize,_e=q.initiatorType;ge&&D_(_e)&&(q=q.responseEnd,E+=ge*(q<M?1:(M-ie)/(q-ie)))}if(--d,i+=8*(v+E)/(g.duration/1e3),s++,10<s)break}}if(0<s)return i/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var jv=null,Dv=null;function Ef(s){return s.nodeType===9?s:s.ownerDocument}function P_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function M_(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Pv(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Mv=null;function g6(){var s=window.event;return s&&s.type==="popstate"?s===Mv?!1:(Mv=s,!0):(Mv=null,!1)}var O_=typeof setTimeout=="function"?setTimeout:void 0,v6=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,y6=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(s){return L_.resolve(null).then(s).catch(b6)}:O_;function b6(s){setTimeout(function(){throw s})}function Da(s){return s==="head"}function V_(s,i){var l=i,d=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(d===0){s.removeChild(g),Zl(i);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")$u(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,$u(l);for(var v=l.firstChild;v;){var E=v.nextSibling,M=v.nodeName;v[Ls]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&v.rel.toLowerCase()==="stylesheet"||l.removeChild(v),v=E}}else l==="body"&&$u(s.ownerDocument.body);l=g}while(l);Zl(i)}function U_(s,i){var l=s;s=0;do{var d=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=d}while(l)}function Ov(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Ov(l),pl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function x6(s,i,l,d){for(;s.nodeType===1;){var g=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[Ls])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=hs(s.nextSibling),s===null)break}return null}function _6(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=hs(s.nextSibling),s===null))return null;return s}function z_(s,i){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!i||(s=hs(s.nextSibling),s===null))return null;return s}function Lv(s){return s.data==="$?"||s.data==="$~"}function Vv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function w6(s,i){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=i;else if(s.data!=="$?"||l.readyState!=="loading")i();else{var d=function(){i(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function hs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return s}var Uv=null;function B_(s){s=s.nextSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(i===0)return hs(s.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}s=s.nextSibling}return null}function F_(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return s;i--}else l!=="/$"&&l!=="/&"||i++}s=s.previousSibling}return null}function H_(s,i,l){switch(i=Ef(l),s){case"html":if(s=i.documentElement,!s)throw Error(r(452));return s;case"head":if(s=i.head,!s)throw Error(r(453));return s;case"body":if(s=i.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function $u(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);pl(s)}var fs=new Map,$_=new Set;function Sf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Pi=Z.d;Z.d={f:E6,r:S6,D:T6,C:C6,L:k6,m:N6,X:R6,S:A6,M:I6};function E6(){var s=Pi.f(),i=pf();return s||i}function S6(s){var i=ns(s);i!==null&&i.tag===5&&i.type==="form"?o2(i):Pi.r(s)}var Xl=typeof document>"u"?null:document;function q_(s,i,l){var d=Xl;if(d&&typeof i=="string"&&i){var g=Ar(i);g='link[rel="'+s+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),$_.has(g)||($_.add(g),s={rel:s,crossOrigin:l,href:i},d.querySelector(g)===null&&(i=d.createElement("link"),lr(i,"link",s),In(i),d.head.appendChild(i)))}}function T6(s){Pi.D(s),q_("dns-prefetch",s,null)}function C6(s,i){Pi.C(s,i),q_("preconnect",s,i)}function k6(s,i,l){Pi.L(s,i,l);var d=Xl;if(d&&s&&i){var g='link[rel="preload"][as="'+Ar(i)+'"]';i==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Ar(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Ar(l.imageSizes)+'"]')):g+='[href="'+Ar(s)+'"]';var v=g;switch(i){case"style":v=Wl(s);break;case"script":v=Jl(s)}fs.has(v)||(s=b({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),fs.set(v,s),d.querySelector(g)!==null||i==="style"&&d.querySelector(qu(v))||i==="script"&&d.querySelector(Gu(v))||(i=d.createElement("link"),lr(i,"link",s),In(i),d.head.appendChild(i)))}}function N6(s,i){Pi.m(s,i);var l=Xl;if(l&&s){var d=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+Ar(d)+'"][href="'+Ar(s)+'"]',v=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Jl(s)}if(!fs.has(v)&&(s=b({rel:"modulepreload",href:s},i),fs.set(v,s),l.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Gu(v)))return}d=l.createElement("link"),lr(d,"link",s),In(d),l.head.appendChild(d)}}}function A6(s,i,l){Pi.S(s,i,l);var d=Xl;if(d&&s){var g=Us(d).hoistableStyles,v=Wl(s);i=i||"default";var E=g.get(v);if(!E){var M={loading:0,preload:null};if(E=d.querySelector(qu(v)))M.loading=5;else{s=b({rel:"stylesheet",href:s,"data-precedence":i},l),(l=fs.get(v))&&zv(s,l);var q=E=d.createElement("link");In(q),lr(q,"link",s),q._p=new Promise(function(ie,ge){q.onload=ie,q.onerror=ge}),q.addEventListener("load",function(){M.loading|=1}),q.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Tf(E,i,d)}E={type:"stylesheet",instance:E,count:1,state:M},g.set(v,E)}}}function R6(s,i){Pi.X(s,i);var l=Xl;if(l&&s){var d=Us(l).hoistableScripts,g=Jl(s),v=d.get(g);v||(v=l.querySelector(Gu(g)),v||(s=b({src:s,async:!0},i),(i=fs.get(g))&&Bv(s,i),v=l.createElement("script"),In(v),lr(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function I6(s,i){Pi.M(s,i);var l=Xl;if(l&&s){var d=Us(l).hoistableScripts,g=Jl(s),v=d.get(g);v||(v=l.querySelector(Gu(g)),v||(s=b({src:s,async:!0,type:"module"},i),(i=fs.get(g))&&Bv(s,i),v=l.createElement("script"),In(v),lr(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function G_(s,i,l,d){var g=(g=Ue.current)?Sf(g):null;if(!g)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Wl(l.href),l=Us(g).hoistableStyles,d=l.get(i),d||(d={type:"style",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Wl(l.href);var v=Us(g).hoistableStyles,E=v.get(s);if(E||(g=g.ownerDocument||g,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,E),(v=g.querySelector(qu(s)))&&!v._p&&(E.instance=v,E.state.loading=5),fs.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},fs.set(s,l),v||j6(g,s,l,E.state))),i&&d===null)throw Error(r(528,""));return E}if(i&&d!==null)throw Error(r(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Jl(l),l=Us(g).hoistableScripts,d=l.get(i),d||(d={type:"script",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Wl(s){return'href="'+Ar(s)+'"'}function qu(s){return'link[rel="stylesheet"]['+s+"]"}function Y_(s){return b({},s,{"data-precedence":s.precedence,precedence:null})}function j6(s,i,l,d){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=s.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),lr(i,"link",l),In(i),s.head.appendChild(i))}function Jl(s){return'[src="'+Ar(s)+'"]'}function Gu(s){return"script[async]"+s}function K_(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var d=s.querySelector('style[data-href~="'+Ar(l.href)+'"]');if(d)return i.instance=d,In(d),d;var g=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),In(d),lr(d,"style",g),Tf(d,l.precedence,s),i.instance=d;case"stylesheet":g=Wl(l.href);var v=s.querySelector(qu(g));if(v)return i.state.loading|=4,i.instance=v,In(v),v;d=Y_(l),(g=fs.get(g))&&zv(d,g),v=(s.ownerDocument||s).createElement("link"),In(v);var E=v;return E._p=new Promise(function(M,q){E.onload=M,E.onerror=q}),lr(v,"link",d),i.state.loading|=4,Tf(v,l.precedence,s),i.instance=v;case"script":return v=Jl(l.src),(g=s.querySelector(Gu(v)))?(i.instance=g,In(g),g):(d=l,(g=fs.get(v))&&(d=b({},l),Bv(d,g)),s=s.ownerDocument||s,g=s.createElement("script"),In(g),lr(g,"link",d),s.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,Tf(d,l.precedence,s));return i.instance}function Tf(s,i,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,v=g,E=0;E<d.length;E++){var M=d[E];if(M.dataset.precedence===i)v=M;else if(v!==g)break}v?v.parentNode.insertBefore(s,v.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function zv(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function Bv(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Cf=null;function Q_(s,i,l){if(Cf===null){var d=new Map,g=Cf=new Map;g.set(l,d)}else g=Cf,d=g.get(l),d||(d=new Map,g.set(l,d));if(d.has(s))return d;for(d.set(s,null),l=l.getElementsByTagName(s),g=0;g<l.length;g++){var v=l[g];if(!(v[Ls]||v[Rn]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(i)||"";E=s+E;var M=d.get(E);M?M.push(v):d.set(E,[v])}}return d}function X_(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function D6(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function W_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function P6(s,i,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=Wl(d.href),v=i.querySelector(qu(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(s.count++,s=kf.bind(s),i.then(s,s)),l.state.loading|=4,l.instance=v,In(v);return}v=i.ownerDocument||i,d=Y_(d),(g=fs.get(g))&&zv(d,g),v=v.createElement("link"),In(v);var E=v;E._p=new Promise(function(M,q){E.onload=M,E.onerror=q}),lr(v,"link",d),l.instance=v}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=kf.bind(s),i.addEventListener("load",l),i.addEventListener("error",l))}}var Fv=0;function M6(s,i){return s.stylesheets&&s.count===0&&Af(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var d=setTimeout(function(){if(s.stylesheets&&Af(s,s.stylesheets),s.unsuspend){var v=s.unsuspend;s.unsuspend=null,v()}},6e4+i);0<s.imgBytes&&Fv===0&&(Fv=62500*p6());var g=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Af(s,s.stylesheets),s.unsuspend)){var v=s.unsuspend;s.unsuspend=null,v()}},(s.imgBytes>Fv?50:800)+i);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function kf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Af(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Nf=null;function Af(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Nf=new Map,i.forEach(O6,s),Nf=null,kf.call(s))}function O6(s,i){if(!(i.state.loading&4)){var l=Nf.get(s);if(l)var d=l.get(null);else{l=new Map,Nf.set(s,l);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var E=g[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),d=E)}d&&l.set(null,d)}g=i.instance,E=g.getAttribute("data-precedence"),v=l.get(E)||d,v===d&&l.set(null,g),l.set(E,g),this.count++,d=kf.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),v?v.parentNode.insertBefore(g,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),i.state.loading|=4}}var Yu={$$typeof:j,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function L6(s,i,l,d,g,v,E,M,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qe(0),this.hiddenUpdates=qe(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function J_(s,i,l,d,g,v,E,M,q,ie,ge,_e){return s=new L6(s,i,l,E,q,ie,ge,_e,M),i=1,v===!0&&(i|=24),v=Gr(3,null,null,i),s.current=v,v.stateNode=s,i=_g(),i.refCount++,s.pooledCache=i,i.refCount++,v.memoizedState={element:d,isDehydrated:l,cache:i},Tg(v),s}function Z_(s){return s?(s=Al,s):Al}function ew(s,i,l,d,g,v){g=Z_(g),d.context===null?d.context=g:d.pendingContext=g,d=wa(i),d.payload={element:l},v=v===void 0?null:v,v!==null&&(d.callback=v),l=Ea(s,d,i),l!==null&&(Mr(l,s,i),Tu(l,s,i))}function tw(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function Hv(s,i){tw(s,i),(s=s.alternate)&&tw(s,i)}function nw(s){if(s.tag===13||s.tag===31){var i=So(s,67108864);i!==null&&Mr(i,s,67108864),Hv(s,67108864)}}function rw(s){if(s.tag===13||s.tag===31){var i=Wr();i=ho(i);var l=So(s,i);l!==null&&Mr(l,s,i),Hv(s,i)}}var Rf=!0;function V6(s,i,l,d){var g=G.T;G.T=null;var v=Z.p;try{Z.p=2,$v(s,i,l,d)}finally{Z.p=v,G.T=g}}function U6(s,i,l,d){var g=G.T;G.T=null;var v=Z.p;try{Z.p=8,$v(s,i,l,d)}finally{Z.p=v,G.T=g}}function $v(s,i,l,d){if(Rf){var g=qv(d);if(g===null)Rv(s,i,d,If,l),iw(s,d);else if(B6(g,s,i,l,d))d.stopPropagation();else if(iw(s,d),i&4&&-1<z6.indexOf(s)){for(;g!==null;){var v=ns(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=At(v.pendingLanes);if(E!==0){var M=v;for(M.pendingLanes|=2,M.entangledLanes|=2;E;){var q=1<<31-Xt(E);M.entanglements[1]|=q,E&=~q}Js(v),(Yt&6)===0&&(ff=W()+500,Bu(0))}}break;case 31:case 13:M=So(v,2),M!==null&&Mr(M,v,2),pf(),Hv(v,2)}if(v=qv(d),v===null&&Rv(s,i,d,If,l),v===g)break;g=v}g!==null&&d.stopPropagation()}else Rv(s,i,d,null,l)}}function qv(s){return s=rs(s),Gv(s)}var If=null;function Gv(s){if(If=null,s=Vs(s),s!==null){var i=o(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=u(i),s!==null)return s;s=null}else if(l===31){if(s=h(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return If=s,null}function sw(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case ct:return 2;case on:return 8;case Ee:case $e:return 32;case lt:return 268435456;default:return 32}default:return 32}}var Yv=!1,Pa=null,Ma=null,Oa=null,Ku=new Map,Qu=new Map,La=[],z6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iw(s,i){switch(s){case"focusin":case"focusout":Pa=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":Ku.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qu.delete(i.pointerId)}}function Xu(s,i,l,d,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:i,domEventName:l,eventSystemFlags:d,nativeEvent:v,targetContainers:[g]},i!==null&&(i=ns(i),i!==null&&nw(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),s)}function B6(s,i,l,d,g){switch(i){case"focusin":return Pa=Xu(Pa,s,i,l,d,g),!0;case"dragenter":return Ma=Xu(Ma,s,i,l,d,g),!0;case"mouseover":return Oa=Xu(Oa,s,i,l,d,g),!0;case"pointerover":var v=g.pointerId;return Ku.set(v,Xu(Ku.get(v)||null,s,i,l,d,g)),!0;case"gotpointercapture":return v=g.pointerId,Qu.set(v,Xu(Qu.get(v)||null,s,i,l,d,g)),!0}return!1}function aw(s){var i=Vs(s.target);if(i!==null){var l=o(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){s.blockedOn=i,vs(s.priority,function(){rw(l)});return}}else if(i===31){if(i=h(l),i!==null){s.blockedOn=i,vs(s.priority,function(){rw(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function jf(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=qv(s.nativeEvent);if(l===null){l=s.nativeEvent;var d=new l.constructor(l.type,l);cu=d,l.target.dispatchEvent(d),cu=null}else return i=ns(l),i!==null&&nw(i),s.blockedOn=l,!1;i.shift()}return!0}function ow(s,i,l){jf(s)&&l.delete(i)}function F6(){Yv=!1,Pa!==null&&jf(Pa)&&(Pa=null),Ma!==null&&jf(Ma)&&(Ma=null),Oa!==null&&jf(Oa)&&(Oa=null),Ku.forEach(ow),Qu.forEach(ow)}function Df(s,i){s.blockedOn===i&&(s.blockedOn=null,Yv||(Yv=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,F6)))}var Pf=null;function lw(s){Pf!==s&&(Pf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Pf===s&&(Pf=null);for(var i=0;i<s.length;i+=3){var l=s[i],d=s[i+1],g=s[i+2];if(typeof d!="function"){if(Gv(d||l)===null)continue;break}var v=ns(l);v!==null&&(s.splice(i,3),i-=3,qg(v,{pending:!0,data:g,method:l.method,action:d},d,g))}}))}function Zl(s){function i(q){return Df(q,s)}Pa!==null&&Df(Pa,s),Ma!==null&&Df(Ma,s),Oa!==null&&Df(Oa,s),Ku.forEach(i),Qu.forEach(i);for(var l=0;l<La.length;l++){var d=La[l];d.blockedOn===s&&(d.blockedOn=null)}for(;0<La.length&&(l=La[0],l.blockedOn===null);)aw(l),l.blockedOn===null&&La.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var g=l[d],v=l[d+1],E=g[Jn]||null;if(typeof v=="function")E||lw(l);else if(E){var M=null;if(v&&v.hasAttribute("formAction")){if(g=v,E=v[Jn]||null)M=E.formAction;else if(Gv(g)!==null)continue}else M=E.action;typeof M=="function"?l[d+1]=M:(l.splice(d,3),d-=3),lw(l)}}}function cw(){function s(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(E){return g=E})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function Kv(s){this._internalRoot=s}Mf.prototype.render=Kv.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(r(409));var l=i.current,d=Wr();ew(l,d,s,i,null,null)},Mf.prototype.unmount=Kv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;ew(s.current,2,null,s,null,null),pf(),i[Os]=null}};function Mf(s){this._internalRoot=s}Mf.prototype.unstable_scheduleHydration=function(s){if(s){var i=mh();s={blockedOn:null,target:s,priority:i};for(var l=0;l<La.length&&i!==0&&i<La[l].priority;l++);La.splice(l,0,s),l===0&&aw(s)}};var uw=e.version;if(uw!=="19.2.3")throw Error(r(527,uw,"19.2.3"));Z.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=p(i),s=s!==null?y(s):null,s=s===null?null:s.stateNode,s};var H6={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{kt=Of.inject(H6),nt=Of}catch{}}return Ju.createRoot=function(s,i){if(!a(s))throw Error(r(299));var l=!1,d="",g=v2,v=y2,E=b2;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError)),i=J_(s,1,!1,null,null,l,d,null,g,v,E,cw),s[Os]=i.current,Av(s),new Kv(i)},Ju.hydrateRoot=function(s,i,l){if(!a(s))throw Error(r(299));var d=!1,g="",v=v2,E=y2,M=b2,q=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),i=J_(s,1,!0,i,l??null,d,g,q,v,E,M,cw),i.context=Z_(null),l=i.current,d=Wr(),d=ho(d),g=wa(d),g.callback=null,Ea(l,g,d),l=d,i.current.lanes=l,xt(i,l),Js(i),s[Os]=i.current,Av(s),new Mf(i)},Ju.version="19.2.3",Ju}var xw;function e5(){if(xw)return Wv.exports;xw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Wv.exports=Z6(),Wv.exports}var t5=e5();const n5=()=>{};var _w={};const X4=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},r5=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[n++];e[r++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[n++],u=t[n++],h=t[n++],f=((a&7)<<18|(o&63)<<12|(u&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const o=t[n++],u=t[n++];e[r++]=String.fromCharCode((a&15)<<12|(o&63)<<6|u&63)}}return e.join("")},W4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const o=t[a],u=a+1<t.length,h=u?t[a+1]:0,f=a+2<t.length,p=f?t[a+2]:0,y=o>>2,b=(o&3)<<4|h>>4;let x=(h&15)<<2|p>>6,k=p&63;f||(k=64,u||(x=64)),r.push(n[y],n[b],n[x],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(X4(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):r5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const o=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const p=a<t.length?n[t.charAt(a)]:64;++a;const b=a<t.length?n[t.charAt(a)]:64;if(++a,o==null||h==null||p==null||b==null)throw new s5;const x=o<<2|h>>4;if(r.push(x),p!==64){const k=h<<4&240|p>>2;if(r.push(k),b!==64){const I=p<<6&192|b;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i5=function(t){const e=X4(t);return W4.encodeByteArray(e,!0)},Sm=function(t){return i5(t).replace(/\./g,"")},J4=function(t){try{return W4.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function a5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const o5=()=>a5().__FIREBASE_DEFAULTS__,l5=()=>{if(typeof process>"u"||typeof _w>"u")return;const t=_w.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},c5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&J4(t[1]);return e&&JSON.parse(e)},ap=()=>{try{return n5()||o5()||l5()||c5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Z4=t=>ap()?.emulatorHosts?.[t],eT=t=>{const e=Z4(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},tT=()=>ap()?.config,nT=t=>ap()?.[`_${t}`];class u5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function rl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Yy(t){return(await fetch(t,{credentials:"include"})).ok}function rT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Sm(JSON.stringify(n)),Sm(JSON.stringify(u)),""].join(".")}const vd={};function d5(){const t={prod:[],emulator:[]};for(const e of Object.keys(vd))vd[e]?t.emulator.push(e):t.prod.push(e);return t}function h5(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ww=!1;function Ky(t,e){if(typeof window>"u"||typeof document>"u"||!rl(window.location.host)||vd[t]===e||vd[t]||ww)return;vd[t]=e;function n(x){return`__firebase__banner__${x}`}const r="__firebase__banner",o=d5().prod.length>0;function u(){const x=document.getElementById(r);x&&x.remove()}function h(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,k){x.setAttribute("width","24"),x.setAttribute("id",k),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function p(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{ww=!0,u()},x}function y(x,k){x.setAttribute("id",k),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function b(){const x=h5(r),k=n("text"),I=document.getElementById(k)||document.createElement("span"),A=n("learnmore"),N=document.getElementById(A)||document.createElement("a"),V=n("preprendIcon"),F=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const j=x.element;h(j),y(N,A);const O=p();f(F,V),j.append(F,I,N,O),document.body.appendChild(j)}o?(I.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function xr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function f5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xr())}function m5(){const t=ap()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function p5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function g5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function v5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function y5(){const t=xr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function b5(){return!m5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function x5(){try{return typeof indexedDB=="object"}catch{return!1}}function _5(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const w5="FirebaseError";class fi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=w5,Object.setPrototypeOf(this,fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qd.prototype.create)}}class Qd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},a=`${this.service}/${e}`,o=this.errors[e],u=o?E5(o,r):"Error",h=`${this.serviceName}: ${u} (${a}).`;return new fi(a,h,r)}}function E5(t,e){return t.replace(S5,(n,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const S5=/\{\$([^}]+)}/g;function T5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Qi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const o=t[a],u=e[a];if(Ew(o)&&Ew(u)){if(!Qi(o,u))return!1}else if(o!==u)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function Ew(t){return t!==null&&typeof t=="object"}function Lc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ad(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,o]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(o)}}),e}function od(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function C5(t,e){const n=new k5(t,e);return n.subscribe.bind(n)}class k5{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let a;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");N5(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:r},a.next===void 0&&(a.next=t0),a.error===void 0&&(a.error=t0),a.complete===void 0&&(a.complete=t0);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function N5(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function t0(){}function at(t){return t&&t._delegate?t._delegate:t}class to{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const zo="[DEFAULT]";class A5{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new u5;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(I5(e))try{this.getOrInitializeService({instanceIdentifier:zo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:a});r.resolve(o)}catch{}}}}clearInstance(e=zo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zo){return this.instances.has(e)}getOptions(e=zo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);r===h&&u.resolve(a)}return a}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const o=this.instances.get(r);return o&&e(o,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:R5(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zo){return this.component?this.component.multipleInstances?e:zo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function R5(t){return t===zo?void 0:t}function I5(t){return t.instantiationMode==="EAGER"}class j5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new A5(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Mt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Mt||(Mt={}));const D5={debug:Mt.DEBUG,verbose:Mt.VERBOSE,info:Mt.INFO,warn:Mt.WARN,error:Mt.ERROR,silent:Mt.SILENT},P5=Mt.INFO,M5={[Mt.DEBUG]:"log",[Mt.VERBOSE]:"log",[Mt.INFO]:"info",[Mt.WARN]:"warn",[Mt.ERROR]:"error"},O5=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),a=M5[e];if(a)console[a](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Qy=class{constructor(e){this.name=e,this._logLevel=P5,this._logHandler=O5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Mt.DEBUG,...e),this._logHandler(this,Mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Mt.VERBOSE,...e),this._logHandler(this,Mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Mt.INFO,...e),this._logHandler(this,Mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Mt.WARN,...e),this._logHandler(this,Mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Mt.ERROR,...e),this._logHandler(this,Mt.ERROR,...e)}};const L5=(t,e)=>e.some(n=>t instanceof n);let Sw,Tw;function V5(){return Sw||(Sw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U5(){return Tw||(Tw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sT=new WeakMap,$0=new WeakMap,iT=new WeakMap,n0=new WeakMap,Xy=new WeakMap;function z5(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{n(Ka(t.result)),a()},u=()=>{r(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&sT.set(n,t)}).catch(()=>{}),Xy.set(e,t),e}function B5(t){if($0.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{n(),a()},u=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});$0.set(t,e)}let q0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return $0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ka(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function F5(t){q0=t(q0)}function H5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(r0(this),e,...n);return iT.set(r,e.sort?e.sort():[e]),Ka(r)}:U5().includes(t)?function(...e){return t.apply(r0(this),e),Ka(sT.get(this))}:function(...e){return Ka(t.apply(r0(this),e))}}function $5(t){return typeof t=="function"?H5(t):(t instanceof IDBTransaction&&B5(t),L5(t,V5())?new Proxy(t,q0):t)}function Ka(t){if(t instanceof IDBRequest)return z5(t);if(n0.has(t))return n0.get(t);const e=$5(t);return e!==t&&(n0.set(t,e),Xy.set(e,t)),e}const r0=t=>Xy.get(t);function q5(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const u=indexedDB.open(t,e),h=Ka(u);return r&&u.addEventListener("upgradeneeded",f=>{r(Ka(u.result),f.oldVersion,f.newVersion,Ka(u.transaction),f)}),n&&u.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const G5=["get","getKey","getAll","getAllKeys","count"],Y5=["put","add","delete","clear"],s0=new Map;function Cw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(s0.get(e))return s0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=Y5.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||G5.includes(n)))return;const o=async function(u,...h){const f=this.transaction(u,a?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(h.shift())),(await Promise.all([p[n](...h),a&&f.done]))[0]};return s0.set(e,o),o}F5(t=>({...t,get:(e,n,r)=>Cw(e,n)||t.get(e,n,r),has:(e,n)=>!!Cw(e,n)||t.has(e,n)}));class K5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Q5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Q5(t){return t.getComponent()?.type==="VERSION"}const G0="@firebase/app",kw="0.14.6";const Xi=new Qy("@firebase/app"),X5="@firebase/app-compat",W5="@firebase/analytics-compat",J5="@firebase/analytics",Z5="@firebase/app-check-compat",eI="@firebase/app-check",tI="@firebase/auth",nI="@firebase/auth-compat",rI="@firebase/database",sI="@firebase/data-connect",iI="@firebase/database-compat",aI="@firebase/functions",oI="@firebase/functions-compat",lI="@firebase/installations",cI="@firebase/installations-compat",uI="@firebase/messaging",dI="@firebase/messaging-compat",hI="@firebase/performance",fI="@firebase/performance-compat",mI="@firebase/remote-config",pI="@firebase/remote-config-compat",gI="@firebase/storage",vI="@firebase/storage-compat",yI="@firebase/firestore",bI="@firebase/ai",xI="@firebase/firestore-compat",_I="firebase",wI="12.6.0";const Y0="[DEFAULT]",EI={[G0]:"fire-core",[X5]:"fire-core-compat",[J5]:"fire-analytics",[W5]:"fire-analytics-compat",[eI]:"fire-app-check",[Z5]:"fire-app-check-compat",[tI]:"fire-auth",[nI]:"fire-auth-compat",[rI]:"fire-rtdb",[sI]:"fire-data-connect",[iI]:"fire-rtdb-compat",[aI]:"fire-fn",[oI]:"fire-fn-compat",[lI]:"fire-iid",[cI]:"fire-iid-compat",[uI]:"fire-fcm",[dI]:"fire-fcm-compat",[hI]:"fire-perf",[fI]:"fire-perf-compat",[mI]:"fire-rc",[pI]:"fire-rc-compat",[gI]:"fire-gcs",[vI]:"fire-gcs-compat",[yI]:"fire-fst",[xI]:"fire-fst-compat",[bI]:"fire-vertex","fire-js":"fire-js",[_I]:"fire-js-all"};const Tm=new Map,SI=new Map,K0=new Map;function Nw(t,e){try{t.container.addComponent(e)}catch(n){Xi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Qo(t){const e=t.name;if(K0.has(e))return Xi.debug(`There were multiple attempts to register component ${e}.`),!1;K0.set(e,t);for(const n of Tm.values())Nw(n,t);for(const n of SI.values())Nw(n,t);return!0}function op(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function vn(t){return t==null?!1:t.settings!==void 0}const TI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qa=new Qd("app","Firebase",TI);class CI{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new to("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qa.create("app-deleted",{appName:this._name})}}const sl=wI;function aT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Y0,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw Qa.create("bad-app-name",{appName:String(a)});if(n||(n=tT()),!n)throw Qa.create("no-options");const o=Tm.get(a);if(o){if(Qi(n,o.options)&&Qi(r,o.config))return o;throw Qa.create("duplicate-app",{appName:a})}const u=new j5(a);for(const f of K0.values())u.addComponent(f);const h=new CI(n,r,u);return Tm.set(a,h),h}function Wy(t=Y0){const e=Tm.get(t);if(!e&&t===Y0&&tT())return aT();if(!e)throw Qa.create("no-app",{appName:t});return e}function ri(t,e,n){let r=EI[t]??t;n&&(r+=`-${n}`);const a=r.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const u=[`Unable to register library "${r}" with version "${e}":`];a&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xi.warn(u.join(" "));return}Qo(new to(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const kI="firebase-heartbeat-database",NI=1,Cd="firebase-heartbeat-store";let i0=null;function oT(){return i0||(i0=q5(kI,NI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Cd)}catch(n){console.warn(n)}}}}).catch(t=>{throw Qa.create("idb-open",{originalErrorMessage:t.message})})),i0}async function AI(t){try{const n=(await oT()).transaction(Cd),r=await n.objectStore(Cd).get(lT(t));return await n.done,r}catch(e){if(e instanceof fi)Xi.warn(e.message);else{const n=Qa.create("idb-get",{originalErrorMessage:e?.message});Xi.warn(n.message)}}}async function Aw(t,e){try{const r=(await oT()).transaction(Cd,"readwrite");await r.objectStore(Cd).put(e,lT(t)),await r.done}catch(n){if(n instanceof fi)Xi.warn(n.message);else{const r=Qa.create("idb-set",{originalErrorMessage:n?.message});Xi.warn(r.message)}}}function lT(t){return`${t.name}!${t.options.appId}`}const RI=1024,II=30;class jI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new PI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Rw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>II){const a=MI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Rw(),{heartbeatsToSend:n,unsentEntries:r}=DI(this._heartbeatsCache.heartbeats),a=Sm(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Xi.warn(e),""}}}function Rw(){return new Date().toISOString().substring(0,10)}function DI(t,e=RI){const n=[];let r=t.slice();for(const a of t){const o=n.find(u=>u.agent===a.agent);if(o){if(o.dates.push(a.date),Iw(n)>e){o.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Iw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class PI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return x5()?_5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await AI(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Aw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Aw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Iw(t){return Sm(JSON.stringify({version:2,heartbeats:t})).length}function MI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function OI(t){Qo(new to("platform-logger",e=>new K5(e),"PRIVATE")),Qo(new to("heartbeat",e=>new jI(e),"PRIVATE")),ri(G0,kw,t),ri(G0,kw,"esm2020"),ri("fire-js","")}OI("");var LI="firebase",VI="12.6.0";ri(LI,VI,"app");const UI={PHONE:"phone",TOTP:"totp"},zI={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},BI={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},FI={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},HI={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function $I(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function cT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qI=$I,uT=cT,dT=new Qd("auth","Firebase",cT()),GI={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_PASSWORD:"auth/missing-password",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};const Cm=new Qy("@firebase/auth");function YI(t,...e){Cm.logLevel<=Mt.WARN&&Cm.warn(`Auth (${sl}): ${t}`,...e)}function tm(t,...e){Cm.logLevel<=Mt.ERROR&&Cm.error(`Auth (${sl}): ${t}`,...e)}function Br(t,...e){throw Zy(t,...e)}function Tr(t,...e){return Zy(t,...e)}function Jy(t,e,n){const r={...uT(),[e]:n};return new Qd("auth","Firebase",r).create(e,{appName:t.name})}function nr(t){return Jy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vc(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Br(t,"argument-error"),Jy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Zy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return dT.create(t,...e)}function Me(t,e,...n){if(!t)throw Zy(e,...n)}function ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw tm(e),new Error(e)}function Wi(t,e){t||ni(e)}function kd(){return typeof self<"u"&&self.location?.href||""}function e1(){return jw()==="http:"||jw()==="https:"}function jw(){return typeof self<"u"&&self.location?.protocol||null}function KI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e1()||g5()||"connection"in navigator)?navigator.onLine:!0}function QI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Xd{constructor(e,n){this.shortDelay=e,this.longDelay=n,Wi(n>e,"Short delay should be less than long delay!"),this.isMobile=f5()||v5()}get(){return KI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function t1(t,e){Wi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class hT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const XI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JI=new Xd(3e4,6e4);function fn(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function mn(t,e,n,r,a={}){return fT(t,a,async()=>{let o={},u={};r&&(e==="GET"?u=r:o={body:JSON.stringify(r)});const h=Lc({key:t.config.apiKey,...u}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:f,...o};return p5()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&rl(t.emulatorConfig.host)&&(p.credentials="include"),hT.fetch()(await mT(t,t.config.apiHost,n,h),p)})}async function fT(t,e,n){t._canInitEmulator=!1;const r={...XI,...e};try{const a=new ej(t),o=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const u=await o.json();if("needConfirmation"in u)throw ld(t,"account-exists-with-different-credential",u);if(o.ok&&!("errorMessage"in u))return u;{const h=o.ok?u.errorMessage:u.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw ld(t,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw ld(t,"email-already-in-use",u);if(f==="USER_DISABLED")throw ld(t,"user-disabled",u);const y=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Jy(t,y,p);Br(t,y)}}catch(a){if(a instanceof fi)throw a;Br(t,"network-request-failed",{message:String(a)})}}async function ra(t,e,n,r,a={}){const o=await mn(t,e,n,r,a);return"mfaPendingCredential"in o&&Br(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function mT(t,e,n,r){const a=`${e}${n}?${r}`,o=t,u=o.config.emulator?t1(t.config,a):`${t.config.apiScheme}://${a}`;return WI.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(u).toString():u}function ZI(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ej{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Tr(this.auth,"network-request-failed")),JI.get())})}}function ld(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=Tr(t,e,r);return a.customData._tokenResponse=n,a}function Dw(t){return t!==void 0&&t.getResponse!==void 0}function Pw(t){return t!==void 0&&t.enterprise!==void 0}class pT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return ZI(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function tj(t){return(await mn(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function gT(t,e){return mn(t,"GET","/v2/recaptchaConfig",fn(t,e))}async function nj(t,e){return mn(t,"POST","/v1/accounts:delete",e)}async function rj(t,e){return mn(t,"POST","/v1/accounts:update",e)}async function km(t,e){return mn(t,"POST","/v1/accounts:lookup",e)}function yd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function sj(t,e=!1){return at(t).getIdToken(e)}async function vT(t,e=!1){const n=at(t),r=await n.getIdToken(e),a=lp(r);Me(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,u=o?.sign_in_provider;return{claims:a,token:r,authTime:yd(a0(a.auth_time)),issuedAtTime:yd(a0(a.iat)),expirationTime:yd(a0(a.exp)),signInProvider:u||null,signInSecondFactor:o?.sign_in_second_factor||null}}function a0(t){return Number(t)*1e3}function lp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return tm("JWT malformed, contained fewer than 3 sections"),null;try{const a=J4(n);return a?JSON.parse(a):(tm("Failed to decode base64 JWT payload"),null)}catch(a){return tm("Caught error parsing JWT payload as JSON",a?.toString()),null}}function Mw(t){const e=lp(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ji(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof fi&&ij(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ij({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class aj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Q0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=yd(this.lastLoginAt),this.creationTime=yd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Nd(t){const e=t.auth,n=await t.getIdToken(),r=await Ji(t,km(e,{idToken:n}));Me(r?.users.length,e,"internal-error");const a=r.users[0];t._notifyReloadListener(a);const o=a.providerUserInfo?.length?bT(a.providerUserInfo):[],u=oj(t.providerData,o),h=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!u?.length,p=h?f:!1,y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Q0(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(t,y)}async function yT(t){const e=at(t);await Nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function oj(t,e){return[...t.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function bT(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function lj(t,e){const n=await fT(t,{},async()=>{const r=Lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,u=await mT(t,a,"/v1/token",`key=${o}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:r};return t.emulatorConfig&&rl(t.emulatorConfig.host)&&(f.credentials="include"),hT.fetch()(u,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function cj(t,e){return mn(t,"POST","/v2/accounts:revokeToken",fn(t,e))}class cc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const n=Mw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:a,expiresIn:o}=await lj(e,n);this.updateTokensAndExpiration(r,a,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:a,expirationTime:o}=n,u=new cc;return r&&(Me(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),a&&(Me(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),o&&(Me(typeof o=="number","internal-error",{appName:e}),u.expirationTime=o),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cc,this.toJSON())}_performRefresh(){return ni("not implemented")}}function Ua(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Is{constructor({uid:e,auth:n,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new aj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Q0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Ji(this,this.stsTokenManager.getToken(this.auth,e));return Me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return vT(this,e)}reload(){return yT(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Is({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Nd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(nr(this.auth));const e=await this.getIdToken();return await Ji(this,nj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,a=n.email??void 0,o=n.phoneNumber??void 0,u=n.photoURL??void 0,h=n.tenantId??void 0,f=n._redirectEventId??void 0,p=n.createdAt??void 0,y=n.lastLoginAt??void 0,{uid:b,emailVerified:x,isAnonymous:k,providerData:I,stsTokenManager:A}=n;Me(b&&A,e,"internal-error");const N=cc.fromJSON(this.name,A);Me(typeof b=="string",e,"internal-error"),Ua(r,e.name),Ua(a,e.name),Me(typeof x=="boolean",e,"internal-error"),Me(typeof k=="boolean",e,"internal-error"),Ua(o,e.name),Ua(u,e.name),Ua(h,e.name),Ua(f,e.name),Ua(p,e.name),Ua(y,e.name);const V=new Is({uid:b,auth:e,email:a,emailVerified:x,displayName:r,isAnonymous:k,photoURL:u,phoneNumber:o,tenantId:h,stsTokenManager:N,createdAt:p,lastLoginAt:y});return I&&Array.isArray(I)&&(V.providerData=I.map(F=>({...F}))),f&&(V._redirectEventId=f),V}static async _fromIdTokenResponse(e,n,r=!1){const a=new cc;a.updateFromServerResponse(n);const o=new Is({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await Nd(o),o}static async _fromGetAccountInfoResponse(e,n,r){const a=n.users[0];Me(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?bT(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!o?.length,h=new cc;h.updateFromIdToken(r);const f=new Is({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Q0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!o?.length};return Object.assign(f,p),f}}const Ow=new Map;function Hi(t){Wi(t instanceof Function,"Expected a class definition");let e=Ow.get(t);return e?(Wi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ow.set(t,e),e)}class xT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}xT.type="NONE";const X0=xT;function nm(t,e,n){return`firebase:${t}:${e}:${n}`}class uc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:a,name:o}=this.auth;this.fullUserKey=nm(this.userKey,a.apiKey,o),this.fullPersistenceKey=nm("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await km(this.auth,{idToken:e}).catch(()=>{});return n?Is._fromGetAccountInfoResponse(this.auth,n,e):null}return Is._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new uc(Hi(X0),e,r);const a=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=a[0]||Hi(X0);const u=nm(r,e.config.apiKey,e.name);let h=null;for(const p of n)try{const y=await p._get(u);if(y){let b;if(typeof y=="string"){const x=await km(e,{idToken:y}).catch(()=>{});if(!x)break;b=await Is._fromGetAccountInfoResponse(e,x,y)}else b=Is._fromJSON(e,y);p!==o&&(h=b),o=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new uc(o,e,r):(o=f[0],h&&await o._set(u,h.toJSON()),await Promise.all(n.map(async p=>{if(p!==o)try{await p._remove(u)}catch{}})),new uc(o,e,r))}}function Lw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ST(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_T(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CT(e))return"Blackberry";if(kT(e))return"Webos";if(wT(e))return"Safari";if((e.includes("chrome/")||ET(e))&&!e.includes("edge/"))return"Chrome";if(TT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function _T(t=xr()){return/firefox\//i.test(t)}function wT(t=xr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ET(t=xr()){return/crios\//i.test(t)}function ST(t=xr()){return/iemobile/i.test(t)}function TT(t=xr()){return/android/i.test(t)}function CT(t=xr()){return/blackberry/i.test(t)}function kT(t=xr()){return/webos/i.test(t)}function n1(t=xr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function uj(t=xr()){return n1(t)&&!!window.navigator?.standalone}function dj(){return y5()&&document.documentMode===10}function NT(t=xr()){return n1(t)||TT(t)||kT(t)||CT(t)||/windows phone/i.test(t)||ST(t)}function AT(t,e=[]){let n;switch(t){case"Browser":n=Lw(xr());break;case"Worker":n=`${Lw(xr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${sl}/${r}`}class hj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((u,h)=>{try{const f=e(o);u(f)}catch(f){h(f)}});r.onAbort=n,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function fj(t,e={}){return mn(t,"GET","/v2/passwordPolicy",fn(t,e))}const mj=6;class pj{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??mj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class gj{constructor(e,n,r,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vw(this),this.idTokenSubscription=new Vw(this),this.beforeStateQueue=new hj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await uc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await km(this,{idToken:e}),r=await Is._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(vn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,u=r?._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&h?.user&&(r=h.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(nr(this));const n=e?at(e):null;return n&&Me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vn(this.app)?Promise.reject(nr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(nr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fj(this),n=new pj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await cj(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hi(e)||this._popupRedirectResolver;Me(n,this,"argument-error"),this.redirectPersistenceManager=await uc.create(this,[Hi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,a){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(h,this,"internal-error"),h.then(()=>{u||o(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,r,a);return()=>{u=!0,f()}}else{const f=e.addObserver(n);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&YI(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Sn(t){return at(t)}class Vw{constructor(e){this.auth=e,this.observer=null,this.addObserver=C5(n=>this.observer=n)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Wd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vj(t){Wd=t}function r1(t){return Wd.loadJS(t)}function yj(){return Wd.recaptchaV2Script}function bj(){return Wd.recaptchaEnterpriseScript}function xj(){return Wd.gapiScript}function RT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const _j=500,wj=6e4,Lf=1e12;class Ej{constructor(e){this.auth=e,this.counter=Lf,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new Cj(e,this.auth.name,n||{})),this.counter++,r}reset(e){const n=e||Lf;this._widgets.get(n)?.delete(),this._widgets.delete(n)}getResponse(e){const n=e||Lf;return this._widgets.get(n)?.getResponse()||""}async execute(e){const n=e||Lf;return this._widgets.get(n)?.execute(),""}}class Sj{constructor(){this.enterprise=new Tj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Tj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Cj{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;Me(a,"argument-error",{appName:n}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=kj(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},wj)},_j))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function kj(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}const Nj="recaptcha-enterprise",bd="NO_RECAPTCHA";class IT{constructor(e){this.type=Nj,this.auth=Sn(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(u,h)=>{gT(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new pT(f);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,u(p.siteKey)}}).catch(f=>{h(f)})})}function a(o,u,h){const f=window.grecaptcha;Pw(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(p=>{u(p)}).catch(()=>{u(bd)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Sj().execute("siteKey",{action:"verify"}):new Promise((o,u)=>{r(this.auth).then(h=>{if(!n&&Pw(window.grecaptcha))a(h,o,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=bj();f.length!==0&&(f+=h),r1(f).then(()=>{a(h,o,u)}).catch(p=>{u(p)})}}).catch(h=>{u(h)})})}}async function Zu(t,e,n,r=!1,a=!1){const o=new IT(t);let u;if(a)u=bd;else try{u=await o.verify(n)}catch{u=await o.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return r?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Xa(t,e,n,r,a){if(a==="EMAIL_PASSWORD_PROVIDER")if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Zu(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Zu(t,e,n,n==="getOobCode");return r(t,u)}else return Promise.reject(o)});else if(a==="PHONE_PROVIDER")if(t._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const o=await Zu(t,e,n);return r(t,o).catch(async u=>{if(t._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const h=await Zu(t,e,n,!1,!0);return r(t,h)}return Promise.reject(u)})}else{const o=await Zu(t,e,n,!1,!0);return r(t,o)}else return Promise.reject(a+" provider is not supported.")}async function jT(t){const e=Sn(t),n=await gT(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new pT(n);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new IT(e).verify()}function DT(t,e){const n=op(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),o=n.getOptions();if(Qi(o,e??{}))return a;Br(a,"already-initialized")}return n.initialize({options:e})}function Aj(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Hi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function PT(t,e,n){const r=Sn(t);Me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!n?.disableWarnings,o=MT(e),{host:u,port:h}=Rj(e),f=h===null?"":`:${h}`,p={url:`${o}//${u}${f}/`},y=Object.freeze({host:u,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Me(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Me(Qi(p,r.config.emulator)&&Qi(y,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=y,r.settings.appVerificationDisabledForTesting=!0,rl(u)?(Yy(`${o}//${u}${f}`),Ky("Auth",!0)):a||Ij()}function MT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Rj(t){const e=MT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const o=a[1];return{host:o,port:Uw(r.substr(o.length+1))}}else{const[o,u]=r.split(":");return{host:o,port:Uw(u)}}}function Uw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ij(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Uc{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,n){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function OT(t,e){return mn(t,"POST","/v1/accounts:resetPassword",fn(t,e))}async function jj(t,e){return mn(t,"POST","/v1/accounts:update",e)}async function Dj(t,e){return mn(t,"POST","/v1/accounts:signUp",e)}async function Pj(t,e){return mn(t,"POST","/v1/accounts:update",fn(t,e))}async function Mj(t,e){return ra(t,"POST","/v1/accounts:signInWithPassword",fn(t,e))}async function cp(t,e){return mn(t,"POST","/v1/accounts:sendOobCode",fn(t,e))}async function Oj(t,e){return cp(t,e)}async function Lj(t,e){return cp(t,e)}async function Vj(t,e){return cp(t,e)}async function Uj(t,e){return cp(t,e)}async function zj(t,e){return ra(t,"POST","/v1/accounts:signInWithEmailLink",fn(t,e))}async function Bj(t,e){return ra(t,"POST","/v1/accounts:signInWithEmailLink",fn(t,e))}class yc extends Uc{constructor(e,n,r,a=null){super("password",r),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new yc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new yc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,n,"signInWithPassword",Mj,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return zj(e,{email:this._email,oobCode:this._password});default:Br(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,r,"signUpPassword",Dj,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Bj(e,{idToken:n,email:this._email,oobCode:this._password});default:Br(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gi(t,e){return ra(t,"POST","/v1/accounts:signInWithIdp",fn(t,e))}const Fj="http://localhost";class li extends Uc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new li(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Br("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...o}=n;if(!r||!a)return null;const u=new li(r,a);return u.idToken=o.idToken||void 0,u.accessToken=o.accessToken||void 0,u.secret=o.secret,u.nonce=o.nonce,u.pendingToken=o.pendingToken||null,u}_getIdTokenResponse(e){const n=this.buildRequest();return Gi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Gi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Gi(e,n)}buildRequest(){const e={requestUri:Fj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Lc(n)}return e}}async function zw(t,e){return mn(t,"POST","/v1/accounts:sendVerificationCode",fn(t,e))}async function Hj(t,e){return ra(t,"POST","/v1/accounts:signInWithPhoneNumber",fn(t,e))}async function $j(t,e){const n=await ra(t,"POST","/v1/accounts:signInWithPhoneNumber",fn(t,e));if(n.temporaryProof)throw ld(t,"account-exists-with-different-credential",n);return n}const qj={USER_NOT_FOUND:"user-not-found"};async function Gj(t,e){const n={...e,operation:"REAUTH"};return ra(t,"POST","/v1/accounts:signInWithPhoneNumber",fn(t,n),qj)}class Wa extends Uc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Wa({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Wa({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return Hj(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return $j(e,{idToken:n,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return Gj(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:a}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:a,temporaryProof:o}=e;return!r&&!n&&!a&&!o?null:new Wa({verificationId:n,verificationCode:r,phoneNumber:a,temporaryProof:o})}}function Yj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Kj(t){const e=ad(od(t)).link,n=e?ad(od(e)).deep_link_id:null,r=ad(od(t)).deep_link_id;return(r?ad(od(r)).link:null)||r||n||e||t}class zc{constructor(e){const n=ad(od(e)),r=n.apiKey??null,a=n.oobCode??null,o=Yj(n.mode??null);Me(r&&a&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Kj(e);try{return new zc(n)}catch{return null}}}function Qj(t){return zc.parseLink(t)}class sa{constructor(){this.providerId=sa.PROVIDER_ID}static credential(e,n){return yc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=zc.parseLink(n);return Me(r,"argument-error"),yc._fromEmailAndCode(e,r.code,r.tenantId)}}sa.PROVIDER_ID="password";sa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";sa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ia{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Bc extends ia{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xd extends Bc{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return Me("providerId"in n&&"signInMethod"in n,"argument-error"),li._fromParams(n)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return Me(e.idToken||e.accessToken,"argument-error"),li._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return xd.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return xd.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:a,pendingToken:o,nonce:u,providerId:h}=e;if(!r&&!a&&!n&&!o||!h)return null;try{return new xd(h)._credential({idToken:n,accessToken:r,nonce:u,pendingToken:o})}catch{return null}}}class zi extends Bc{constructor(){super("facebook.com")}static credential(e){return li._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zi.credential(e.oauthAccessToken)}catch{return null}}}zi.FACEBOOK_SIGN_IN_METHOD="facebook.com";zi.PROVIDER_ID="facebook.com";class Rs extends Bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return li._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Rs.credential(n,r)}catch{return null}}}Rs.GOOGLE_SIGN_IN_METHOD="google.com";Rs.PROVIDER_ID="google.com";class Bi extends Bc{constructor(){super("github.com")}static credential(e){return li._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bi.credential(e.oauthAccessToken)}catch{return null}}}Bi.GITHUB_SIGN_IN_METHOD="github.com";Bi.PROVIDER_ID="github.com";const Xj="http://localhost";class Ad extends Uc{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Gi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Gi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Gi(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,pendingToken:o}=n;return!r||!a||!o||r!==a?null:new Ad(r,o)}static _create(e,n){return new Ad(e,n)}buildRequest(){return{requestUri:Xj,returnSecureToken:!0,pendingToken:this.pendingToken}}}const Wj="saml.";class Nm extends ia{constructor(e){Me(e.startsWith(Wj),"argument-error"),super(e)}static credentialFromResult(e){return Nm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Nm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ad.fromJSON(e);return Me(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Ad._create(r,n)}catch{return null}}}class Fi extends Bc{constructor(){super("twitter.com")}static credential(e,n){return li._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Fi.credential(n,r)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";async function LT(t,e){return ra(t,"POST","/v1/accounts:signUp",fn(t,e))}class ps{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,a=!1){const o=await Is._fromIdTokenResponse(e,r,a),u=Bw(r);return new ps({user:o,providerId:u,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const a=Bw(r);return new ps({user:e,providerId:a,_tokenResponse:r,operationType:n})}}function Bw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function Jj(t){if(vn(t.app))return Promise.reject(nr(t));const e=Sn(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new ps({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await LT(e,{returnSecureToken:!0}),r=await ps._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}class Am extends fi{constructor(e,n,r,a){super(n.code,n.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Am.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,a){return new Am(e,n,r,a)}}function VT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Am._fromErrorAndOperation(t,o,e,r):o})}function UT(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function Zj(t,e){const n=at(t);await up(!0,n,e);const{providerUserInfo:r}=await rj(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),a=UT(r||[]);return n.providerData=n.providerData.filter(o=>a.has(o.providerId)),a.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function s1(t,e,n=!1){const r=await Ji(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ps._forOperation(t,"link",r)}async function up(t,e,n){await Nd(e);const r=UT(e.providerData),a=t===!1?"provider-already-linked":"no-such-provider";Me(r.has(n)===t,e.auth,a)}async function zT(t,e,n=!1){const{auth:r}=t;if(vn(r.app))return Promise.reject(nr(r));const a="reauthenticate";try{const o=await Ji(t,VT(r,a,e,t),n);Me(o.idToken,r,"internal-error");const u=lp(o.idToken);Me(u,r,"internal-error");const{sub:h}=u;return Me(t.uid===h,r,"user-mismatch"),ps._forOperation(t,a,o)}catch(o){throw o?.code==="auth/user-not-found"&&Br(r,"user-mismatch"),o}}async function BT(t,e,n=!1){if(vn(t.app))return Promise.reject(nr(t));const r="signIn",a=await VT(t,r,e),o=await ps._fromIdTokenResponse(t,r,a);return n||await t._updateCurrentUser(o.user),o}async function Jd(t,e){return BT(Sn(t),e)}async function FT(t,e){const n=at(t);return await up(!1,n,e.providerId),s1(n,e)}async function i1(t,e){return zT(at(t),e)}async function e9(t,e){return ra(t,"POST","/v1/accounts:signInWithCustomToken",fn(t,e))}async function HT(t,e){if(vn(t.app))return Promise.reject(nr(t));const n=Sn(t),r=await e9(n,{token:e,returnSecureToken:!0}),a=await ps._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(a.user),a}class Zd{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?a1._fromServerResponse(e,n):"totpInfo"in n?o1._fromServerResponse(e,n):Br(e,"internal-error")}}class a1 extends Zd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new a1(n)}}class o1 extends Zd{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new o1(n)}}function dp(t,e,n){Me(n.url?.length>0,t,"invalid-continue-uri"),Me(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),Me(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Me(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Me(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function l1(t){const e=Sn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function c1(t,e,n){const r=Sn(t),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&dp(r,a,n),await Xa(r,a,"getOobCode",Lj,"EMAIL_PASSWORD_PROVIDER")}async function t9(t,e,n){await OT(at(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&l1(t),r})}async function n9(t,e){await Pj(at(t),{oobCode:e})}async function $T(t,e){const n=at(t),r=await OT(n,{oobCode:e}),a=r.requestType;switch(Me(a,n,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Me(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Me(r.mfaInfo,n,"internal-error");default:Me(r.email,n,"internal-error")}let o=null;return r.mfaInfo&&(o=Zd._fromServerResponse(Sn(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:o},operation:a}}async function r9(t,e){const{data:n}=await $T(at(t),e);return n.email}async function qT(t,e,n){if(vn(t.app))return Promise.reject(nr(t));const r=Sn(t),u=await Xa(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",LT,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&l1(t),f}),h=await ps._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(h.user),h}function GT(t,e,n){return vn(t.app)?Promise.reject(nr(t)):Jd(at(t),sa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&l1(t),r})}async function s9(t,e,n){const r=Sn(t),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(u,h){Me(h.handleCodeInApp,r,"argument-error"),h&&dp(r,u,h)}o(a,n),await Xa(r,a,"getOobCode",Vj,"EMAIL_PASSWORD_PROVIDER")}function i9(t,e){return zc.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function a9(t,e,n){if(vn(t.app))return Promise.reject(nr(t));const r=at(t),a=sa.credentialWithLink(e,n||kd());return Me(a._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Jd(r,a)}async function o9(t,e){return mn(t,"POST","/v1/accounts:createAuthUri",fn(t,e))}async function l9(t,e){const n=e1()?kd():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:a}=await o9(at(t),r);return a||[]}async function W0(t,e){const n=at(t),a={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&dp(n.auth,a,e);const{email:o}=await Oj(n.auth,a);o!==t.email&&await t.reload()}async function c9(t,e,n){const r=at(t),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&dp(r.auth,o,n);const{email:u}=await Uj(r.auth,o);u!==t.email&&await t.reload()}async function u9(t,e){return mn(t,"POST","/v1/accounts:update",e)}async function YT(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=at(t),o={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},u=await Ji(r,u9(r.auth,o));r.displayName=u.displayName||null,r.photoURL=u.photoUrl||null;const h=r.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=r.displayName,h.photoURL=r.photoURL),await r._updateTokensIfNecessary(u)}function d9(t,e){const n=at(t);return vn(n.auth.app)?Promise.reject(nr(n.auth)):QT(n,e,null)}function KT(t,e){return QT(at(t),null,e)}async function QT(t,e,n){const{auth:r}=t,o={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(o.email=e),n&&(o.password=n);const u=await Ji(t,jj(r,o));await t._updateTokensIfNecessary(u,!0)}function h9(t){if(!t)return null;const{providerId:e}=t,n=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},r=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&t?.idToken){const a=lp(t.idToken)?.firebase?.sign_in_provider;if(a){const o=a!=="anonymous"&&a!=="custom"?a:null;return new dc(r,o)}}if(!e)return null;switch(e){case"facebook.com":return new f9(r,n);case"github.com":return new m9(r,n);case"google.com":return new p9(r,n);case"twitter.com":return new g9(r,n,t.screenName||null);case"custom":case"anonymous":return new dc(r,null);default:return new dc(r,e,n)}}class dc{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class XT extends dc{constructor(e,n,r,a){super(e,n,r),this.username=a}}class f9 extends dc{constructor(e,n){super(e,"facebook.com",n)}}class m9 extends XT{constructor(e,n){super(e,"github.com",n,typeof n?.login=="string"?n?.login:null)}}class p9 extends dc{constructor(e,n){super(e,"google.com",n)}}class g9 extends XT{constructor(e,n,r){super(e,"twitter.com",n,r)}}function v9(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:h9(n)}function y9(t,e){return at(t).setPersistence(e)}function b9(t){return jT(t)}async function x9(t,e){return Sn(t).validatePassword(e)}function WT(t,e,n,r){return at(t).onIdTokenChanged(e,n,r)}function JT(t,e,n){return at(t).beforeAuthStateChanged(e,n)}function ZT(t,e,n,r){return at(t).onAuthStateChanged(e,n,r)}function _9(t){at(t).useDeviceLanguage()}function w9(t,e){return at(t).updateCurrentUser(e)}function eC(t){return at(t).signOut()}function E9(t,e){return Sn(t).revokeAccessToken(e)}async function S9(t){return at(t).delete()}class Bo{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Bo("enroll",e,n)}static _fromMfaPendingCredential(e){return new Bo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return Bo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return Bo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class u1{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Sn(e),a=n.customData._serverResponse,o=(a.mfaInfo||[]).map(h=>Zd._fromServerResponse(r,h));Me(a.mfaPendingCredential,r,"internal-error");const u=Bo._fromMfaPendingCredential(a.mfaPendingCredential);return new u1(u,o,async h=>{const f=await h._process(r,u);delete a.mfaInfo,delete a.mfaPendingCredential;const p={...a,idToken:f.idToken,refreshToken:f.refreshToken};switch(n.operationType){case"signIn":const y=await ps._fromIdTokenResponse(r,n.operationType,p);return await r._updateCurrentUser(y.user),y;case"reauthenticate":return Me(n.user,r,"internal-error"),ps._forOperation(n.user,n.operationType,p);default:Br(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function T9(t,e){const n=at(t),r=e;return Me(e.customData.operationType,n,"argument-error"),Me(r.customData._serverResponse?.mfaPendingCredential,n,"argument-error"),u1._fromError(n,r)}function Fw(t,e){return mn(t,"POST","/v2/accounts/mfaEnrollment:start",fn(t,e))}function C9(t,e){return mn(t,"POST","/v2/accounts/mfaEnrollment:finalize",fn(t,e))}function k9(t,e){return mn(t,"POST","/v2/accounts/mfaEnrollment:start",fn(t,e))}function N9(t,e){return mn(t,"POST","/v2/accounts/mfaEnrollment:finalize",fn(t,e))}function A9(t,e){return mn(t,"POST","/v2/accounts/mfaEnrollment:withdraw",fn(t,e))}class d1{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Zd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new d1(e)}async getSession(){return Bo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,a=await this.getSession(),o=await Ji(this.user,r._process(this.user.auth,a,n));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const a=await Ji(this.user,A9(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==n),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const o0=new WeakMap;function R9(t){const e=at(t);return o0.has(e)||o0.set(e,d1._fromUser(e)),o0.get(e)}const Rm="__sak";class tC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rm,"1"),this.storage.removeItem(Rm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const I9=1e3,j9=10;class nC extends tC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),a=this.localCache[n];r!==a&&e(n,a,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((u,h,f)=>{this.notifyListeners(u,f)});return}const r=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(r);!n&&this.localCache[r]===u||this.notifyListeners(r,u)},o=this.storage.getItem(r);dj()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,j9):a()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},I9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nC.type="LOCAL";const rC=nC;const D9=1e3;function l0(t){const e=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${e}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function c0(t){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${t.split(":")[3]}`}class sC{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const n=new URL(`${window.location.origin}/__cookies__`);return n.searchParams.set("finalTarget",e),n}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,n){}async _get(e){if(!this._isAvailable())return null;const n=c0(e);return window.cookieStore?(await window.cookieStore.get(n))?.value:l0(n)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const r=c0(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,n){if(!this._isAvailable())return;const r=c0(e);if(window.cookieStore){const h=(p=>{const y=p.changed.find(x=>x.name===r);y&&n(y.value),p.deleted.find(x=>x.name===r)&&n(null)}),f=()=>window.cookieStore.removeEventListener("change",h);return this.listenerUnsubscribes.set(n,f),window.cookieStore.addEventListener("change",h)}let a=l0(r);const o=setInterval(()=>{const h=l0(r);h!==a&&(n(h),a=h)},D9),u=()=>clearInterval(o);this.listenerUnsubscribes.set(n,u)}_removeListener(e,n){const r=this.listenerUnsubscribes.get(n);r&&(r(),this.listenerUnsubscribes.delete(n))}}sC.type="COOKIE";const P9=sC;class iC extends tC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}iC.type="SESSION";const h1=iC;function M9(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class hp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const r=new hp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:a,data:o}=n.data,u=this.handlersMap[a];if(!u?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const h=Array.from(u).map(async p=>p(n.origin,o)),f=await M9(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hp.receivers=[];function fp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class O9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,u;return new Promise((h,f)=>{const p=fp("",20);a.port1.start();const y=setTimeout(()=>{f(new Error("unsupported_event"))},r);u={messageChannel:a,onMessage(b){const x=b;if(x.data.eventId===p)switch(x.data.status){case"ack":clearTimeout(y),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(x.data.response);break;default:clearTimeout(y),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function Un(){return window}function L9(t){Un().location.href=t}function f1(){return typeof Un().WorkerGlobalScope<"u"&&typeof Un().importScripts=="function"}async function V9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function U9(){return navigator?.serviceWorker?.controller||null}function z9(){return f1()?self:null}const aC="firebaseLocalStorageDb",B9=1,Im="firebaseLocalStorage",oC="fbase_key";class eh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function mp(t,e){return t.transaction([Im],e?"readwrite":"readonly").objectStore(Im)}function F9(){const t=indexedDB.deleteDatabase(aC);return new eh(t).toPromise()}function J0(){const t=indexedDB.open(aC,B9);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Im,{keyPath:oC})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Im)?e(r):(r.close(),await F9(),e(await J0()))})})}async function Hw(t,e,n){const r=mp(t,!0).put({[oC]:e,value:n});return new eh(r).toPromise()}async function H9(t,e){const n=mp(t,!1).get(e),r=await new eh(n).toPromise();return r===void 0?null:r.value}function $w(t,e){const n=mp(t,!0).delete(e);return new eh(n).toPromise()}const $9=800,q9=3;class lC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await J0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>q9)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return f1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hp._getInstance(z9()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await V9(),!this.activeServiceWorker)return;this.sender=new O9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||U9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await J0();return await Hw(e,Rm,"1"),await $w(e,Rm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Hw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>H9(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>$w(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=mp(a,!1).getAll();return new eh(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lC.type="LOCAL";const cC=lC;function qw(t,e){return mn(t,"POST","/v2/accounts/mfaSignIn:start",fn(t,e))}function G9(t,e){return mn(t,"POST","/v2/accounts/mfaSignIn:finalize",fn(t,e))}function Y9(t,e){return mn(t,"POST","/v2/accounts/mfaSignIn:finalize",fn(t,e))}const u0=RT("rcb"),K9=new Xd(3e4,6e4);class Q9{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Un().grecaptcha?.render}load(e,n=""){return Me(X9(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Dw(Un().grecaptcha)?Promise.resolve(Un().grecaptcha):new Promise((r,a)=>{const o=Un().setTimeout(()=>{a(Tr(e,"network-request-failed"))},K9.get());Un()[u0]=()=>{Un().clearTimeout(o),delete Un()[u0];const h=Un().grecaptcha;if(!h||!Dw(h)){a(Tr(e,"internal-error"));return}const f=h.render;h.render=(p,y)=>{const b=f(p,y);return this.counter++,b},this.hostLanguage=n,r(h)};const u=`${yj()}?${Lc({onload:u0,render:"explicit",hl:n})}`;r1(u).catch(()=>{clearTimeout(o),a(Tr(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Un().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function X9(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class W9{async load(e){return new Ej(e)}clearedOneInstance(){}}const _d="recaptcha",J9={theme:"light",type:"image"};class Z9{constructor(e,n,r={...J9}){this.parameters=r,this.type=_d,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Sn(e),this.isInvisible=this.parameters.size==="invisible",Me(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof n=="string"?document.getElementById(n):n;Me(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new W9:new Q9,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(a=>{const o=u=>{u&&(this.tokenChangeListeners.delete(o),a(u))};this.tokenChangeListeners.add(o),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Me(!this.parameters.sitekey,this.auth,"argument-error"),Me(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Me(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=Un()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){Me(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Me(e1()&&!f1(),this.auth,"internal-error"),await e8(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await tj(this.auth);Me(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Me(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function e8(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}class m1{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Wa._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function t8(t,e,n){if(vn(t.app))return Promise.reject(nr(t));const r=Sn(t),a=await pp(r,e,at(n));return new m1(a,o=>Jd(r,o))}async function n8(t,e,n){const r=at(t);await up(!1,r,"phone");const a=await pp(r.auth,e,at(n));return new m1(a,o=>FT(r,o))}async function r8(t,e,n){const r=at(t);if(vn(r.auth.app))return Promise.reject(nr(r.auth));const a=await pp(r.auth,e,at(n));return new m1(a,o=>i1(r,o))}async function pp(t,e,n){if(!t._getRecaptchaConfig())try{await jT(t)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const a=r.session;if("phoneNumber"in r){Me(a.type==="enroll",t,"internal-error");const o={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Xa(t,o,"mfaSmsEnrollment",async(p,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===bd){Me(n?.type===_d,p,"argument-error");const b=await d0(p,y,n);return Fw(p,b)}return Fw(p,y)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{Me(a.type==="signin",t,"internal-error");const o=r.multiFactorHint?.uid||r.multiFactorUid;Me(o,t,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Xa(t,u,"mfaSmsSignIn",async(y,b)=>{if(b.phoneSignInInfo.captchaResponse===bd){Me(n?.type===_d,y,"argument-error");const x=await d0(y,b,n);return qw(y,x)}return qw(y,b)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Xa(t,a,"sendVerificationCode",async(f,p)=>{if(p.captchaResponse===bd){Me(n?.type===_d,f,"argument-error");const y=await d0(f,p,n);return zw(f,y)}return zw(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{n?._reset()}}async function s8(t,e){const n=at(t);if(vn(n.auth.app))return Promise.reject(nr(n.auth));await s1(n,e)}async function d0(t,e,n){Me(n.type===_d,t,"argument-error");const r=await n.verify();Me(typeof r=="string",t,"argument-error");const a={...e};if("phoneEnrollmentInfo"in a){const o=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.captchaResponse,h=a.phoneEnrollmentInfo.clientType,f=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r,captchaResponse:u,clientType:h,recaptchaVersion:f}}),a}else if("phoneSignInInfo"in a){const o=a.phoneSignInInfo.captchaResponse,u=a.phoneSignInInfo.clientType,h=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:o,clientType:u,recaptchaVersion:h}}),a}else return Object.assign(a,{recaptchaToken:r}),a}class $o{constructor(e){this.providerId=$o.PROVIDER_ID,this.auth=Sn(e)}verifyPhoneNumber(e,n){return pp(this.auth,e,at(n))}static credential(e,n){return Wa._fromVerification(e,n)}static credentialFromResult(e){const n=e;return $o.credentialFromTaggedObject(n)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Wa._fromTokenResponse(n,r):null}}$o.PROVIDER_ID="phone";$o.PHONE_SIGN_IN_METHOD="phone";function il(t,e){return e?Hi(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class p1 extends Uc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Gi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Gi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function i8(t){return BT(t.auth,new p1(t),t.bypassAuthState)}function a8(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),zT(n,new p1(t),t.bypassAuthState)}async function o8(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),s1(n,new p1(t),t.bypassAuthState)}class uC{constructor(e,n,r,a,o=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:a,tenantId:o,error:u,type:h}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return i8;case"linkViaPopup":case"linkViaRedirect":return o8;case"reauthViaPopup":case"reauthViaRedirect":return a8;default:Br(this.auth,"internal-error")}}resolve(e){Wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const l8=new Xd(2e3,1e4);async function dC(t,e,n){if(vn(t.app))return Promise.reject(Tr(t,"operation-not-supported-in-this-environment"));const r=Sn(t);Vc(t,e,ia);const a=il(r,n);return new $i(r,"signInViaPopup",e,a).executeNotNull()}async function c8(t,e,n){const r=at(t);if(vn(r.auth.app))return Promise.reject(Tr(r.auth,"operation-not-supported-in-this-environment"));Vc(r.auth,e,ia);const a=il(r.auth,n);return new $i(r.auth,"reauthViaPopup",e,a,r).executeNotNull()}async function u8(t,e,n){const r=at(t);Vc(r.auth,e,ia);const a=il(r.auth,n);return new $i(r.auth,"linkViaPopup",e,a,r).executeNotNull()}class $i extends uC{constructor(e,n,r,a,o){super(e,n,a,o),this.provider=r,this.authWindow=null,this.pollId=null,$i.currentPopupAction&&$i.currentPopupAction.cancel(),$i.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){Wi(this.filter.length===1,"Popup operations only handle one event");const e=fp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$i.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,l8.get())};e()}}$i.currentPopupAction=null;const d8="pendingRedirect",rm=new Map;class h8 extends uC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=rm.get(this.auth._key());if(!e){try{const r=await f8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}rm.set(this.auth._key(),e)}return this.bypassAuthState||rm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function f8(t,e){const n=fC(e),r=hC(t);if(!await r._isAvailable())return!1;const a=await r._get(n)==="true";return await r._remove(n),a}async function g1(t,e){return hC(t)._set(fC(e),"true")}function m8(t,e){rm.set(t._key(),e)}function hC(t){return Hi(t._redirectPersistence)}function fC(t){return nm(d8,t.config.apiKey,t.name)}function p8(t,e,n){return g8(t,e,n)}async function g8(t,e,n){if(vn(t.app))return Promise.reject(nr(t));const r=Sn(t);Vc(t,e,ia),await r._initializationPromise;const a=il(r,n);return await g1(a,r),a._openRedirect(r,e,"signInViaRedirect")}function v8(t,e,n){return y8(t,e,n)}async function y8(t,e,n){const r=at(t);if(Vc(r.auth,e,ia),vn(r.auth.app))return Promise.reject(nr(r.auth));await r.auth._initializationPromise;const a=il(r.auth,n);await g1(a,r.auth);const o=await pC(r);return a._openRedirect(r.auth,e,"reauthViaRedirect",o)}function b8(t,e,n){return x8(t,e,n)}async function x8(t,e,n){const r=at(t);Vc(r.auth,e,ia),await r.auth._initializationPromise;const a=il(r.auth,n);await up(!1,r,e.providerId),await g1(a,r.auth);const o=await pC(r);return a._openRedirect(r.auth,e,"linkViaRedirect",o)}async function _8(t,e){return await Sn(t)._initializationPromise,mC(t,e,!1)}async function mC(t,e,n=!1){if(vn(t.app))return Promise.reject(nr(t));const r=Sn(t),a=il(r,e),u=await new h8(r,a,n).execute();return u&&!n&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}async function pC(t){const e=fp(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}const w8=600*1e3;class E8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S8(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!gC(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Tr(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w8&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gw(e))}saveEventToCache(e){this.cachedEventUids.add(Gw(e)),this.lastProcessedEventTime=Date.now()}}function Gw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gC({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function S8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gC(t);default:return!1}}async function T8(t,e={}){return mn(t,"GET","/v1/projects",e)}const C8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k8=/^https?/;async function N8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await T8(t);for(const n of e)try{if(A8(n))return}catch{}Br(t,"unauthorized-domain")}function A8(t){const e=kd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const u=new URL(t);return u.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&u.hostname===r}if(!k8.test(n))return!1;if(C8.test(t))return r===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const R8=new Xd(3e4,6e4);function Yw(){const t=Un().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function I8(t){return new Promise((e,n)=>{function r(){Yw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Yw(),n(Tr(t,"network-request-failed"))},timeout:R8.get()})}if(Un().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Un().gapi?.load)r();else{const a=RT("iframefcb");return Un()[a]=()=>{gapi.load?r():n(Tr(t,"network-request-failed"))},r1(`${xj()}?onload=${a}`).catch(o=>n(o))}}).catch(e=>{throw sm=null,e})}let sm=null;function j8(t){return sm=sm||I8(t),sm}const D8=new Xd(5e3,15e3),P8="__/auth/iframe",M8="emulator/auth/iframe",O8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function V8(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?t1(e,M8):`https://${t.config.authDomain}/${P8}`,r={apiKey:e.apiKey,appName:t.name,v:sl},a=L8.get(t.config.apiHost);a&&(r.eid=a);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Lc(r).slice(1)}`}async function U8(t){const e=await j8(t),n=Un().gapi;return Me(n,t,"internal-error"),e.open({where:document.body,url:V8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:O8,dontclear:!0},r=>new Promise(async(a,o)=>{await r.restyle({setHideOnLeave:!1});const u=Tr(t,"network-request-failed"),h=Un().setTimeout(()=>{o(u)},D8.get());function f(){Un().clearTimeout(h),a(r)}r.ping(f).then(f,()=>{o(u)})}))}const z8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B8=500,F8=600,H8="_blank",$8="http://localhost";class Kw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function q8(t,e,n,r=B8,a=F8){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f={...z8,width:r.toString(),height:a.toString(),top:o,left:u},p=xr().toLowerCase();n&&(h=ET(p)?H8:n),_T(p)&&(e=e||$8,f.scrollbars="yes");const y=Object.entries(f).reduce((x,[k,I])=>`${x}${k}=${I},`,"");if(uj(p)&&h!=="_self")return G8(e||"",h),new Kw(null);const b=window.open(e||"",h,y);Me(b,t,"popup-blocked");try{b.focus()}catch{}return new Kw(b)}function G8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const Y8="__/auth/handler",K8="emulator/auth/handler",Q8=encodeURIComponent("fac");async function Qw(t,e,n,r,a,o){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const u={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:sl,eventId:a};if(e instanceof ia){e.setDefaultLanguage(t.languageCode),u.providerId=e.providerId||"",T5(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,b]of Object.entries({}))u[y]=b}if(e instanceof Bc){const y=e.getScopes().filter(b=>b!=="");y.length>0&&(u.scopes=y.join(","))}t.tenantId&&(u.tid=t.tenantId);const h=u;for(const y of Object.keys(h))h[y]===void 0&&delete h[y];const f=await t._getAppCheckToken(),p=f?`#${Q8}=${encodeURIComponent(f)}`:"";return`${X8(t)}?${Lc(h).slice(1)}${p}`}function X8({config:t}){return t.emulator?t1(t,K8):`https://${t.authDomain}/${Y8}`}const h0="webStorageSupport";class W8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h1,this._completeRedirectFn=mC,this._overrideRedirectResult=m8}async _openPopup(e,n,r,a){Wi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Qw(e,n,r,kd(),a);return q8(e,o,fp())}async _openRedirect(e,n,r,a){await this._originValidation(e);const o=await Qw(e,n,r,kd(),a);return L9(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:o}=this.eventManagers[n];return a?Promise.resolve(a):(Wi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await U8(e),r=new E8(e);return n.register("authEvent",a=>(Me(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(h0,{type:h0},a=>{const o=a?.[0]?.[h0];o!==void 0&&n(!!o),Br(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=N8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return NT()||wT()||n1()}}const vC=W8;class yC{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return ni("unexpected MultiFactorSessionType")}}}class v1 extends yC{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new v1(e)}_finalizeEnroll(e,n,r){return C9(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return G9(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class bC{constructor(){}static assertion(e){return v1._fromCredential(e)}}bC.FACTOR_ID="phone";class xC{static assertionForEnrollment(e,n){return Rd._fromSecret(e,n)}static assertionForSignIn(e,n){return Rd._fromEnrollmentId(e,n)}static async generateSecret(e){const n=e;Me(typeof n.user?.auth<"u","internal-error");const r=await k9(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return gp._fromStartTotpMfaEnrollmentResponse(r,n.user.auth)}}xC.FACTOR_ID="totp";class Rd extends yC{constructor(e,n,r){super("totp"),this.otp=e,this.enrollmentId=n,this.secret=r}static _fromSecret(e,n){return new Rd(n,void 0,e)}static _fromEnrollmentId(e,n){return new Rd(n,e)}async _finalizeEnroll(e,n,r){return Me(typeof this.secret<"u",e,"argument-error"),N9(e,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,n){Me(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return Y9(e,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class gp{constructor(e,n,r,a,o,u,h){this.sessionInfo=u,this.auth=h,this.secretKey=e,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=a,this.enrollmentCompletionDeadline=o}static _fromStartTotpMfaEnrollmentResponse(e,n){return new gp(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,n){let r=!1;return(Vf(e)||Vf(n))&&(r=!0),r&&(Vf(e)&&(e=this.auth.currentUser?.email||"unknownuser"),Vf(n)&&(n=this.auth.name)),`otpauth://totp/${n}:${e}?secret=${this.secretKey}&issuer=${n}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Vf(t){return typeof t>"u"||t?.length===0}var Xw="@firebase/auth",Ww="1.11.1";class J8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Z8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eD(t){Qo(new to("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=r.options;Me(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:u,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AT(t)},p=new gj(r,a,o,f);return Aj(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Qo(new to("auth-internal",e=>{const n=Sn(e.getProvider("auth").getImmediate());return(r=>new J8(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ri(Xw,Ww,Z8(t)),ri(Xw,Ww,"esm2020")}const tD=300,nD=nT("authIdTokenMaxAge")||tD;let Jw=null;const rD=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nD)return;const a=n?.token;Jw!==a&&(Jw=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function _C(t=Wy()){const e=op(t,"auth");if(e.isInitialized())return e.getImmediate();const n=DT(t,{popupRedirectResolver:vC,persistence:[cC,rC,h1]}),r=nT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const u=rD(o.toString());JT(n,u,()=>u(n.currentUser)),WT(n,h=>u(h))}}const a=Z4("auth");return a&&PT(n,`http://${a}`),n}function sD(){return document.getElementsByTagName("head")?.[0]??document}vj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=a=>{const o=Tr("internal-error");o.customData=a,n(o)},r.type="text/javascript",r.charset="UTF-8",sD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eD("Browser");const iD=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeOperation:HI,ActionCodeURL:zc,AuthCredential:Uc,AuthErrorCodes:GI,EmailAuthCredential:yc,EmailAuthProvider:sa,FacebookAuthProvider:zi,FactorId:UI,GithubAuthProvider:Bi,GoogleAuthProvider:Rs,OAuthCredential:li,OAuthProvider:xd,OperationType:FI,PhoneAuthCredential:Wa,PhoneAuthProvider:$o,PhoneMultiFactorGenerator:bC,ProviderId:zI,RecaptchaVerifier:Z9,SAMLAuthProvider:Nm,SignInMethod:BI,TotpMultiFactorGenerator:xC,TotpSecret:gp,TwitterAuthProvider:Fi,applyActionCode:n9,beforeAuthStateChanged:JT,browserCookiePersistence:P9,browserLocalPersistence:rC,browserPopupRedirectResolver:vC,browserSessionPersistence:h1,checkActionCode:$T,confirmPasswordReset:t9,connectAuthEmulator:PT,createUserWithEmailAndPassword:qT,debugErrorMap:qI,deleteUser:S9,fetchSignInMethodsForEmail:l9,getAdditionalUserInfo:v9,getAuth:_C,getIdToken:sj,getIdTokenResult:vT,getMultiFactorResolver:T9,getRedirectResult:_8,inMemoryPersistence:X0,indexedDBLocalPersistence:cC,initializeAuth:DT,initializeRecaptchaConfig:b9,isSignInWithEmailLink:i9,linkWithCredential:FT,linkWithPhoneNumber:n8,linkWithPopup:u8,linkWithRedirect:b8,multiFactor:R9,onAuthStateChanged:ZT,onIdTokenChanged:WT,parseActionCodeURL:Qj,prodErrorMap:uT,reauthenticateWithCredential:i1,reauthenticateWithPhoneNumber:r8,reauthenticateWithPopup:c8,reauthenticateWithRedirect:v8,reload:yT,revokeAccessToken:E9,sendEmailVerification:W0,sendPasswordResetEmail:c1,sendSignInLinkToEmail:s9,setPersistence:y9,signInAnonymously:Jj,signInWithCredential:Jd,signInWithCustomToken:HT,signInWithEmailAndPassword:GT,signInWithEmailLink:a9,signInWithPhoneNumber:t8,signInWithPopup:dC,signInWithRedirect:p8,signOut:eC,unlink:Zj,updateCurrentUser:w9,updateEmail:d9,updatePassword:KT,updatePhoneNumber:s8,updateProfile:YT,useDeviceLanguage:_9,validatePassword:x9,verifyBeforeUpdateEmail:c9,verifyPasswordResetCode:r9},Symbol.toStringTag,{value:"Module"}));var Zw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ja,wC;(function(){var t;function e(w,S){function R(){}R.prototype=S.prototype,w.F=S.prototype,w.prototype=new R,w.prototype.constructor=w,w.D=function(D,L,U){for(var P=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)P[ne-2]=arguments[ne];return S.prototype[L].apply(D,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(w,S,R){R||(R=0);const D=Array(16);if(typeof S=="string")for(var L=0;L<16;++L)D[L]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(L=0;L<16;++L)D[L]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=w.g[0],R=w.g[1],L=w.g[2];let U=w.g[3],P;P=S+(U^R&(L^U))+D[0]+3614090360&4294967295,S=R+(P<<7&4294967295|P>>>25),P=U+(L^S&(R^L))+D[1]+3905402710&4294967295,U=S+(P<<12&4294967295|P>>>20),P=L+(R^U&(S^R))+D[2]+606105819&4294967295,L=U+(P<<17&4294967295|P>>>15),P=R+(S^L&(U^S))+D[3]+3250441966&4294967295,R=L+(P<<22&4294967295|P>>>10),P=S+(U^R&(L^U))+D[4]+4118548399&4294967295,S=R+(P<<7&4294967295|P>>>25),P=U+(L^S&(R^L))+D[5]+1200080426&4294967295,U=S+(P<<12&4294967295|P>>>20),P=L+(R^U&(S^R))+D[6]+2821735955&4294967295,L=U+(P<<17&4294967295|P>>>15),P=R+(S^L&(U^S))+D[7]+4249261313&4294967295,R=L+(P<<22&4294967295|P>>>10),P=S+(U^R&(L^U))+D[8]+1770035416&4294967295,S=R+(P<<7&4294967295|P>>>25),P=U+(L^S&(R^L))+D[9]+2336552879&4294967295,U=S+(P<<12&4294967295|P>>>20),P=L+(R^U&(S^R))+D[10]+4294925233&4294967295,L=U+(P<<17&4294967295|P>>>15),P=R+(S^L&(U^S))+D[11]+2304563134&4294967295,R=L+(P<<22&4294967295|P>>>10),P=S+(U^R&(L^U))+D[12]+1804603682&4294967295,S=R+(P<<7&4294967295|P>>>25),P=U+(L^S&(R^L))+D[13]+4254626195&4294967295,U=S+(P<<12&4294967295|P>>>20),P=L+(R^U&(S^R))+D[14]+2792965006&4294967295,L=U+(P<<17&4294967295|P>>>15),P=R+(S^L&(U^S))+D[15]+1236535329&4294967295,R=L+(P<<22&4294967295|P>>>10),P=S+(L^U&(R^L))+D[1]+4129170786&4294967295,S=R+(P<<5&4294967295|P>>>27),P=U+(R^L&(S^R))+D[6]+3225465664&4294967295,U=S+(P<<9&4294967295|P>>>23),P=L+(S^R&(U^S))+D[11]+643717713&4294967295,L=U+(P<<14&4294967295|P>>>18),P=R+(U^S&(L^U))+D[0]+3921069994&4294967295,R=L+(P<<20&4294967295|P>>>12),P=S+(L^U&(R^L))+D[5]+3593408605&4294967295,S=R+(P<<5&4294967295|P>>>27),P=U+(R^L&(S^R))+D[10]+38016083&4294967295,U=S+(P<<9&4294967295|P>>>23),P=L+(S^R&(U^S))+D[15]+3634488961&4294967295,L=U+(P<<14&4294967295|P>>>18),P=R+(U^S&(L^U))+D[4]+3889429448&4294967295,R=L+(P<<20&4294967295|P>>>12),P=S+(L^U&(R^L))+D[9]+568446438&4294967295,S=R+(P<<5&4294967295|P>>>27),P=U+(R^L&(S^R))+D[14]+3275163606&4294967295,U=S+(P<<9&4294967295|P>>>23),P=L+(S^R&(U^S))+D[3]+4107603335&4294967295,L=U+(P<<14&4294967295|P>>>18),P=R+(U^S&(L^U))+D[8]+1163531501&4294967295,R=L+(P<<20&4294967295|P>>>12),P=S+(L^U&(R^L))+D[13]+2850285829&4294967295,S=R+(P<<5&4294967295|P>>>27),P=U+(R^L&(S^R))+D[2]+4243563512&4294967295,U=S+(P<<9&4294967295|P>>>23),P=L+(S^R&(U^S))+D[7]+1735328473&4294967295,L=U+(P<<14&4294967295|P>>>18),P=R+(U^S&(L^U))+D[12]+2368359562&4294967295,R=L+(P<<20&4294967295|P>>>12),P=S+(R^L^U)+D[5]+4294588738&4294967295,S=R+(P<<4&4294967295|P>>>28),P=U+(S^R^L)+D[8]+2272392833&4294967295,U=S+(P<<11&4294967295|P>>>21),P=L+(U^S^R)+D[11]+1839030562&4294967295,L=U+(P<<16&4294967295|P>>>16),P=R+(L^U^S)+D[14]+4259657740&4294967295,R=L+(P<<23&4294967295|P>>>9),P=S+(R^L^U)+D[1]+2763975236&4294967295,S=R+(P<<4&4294967295|P>>>28),P=U+(S^R^L)+D[4]+1272893353&4294967295,U=S+(P<<11&4294967295|P>>>21),P=L+(U^S^R)+D[7]+4139469664&4294967295,L=U+(P<<16&4294967295|P>>>16),P=R+(L^U^S)+D[10]+3200236656&4294967295,R=L+(P<<23&4294967295|P>>>9),P=S+(R^L^U)+D[13]+681279174&4294967295,S=R+(P<<4&4294967295|P>>>28),P=U+(S^R^L)+D[0]+3936430074&4294967295,U=S+(P<<11&4294967295|P>>>21),P=L+(U^S^R)+D[3]+3572445317&4294967295,L=U+(P<<16&4294967295|P>>>16),P=R+(L^U^S)+D[6]+76029189&4294967295,R=L+(P<<23&4294967295|P>>>9),P=S+(R^L^U)+D[9]+3654602809&4294967295,S=R+(P<<4&4294967295|P>>>28),P=U+(S^R^L)+D[12]+3873151461&4294967295,U=S+(P<<11&4294967295|P>>>21),P=L+(U^S^R)+D[15]+530742520&4294967295,L=U+(P<<16&4294967295|P>>>16),P=R+(L^U^S)+D[2]+3299628645&4294967295,R=L+(P<<23&4294967295|P>>>9),P=S+(L^(R|~U))+D[0]+4096336452&4294967295,S=R+(P<<6&4294967295|P>>>26),P=U+(R^(S|~L))+D[7]+1126891415&4294967295,U=S+(P<<10&4294967295|P>>>22),P=L+(S^(U|~R))+D[14]+2878612391&4294967295,L=U+(P<<15&4294967295|P>>>17),P=R+(U^(L|~S))+D[5]+4237533241&4294967295,R=L+(P<<21&4294967295|P>>>11),P=S+(L^(R|~U))+D[12]+1700485571&4294967295,S=R+(P<<6&4294967295|P>>>26),P=U+(R^(S|~L))+D[3]+2399980690&4294967295,U=S+(P<<10&4294967295|P>>>22),P=L+(S^(U|~R))+D[10]+4293915773&4294967295,L=U+(P<<15&4294967295|P>>>17),P=R+(U^(L|~S))+D[1]+2240044497&4294967295,R=L+(P<<21&4294967295|P>>>11),P=S+(L^(R|~U))+D[8]+1873313359&4294967295,S=R+(P<<6&4294967295|P>>>26),P=U+(R^(S|~L))+D[15]+4264355552&4294967295,U=S+(P<<10&4294967295|P>>>22),P=L+(S^(U|~R))+D[6]+2734768916&4294967295,L=U+(P<<15&4294967295|P>>>17),P=R+(U^(L|~S))+D[13]+1309151649&4294967295,R=L+(P<<21&4294967295|P>>>11),P=S+(L^(R|~U))+D[4]+4149444226&4294967295,S=R+(P<<6&4294967295|P>>>26),P=U+(R^(S|~L))+D[11]+3174756917&4294967295,U=S+(P<<10&4294967295|P>>>22),P=L+(S^(U|~R))+D[2]+718787259&4294967295,L=U+(P<<15&4294967295|P>>>17),P=R+(U^(L|~S))+D[9]+3951481745&4294967295,w.g[0]=w.g[0]+S&4294967295,w.g[1]=w.g[1]+(L+(P<<21&4294967295|P>>>11))&4294967295,w.g[2]=w.g[2]+L&4294967295,w.g[3]=w.g[3]+U&4294967295}r.prototype.v=function(w,S){S===void 0&&(S=w.length);const R=S-this.blockSize,D=this.C;let L=this.h,U=0;for(;U<S;){if(L==0)for(;U<=R;)a(this,w,U),U+=this.blockSize;if(typeof w=="string"){for(;U<S;)if(D[L++]=w.charCodeAt(U++),L==this.blockSize){a(this,D),L=0;break}}else for(;U<S;)if(D[L++]=w[U++],L==this.blockSize){a(this,D),L=0;break}}this.h=L,this.o+=S},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var S=1;S<w.length-8;++S)w[S]=0;S=this.o*8;for(var R=w.length-8;R<w.length;++R)w[R]=S&255,S/=256;for(this.v(w),w=Array(16),S=0,R=0;R<4;++R)for(let D=0;D<32;D+=8)w[S++]=this.g[R]>>>D&255;return w};function o(w,S){var R=h;return Object.prototype.hasOwnProperty.call(R,w)?R[w]:R[w]=S(w)}function u(w,S){this.h=S;const R=[];let D=!0;for(let L=w.length-1;L>=0;L--){const U=w[L]|0;D&&U==S||(R[L]=U,D=!1)}this.g=R}var h={};function f(w){return-128<=w&&w<128?o(w,function(S){return new u([S|0],S<0?-1:0)}):new u([w|0],w<0?-1:0)}function p(w){if(isNaN(w)||!isFinite(w))return b;if(w<0)return N(p(-w));const S=[];let R=1;for(let D=0;w>=R;D++)S[D]=w/R|0,R*=4294967296;return new u(S,0)}function y(w,S){if(w.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(w.charAt(0)=="-")return N(y(w.substring(1),S));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=p(Math.pow(S,8));let D=b;for(let U=0;U<w.length;U+=8){var L=Math.min(8,w.length-U);const P=parseInt(w.substring(U,U+L),S);L<8?(L=p(Math.pow(S,L)),D=D.j(L).add(p(P))):(D=D.j(R),D=D.add(p(P)))}return D}var b=f(0),x=f(1),k=f(16777216);t=u.prototype,t.m=function(){if(A(this))return-N(this).m();let w=0,S=1;for(let R=0;R<this.g.length;R++){const D=this.i(R);w+=(D>=0?D:4294967296+D)*S,S*=4294967296}return w},t.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(I(this))return"0";if(A(this))return"-"+N(this).toString(w);const S=p(Math.pow(w,6));var R=this;let D="";for(;;){const L=O(R,S).g;R=V(R,L.j(S));let U=((R.g.length>0?R.g[0]:R.h)>>>0).toString(w);if(R=L,I(R))return U+D;for(;U.length<6;)U="0"+U;D=U+D}},t.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function I(w){if(w.h!=0)return!1;for(let S=0;S<w.g.length;S++)if(w.g[S]!=0)return!1;return!0}function A(w){return w.h==-1}t.l=function(w){return w=V(this,w),A(w)?-1:I(w)?0:1};function N(w){const S=w.g.length,R=[];for(let D=0;D<S;D++)R[D]=~w.g[D];return new u(R,~w.h).add(x)}t.abs=function(){return A(this)?N(this):this},t.add=function(w){const S=Math.max(this.g.length,w.g.length),R=[];let D=0;for(let L=0;L<=S;L++){let U=D+(this.i(L)&65535)+(w.i(L)&65535),P=(U>>>16)+(this.i(L)>>>16)+(w.i(L)>>>16);D=P>>>16,U&=65535,P&=65535,R[L]=P<<16|U}return new u(R,R[R.length-1]&-2147483648?-1:0)};function V(w,S){return w.add(N(S))}t.j=function(w){if(I(this)||I(w))return b;if(A(this))return A(w)?N(this).j(N(w)):N(N(this).j(w));if(A(w))return N(this.j(N(w)));if(this.l(k)<0&&w.l(k)<0)return p(this.m()*w.m());const S=this.g.length+w.g.length,R=[];for(var D=0;D<2*S;D++)R[D]=0;for(D=0;D<this.g.length;D++)for(let L=0;L<w.g.length;L++){const U=this.i(D)>>>16,P=this.i(D)&65535,ne=w.i(L)>>>16,oe=w.i(L)&65535;R[2*D+2*L]+=P*oe,F(R,2*D+2*L),R[2*D+2*L+1]+=U*oe,F(R,2*D+2*L+1),R[2*D+2*L+1]+=P*ne,F(R,2*D+2*L+1),R[2*D+2*L+2]+=U*ne,F(R,2*D+2*L+2)}for(w=0;w<S;w++)R[w]=R[2*w+1]<<16|R[2*w];for(w=S;w<2*S;w++)R[w]=0;return new u(R,0)};function F(w,S){for(;(w[S]&65535)!=w[S];)w[S+1]+=w[S]>>>16,w[S]&=65535,S++}function j(w,S){this.g=w,this.h=S}function O(w,S){if(I(S))throw Error("division by zero");if(I(w))return new j(b,b);if(A(w))return S=O(N(w),S),new j(N(S.g),N(S.h));if(A(S))return S=O(w,N(S)),new j(N(S.g),S.h);if(w.g.length>30){if(A(w)||A(S))throw Error("slowDivide_ only works with positive integers.");for(var R=x,D=S;D.l(w)<=0;)R=B(R),D=B(D);var L=H(R,1),U=H(D,1);for(D=H(D,2),R=H(R,2);!I(D);){var P=U.add(D);P.l(w)<=0&&(L=L.add(R),U=P),D=H(D,1),R=H(R,1)}return S=V(w,L.j(S)),new j(L,S)}for(L=b;w.l(S)>=0;){for(R=Math.max(1,Math.floor(w.m()/S.m())),D=Math.ceil(Math.log(R)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),U=p(R),P=U.j(S);A(P)||P.l(w)>0;)R-=D,U=p(R),P=U.j(S);I(U)&&(U=x),L=L.add(U),w=V(w,P)}return new j(L,w)}t.B=function(w){return O(this,w).h},t.and=function(w){const S=Math.max(this.g.length,w.g.length),R=[];for(let D=0;D<S;D++)R[D]=this.i(D)&w.i(D);return new u(R,this.h&w.h)},t.or=function(w){const S=Math.max(this.g.length,w.g.length),R=[];for(let D=0;D<S;D++)R[D]=this.i(D)|w.i(D);return new u(R,this.h|w.h)},t.xor=function(w){const S=Math.max(this.g.length,w.g.length),R=[];for(let D=0;D<S;D++)R[D]=this.i(D)^w.i(D);return new u(R,this.h^w.h)};function B(w){const S=w.g.length+1,R=[];for(let D=0;D<S;D++)R[D]=w.i(D)<<1|w.i(D-1)>>>31;return new u(R,w.h)}function H(w,S){const R=S>>5;S%=32;const D=w.g.length-R,L=[];for(let U=0;U<D;U++)L[U]=S>0?w.i(U+R)>>>S|w.i(U+R+1)<<32-S:w.i(U+R);return new u(L,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,wC=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=y,Ja=u}).apply(typeof Zw<"u"?Zw:typeof self<"u"?self:typeof window<"u"?window:{});var Uf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var EC,cd,SC,im,Z0,TC,CC,kC;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Uf=="object"&&Uf];for(var _=0;_<m.length;++_){var C=m[_];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=n(this);function a(m,_){if(_)e:{var C=r;m=m.split(".");for(var z=0;z<m.length-1;z++){var ee=m[z];if(!(ee in C))break e;C=C[ee]}m=m[m.length-1],z=C[m],_=_(z),_!=z&&_!=null&&e(C,m,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(_){var C=[],z;for(z in _)Object.prototype.hasOwnProperty.call(_,z)&&C.push([z,_[z]]);return C}});var o=o||{},u=this||self;function h(m){var _=typeof m;return _=="object"&&m!=null||_=="function"}function f(m,_,C){return m.call.apply(m.bind,arguments)}function p(m,_,C){return p=f,p.apply(null,arguments)}function y(m,_){var C=Array.prototype.slice.call(arguments,1);return function(){var z=C.slice();return z.push.apply(z,arguments),m.apply(this,z)}}function b(m,_){function C(){}C.prototype=_.prototype,m.Z=_.prototype,m.prototype=new C,m.prototype.constructor=m,m.Ob=function(z,ee,ce){for(var ze=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)ze[wt-2]=arguments[wt];return _.prototype[ee].apply(z,ze)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function k(m){const _=m.length;if(_>0){const C=Array(_);for(let z=0;z<_;z++)C[z]=m[z];return C}return[]}function I(m,_){for(let z=1;z<arguments.length;z++){const ee=arguments[z];var C=typeof ee;if(C=C!="object"?C:ee?Array.isArray(ee)?"array":C:"null",C=="array"||C=="object"&&typeof ee.length=="number"){C=m.length||0;const ce=ee.length||0;m.length=C+ce;for(let ze=0;ze<ce;ze++)m[C+ze]=ee[ze]}else m.push(ee)}}class A{constructor(_,C){this.i=_,this.j=C,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function N(m){u.setTimeout(()=>{throw m},0)}function V(){var m=w;let _=null;return m.g&&(_=m.g,m.g=m.g.next,m.g||(m.h=null),_.next=null),_}class F{constructor(){this.h=this.g=null}add(_,C){const z=j.get();z.set(_,C),this.h?this.h.next=z:this.g=z,this.h=z}}var j=new A(()=>new O,m=>m.reset());class O{constructor(){this.next=this.g=this.h=null}set(_,C){this.h=_,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let B,H=!1,w=new F,S=()=>{const m=Promise.resolve(void 0);B=()=>{m.then(R)}};function R(){for(var m;m=V();){try{m.h.call(m.g)}catch(C){N(C)}var _=j;_.j(m),_.h<100&&(_.h++,m.next=_.g,_.g=m)}H=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(m,_){this.type=m,this.g=this.target=_,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,_=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};u.addEventListener("test",C,_),u.removeEventListener("test",C,_)}catch{}return m})();function P(m){return/^[\s\xa0]*$/.test(m)}function ne(m,_){L.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,_)}b(ne,L),ne.prototype.init=function(m,_){const C=this.type=m.type,z=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=_,_=m.relatedTarget,_||(C=="mouseover"?_=m.fromElement:C=="mouseout"&&(_=m.toElement)),this.relatedTarget=_,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&ne.Z.h.call(this)},ne.prototype.h=function(){ne.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),G=0;function Z(m,_,C,z,ee){this.listener=m,this.proxy=null,this.src=_,this.type=C,this.capture=!!z,this.ha=ee,this.key=++G,this.da=this.fa=!1}function J(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Se(m,_,C){for(const z in m)_.call(C,m[z],z,m)}function Le(m,_){for(const C in m)_.call(void 0,m[C],C,m)}function $(m){const _={};for(const C in m)_[C]=m[C];return _}const X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(m,_){let C,z;for(let ee=1;ee<arguments.length;ee++){z=arguments[ee];for(C in z)m[C]=z[C];for(let ce=0;ce<X.length;ce++)C=X[ce],Object.prototype.hasOwnProperty.call(z,C)&&(m[C]=z[C])}}function he(m){this.src=m,this.g={},this.h=0}he.prototype.add=function(m,_,C,z,ee){const ce=m.toString();m=this.g[ce],m||(m=this.g[ce]=[],this.h++);const ze=Ue(m,_,z,ee);return ze>-1?(_=m[ze],C||(_.fa=!1)):(_=new Z(_,this.src,ce,!!z,ee),_.fa=C,m.push(_)),_};function Te(m,_){const C=_.type;if(C in m.g){var z=m.g[C],ee=Array.prototype.indexOf.call(z,_,void 0),ce;(ce=ee>=0)&&Array.prototype.splice.call(z,ee,1),ce&&(J(_),m.g[C].length==0&&(delete m.g[C],m.h--))}}function Ue(m,_,C,z){for(let ee=0;ee<m.length;++ee){const ce=m[ee];if(!ce.da&&ce.listener==_&&ce.capture==!!C&&ce.ha==z)return ee}return-1}var te="closure_lm_"+(Math.random()*1e6|0),Oe={};function Ie(m,_,C,z,ee){if(Array.isArray(_)){for(let ce=0;ce<_.length;ce++)Ie(m,_[ce],C,z,ee);return null}return C=K(C),m&&m[oe]?m.J(_,C,h(z)?!!z.capture:!1,ee):We(m,_,C,!1,z,ee)}function We(m,_,C,z,ee,ce){if(!_)throw Error("Invalid event type");const ze=h(ee)?!!ee.capture:!!ee;let wt=Ve(m);if(wt||(m[te]=wt=new he(m)),C=wt.add(_,C,z,ze,ce),C.proxy)return C;if(z=ke(),C.proxy=z,z.src=m,z.listener=C,m.addEventListener)U||(ee=ze),ee===void 0&&(ee=!1),m.addEventListener(_.toString(),z,ee);else if(m.attachEvent)m.attachEvent(dt(_.toString()),z);else if(m.addListener&&m.removeListener)m.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return C}function ke(){function m(C){return _.call(m.src,m.listener,C)}const _=ye;return m}function fe(m,_,C,z,ee){if(Array.isArray(_))for(var ce=0;ce<_.length;ce++)fe(m,_[ce],C,z,ee);else z=h(z)?!!z.capture:!!z,C=K(C),m&&m[oe]?(m=m.i,ce=String(_).toString(),ce in m.g&&(_=m.g[ce],C=Ue(_,C,z,ee),C>-1&&(J(_[C]),Array.prototype.splice.call(_,C,1),_.length==0&&(delete m.g[ce],m.h--)))):m&&(m=Ve(m))&&(_=m.g[_.toString()],m=-1,_&&(m=Ue(_,C,z,ee)),(C=m>-1?_[m]:null)&&Re(C))}function Re(m){if(typeof m!="number"&&m&&!m.da){var _=m.src;if(_&&_[oe])Te(_.i,m);else{var C=m.type,z=m.proxy;_.removeEventListener?_.removeEventListener(C,z,m.capture):_.detachEvent?_.detachEvent(dt(C),z):_.addListener&&_.removeListener&&_.removeListener(z),(C=Ve(_))?(Te(C,m),C.h==0&&(C.src=null,_[te]=null)):J(m)}}}function dt(m){return m in Oe?Oe[m]:Oe[m]="on"+m}function ye(m,_){if(m.da)m=!0;else{_=new ne(_,this);const C=m.listener,z=m.ha||m.src;m.fa&&Re(m),m=C.call(z,_)}return m}function Ve(m){return m=m[te],m instanceof he?m:null}var De="__closure_events_fn_"+(Math.random()*1e9>>>0);function K(m){return typeof m=="function"?m:(m[De]||(m[De]=function(_){return m.handleEvent(_)}),m[De])}function ue(){D.call(this),this.i=new he(this),this.M=this,this.G=null}b(ue,D),ue.prototype[oe]=!0,ue.prototype.removeEventListener=function(m,_,C,z){fe(this,m,_,C,z)};function je(m,_){var C,z=m.G;if(z)for(C=[];z;z=z.G)C.push(z);if(m=m.M,z=_.type||_,typeof _=="string")_=new L(_,m);else if(_ instanceof L)_.target=_.target||m;else{var ee=_;_=new L(z,m),re(_,ee)}ee=!0;let ce,ze;if(C)for(ze=C.length-1;ze>=0;ze--)ce=_.g=C[ze],ee=me(ce,z,!0,_)&&ee;if(ce=_.g=m,ee=me(ce,z,!0,_)&&ee,ee=me(ce,z,!1,_)&&ee,C)for(ze=0;ze<C.length;ze++)ce=_.g=C[ze],ee=me(ce,z,!1,_)&&ee}ue.prototype.N=function(){if(ue.Z.N.call(this),this.i){var m=this.i;for(const _ in m.g){const C=m.g[_];for(let z=0;z<C.length;z++)J(C[z]);delete m.g[_],m.h--}}this.G=null},ue.prototype.J=function(m,_,C,z){return this.i.add(String(m),_,!1,C,z)},ue.prototype.K=function(m,_,C,z){return this.i.add(String(m),_,!0,C,z)};function me(m,_,C,z){if(_=m.i.g[String(_)],!_)return!0;_=_.concat();let ee=!0;for(let ce=0;ce<_.length;++ce){const ze=_[ce];if(ze&&!ze.da&&ze.capture==C){const wt=ze.listener,Tn=ze.ha||ze.src;ze.fa&&Te(m.i,ze),ee=wt.call(Tn,z)!==!1&&ee}}return ee&&!z.defaultPrevented}function Ae(m,_){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:u.setTimeout(m,_||0)}function xe(m){m.g=Ae(()=>{m.g=null,m.i&&(m.i=!1,xe(m))},m.l);const _=m.h;m.h=null,m.m.apply(null,_)}class W extends D{constructor(_,C){super(),this.m=_,this.l=C,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function He(m){D.call(this),this.h=m,this.g={}}b(He,D);var ct=[];function on(m){Se(m.g,function(_,C){this.g.hasOwnProperty(C)&&Re(_)},m),m.g={}}He.prototype.N=function(){He.Z.N.call(this),on(this)},He.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ee=u.JSON.stringify,$e=u.JSON.parse,lt=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function yt(){}function Vt(){}var kt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function nt(){L.call(this,"d")}b(nt,L);function Rt(){L.call(this,"c")}b(Rt,L);var Xt={},Fe=null;function Ce(){return Fe=Fe||new ue}Xt.Ia="serverreachability";function Ze(m){L.call(this,Xt.Ia,m)}b(Ze,L);function et(m){const _=Ce();je(_,new Ze(_))}Xt.STAT_EVENT="statevent";function bt(m,_){L.call(this,Xt.STAT_EVENT,m),this.stat=_}b(bt,L);function mt(m){const _=Ce();je(_,new bt(_,m))}Xt.Ja="timingevent";function At(m,_){L.call(this,Xt.Ja,m),this.size=_}b(At,L);function $t(m,_){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},_)}function St(){this.g=!0}St.prototype.ua=function(){this.g=!1};function ln(m,_,C,z,ee,ce){m.info(function(){if(m.g)if(ce){var ze="",wt=ce.split("&");for(let Gt=0;Gt<wt.length;Gt++){var Tn=wt[Gt].split("=");if(Tn.length>1){const pn=Tn[0];Tn=Tn[1];const is=pn.split("_");ze=is.length>=2&&is[1]=="type"?ze+(pn+"="+Tn+"&"):ze+(pn+"=redacted&")}}}else ze=null;else ze=ce;return"XMLHTTP REQ ("+z+") [attempt "+ee+"]: "+_+`
`+C+`
`+ze})}function qn(m,_,C,z,ee,ce,ze){m.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ee+"]: "+_+`
`+C+`
`+ce+" "+ze})}function qe(m,_,C,z){m.info(function(){return"XMLHTTP TEXT ("+_+"): "+qt(m,C)+(z?" "+z:"")})}function xt(m,_){m.info(function(){return"TIMEOUT: "+_})}St.prototype.info=function(){};function qt(m,_){if(!m.g)return _;if(!_)return null;try{const ce=JSON.parse(_);if(ce){for(m=0;m<ce.length;m++)if(Array.isArray(ce[m])){var C=ce[m];if(!(C.length<2)){var z=C[1];if(Array.isArray(z)&&!(z.length<1)){var ee=z[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let ze=1;ze<z.length;ze++)z[ze]=""}}}}return Ee(ce)}catch{return _}}var rr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},oa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Zc;function ho(){}b(ho,yt),ho.prototype.g=function(){return new XMLHttpRequest},Zc=new ho;function gi(m){return encodeURIComponent(String(m))}function mh(m){var _=1;m=m.split(":");const C=[];for(;_>0&&m.length;)C.push(m.shift()),_--;return m.length&&C.push(m.join(":")),C}function vs(m,_,C,z){this.j=m,this.i=_,this.l=C,this.S=z||1,this.V=new He(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ys}function ys(){this.i=null,this.g="",this.h=!1}var Rn={},Jn={};function Os(m,_,C){m.M=1,m.A=fo(jn(_)),m.u=C,m.R=!0,ml(m,null)}function ml(m,_){m.F=Date.now(),Ls(m),m.B=jn(m.A);var C=m.B,z=m.S;Array.isArray(z)||(z=[String(z)]),yl(C.i,"t",z),m.C=0,C=m.j.L,m.h=new ys,m.g=Ah(m.j,C?_:null,!m.u),m.P>0&&(m.O=new W(p(m.Y,m,m.g),m.P)),_=m.V,C=m.g,z=m.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(ct[0]=ee.toString()),ee=ct);for(let ce=0;ce<ee.length;ce++){const ze=Ie(C,ee[ce],z||_.handleEvent,!1,_.h||_);if(!ze)break;_.g[ze.key]=ze}_=m.J?$(m.J):{},m.u?(m.v||(m.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,_)):(m.v="GET",m.g.ea(m.B,m.v,null,_)),et(),ln(m.i,m.v,m.B,m.l,m.S,m.u)}vs.prototype.ba=function(m){m=m.target;const _=this.O;_&&_s(m)==3?_.j():this.Y(m)},vs.prototype.Y=function(m){try{if(m==this.g)e:{const wt=_s(this.g),Tn=this.g.ya(),Gt=this.g.ca();if(!(wt<3)&&(wt!=3||this.g&&(this.h.h||this.g.la()||sr(this.g)))){this.K||wt!=4||Tn==7||(Tn==8||Gt<=0?et(3):et(2)),Vs(this);var _=this.g.ca();this.X=_;var C=tg(this);if(this.o=_==200,qn(this.i,this.v,this.B,this.l,this.S,wt,_),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ee=this.g;if((z=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(z)){var ce=z;break t}}ce=null}if(m=ce)qe(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Us(this,m);else{this.o=!1,this.m=3,mt(12),Hr(this),ns(this);break e}}if(this.R){m=!0;let pn;for(;!this.K&&this.C<C.length;)if(pn=gh(this,C),pn==Jn){wt==4&&(this.m=4,mt(14),m=!1),qe(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Rn){this.m=4,mt(15),qe(this.i,this.l,C,"[Invalid Chunk]"),m=!1;break}else qe(this.i,this.l,pn,null),Us(this,pn);if(ph(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wt!=4||C.length!=0||this.h.h||(this.m=1,mt(16),m=!1),this.o=this.o&&m,!m)qe(this.i,this.l,C,"[Invalid Chunked Response]"),Hr(this),ns(this);else if(C.length>0&&!this.W){this.W=!0;var ze=this.j;ze.g==this&&ze.aa&&!ze.P&&(ze.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),mu(ze),ze.P=!0,mt(11))}}else qe(this.i,this.l,C,null),Us(this,C);wt==4&&Hr(this),this.o&&!this.K&&(wt==4?Th(this.j,this):(this.o=!1,Ls(this)))}else yi(this.g),_==400&&C.indexOf("Unknown SID")>0?(this.m=3,mt(12)):(this.m=0,mt(13)),Hr(this),ns(this)}}}catch{}finally{}};function tg(m){if(!ph(m))return m.g.la();const _=sr(m.g);if(_==="")return"";let C="";const z=_.length,ee=_s(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Hr(m),ns(m),"";m.h.i=new u.TextDecoder}for(let ce=0;ce<z;ce++)m.h.h=!0,C+=m.h.i.decode(_[ce],{stream:!(ee&&ce==z-1)});return _.length=0,m.h.g+=C,m.C=0,m.h.g}function ph(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function gh(m,_){var C=m.C,z=_.indexOf(`
`,C);return z==-1?Jn:(C=Number(_.substring(C,z)),isNaN(C)?Rn:(z+=1,z+C>_.length?Jn:(_=_.slice(z,z+C),m.C=z+C,_)))}vs.prototype.cancel=function(){this.K=!0,Hr(this)};function Ls(m){m.T=Date.now()+m.H,pl(m,m.H)}function pl(m,_){if(m.D!=null)throw Error("WatchDog timer not null");m.D=$t(p(m.aa,m),_)}function Vs(m){m.D&&(u.clearTimeout(m.D),m.D=null)}vs.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(xt(this.i,this.B),this.M!=2&&(et(),mt(17)),Hr(this),this.m=2,ns(this)):pl(this,this.T-m)};function ns(m){m.j.I==0||m.K||Th(m.j,m)}function Hr(m){Vs(m);var _=m.O;_&&typeof _.dispose=="function"&&_.dispose(),m.O=null,on(m.V),m.g&&(_=m.g,m.g=null,_.abort(),_.dispose())}function Us(m,_){try{var C=m.j;if(C.I!=0&&(C.g==m||Bs(C.h,m))){if(!m.L&&Bs(C.h,m)&&C.I==3){try{var z=C.Ba.g.parse(_)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ee=z;if(ee[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<m.F)El(C),pa(C);else break e;xo(C),mt(18)}}else C.xa=ee[1],0<C.xa-C.K&&ee[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=$t(p(C.Va,C),6e3));zs(C.h)<=1&&C.ta&&(C.ta=void 0)}else Ys(C,11)}else if((m.L||C.g==m)&&El(C),!P(_))for(ee=C.Ba.g.parse(_),_=0;_<ee.length;_++){let Gt=ee[_];const pn=Gt[0];if(!(pn<=C.K))if(C.K=pn,Gt=Gt[1],C.I==2)if(Gt[0]=="c"){C.M=Gt[1],C.ba=Gt[2];const is=Gt[3];is!=null&&(C.ka=is,C.j.info("VER="+C.ka));const Ks=Gt[4];Ks!=null&&(C.za=Ks,C.j.info("SVER="+C.za));const ws=Gt[5];ws!=null&&typeof ws=="number"&&ws>0&&(z=1.5*ws,C.O=z,C.j.info("backChannelRequestTimeoutMs_="+z)),z=C;const Es=m.g;if(Es){const _o=Es.g?Es.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_o){var ce=z.h;ce.g||_o.indexOf("spdy")==-1&&_o.indexOf("quic")==-1&&_o.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(nu(ce,ce.h),ce.h=null))}if(z.G){const Sl=Es.g?Es.g.getResponseHeader("X-HTTP-Session-Id"):null;Sl&&(z.wa=Sl,Wt(z.J,z.G,Sl))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-m.F,C.j.info("Handshake RTT: "+C.T+"ms")),z=C;var ze=m;if(z.na=Nh(z,z.L?z.ba:null,z.W),ze.L){ru(z.h,ze);var wt=ze,Tn=z.O;Tn&&(wt.H=Tn),wt.D&&(Vs(wt),Ls(wt)),z.g=ze}else Eh(z);C.i.length>0&&Gs(C)}else Gt[0]!="stop"&&Gt[0]!="close"||Ys(C,7);else C.I==3&&(Gt[0]=="stop"||Gt[0]=="close"?Gt[0]=="stop"?Ys(C,7):hu(C):Gt[0]!="noop"&&C.l&&C.l.qa(Gt),C.A=0)}}et(4)}catch{}}var In=class{constructor(m,_){this.g=m,this.map=_}};function eu(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function tu(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function zs(m){return m.h?1:m.g?m.g.size:0}function Bs(m,_){return m.h?m.h==_:m.g?m.g.has(_):!1}function nu(m,_){m.g?m.g.add(_):m.h=_}function ru(m,_){m.h&&m.h==_?m.h=null:m.g&&m.g.has(_)&&m.g.delete(_)}eu.prototype.cancel=function(){if(this.i=su(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function su(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let _=m.i;for(const C of m.g.values())_=_.concat(C.G);return _}return k(m.i)}var vh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gl(m,_){if(m){m=m.split("&");for(let C=0;C<m.length;C++){const z=m[C].indexOf("=");let ee,ce=null;z>=0?(ee=m[C].substring(0,z),ce=m[C].substring(z+1)):ee=m[C],_(ee,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function $r(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;m instanceof $r?(this.l=m.l,Zn(this,m.j),this.o=m.o,this.g=m.g,la(this,m.u),this.h=m.h,iu(this,_h(m.i)),this.m=m.m):m&&(_=String(m).match(vh))?(this.l=!1,Zn(this,_[1]||"",!0),this.o=Fs(_[2]||""),this.g=Fs(_[3]||"",!0),la(this,_[4]),this.h=Fs(_[5]||"",!0),iu(this,_[6]||"",!0),this.m=Fs(_[7]||"")):(this.l=!1,this.i=new ua(null,this.l))}$r.prototype.toString=function(){const m=[];var _=this.j;_&&m.push(mo(_,vl,!0),":");var C=this.g;return(C||_=="file")&&(m.push("//"),(_=this.o)&&m.push(mo(_,vl,!0),"@"),m.push(gi(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&m.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(mo(C,C.charAt(0)=="/"?au:yh,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",mo(C,bh)),m.join("")},$r.prototype.resolve=function(m){const _=jn(this);let C=!!m.j;C?Zn(_,m.j):C=!!m.o,C?_.o=m.o:C=!!m.g,C?_.g=m.g:C=m.u!=null;var z=m.h;if(C)la(_,m.u);else if(C=!!m.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ee=_.h.lastIndexOf("/");ee!=-1&&(z=_.h.slice(0,ee+1)+z)}if(ee=z,ee==".."||ee==".")z="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){z=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const ce=[];for(let ze=0;ze<ee.length;){const wt=ee[ze++];wt=="."?z&&ze==ee.length&&ce.push(""):wt==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),z&&ze==ee.length&&ce.push("")):(ce.push(wt),z=!0)}z=ce.join("/")}else z=ee}return C?_.h=z:C=m.i.toString()!=="",C?iu(_,_h(m.i)):C=!!m.m,C&&(_.m=m.m),_};function jn(m){return new $r(m)}function Zn(m,_,C){m.j=C?Fs(_,!0):_,m.j&&(m.j=m.j.replace(/:$/,""))}function la(m,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);m.u=_}else m.u=null}function iu(m,_,C){_ instanceof ua?(m.i=_,bl(m.i,m.l)):(C||(_=mo(_,ca)),m.i=new ua(_,m.l))}function Wt(m,_,C){m.i.set(_,C)}function fo(m){return Wt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Fs(m,_){return m?_?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function mo(m,_,C){return typeof m=="string"?(m=encodeURI(m).replace(_,Ar),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Ar(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var vl=/[#\/\?@]/g,yh=/[#\?:]/g,au=/[#\?]/g,ca=/[#\?@]/g,bh=/#/g;function ua(m,_){this.h=this.g=null,this.i=m||null,this.j=!!_}function Rr(m){m.g||(m.g=new Map,m.h=0,m.i&&gl(m.i,function(_,C){m.add(decodeURIComponent(_.replace(/\+/g," ")),C)}))}t=ua.prototype,t.add=function(m,_){Rr(this),this.i=null,m=da(this,m);let C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(_),this.h+=1,this};function xh(m,_){Rr(m),_=da(m,_),m.g.has(_)&&(m.i=null,m.h-=m.g.get(_).length,m.g.delete(_))}function ou(m,_){return Rr(m),_=da(m,_),m.g.has(_)}t.forEach=function(m,_){Rr(this),this.g.forEach(function(C,z){C.forEach(function(ee){m.call(_,ee,z,this)},this)},this)};function lu(m,_){Rr(m);let C=[];if(typeof _=="string")ou(m,_)&&(C=C.concat(m.g.get(da(m,_))));else for(m=Array.from(m.g.values()),_=0;_<m.length;_++)C=C.concat(m[_]);return C}t.set=function(m,_){return Rr(this),this.i=null,m=da(this,m),ou(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[_]),this.h+=1,this},t.get=function(m,_){return m?(m=lu(this,m),m.length>0?String(m[0]):_):_};function yl(m,_,C){xh(m,_),C.length>0&&(m.i=null,m.g.set(da(m,_),k(C)),m.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],_=Array.from(this.g.keys());for(let z=0;z<_.length;z++){var C=_[z];const ee=gi(C);C=lu(this,C);for(let ce=0;ce<C.length;ce++){let ze=ee;C[ce]!==""&&(ze+="="+gi(C[ce])),m.push(ze)}}return this.i=m.join("&")};function _h(m){const _=new ua;return _.i=m.i,m.g&&(_.g=new Map(m.g),_.h=m.h),_}function da(m,_){return _=String(_),m.j&&(_=_.toLowerCase()),_}function bl(m,_){_&&!m.j&&(Rr(m),m.i=null,m.g.forEach(function(C,z){const ee=z.toLowerCase();z!=ee&&(xh(this,z),yl(this,ee,C))},m)),m.j=_}function bs(m,_){const C=new St;if(u.Image){const z=new Image;z.onload=y(rs,C,"TestLoadImage: loaded",!0,_,z),z.onerror=y(rs,C,"TestLoadImage: error",!1,_,z),z.onabort=y(rs,C,"TestLoadImage: abort",!1,_,z),z.ontimeout=y(rs,C,"TestLoadImage: timeout",!1,_,z),u.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=m}else _(!1)}function cu(m,_){const C=new St,z=new AbortController,ee=setTimeout(()=>{z.abort(),rs(C,"TestPingServer: timeout",!1,_)},1e4);fetch(m,{signal:z.signal}).then(ce=>{clearTimeout(ee),ce.ok?rs(C,"TestPingServer: ok",!0,_):rs(C,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ee),rs(C,"TestPingServer: error",!1,_)})}function rs(m,_,C,z,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),z(C)}catch{}}function ha(){this.g=new lt}function Hs(m){this.i=m.Sb||null,this.h=m.ab||!1}b(Hs,yt),Hs.prototype.g=function(){return new po(this.i,this.h)};function po(m,_){ue.call(this),this.H=m,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(po,ue),t=po.prototype,t.open=function(m,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=_,this.readyState=1,xs(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(_.body=m),(this.H||u).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,fa(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,xs(this)),this.g&&(this.readyState=3,xs(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xl(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function xl(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var _=m.value?m.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!m.done}))&&(this.response=this.responseText+=_)}m.done?fa(this):xs(this),this.readyState==3&&xl(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,fa(this))},t.Na=function(m){this.g&&(this.response=m,fa(this))},t.ga=function(){this.g&&fa(this)};function fa(m){m.readyState=4,m.l=null,m.j=null,m.B=null,xs(m)}t.setRequestHeader=function(m,_){this.A.append(m,_)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],_=this.h.entries();for(var C=_.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=_.next();return m.join(`\r
`)};function xs(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(po.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function ss(m){let _="";return Se(m,function(C,z){_+=z,_+=":",_+=C,_+=`\r
`}),_}function go(m,_,C){e:{for(z in C){var z=!1;break e}z=!0}z||(C=ss(C),typeof m=="string"?C!=null&&gi(C):Wt(m,_,C))}function en(m){ue.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(en,ue);var $s=/^https?$/i,uu=["POST","PUT"];t=en.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,_,C,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);_=_?_.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Zc.g(),this.g.onreadystatechange=x(p(this.Ca,this));try{this.B=!0,this.g.open(_,String(m),!0),this.B=!1}catch(ce){vo(this,ce);return}if(m=C||"",C=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ee in z)C.set(ee,z[ee]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const ce of z.keys())C.set(ce,z.get(ce));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(C.keys()).find(ce=>ce.toLowerCase()=="content-type"),ee=u.FormData&&m instanceof u.FormData,!(Array.prototype.indexOf.call(uu,_,void 0)>=0)||z||ee||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,ze]of C)this.g.setRequestHeader(ce,ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ce){vo(this,ce)}};function vo(m,_){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=_,m.o=5,du(m),vi(m)}function du(m){m.A||(m.A=!0,je(m,"complete"),je(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,je(this,"complete"),je(this,"abort"),vi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vi(this,!0)),en.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?yo(this):this.Xa())},t.Xa=function(){yo(this)};function yo(m){if(m.h&&typeof o<"u"){if(m.v&&_s(m)==4)setTimeout(m.Ca.bind(m),0);else if(je(m,"readystatechange"),_s(m)==4){m.h=!1;try{const ce=m.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var C;if(!(C=_)){var z;if(z=ce===0){let ze=String(m.D).match(vh)[1]||null;!ze&&u.self&&u.self.location&&(ze=u.self.location.protocol.slice(0,-1)),z=!$s.test(ze?ze.toLowerCase():"")}C=z}if(C)je(m,"complete"),je(m,"success");else{m.o=6;try{var ee=_s(m)>2?m.g.statusText:""}catch{ee=""}m.l=ee+" ["+m.ca()+"]",du(m)}}finally{vi(m)}}}}function vi(m,_){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const C=m.g;m.g=null,_||je(m,"ready");try{C.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function _s(m){return m.g?m.g.readyState:0}t.ca=function(){try{return _s(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var _=this.g.responseText;return m&&_.indexOf(m)==0&&(_=_.substring(m.length)),$e(_)}};function sr(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function yi(m){const _={};m=(m.g&&_s(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<m.length;z++){if(P(m[z]))continue;var C=mh(m[z]);const ee=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ce=_[ee]||[];_[ee]=ce,ce.push(C)}Le(_,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qs(m,_,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||_}function ma(m){this.za=0,this.i=[],this.j=new St,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qs("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qs("baseRetryDelayMs",5e3,m),this.Za=qs("retryDelaySeedMs",1e4,m),this.Ta=qs("forwardChannelMaxRetries",2,m),this.va=qs("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new eu(m&&m.concurrentRequestLimit),this.Ba=new ha,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ma.prototype,t.ka=8,t.I=1,t.connect=function(m,_,C,z){mt(0),this.W=m,this.H=_||{},C&&z!==void 0&&(this.H.OSID=C,this.H.OAID=z),this.F=this.X,this.J=Nh(this,null,this.W),Gs(this)};function hu(m){if(_l(m),m.I==3){var _=m.V++,C=jn(m.J);if(Wt(C,"SID",m.M),Wt(C,"RID",_),Wt(C,"TYPE","terminate"),bo(m,C),_=new vs(m,m.j,_),_.M=2,_.A=fo(jn(C)),C=!1,u.navigator&&u.navigator.sendBeacon)try{C=u.navigator.sendBeacon(_.A.toString(),"")}catch{}!C&&u.Image&&(new Image().src=_.A,C=!0),C||(_.g=Ah(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Ls(_)}kh(m)}function pa(m){m.g&&(mu(m),m.g.cancel(),m.g=null)}function _l(m){pa(m),m.v&&(u.clearTimeout(m.v),m.v=null),El(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&u.clearTimeout(m.m),m.m=null)}function Gs(m){if(!tu(m.h)&&!m.m){m.m=!0;var _=m.Ea;B||S(),H||(B(),H=!0),w.add(_,m),m.D=0}}function wl(m,_){return zs(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=_.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=$t(p(m.Ea,m,_),Ch(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const ee=new vs(this,this.j,m);let ce=this.o;if(this.U&&(ce?(ce=$(ce),re(ce,this.U)):ce=this.U),this.u!==null||this.R||(ee.J=ce,ce=null),this.S)e:{for(var _=0,C=0;C<this.i.length;C++){t:{var z=this.i[C];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(_+=z,_>4096){_=C;break e}if(_===4096||C===this.i.length-1){_=C+1;break e}}_=1e3}else _=1e3;_=wh(this,ee,_),C=jn(this.J),Wt(C,"RID",m),Wt(C,"CVER",22),this.G&&Wt(C,"X-HTTP-Session-Id",this.G),bo(this,C),ce&&(this.R?_="headers="+gi(ss(ce))+"&"+_:this.u&&go(C,this.u,ce)),nu(this.h,ee),this.Ra&&Wt(C,"TYPE","init"),this.S?(Wt(C,"$req",_),Wt(C,"SID","null"),ee.U=!0,Os(ee,C,null)):Os(ee,C,_),this.I=2}}else this.I==3&&(m?fu(this,m):this.i.length==0||tu(this.h)||fu(this))};function fu(m,_){var C;_?C=_.l:C=m.V++;const z=jn(m.J);Wt(z,"SID",m.M),Wt(z,"RID",C),Wt(z,"AID",m.K),bo(m,z),m.u&&m.o&&go(z,m.u,m.o),C=new vs(m,m.j,C,m.D+1),m.u===null&&(C.J=m.o),_&&(m.i=_.G.concat(m.i)),_=wh(m,C,1e3),C.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),nu(m.h,C),Os(C,z,_)}function bo(m,_){m.H&&Se(m.H,function(C,z){Wt(_,z,C)}),m.l&&Se({},function(C,z){Wt(_,z,C)})}function wh(m,_,C){C=Math.min(m.i.length,C);const z=m.l?p(m.l.Ka,m.l,m):null;e:{var ee=m.i;let wt=-1;for(;;){const Tn=["count="+C];wt==-1?C>0?(wt=ee[0].g,Tn.push("ofs="+wt)):wt=0:Tn.push("ofs="+wt);let Gt=!0;for(let pn=0;pn<C;pn++){var ce=ee[pn].g;const is=ee[pn].map;if(ce-=wt,ce<0)wt=Math.max(0,ee[pn].g-100),Gt=!1;else try{ce="req"+ce+"_"||"";try{var ze=is instanceof Map?is:Object.entries(is);for(const[Ks,ws]of ze){let Es=ws;h(ws)&&(Es=Ee(ws)),Tn.push(ce+Ks+"="+encodeURIComponent(Es))}}catch(Ks){throw Tn.push(ce+"type="+encodeURIComponent("_badmap")),Ks}}catch{z&&z(is)}}if(Gt){ze=Tn.join("&");break e}}ze=void 0}return m=m.i.splice(0,C),_.G=m,ze}function Eh(m){if(!m.g&&!m.v){m.Y=1;var _=m.Da;B||S(),H||(B(),H=!0),w.add(_,m),m.A=0}}function xo(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=$t(p(m.Da,m),Ch(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,Sh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=$t(p(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,mt(10),pa(this),Sh(this))};function mu(m){m.B!=null&&(u.clearTimeout(m.B),m.B=null)}function Sh(m){m.g=new vs(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var _=jn(m.na);Wt(_,"RID","rpc"),Wt(_,"SID",m.M),Wt(_,"AID",m.K),Wt(_,"CI",m.F?"0":"1"),!m.F&&m.ia&&Wt(_,"TO",m.ia),Wt(_,"TYPE","xmlhttp"),bo(m,_),m.u&&m.o&&go(_,m.u,m.o),m.O&&(m.g.H=m.O);var C=m.g;m=m.ba,C.M=1,C.A=fo(jn(_)),C.u=null,C.R=!0,ml(C,m)}t.Va=function(){this.C!=null&&(this.C=null,pa(this),xo(this),mt(19))};function El(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function Th(m,_){var C=null;if(m.g==_){El(m),mu(m),m.g=null;var z=2}else if(Bs(m.h,_))C=_.G,ru(m.h,_),z=1;else return;if(m.I!=0){if(_.o)if(z==1){C=_.u?_.u.length:0,_=Date.now()-_.F;var ee=m.D;z=Ce(),je(z,new At(z,C)),Gs(m)}else Eh(m);else if(ee=_.m,ee==3||ee==0&&_.X>0||!(z==1&&wl(m,_)||z==2&&xo(m)))switch(C&&C.length>0&&(_=m.h,_.i=_.i.concat(C)),ee){case 1:Ys(m,5);break;case 4:Ys(m,10);break;case 3:Ys(m,6);break;default:Ys(m,2)}}}function Ch(m,_){let C=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(C*=2),C*_}function Ys(m,_){if(m.j.info("Error code "+_),_==2){var C=p(m.bb,m),z=m.Ua;const ee=!z;z=new $r(z||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Zn(z,"https"),fo(z),ee?bs(z.toString(),C):cu(z.toString(),C)}else mt(2);m.I=0,m.l&&m.l.pa(_),kh(m),_l(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function kh(m){if(m.I=0,m.ja=[],m.l){const _=su(m.h);(_.length!=0||m.i.length!=0)&&(I(m.ja,_),I(m.ja,m.i),m.h.i.length=0,k(m.i),m.i.length=0),m.l.oa()}}function Nh(m,_,C){var z=C instanceof $r?jn(C):new $r(C);if(z.g!="")_&&(z.g=_+"."+z.g),la(z,z.u);else{var ee=u.location;z=ee.protocol,_=_?_+"."+ee.hostname:ee.hostname,ee=+ee.port;const ce=new $r(null);z&&Zn(ce,z),_&&(ce.g=_),ee&&la(ce,ee),C&&(ce.h=C),z=ce}return C=m.G,_=m.wa,C&&_&&Wt(z,C,_),Wt(z,"VER",m.ka),bo(m,z),z}function Ah(m,_,C){if(_&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=m.Aa&&!m.ma?new en(new Hs({ab:C})):new en(m.ma),_.Fa(m.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rh(){}t=Rh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ga(){}ga.prototype.g=function(m,_){return new wr(m,_)};function wr(m,_){ue.call(this),this.g=new ma(_),this.l=m,this.h=_&&_.messageUrlParams||null,m=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(m?m["X-WebChannel-Content-Type"]=_.messageContentType:m={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(m?m["X-WebChannel-Client-Profile"]=_.sa:m={"X-WebChannel-Client-Profile":_.sa}),this.g.U=m,(m=_&&_.Qb)&&!P(m)&&(this.g.u=m),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!P(_)&&(this.g.G=_,m=this.h,m!==null&&_ in m&&(m=this.h,_ in m&&delete m[_])),this.j=new bi(this)}b(wr,ue),wr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wr.prototype.close=function(){hu(this.g)},wr.prototype.o=function(m){var _=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.v&&(C={},C.__data__=Ee(m),m=C);_.i.push(new In(_.Ya++,m)),_.I==3&&Gs(_)},wr.prototype.N=function(){this.g.l=null,delete this.j,hu(this.g),delete this.g,wr.Z.N.call(this)};function Ih(m){nt.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var _=m.__sm__;if(_){e:{for(const C in _){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,_=_!==null&&m in _?_[m]:void 0),this.data=_}else this.data=m}b(Ih,nt);function jh(){Rt.call(this),this.status=1}b(jh,Rt);function bi(m){this.g=m}b(bi,Rh),bi.prototype.ra=function(){je(this.g,"a")},bi.prototype.qa=function(m){je(this.g,new Ih(m))},bi.prototype.pa=function(m){je(this.g,new jh)},bi.prototype.oa=function(){je(this.g,"b")},ga.prototype.createWebChannel=ga.prototype.g,wr.prototype.send=wr.prototype.o,wr.prototype.open=wr.prototype.m,wr.prototype.close=wr.prototype.close,kC=function(){return new ga},CC=function(){return Ce()},TC=Xt,Z0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rr.NO_ERROR=0,rr.TIMEOUT=8,rr.HTTP_ERROR=6,im=rr,oa.COMPLETE="complete",SC=oa,Vt.EventType=kt,kt.OPEN="a",kt.CLOSE="b",kt.ERROR="c",kt.MESSAGE="d",ue.prototype.listen=ue.prototype.J,cd=Vt,en.prototype.listenOnce=en.prototype.K,en.prototype.getLastError=en.prototype.Ha,en.prototype.getLastErrorCode=en.prototype.ya,en.prototype.getStatus=en.prototype.ca,en.prototype.getResponseJson=en.prototype.La,en.prototype.getResponseText=en.prototype.la,en.prototype.send=en.prototype.ea,en.prototype.setWithCredentials=en.prototype.Fa,EC=en}).apply(typeof Uf<"u"?Uf:typeof self<"u"?self:typeof window<"u"?window:{});const eE="@firebase/firestore",tE="4.9.2";let gr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};gr.UNAUTHENTICATED=new gr(null),gr.GOOGLE_CREDENTIALS=new gr("google-credentials-uid"),gr.FIRST_PARTY=new gr("first-party-uid"),gr.MOCK_USER=new gr("mock-user");let Fc="12.3.0";const Xo=new Qy("@firebase/firestore");function rc(){return Xo.logLevel}function Ge(t,...e){if(Xo.logLevel<=Mt.DEBUG){const n=e.map(y1);Xo.debug(`Firestore (${Fc}): ${t}`,...n)}}function Zi(t,...e){if(Xo.logLevel<=Mt.ERROR){const n=e.map(y1);Xo.error(`Firestore (${Fc}): ${t}`,...n)}}function bc(t,...e){if(Xo.logLevel<=Mt.WARN){const n=e.map(y1);Xo.warn(`Firestore (${Fc}): ${t}`,...n)}}function y1(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function ft(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,NC(t,r,n)}function NC(t,e,n){let r=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Zi(r),new Error(r)}function Qt(t,e,n,r){let a="Unexpected state";typeof n=="string"?a=n:r=n,t||NC(e,a,r)}function vt(t,e){return t}const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Be extends fi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Yi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class AC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(gr.UNAUTHENTICATED)))}shutdown(){}}class oD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class lD{constructor(e){this.t=e,this.currentUser=gr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Qt(this.o===void 0,42304);let r=this.i;const a=f=>this.i!==r?(r=this.i,n(f)):Promise.resolve();let o=new Yi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Yi,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const f=o;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},h=f=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Yi)}}),0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qt(typeof r.accessToken=="string",31837,{l:r}),new AC(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qt(e===null||typeof e=="string",2055,{h:e}),new gr(e)}}class cD{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=gr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uD{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new cD(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(gr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dD{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Qt(this.o===void 0,3512);const r=o=>{o.error!=null&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,Ge("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const a=o=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>a(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Qt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new nE(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function hD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class b1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=hD(40);for(let o=0;o<a.length;++o)r.length<20&&a[o]<n&&(r+=e.charAt(a[o]%62))}return r}}function Ot(t,e){return t<e?-1:t>e?1:0}function ey(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const a=t.charAt(r),o=e.charAt(r);if(a!==o)return f0(a)===f0(o)?Ot(a,o):f0(a)?1:-1}return Ot(t.length,e.length)}const fD=55296,mD=57343;function f0(t){const e=t.charCodeAt(0);return e>=fD&&e<=mD}function xc(t,e,n){return t.length===e.length&&t.every(((r,a)=>n(r,e[a])))}const rE="__name__";class ti{constructor(e,n,r){n===void 0?n=0:n>e.length&&ft(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ft(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ti.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ti?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let a=0;a<r;a++){const o=ti.compareSegments(e.get(a),n.get(a));if(o!==0)return o}return Ot(e.length,n.length)}static compareSegments(e,n){const r=ti.isNumericId(e),a=ti.isNumericId(n);return r&&!a?-1:!r&&a?1:r&&a?ti.extractNumericId(e).compare(ti.extractNumericId(n)):ey(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ja.fromString(e.substring(4,e.length-2))}}class an extends ti{construct(e,n,r){return new an(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Be(pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((a=>a.length>0)))}return new an(n)}static emptyPath(){return new an([])}}const pD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hr extends ti{construct(e,n,r){return new hr(e,n,r)}static isValidIdentifier(e){return pD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rE}static keyField(){return new hr([rE])}static fromServerFormat(e){const n=[];let r="",a=0;const o=()=>{if(r.length===0)throw new Be(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let u=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new Be(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Be(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,a+=2}else h==="`"?(u=!u,a++):h!=="."||u?(r+=h,a++):(o(),a++)}if(o(),u)throw new Be(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hr(n)}static emptyPath(){return new hr([])}}class tt{constructor(e){this.path=e}static fromPath(e){return new tt(an.fromString(e))}static fromName(e){return new tt(an.fromString(e).popFirst(5))}static empty(){return new tt(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&an.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return an.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new an(e.slice()))}}function RC(t,e,n){if(!n)throw new Be(pe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function gD(t,e,n,r){if(e===!0&&r===!0)throw new Be(pe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sE(t){if(!tt.isDocumentKey(t))throw new Be(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iE(t){if(tt.isDocumentKey(t))throw new Be(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function IC(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function vp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ft(12329,{type:typeof t})}function Cr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Be(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vp(t);throw new Be(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function vD(t,e){if(e<=0)throw new Be(pe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}function Hn(t,e){const n={typeString:t};return e&&(n.value=e),n}function th(t,e){if(!IC(t))throw new Be(pe.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const a=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const u=t[r];if(a&&typeof u!==a){n=`JSON field '${r}' must be a ${a}.`;break}if(o!==void 0&&u!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new Be(pe.INVALID_ARGUMENT,n);return!0}const aE=-62135596800,oE=1e6;class hn{static now(){return hn.fromMillis(Date.now())}static fromDate(e){return hn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*oE);return new hn(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Be(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Be(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<aE)throw new Be(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Be(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oE}_compareTo(e){return this.seconds===e.seconds?Ot(this.nanoseconds,e.nanoseconds):Ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:hn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(th(e,hn._jsonSchema))return new hn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-aE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}hn._jsonSchemaVersion="firestore/timestamp/1.0",hn._jsonSchema={type:Hn("string",hn._jsonSchemaVersion),seconds:Hn("number"),nanoseconds:Hn("number")};class pt{static fromTimestamp(e){return new pt(e)}static min(){return new pt(new hn(0,0))}static max(){return new pt(new hn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Id=-1;function yD(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=pt.fromTimestamp(r===1e9?new hn(n+1,0):new hn(n,r));return new no(a,tt.empty(),e)}function bD(t){return new no(t.readTime,t.key,Id)}class no{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new no(pt.min(),tt.empty(),Id)}static max(){return new no(pt.max(),tt.empty(),Id)}}function xD(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=tt.comparator(t.documentKey,e.documentKey),n!==0?n:Ot(t.largestBatchId,e.largestBatchId))}const _D="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Hc(t){if(t.code!==pe.FAILED_PRECONDITION||t.message!==_D)throw t;Ge("LocalStore","Unexpectedly lost primary lease")}class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ft(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we(((r,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,a)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):we.reject(n)}static resolve(e){return new we(((n,r)=>{n(e)}))}static reject(e){return new we(((n,r)=>{r(e)}))}static waitFor(e){return new we(((n,r)=>{let a=0,o=0,u=!1;e.forEach((h=>{++a,h.next((()=>{++o,u&&o===a&&n()}),(f=>r(f)))})),u=!0,o===a&&n()}))}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next((a=>a?we.resolve(a):r()));return n}static forEach(e,n){const r=[];return e.forEach(((a,o)=>{r.push(n.call(this,a,o))})),this.waitFor(r)}static mapArray(e,n){return new we(((r,a)=>{const o=e.length,u=new Array(o);let h=0;for(let f=0;f<o;f++){const p=f;n(e[p]).next((y=>{u[p]=y,++h,h===o&&r(u)}),(y=>a(y)))}}))}static doWhile(e,n){return new we(((r,a)=>{const o=()=>{e()===!0?n().next((()=>{o()}),a):r()};o()}))}}function ED(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $c(t){return t.name==="IndexedDbTransactionError"}class yp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yp.ce=-1;const x1=-1;function bp(t){return t==null}function jm(t){return t===0&&1/t==-1/0}function SD(t){return typeof t=="number"&&Number.isInteger(t)&&!jm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const jC="";function TD(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=lE(e)),e=CD(t.get(n),e);return lE(e)}function CD(t,e){let n=e;const r=t.length;for(let a=0;a<r;a++){const o=t.charAt(a);switch(o){case"\0":n+="";break;case jC:n+="";break;default:n+=o}}return n}function lE(t){return t+jC+""}function cE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function co(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function DC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class xn{constructor(e,n){this.comparator=e,this.root=n||dr.EMPTY}insert(e,n){return new xn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new xn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zf(this.root,e,this.comparator,!1)}getReverseIterator(){return new zf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zf(this.root,e,this.comparator,!0)}}class zf{constructor(e,n,r,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dr{constructor(e,n,r,a,o){this.key=e,this.value=n,this.color=r??dr.RED,this.left=a??dr.EMPTY,this.right=o??dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,a,o){return new dr(e??this.key,n??this.value,r??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let a=this;const o=r(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,n,r),null):o===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return dr.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ft(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ft(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ft(27949);return e+(this.isRed()?0:1)}}dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1;dr.EMPTY=new class{constructor(){this.size=0}get key(){throw ft(57766)}get value(){throw ft(16141)}get color(){throw ft(16727)}get left(){throw ft(29726)}get right(){throw ft(36894)}copy(e,n,r,a,o){return this}insert(e,n,r){return new dr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wn{constructor(e){this.comparator=e,this.data=new xn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new uE(this.data.getIterator())}getIteratorFrom(e){return new uE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Wn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Wn(this.comparator);return n.data=e,n}}class uE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class es{constructor(e){this.fields=e,e.sort(hr.comparator)}static empty(){return new es([])}unionWith(e){let n=new Wn(hr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new es(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return xc(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class PC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new PC("Invalid base64 string: "+o):o}})(e);return new fr(n)}static fromUint8Array(e){const n=(function(a){let o="";for(let u=0;u<a.length;++u)o+=String.fromCharCode(a[u]);return o})(e);return new fr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fr.EMPTY_BYTE_STRING=new fr("");const kD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){if(Qt(!!t,39018),typeof t=="string"){let e=0;const n=kD.exec(t);if(Qt(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:An(t.seconds),nanos:An(t.nanos)}}function An(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function so(t){return typeof t=="string"?fr.fromBase64String(t):fr.fromUint8Array(t)}const MC="server_timestamp",OC="__type__",LC="__previous_value__",VC="__local_write_time__";function xp(t){return(t?.mapValue?.fields||{})[OC]?.stringValue===MC}function _p(t){const e=t.mapValue.fields[LC];return xp(e)?_p(e):e}function jd(t){const e=ro(t.mapValue.fields[VC].timestampValue);return new hn(e.seconds,e.nanos)}class ND{constructor(e,n,r,a,o,u,h,f,p,y){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=y}}const Dm="(default)";class Dd{constructor(e,n){this.projectId=e,this.database=n||Dm}static empty(){return new Dd("","")}get isDefaultDatabase(){return this.database===Dm}isEqual(e){return e instanceof Dd&&e.projectId===this.projectId&&e.database===this.database}}const UC="__type__",AD="__max__",Bf={mapValue:{}},zC="__vector__",Pm="value";function io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xp(t)?4:ID(t)?9007199254740991:RD(t)?10:11:ft(28295,{value:t})}function ci(t,e){if(t===e)return!0;const n=io(t);if(n!==io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jd(t).isEqual(jd(e));case 3:return(function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const u=ro(a.timestampValue),h=ro(o.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,o){return so(a.bytesValue).isEqual(so(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,o){return An(a.geoPointValue.latitude)===An(o.geoPointValue.latitude)&&An(a.geoPointValue.longitude)===An(o.geoPointValue.longitude)})(t,e);case 2:return(function(a,o){if("integerValue"in a&&"integerValue"in o)return An(a.integerValue)===An(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const u=An(a.doubleValue),h=An(o.doubleValue);return u===h?jm(u)===jm(h):isNaN(u)&&isNaN(h)}return!1})(t,e);case 9:return xc(t.arrayValue.values||[],e.arrayValue.values||[],ci);case 10:case 11:return(function(a,o){const u=a.mapValue.fields||{},h=o.mapValue.fields||{};if(cE(u)!==cE(h))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(h[f]===void 0||!ci(u[f],h[f])))return!1;return!0})(t,e);default:return ft(52216,{left:t})}}function Pd(t,e){return(t.values||[]).find((n=>ci(n,e)))!==void 0}function _c(t,e){if(t===e)return 0;const n=io(t),r=io(e);if(n!==r)return Ot(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ot(t.booleanValue,e.booleanValue);case 2:return(function(o,u){const h=An(o.integerValue||o.doubleValue),f=An(u.integerValue||u.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(t,e);case 3:return dE(t.timestampValue,e.timestampValue);case 4:return dE(jd(t),jd(e));case 5:return ey(t.stringValue,e.stringValue);case 6:return(function(o,u){const h=so(o),f=so(u);return h.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(o,u){const h=o.split("/"),f=u.split("/");for(let p=0;p<h.length&&p<f.length;p++){const y=Ot(h[p],f[p]);if(y!==0)return y}return Ot(h.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,u){const h=Ot(An(o.latitude),An(u.latitude));return h!==0?h:Ot(An(o.longitude),An(u.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return hE(t.arrayValue,e.arrayValue);case 10:return(function(o,u){const h=o.fields||{},f=u.fields||{},p=h[Pm]?.arrayValue,y=f[Pm]?.arrayValue,b=Ot(p?.values?.length||0,y?.values?.length||0);return b!==0?b:hE(p,y)})(t.mapValue,e.mapValue);case 11:return(function(o,u){if(o===Bf.mapValue&&u===Bf.mapValue)return 0;if(o===Bf.mapValue)return 1;if(u===Bf.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),p=u.fields||{},y=Object.keys(p);f.sort(),y.sort();for(let b=0;b<f.length&&b<y.length;++b){const x=ey(f[b],y[b]);if(x!==0)return x;const k=_c(h[f[b]],p[y[b]]);if(k!==0)return k}return Ot(f.length,y.length)})(t.mapValue,e.mapValue);default:throw ft(23264,{he:n})}}function dE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ot(t,e);const n=ro(t),r=ro(e),a=Ot(n.seconds,r.seconds);return a!==0?a:Ot(n.nanos,r.nanos)}function hE(t,e){const n=t.values||[],r=e.values||[];for(let a=0;a<n.length&&a<r.length;++a){const o=_c(n[a],r[a]);if(o)return o}return Ot(n.length,r.length)}function wc(t){return ty(t)}function ty(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=ro(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return so(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return tt.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",a=!0;for(const o of n.values||[])a?a=!1:r+=",",r+=ty(o);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let a="{",o=!0;for(const u of r)o?o=!1:a+=",",a+=`${u}:${ty(n.fields[u])}`;return a+"}"})(t.mapValue):ft(61005,{value:t})}function am(t){switch(io(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_p(t);return e?16+am(e):16;case 5:return 2*t.stringValue.length;case 6:return so(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,o)=>a+am(o)),0)})(t.arrayValue);case 10:case 11:return(function(r){let a=0;return co(r.fields,((o,u)=>{a+=o.length+am(u)})),a})(t.mapValue);default:throw ft(13486,{value:t})}}function Mm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ny(t){return!!t&&"integerValue"in t}function _1(t){return!!t&&"arrayValue"in t}function fE(t){return!!t&&"nullValue"in t}function mE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function om(t){return!!t&&"mapValue"in t}function RD(t){return(t?.mapValue?.fields||{})[UC]?.stringValue===zC}function wd(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return co(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=wd(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=wd(t.arrayValue.values[n]);return e}return{...t}}function ID(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===AD}class Ur{constructor(e){this.value=e}static empty(){return new Ur({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!om(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=wd(n)}setAll(e){let n=hr.emptyPath(),r={},a=[];e.forEach(((u,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,r,a),r={},a=[],n=h.popLast()}u?r[h.lastSegment()]=wd(u):a.push(h.lastSegment())}));const o=this.getFieldsMap(n);this.applyChanges(o,r,a)}delete(e){const n=this.field(e.popLast());om(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ci(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=n.mapValue.fields[e.get(r)];om(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,r){co(n,((a,o)=>e[a]=o));for(const a of r)delete e[a]}clone(){return new Ur(wd(this.value))}}function BC(t){const e=[];return co(t.fields,((n,r)=>{const a=new hr([n]);if(om(r)){const o=BC(r.mapValue).fields;if(o.length===0)e.push(a);else for(const u of o)e.push(a.child(u))}else e.push(a)})),new es(e)}class yr{constructor(e,n,r,a,o,u,h){this.key=e,this.documentType=n,this.version=r,this.readTime=a,this.createTime=o,this.data=u,this.documentState=h}static newInvalidDocument(e){return new yr(e,0,pt.min(),pt.min(),pt.min(),Ur.empty(),0)}static newFoundDocument(e,n,r,a){return new yr(e,1,n,pt.min(),r,a,0)}static newNoDocument(e,n){return new yr(e,2,n,pt.min(),pt.min(),Ur.empty(),0)}static newUnknownDocument(e,n){return new yr(e,3,n,pt.min(),pt.min(),Ur.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ur.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ur.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ec{constructor(e,n){this.position=e,this.inclusive=n}}function pE(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const o=e[a],u=t.position[a];if(o.field.isKeyField()?r=tt.comparator(tt.fromName(u.referenceValue),n.key):r=_c(u,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function gE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ci(t.position[n],e.position[n]))return!1;return!0}class Md{constructor(e,n="asc"){this.field=e,this.dir=n}}function jD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class FC{}class Fn extends FC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new PD(e,n,r):n==="array-contains"?new LD(e,r):n==="in"?new VD(e,r):n==="not-in"?new UD(e,r):n==="array-contains-any"?new zD(e,r):new Fn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new MD(e,r):new OD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(_c(n,this.value)):n!==null&&io(this.value)===io(n)&&this.matchesComparison(_c(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ft(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ms extends FC{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ms(e,n)}matches(e){return HC(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function HC(t){return t.op==="and"}function $C(t){return DD(t)&&HC(t)}function DD(t){for(const e of t.filters)if(e instanceof Ms)return!1;return!0}function ry(t){if(t instanceof Fn)return t.field.canonicalString()+t.op.toString()+wc(t.value);if($C(t))return t.filters.map((e=>ry(e))).join(",");{const e=t.filters.map((n=>ry(n))).join(",");return`${t.op}(${e})`}}function qC(t,e){return t instanceof Fn?(function(r,a){return a instanceof Fn&&r.op===a.op&&r.field.isEqual(a.field)&&ci(r.value,a.value)})(t,e):t instanceof Ms?(function(r,a){return a instanceof Ms&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((o,u,h)=>o&&qC(u,a.filters[h])),!0):!1})(t,e):void ft(19439)}function GC(t){return t instanceof Fn?(function(n){return`${n.field.canonicalString()} ${n.op} ${wc(n.value)}`})(t):t instanceof Ms?(function(n){return n.op.toString()+" {"+n.getFilters().map(GC).join(" ,")+"}"})(t):"Filter"}class PD extends Fn{constructor(e,n,r){super(e,n,r),this.key=tt.fromName(r.referenceValue)}matches(e){const n=tt.comparator(e.key,this.key);return this.matchesComparison(n)}}class MD extends Fn{constructor(e,n){super(e,"in",n),this.keys=YC("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class OD extends Fn{constructor(e,n){super(e,"not-in",n),this.keys=YC("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function YC(t,e){return(e.arrayValue?.values||[]).map((n=>tt.fromName(n.referenceValue)))}class LD extends Fn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return _1(n)&&Pd(n.arrayValue,this.value)}}class VD extends Fn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Pd(this.value.arrayValue,n)}}class UD extends Fn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Pd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Pd(this.value.arrayValue,n)}}class zD extends Fn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!_1(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>Pd(this.value.arrayValue,r)))}}class BD{constructor(e,n=null,r=[],a=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=o,this.startAt=u,this.endAt=h,this.Te=null}}function vE(t,e=null,n=[],r=[],a=null,o=null,u=null){return new BD(t,e,n,r,a,o,u)}function w1(t){const e=vt(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>ry(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),bp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>wc(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>wc(r))).join(",")),e.Te=n}return e.Te}function E1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!jD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!qC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gE(t.startAt,e.startAt)&&gE(t.endAt,e.endAt)}function sy(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class al{constructor(e,n=null,r=[],a=[],o=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function FD(t,e,n,r,a,o,u,h){return new al(t,e,n,r,a,o,u,h)}function wp(t){return new al(t)}function yE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function S1(t){return t.collectionGroup!==null}function hc(t){const e=vt(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Wn(hr.comparator);return u.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((o=>{n.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Md(o,r))})),n.has(hr.keyField().canonicalString())||e.Ie.push(new Md(hr.keyField(),r))}return e.Ie}function si(t){const e=vt(t);return e.Ee||(e.Ee=HD(e,hc(t))),e.Ee}function HD(t,e){if(t.limitType==="F")return vE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const o=a.dir==="desc"?"asc":"desc";return new Md(a.field,o)}));const n=t.endAt?new Ec(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ec(t.startAt.position,t.startAt.inclusive):null;return vE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function iy(t,e){const n=t.filters.concat([e]);return new al(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Om(t,e,n){return new al(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ep(t,e){return E1(si(t),si(e))&&t.limitType===e.limitType}function KC(t){return`${w1(si(t))}|lt:${t.limitType}`}function sc(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((a=>GC(a))).join(", ")}]`),bp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((a=>wc(a))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((a=>wc(a))).join(",")),`Target(${r})`})(si(t))}; limitType=${t.limitType})`}function Sp(t,e){return e.isFoundDocument()&&(function(r,a){const o=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):tt.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(t,e)&&(function(r,a){for(const o of hc(r))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(r,a){for(const o of r.filters)if(!o.matches(a))return!1;return!0})(t,e)&&(function(r,a){return!(r.startAt&&!(function(u,h,f){const p=pE(u,h,f);return u.inclusive?p<=0:p<0})(r.startAt,hc(r),a)||r.endAt&&!(function(u,h,f){const p=pE(u,h,f);return u.inclusive?p>=0:p>0})(r.endAt,hc(r),a))})(t,e)}function $D(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function QC(t){return(e,n)=>{let r=!1;for(const a of hc(t)){const o=qD(a,e,n);if(o!==0)return o;r=r||a.field.isKeyField()}return 0}}function qD(t,e,n){const r=t.field.isKeyField()?tt.comparator(e.key,n.key):(function(o,u,h){const f=u.data.field(o),p=h.data.field(o);return f!==null&&p!==null?_c(f,p):ft(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ft(19790,{direction:t.dir})}}class ol{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[a,o]of r)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){co(this.inner,((n,r)=>{for(const[a,o]of r)e(a,o)}))}isEmpty(){return DC(this.inner)}size(){return this.innerSize}}const GD=new xn(tt.comparator);function ea(){return GD}const XC=new xn(tt.comparator);function ud(...t){let e=XC;for(const n of t)e=e.insert(n.key,n);return e}function WC(t){let e=XC;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function Fo(){return Ed()}function JC(){return Ed()}function Ed(){return new ol((t=>t.toString()),((t,e)=>t.isEqual(e)))}const YD=new xn(tt.comparator),KD=new Wn(tt.comparator);function Lt(...t){let e=KD;for(const n of t)e=e.add(n);return e}const QD=new Wn(Ot);function XD(){return QD}function T1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jm(e)?"-0":e}}function ZC(t){return{integerValue:""+t}}function ek(t,e){return SD(e)?ZC(e):T1(t,e)}class Tp{constructor(){this._=void 0}}function WD(t,e,n){return t instanceof Od?(function(a,o){const u={fields:{[OC]:{stringValue:MC},[VC]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&xp(o)&&(o=_p(o)),o&&(u.fields[LC]=o),{mapValue:u}})(n,e):t instanceof Sc?nk(t,e):t instanceof Tc?rk(t,e):(function(a,o){const u=tk(a,o),h=bE(u)+bE(a.Ae);return ny(u)&&ny(a.Ae)?ZC(h):T1(a.serializer,h)})(t,e)}function JD(t,e,n){return t instanceof Sc?nk(t,e):t instanceof Tc?rk(t,e):n}function tk(t,e){return t instanceof Ld?(function(r){return ny(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Od extends Tp{}class Sc extends Tp{constructor(e){super(),this.elements=e}}function nk(t,e){const n=sk(e);for(const r of t.elements)n.some((a=>ci(a,r)))||n.push(r);return{arrayValue:{values:n}}}class Tc extends Tp{constructor(e){super(),this.elements=e}}function rk(t,e){let n=sk(e);for(const r of t.elements)n=n.filter((a=>!ci(a,r)));return{arrayValue:{values:n}}}class Ld extends Tp{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function bE(t){return An(t.integerValue||t.doubleValue)}function sk(t){return _1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Cp{constructor(e,n){this.field=e,this.transform=n}}function ZD(t,e){return t.field.isEqual(e.field)&&(function(r,a){return r instanceof Sc&&a instanceof Sc||r instanceof Tc&&a instanceof Tc?xc(r.elements,a.elements,ci):r instanceof Ld&&a instanceof Ld?ci(r.Ae,a.Ae):r instanceof Od&&a instanceof Od})(t.transform,e.transform)}class eP{constructor(e,n){this.version=e,this.transformResults=n}}class kr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new kr}static exists(e){return new kr(void 0,e)}static updateTime(e){return new kr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kp{}function ik(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Np(t.key,kr.none()):new nh(t.key,t.data,kr.none());{const n=t.data,r=Ur.empty();let a=new Wn(hr.comparator);for(let o of e.fields)if(!a.has(o)){let u=n.field(o);u===null&&o.length>1&&(o=o.popLast(),u=n.field(o)),u===null?r.delete(o):r.set(o,u),a=a.add(o)}return new uo(t.key,r,new es(a.toArray()),kr.none())}}function tP(t,e,n){t instanceof nh?(function(a,o,u){const h=a.value.clone(),f=_E(a.fieldTransforms,o,u.transformResults);h.setAll(f),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(t,e,n):t instanceof uo?(function(a,o,u){if(!lm(a.precondition,o))return void o.convertToUnknownDocument(u.version);const h=_E(a.fieldTransforms,o,u.transformResults),f=o.data;f.setAll(ak(a)),f.setAll(h),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(t,e,n):(function(a,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,n)}function Sd(t,e,n,r){return t instanceof nh?(function(o,u,h,f){if(!lm(o.precondition,u))return h;const p=o.value.clone(),y=wE(o.fieldTransforms,f,u);return p.setAll(y),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(t,e,n,r):t instanceof uo?(function(o,u,h,f){if(!lm(o.precondition,u))return h;const p=wE(o.fieldTransforms,f,u),y=u.data;return y.setAll(ak(o)),y.setAll(p),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((b=>b.field)))})(t,e,n,r):(function(o,u,h){return lm(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(t,e,n)}function nP(t,e){let n=null;for(const r of t.fieldTransforms){const a=e.data.field(r.field),o=tk(r.transform,a||null);o!=null&&(n===null&&(n=Ur.empty()),n.set(r.field,o))}return n||null}function xE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&xc(r,a,((o,u)=>ZD(o,u)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nh extends kp{constructor(e,n,r,a=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class uo extends kp{constructor(e,n,r,a,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function ak(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function _E(t,e,n){const r=new Map;Qt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const o=t[a],u=o.transform,h=e.data.field(o.field);r.set(o.field,JD(u,h,n[a]))}return r}function wE(t,e,n){const r=new Map;for(const a of t){const o=a.transform,u=n.data.field(a.field);r.set(a.field,WD(o,u,e))}return r}class Np extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rP extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sP{constructor(e,n,r,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&tP(o,e,r[a])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Sd(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Sd(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=JC();return this.mutations.forEach((a=>{const o=e.get(a.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=n.has(a.key)?null:h;const f=ik(u,h);f!==null&&r.set(a.key,f),u.isValidDocument()||u.convertToNoDocument(pt.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Lt())}isEqual(e){return this.batchId===e.batchId&&xc(this.mutations,e.mutations,((n,r)=>xE(n,r)))&&xc(this.baseMutations,e.baseMutations,((n,r)=>xE(n,r)))}}class C1{constructor(e,n,r,a){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(e,n,r){Qt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return YD})();const o=e.mutations;for(let u=0;u<o.length;u++)a=a.insert(o[u].key,r[u].version);return new C1(e,n,r,a)}}class iP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class aP{constructor(e,n){this.count=e,this.unchangedNames=n}}var Ln,zt;function oP(t){switch(t){case pe.OK:return ft(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return ft(15467,{code:t})}}function ok(t){if(t===void 0)return Zi("GRPC error has no .code"),pe.UNKNOWN;switch(t){case Ln.OK:return pe.OK;case Ln.CANCELLED:return pe.CANCELLED;case Ln.UNKNOWN:return pe.UNKNOWN;case Ln.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case Ln.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case Ln.INTERNAL:return pe.INTERNAL;case Ln.UNAVAILABLE:return pe.UNAVAILABLE;case Ln.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case Ln.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case Ln.NOT_FOUND:return pe.NOT_FOUND;case Ln.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case Ln.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case Ln.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case Ln.ABORTED:return pe.ABORTED;case Ln.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case Ln.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case Ln.DATA_LOSS:return pe.DATA_LOSS;default:return ft(39323,{code:t})}}(zt=Ln||(Ln={}))[zt.OK=0]="OK",zt[zt.CANCELLED=1]="CANCELLED",zt[zt.UNKNOWN=2]="UNKNOWN",zt[zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zt[zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zt[zt.NOT_FOUND=5]="NOT_FOUND",zt[zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",zt[zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",zt[zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",zt[zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zt[zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zt[zt.ABORTED=10]="ABORTED",zt[zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",zt[zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",zt[zt.INTERNAL=13]="INTERNAL",zt[zt.UNAVAILABLE=14]="UNAVAILABLE",zt[zt.DATA_LOSS=15]="DATA_LOSS";function lP(){return new TextEncoder}const cP=new Ja([4294967295,4294967295],0);function EE(t){const e=lP().encode(t),n=new wC;return n.update(e),new Uint8Array(n.digest())}function SE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ja([n,r],0),new Ja([a,o],0)]}class k1{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new dd(`Invalid padding: ${n}`);if(r<0)throw new dd(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new dd(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new dd(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ja.fromNumber(this.ge)}ye(e,n,r){let a=e.add(n.multiply(Ja.fromNumber(r)));return a.compare(cP)===1&&(a=new Ja([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=EE(e),[r,a]=SE(n);for(let o=0;o<this.hashCount;o++){const u=this.ye(r,a,o);if(!this.we(u))return!1}return!0}static create(e,n,r){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new k1(o,a,n);return r.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const n=EE(e),[r,a]=SE(n);for(let o=0;o<this.hashCount;o++){const u=this.ye(r,a,o);this.Se(u)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class dd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ap{constructor(e,n,r,a,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const a=new Map;return a.set(e,rh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ap(pt.min(),a,new xn(Ot),ea(),Lt())}}class rh{constructor(e,n,r,a,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new rh(r,n,Lt(),Lt(),Lt())}}class cm{constructor(e,n,r,a){this.be=e,this.removedTargetIds=n,this.key=r,this.De=a}}class lk{constructor(e,n){this.targetId=e,this.Ce=n}}class ck{constructor(e,n,r=fr.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=a}}class TE{constructor(){this.ve=0,this.Fe=CE(),this.Me=fr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Lt(),n=Lt(),r=Lt();return this.Fe.forEach(((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:ft(38017,{changeType:o})}})),new rh(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=CE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Qt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uP{constructor(e){this.Ge=e,this.ze=new Map,this.je=ea(),this.Je=Ff(),this.He=Ff(),this.Ye=new xn(Ot)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ft(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,r=e.Ce.count,a=this.ot(n);if(a){const o=a.target;if(sy(o))if(r===0){const u=new tt(o.path);this.et(n,u,yr.newNoDocument(u,pt.min()))}else Qt(r===1,20013,{expectedCount:r});else{const u=this._t(n);if(u!==r){const h=this.ut(e),f=h?this.ct(h,e,u):1;if(f!==0){this.it(n);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,p)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:o=0}=n;let u,h;try{u=so(r).toUint8Array()}catch(f){if(f instanceof PC)return bc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new k1(u,a,o)}catch(f){return bc(f instanceof dd?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let a=0;return r.forEach((o=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.et(n,o,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((o,u)=>{const h=this.ot(u);if(h){if(o.current&&sy(h.target)){const f=new tt(h.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,yr.newNoDocument(f,e))}o.Be&&(n.set(u,o.ke()),o.qe())}}));let r=Lt();this.He.forEach(((o,u)=>{let h=!0;u.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(r=r.add(o))})),this.je.forEach(((o,u)=>u.setReadTime(e)));const a=new Ap(e,n,this.Ye,this.je,r);return this.je=ea(),this.Je=Ff(),this.He=Ff(),this.Ye=new xn(Ot),a}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new TE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Wn(Ot),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Wn(Ot),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ge("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new TE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ff(){return new xn(tt.comparator)}function CE(){return new xn(tt.comparator)}const dP={asc:"ASCENDING",desc:"DESCENDING"},hP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fP={and:"AND",or:"OR"};class mP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ay(t,e){return t.useProto3Json||bp(e)?e:{value:e}}function Lm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pP(t,e){return Lm(t,e.toTimestamp())}function ii(t){return Qt(!!t,49232),pt.fromTimestamp((function(n){const r=ro(n);return new hn(r.seconds,r.nanos)})(t))}function N1(t,e){return oy(t,e).canonicalString()}function oy(t,e){const n=(function(a){return new an(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function dk(t){const e=an.fromString(t);return Qt(gk(e),10190,{key:e.toString()}),e}function ly(t,e){return N1(t.databaseId,e.path)}function m0(t,e){const n=dk(e);if(n.get(1)!==t.databaseId.projectId)throw new Be(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Be(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new tt(fk(n))}function hk(t,e){return N1(t.databaseId,e)}function gP(t){const e=dk(t);return e.length===4?an.emptyPath():fk(e)}function cy(t){return new an(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fk(t){return Qt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kE(t,e,n){return{name:ly(t,e),fields:n.value.mapValue.fields}}function vP(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ft(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=(function(p,y){return p.useProto3Json?(Qt(y===void 0||typeof y=="string",58123),fr.fromBase64String(y||"")):(Qt(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),fr.fromUint8Array(y||new Uint8Array))})(t,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(p){const y=p.code===void 0?pe.UNKNOWN:ok(p.code);return new Be(y,p.message||"")})(u);n=new ck(r,a,o,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=m0(t,r.document.name),o=ii(r.document.updateTime),u=r.document.createTime?ii(r.document.createTime):pt.min(),h=new Ur({mapValue:{fields:r.document.fields}}),f=yr.newFoundDocument(a,o,u,h),p=r.targetIds||[],y=r.removedTargetIds||[];n=new cm(p,y,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=m0(t,r.document),o=r.readTime?ii(r.readTime):pt.min(),u=yr.newNoDocument(a,o),h=r.removedTargetIds||[];n=new cm([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=m0(t,r.document),o=r.removedTargetIds||[];n=new cm([],o,a,null)}else{if(!("filter"in e))return ft(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:o}=r,u=new aP(a,o),h=r.targetId;n=new lk(h,u)}}return n}function yP(t,e){let n;if(e instanceof nh)n={update:kE(t,e.key,e.value)};else if(e instanceof Np)n={delete:ly(t,e.key)};else if(e instanceof uo)n={update:kE(t,e.key,e.data),updateMask:kP(e.fieldMask)};else{if(!(e instanceof rP))return ft(16599,{Vt:e.type});n={verify:ly(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(o,u){const h=u.transform;if(h instanceof Od)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Sc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Tc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Ld)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw ft(20930,{transform:u.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(a,o){return o.updateTime!==void 0?{updateTime:pP(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ft(27497)})(t,e.precondition)),n}function bP(t,e){return t&&t.length>0?(Qt(e!==void 0,14353),t.map((n=>(function(a,o){let u=a.updateTime?ii(a.updateTime):ii(o);return u.isEqual(pt.min())&&(u=ii(o)),new eP(u,a.transformResults||[])})(n,e)))):[]}function xP(t,e){return{documents:[hk(t,e.path)]}}function _P(t,e){const n={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=hk(t,a);const o=(function(p){if(p.length!==0)return pk(Ms.create(p,"and"))})(e.filters);o&&(n.structuredQuery.where=o);const u=(function(p){if(p.length!==0)return p.map((y=>(function(x){return{field:ic(x.field),direction:SP(x.dir)}})(y)))})(e.orderBy);u&&(n.structuredQuery.orderBy=u);const h=ay(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:n,parent:a}}function wP(t){let e=gP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){Qt(r===1,65062);const y=n.from[0];y.allDescendants?a=y.collectionId:e=e.child(y.collectionId)}let o=[];n.where&&(o=(function(b){const x=mk(b);return x instanceof Ms&&$C(x)?x.getFilters():[x]})(n.where));let u=[];n.orderBy&&(u=(function(b){return b.map((x=>(function(I){return new Md(ac(I.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(x)))})(n.orderBy));let h=null;n.limit&&(h=(function(b){let x;return x=typeof b=="object"?b.value:b,bp(x)?null:x})(n.limit));let f=null;n.startAt&&(f=(function(b){const x=!!b.before,k=b.values||[];return new Ec(k,x)})(n.startAt));let p=null;return n.endAt&&(p=(function(b){const x=!b.before,k=b.values||[];return new Ec(k,x)})(n.endAt)),FD(e,a,u,o,h,"F",f,p)}function EP(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ft(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function mk(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ac(n.unaryFilter.field);return Fn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=ac(n.unaryFilter.field);return Fn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ac(n.unaryFilter.field);return Fn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ac(n.unaryFilter.field);return Fn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ft(61313);default:return ft(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Fn.create(ac(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ft(58110);default:return ft(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Ms.create(n.compositeFilter.filters.map((r=>mk(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ft(1026)}})(n.compositeFilter.op))})(t):ft(30097,{filter:t})}function SP(t){return dP[t]}function TP(t){return hP[t]}function CP(t){return fP[t]}function ic(t){return{fieldPath:t.canonicalString()}}function ac(t){return hr.fromServerFormat(t.fieldPath)}function pk(t){return t instanceof Fn?(function(n){if(n.op==="=="){if(mE(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NAN"}};if(fE(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mE(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NOT_NAN"}};if(fE(n.value))return{unaryFilter:{field:ic(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(n.field),op:TP(n.op),value:n.value}}})(t):t instanceof Ms?(function(n){const r=n.getFilters().map((a=>pk(a)));return r.length===1?r[0]:{compositeFilter:{op:CP(n.op),filters:r}}})(t):ft(54877,{filter:t})}function kP(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function gk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class $a{constructor(e,n,r,a,o=pt.min(),u=pt.min(),h=fr.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new $a(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class NP{constructor(e){this.yt=e}}function AP(t){const e=wP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Om(e,e.limit,"L"):e}class RP{constructor(){this.Cn=new IP}addToCollectionParentIndex(e,n){return this.Cn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(no.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(no.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class IP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n]||new Wn(an.comparator),o=!a.has(r);return this.index[n]=a.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(e){return(this.index[e]||new Wn(an.comparator)).toArray()}}const NE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vk=41943040;class Vr{static withCacheSize(e){return new Vr(e,Vr.DEFAULT_COLLECTION_PERCENTILE,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}Vr.DEFAULT_COLLECTION_PERCENTILE=10,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vr.DEFAULT=new Vr(vk,Vr.DEFAULT_COLLECTION_PERCENTILE,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vr.DISABLED=new Vr(-1,0,0);class Cc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cc(0)}static cr(){return new Cc(-1)}}const AE="LruGarbageCollector",jP=1048576;function RE([t,e],[n,r]){const a=Ot(t,n);return a===0?Ot(e,r):a}class DP{constructor(e){this.Ir=e,this.buffer=new Wn(RE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();RE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class PP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ge(AE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){$c(n)?Ge(AE,"Ignoring IndexedDB error during garbage collection: ",n):await Hc(n)}await this.Vr(3e5)}))}}class MP{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return we.resolve(yp.ce);const r=new DP(n);return this.mr.forEachTarget(e,(a=>r.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>r.Ar(a))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ge("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(NE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),NE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,a,o,u,h,f,p;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,u=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(r=b,h=Date.now(),this.removeTargets(e,r,n)))).next((b=>(o=b,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((b=>(p=Date.now(),rc()<=Mt.DEBUG&&Ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-y}ms
	Determined least recently used ${a} in `+(h-u)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${b} documents in `+(p-f)+`ms
Total Duration: ${p-y}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:b}))))}}function OP(t,e){return new MP(t,e)}class LP{constructor(){this.changes=new ol((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class VP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class UP{constructor(e,n,r,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(r!==null&&Sd(r.mutation,a,es.empty(),hn.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,Lt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=Lt()){const a=Fo();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,r).next((o=>{let u=ud();return o.forEach(((h,f)=>{u=u.insert(h,f.overlayedDocument)})),u}))))}getOverlayedDocuments(e,n){const r=Fo();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,Lt())))}populateOverlays(e,n,r){const a=[];return r.forEach((o=>{n.has(o)||a.push(o)})),this.documentOverlayCache.getOverlays(e,a).next((o=>{o.forEach(((u,h)=>{n.set(u,h)}))}))}computeViews(e,n,r,a){let o=ea();const u=Ed(),h=(function(){return Ed()})();return n.forEach(((f,p)=>{const y=r.get(p.key);a.has(p.key)&&(y===void 0||y.mutation instanceof uo)?o=o.insert(p.key,p):y!==void 0?(u.set(p.key,y.mutation.getFieldMask()),Sd(y.mutation,p,y.mutation.getFieldMask(),hn.now())):u.set(p.key,es.empty())})),this.recalculateAndSaveOverlays(e,o).next((f=>(f.forEach(((p,y)=>u.set(p,y))),n.forEach(((p,y)=>h.set(p,new VP(y,u.get(p)??null)))),h)))}recalculateAndSaveOverlays(e,n){const r=Ed();let a=new xn(((u,h)=>u-h)),o=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((u=>{for(const h of u)h.keys().forEach((f=>{const p=n.get(f);if(p===null)return;let y=r.get(f)||es.empty();y=h.applyToLocalView(p,y),r.set(f,y);const b=(a.get(h.batchId)||Lt()).add(f);a=a.insert(h.batchId,b)}))})).next((()=>{const u=[],h=a.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,y=f.value,b=JC();y.forEach((x=>{if(!o.has(x)){const k=ik(n.get(x),r.get(x));k!==null&&b.set(x,k),o=o.add(x)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,b))}return we.waitFor(u)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,a){return(function(u){return tt.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):S1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,a):this.getDocumentsMatchingCollectionQuery(e,n,r,a)}getNextDocuments(e,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,a).next((o=>{const u=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,a-o.size):we.resolve(Fo());let h=Id,f=o;return u.next((p=>we.forEach(p,((y,b)=>(h<b.largestBatchId&&(h=b.largestBatchId),o.get(y)?we.resolve():this.remoteDocumentCache.getEntry(e,y).next((x=>{f=f.insert(y,x)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,f,p,Lt()))).next((y=>({batchId:h,changes:WC(y)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new tt(n)).next((r=>{let a=ud();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,a){const o=n.collectionGroup;let u=ud();return this.indexManager.getCollectionParents(e,o).next((h=>we.forEach(h,(f=>{const p=(function(b,x){return new al(x,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(n,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,r,a).next((y=>{y.forEach(((b,x)=>{u=u.insert(b,x)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,n,r,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,a)))).next((u=>{o.forEach(((f,p)=>{const y=p.getKey();u.get(y)===null&&(u=u.insert(y,yr.newInvalidDocument(y)))}));let h=ud();return u.forEach(((f,p)=>{const y=o.get(f);y!==void 0&&Sd(y.mutation,p,es.empty(),hn.now()),Sp(n,p)&&(h=h.insert(f,p))})),h}))}}class zP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return we.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ii(a.createTime)}})(n)),we.resolve()}getNamedQuery(e,n){return we.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:AP(a.bundledQuery),readTime:ii(a.readTime)}})(n)),we.resolve()}}class BP{constructor(){this.overlays=new xn(tt.comparator),this.qr=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Fo();return we.forEach(n,(a=>this.getOverlay(e,a).next((o=>{o!==null&&r.set(a,o)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((a,o)=>{this.St(e,n,o)})),we.resolve()}removeOverlaysForBatchId(e,n,r){const a=this.qr.get(r);return a!==void 0&&(a.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const a=Fo(),o=n.length+1,u=new tt(n.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>r&&a.set(f.getKey(),f)}return we.resolve(a)}getOverlaysForCollectionGroup(e,n,r,a){let o=new xn(((p,y)=>p-y));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>r){let y=o.get(p.largestBatchId);y===null&&(y=Fo(),o=o.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const h=Fo(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,y)=>h.set(p,y))),!(h.size()>=a)););return we.resolve(h)}St(e,n,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new iP(n,r));let o=this.qr.get(n);o===void 0&&(o=Lt(),this.qr.set(n,o)),this.qr.set(n,o.add(r.key))}}class FP{constructor(){this.sessionToken=fr.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,we.resolve()}}class A1{constructor(){this.Qr=new Wn(tr.$r),this.Ur=new Wn(tr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new tr(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new tr(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new tt(new an([])),r=new tr(n,e),a=new tr(n,e+1),o=[];return this.Ur.forEachInRange([r,a],(u=>{this.Gr(u),o.push(u.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new tt(new an([])),r=new tr(n,e),a=new tr(n,e+1);let o=Lt();return this.Ur.forEachInRange([r,a],(u=>{o=o.add(u.key)})),o}containsKey(e){const n=new tr(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class tr{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return tt.comparator(e.key,n.key)||Ot(e.Yr,n.Yr)}static Kr(e,n){return Ot(e.Yr,n.Yr)||tt.comparator(e.key,n.key)}}class HP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Wn(tr.$r)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,a){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new sP(o,n,r,a);this.mutationQueue.push(u);for(const h of a)this.Zr=this.Zr.add(new tr(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return we.resolve(u)}lookupMutationBatch(e,n){return we.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,a=this.ei(r),o=a<0?0:a;return we.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?x1:this.tr-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new tr(n,0),a=new tr(n,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,a],(u=>{const h=this.Xr(u.Yr);o.push(h)})),we.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Wn(Ot);return n.forEach((a=>{const o=new tr(a,0),u=new tr(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,u],(h=>{r=r.add(h.Yr)}))})),we.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,a=r.length+1;let o=r;tt.isDocumentKey(o)||(o=o.child(""));const u=new tr(new tt(o),0);let h=new Wn(Ot);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===a&&(h=h.add(f.Yr)),!0)}),u),we.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((r=>{const a=this.Xr(r);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){Qt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return we.forEach(n.mutations,(a=>{const o=new tr(a.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new tr(n,0),a=this.Zr.firstAfterOrEqual(r);return we.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class $P{constructor(e){this.ri=e,this.docs=(function(){return new xn(tt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,a=this.docs.get(r),o=a?a.size:0,u=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():yr.newInvalidDocument(n))}getEntries(e,n){let r=ea();return n.forEach((a=>{const o=this.docs.get(a);r=r.insert(a,o?o.document.mutableCopy():yr.newInvalidDocument(a))})),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,a){let o=ea();const u=n.path,h=new tt(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:y}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||xD(bD(y),r)<=0||(a.has(y.key)||Sp(n,y))&&(o=o.insert(y.key,y.mutableCopy()))}return we.resolve(o)}getAllFromCollectionGroup(e,n,r,a){ft(9500)}ii(e,n){return we.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new qP(this)}getSize(e){return we.resolve(this.size)}}class qP extends LP{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)})),we.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class GP{constructor(e){this.persistence=e,this.si=new ol((n=>w1(n)),E1),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.oi=0,this._i=new A1,this.targetCount=0,this.ai=Cc.ur()}forEachTarget(e,n){return this.si.forEach(((r,a)=>n(a))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),we.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Cc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.Pr(n),we.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let a=0;const o=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.si.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),we.waitFor(o).next((()=>a))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),we.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const a=this.persistence.referenceDelegate,o=[];return a&&n.forEach((u=>{o.push(a.markPotentiallyOrphaned(e,u))})),we.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this._i.containsKey(n))}}class yk{constructor(e,n){this.ui={},this.overlays={},this.ci=new yp(0),this.li=!1,this.li=!0,this.hi=new FP,this.referenceDelegate=e(this),this.Pi=new GP(this),this.indexManager=new RP,this.remoteDocumentCache=(function(a){return new $P(a)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new NP(n),this.Ii=new zP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new BP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new HP(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Ge("MemoryPersistence","Starting transaction:",e);const a=new YP(this.ci.next());return this.referenceDelegate.Ei(),r(a).next((o=>this.referenceDelegate.di(a).next((()=>o)))).toPromise().then((o=>(a.raiseOnCommittedEvent(),o)))}Ai(e,n){return we.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class YP extends wD{constructor(e){super(),this.currentSequenceNumber=e}}class R1{constructor(e){this.persistence=e,this.Ri=new A1,this.Vi=null}static mi(e){return new R1(e)}get fi(){if(this.Vi)return this.Vi;throw ft(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),we.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.fi,(r=>{const a=tt.fromPath(r);return this.gi(e,a).next((o=>{o||n.removeEntry(a,pt.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return we.or([()=>we.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Vm{constructor(e,n){this.persistence=e,this.pi=new ol((r=>TD(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=OP(this,n)}static mi(e,n){return new Vm(e,n)}Ei(){}di(e){return we.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((a=>r+a))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return we.forEach(this.pi,((r,a)=>this.br(e,r,a).next((o=>o?we.resolve():n(a)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,n).next((h=>{h||(r++,o.removeEntry(u,pt.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=am(e.data.value)),n}br(e,n,r){return we.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return we.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class I1{constructor(e,n,r,a){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=a}static As(e,n){let r=Lt(),a=Lt();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new I1(e,n.fromCache,r,a)}}class KP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class QP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return b5()?8:ED(xr())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,a){const o={result:null};return this.ys(e,n).next((u=>{o.result=u})).next((()=>{if(!o.result)return this.ws(e,n,a,r).next((u=>{o.result=u}))})).next((()=>{if(o.result)return;const u=new KP;return this.Ss(e,n,u).next((h=>{if(o.result=h,this.Vs)return this.bs(e,n,u,h.size)}))})).next((()=>o.result))}bs(e,n,r,a){return r.documentReadCount<this.fs?(rc()<=Mt.DEBUG&&Ge("QueryEngine","SDK will not create cache indexes for query:",sc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),we.resolve()):(rc()<=Mt.DEBUG&&Ge("QueryEngine","Query:",sc(n),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(rc()<=Mt.DEBUG&&Ge("QueryEngine","The SDK decides to create cache indexes for query:",sc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,si(n))):we.resolve())}ys(e,n){if(yE(n))return we.resolve(null);let r=si(n);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=Om(n,null,"F"),r=si(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const u=Lt(...o);return this.ps.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.Ds(n,h);return this.Cs(n,p,u,f.readTime)?this.ys(e,Om(n,null,"F")):this.vs(e,p,n,f)}))))})))))}ws(e,n,r,a){return yE(n)||a.isEqual(pt.min())?we.resolve(null):this.ps.getDocuments(e,r).next((o=>{const u=this.Ds(n,o);return this.Cs(n,u,r,a)?we.resolve(null):(rc()<=Mt.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),sc(n)),this.vs(e,u,n,yD(a,Id)).next((h=>h)))}))}Ds(e,n){let r=new Wn(QC(e));return n.forEach(((a,o)=>{Sp(e,o)&&(r=r.add(o))})),r}Cs(e,n,r,a){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Ss(e,n,r){return rc()<=Mt.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",sc(n)),this.ps.getDocumentsMatchingQuery(e,n,no.min(),r)}vs(e,n,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next((o=>(n.forEach((u=>{o=o.insert(u.key,u)})),o)))}}const j1="LocalStore",XP=3e8;class WP{constructor(e,n,r,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new xn(Ot),this.xs=new ol((o=>w1(o)),E1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new UP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function JP(t,e,n,r){return new WP(t,e,n,r)}async function bk(t,e){const n=vt(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next((o=>(a=o,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((o=>{const u=[],h=[];let f=Lt();for(const p of a){u.push(p.batchId);for(const y of p.mutations)f=f.add(y.key)}for(const p of o){h.push(p.batchId);for(const y of p.mutations)f=f.add(y.key)}return n.localDocuments.getDocuments(r,f).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:h})))}))}))}function ZP(t,e){const n=vt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),o=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,f,p,y){const b=p.batch,x=b.keys();let k=we.resolve();return x.forEach((I=>{k=k.next((()=>y.getEntry(f,I))).next((A=>{const N=p.docVersions.get(I);Qt(N!==null,48541),A.version.compareTo(N)<0&&(b.applyToRemoteDocument(A,p),A.isValidDocument()&&(A.setReadTime(p.commitVersion),y.addEntry(A)))}))})),k.next((()=>h.mutationQueue.removeMutationBatch(f,b)))})(n,r,e,o).next((()=>o.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(h){let f=Lt();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(r,a)))}))}function xk(t){const e=vt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function eM(t,e){const n=vt(t),r=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const u=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((y,b)=>{const x=a.get(b);if(!x)return;h.push(n.Pi.removeMatchingKeys(o,y.removedDocuments,b).next((()=>n.Pi.addMatchingKeys(o,y.addedDocuments,b))));let k=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?k=k.withResumeToken(fr.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):y.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(y.resumeToken,r)),a=a.insert(b,k),(function(A,N,V){return A.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=XP?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0})(x,k,y)&&h.push(n.Pi.updateTargetData(o,k))}));let f=ea(),p=Lt();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(o,y))})),h.push(tM(o,u,e.documentUpdates).next((y=>{f=y.ks,p=y.qs}))),!r.isEqual(pt.min())){const y=n.Pi.getLastRemoteSnapshotVersion(o).next((b=>n.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));h.push(y)}return we.waitFor(h).next((()=>u.apply(o))).next((()=>n.localDocuments.getLocalViewOfDocuments(o,f,p))).next((()=>f))})).then((o=>(n.Ms=a,o)))}function tM(t,e,n){let r=Lt(),a=Lt();return n.forEach((o=>r=r.add(o))),e.getEntries(t,r).next((o=>{let u=ea();return n.forEach(((h,f)=>{const p=o.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(h)),f.isNoDocument()&&f.version.isEqual(pt.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):Ge(j1,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)})),{ks:u,qs:a}}))}function nM(t,e){const n=vt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=x1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function rM(t,e){const n=vt(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return n.Pi.getTargetData(r,e).next((o=>o?(a=o,we.resolve(a)):n.Pi.allocateTargetId(r).next((u=>(a=new $a(e,u,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=n.Ms.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function uy(t,e,n){const r=vt(t),a=r.Ms.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,(u=>r.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!$c(u))throw u;Ge(j1,`Failed to update sequence numbers for target ${e}: ${u}`)}r.Ms=r.Ms.remove(e),r.xs.delete(a.target)}function IE(t,e,n){const r=vt(t);let a=pt.min(),o=Lt();return r.persistence.runTransaction("Execute query","readwrite",(u=>(function(f,p,y){const b=vt(f),x=b.xs.get(y);return x!==void 0?we.resolve(b.Ms.get(x)):b.Pi.getTargetData(p,y)})(r,u,si(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(u,h.targetId).next((f=>{o=f}))})).next((()=>r.Fs.getDocumentsMatchingQuery(u,e,n?a:pt.min(),n?o:Lt()))).next((h=>(sM(r,$D(e),h),{documents:h,Qs:o})))))}function sM(t,e,n){let r=t.Os.get(e)||pt.min();n.forEach(((a,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),t.Os.set(e,r)}class jE{constructor(){this.activeTargetIds=XD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iM{constructor(){this.Mo=new jE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jE,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aM{Oo(e){}shutdown(){}}const DE="ConnectivityMonitor";class PE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ge(DE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ge(DE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Hf=null;function dy(){return Hf===null?Hf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Hf++,"0x"+Hf.toString(16)}const p0="RestConnection",oM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${a}`,this.Wo=this.databaseId.database===Dm?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Go(e,n,r,a,o){const u=dy(),h=this.zo(e,n.toUriEncodedString());Ge(p0,`Sending RPC '${e}' ${u}:`,h,r);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,o);const{host:p}=new URL(h),y=rl(p);return this.Jo(e,h,f,r,y).then((b=>(Ge(p0,`Received RPC '${e}' ${u}: `,b),b)),(b=>{throw bc(p0,`RPC '${e}' ${u} failed with error: `,b,"url: ",h,"request:",r),b}))}Ho(e,n,r,a,o,u){return this.Go(e,n,r,a,o)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,o)=>e[o]=a)),r&&r.headers.forEach(((a,o)=>e[o]=a))}zo(e,n){const r=oM[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class cM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const pr="WebChannelConnection";class uM extends lM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,a,o){const u=dy();return new Promise(((h,f)=>{const p=new EC;p.setWithCredentials(!0),p.listenOnce(SC.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case im.NO_ERROR:const b=p.getResponseJson();Ge(pr,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(b)),h(b);break;case im.TIMEOUT:Ge(pr,`RPC '${e}' ${u} timed out`),f(new Be(pe.DEADLINE_EXCEEDED,"Request time out"));break;case im.HTTP_ERROR:const x=p.getStatus();if(Ge(pr,`RPC '${e}' ${u} failed with status:`,x,"response text:",p.getResponseText()),x>0){let k=p.getResponseJson();Array.isArray(k)&&(k=k[0]);const I=k?.error;if(I&&I.status&&I.message){const A=(function(V){const F=V.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(F)>=0?F:pe.UNKNOWN})(I.status);f(new Be(A,I.message))}else f(new Be(pe.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Be(pe.UNAVAILABLE,"Connection failed."));break;default:ft(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Ge(pr,`RPC '${e}' ${u} completed.`)}}));const y=JSON.stringify(a);Ge(pr,`RPC '${e}' ${u} sending request:`,a),p.send(n,"POST",y,r,15)}))}T_(e,n,r){const a=dy(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=kC(),h=CC(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,r),f.encodeInitMessageHeaders=!0;const y=o.join("");Ge(pr,`Creating RPC '${e}' stream ${a}: ${y}`,f);const b=u.createWebChannel(y,f);this.I_(b);let x=!1,k=!1;const I=new cM({Yo:N=>{k?Ge(pr,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(x||(Ge(pr,`Opening RPC '${e}' stream ${a} transport.`),b.open(),x=!0),Ge(pr,`RPC '${e}' stream ${a} sending:`,N),b.send(N))},Zo:()=>b.close()}),A=(N,V,F)=>{N.listen(V,(j=>{try{F(j)}catch(O){setTimeout((()=>{throw O}),0)}}))};return A(b,cd.EventType.OPEN,(()=>{k||(Ge(pr,`RPC '${e}' stream ${a} transport opened.`),I.o_())})),A(b,cd.EventType.CLOSE,(()=>{k||(k=!0,Ge(pr,`RPC '${e}' stream ${a} transport closed`),I.a_(),this.E_(b))})),A(b,cd.EventType.ERROR,(N=>{k||(k=!0,bc(pr,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),I.a_(new Be(pe.UNAVAILABLE,"The operation could not be completed")))})),A(b,cd.EventType.MESSAGE,(N=>{if(!k){const V=N.data[0];Qt(!!V,16349);const F=V,j=F?.error||F[0]?.error;if(j){Ge(pr,`RPC '${e}' stream ${a} received error:`,j);const O=j.status;let B=(function(S){const R=Ln[S];if(R!==void 0)return ok(R)})(O),H=j.message;B===void 0&&(B=pe.INTERNAL,H="Unknown error status: "+O+" with message "+j.message),k=!0,I.a_(new Be(B,H)),b.close()}else Ge(pr,`RPC '${e}' stream ${a} received:`,V),I.u_(V)}})),A(h,TC.STAT_EVENT,(N=>{N.stat===Z0.PROXY?Ge(pr,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===Z0.NOPROXY&&Ge(pr,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function g0(){return typeof document<"u"?document:null}function Rp(t){return new mP(t,!0)}class _k{constructor(e,n,r=1e3,a=1.5,o=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=a,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-r);a>0&&Ge("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ME="PersistentStream";class wk{constructor(e,n,r,a,o,u,h,f){this.Mi=e,this.S_=r,this.b_=a,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _k(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===pe.RESOURCE_EXHAUSTED?(Zi(n.toString()),Zi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===n&&this.G_(r,a)}),(r=>{e((()=>{const a=new Be(pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ge(ME,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ge(ME,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dM extends wk{constructor(e,n,r,a,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=vP(this.serializer,e),r=(function(o){if(!("targetChange"in o))return pt.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?pt.min():u.readTime?ii(u.readTime):pt.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=cy(this.serializer),n.addTarget=(function(o,u){let h;const f=u.target;if(h=sy(f)?{documents:xP(o,f)}:{query:_P(o,f).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=uk(o,u.resumeToken);const p=ay(o,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(pt.min())>0){h.readTime=Lm(o,u.snapshotVersion.toTimestamp());const p=ay(o,u.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const r=EP(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=cy(this.serializer),n.removeTarget=e,this.q_(n)}}class hM extends wk{constructor(e,n,r,a,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Qt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Qt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Qt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=bP(e.writeResults,e.commitTime),r=ii(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=cy(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>yP(this.serializer,r)))};this.q_(n)}}class fM{}class mM extends fM{constructor(e,n,r,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Be(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Go(e,oy(n,r),a,o,u))).catch((o=>{throw o.name==="FirebaseError"?(o.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Be(pe.UNKNOWN,o.toString())}))}Ho(e,n,r,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(e,oy(n,r),a,u,h,o))).catch((u=>{throw u.name==="FirebaseError"?(u.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Be(pe.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class pM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zi(n),this.aa=!1):Ge("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Wo="RemoteStore";class gM{constructor(e,n,r,a,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((u=>{r.enqueueAndForget((async()=>{ll(this)&&(Ge(Wo,"Restarting streams for network reachability change."),await(async function(f){const p=vt(f);p.Ea.add(4),await sh(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Ip(p)})(this))}))})),this.Ra=new pM(r,a)}}async function Ip(t){if(ll(t))for(const e of t.da)await e(!0)}async function sh(t){for(const e of t.da)await e(!1)}function Ek(t,e){const n=vt(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),O1(n)?M1(n):qc(n).O_()&&P1(n,e))}function D1(t,e){const n=vt(t),r=qc(n);n.Ia.delete(e),r.O_()&&Sk(n,e),n.Ia.size===0&&(r.O_()?r.L_():ll(n)&&n.Ra.set("Unknown"))}function P1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qc(t).Y_(e)}function Sk(t,e){t.Va.Ue(e),qc(t).Z_(e)}function M1(t){t.Va=new uP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),qc(t).start(),t.Ra.ua()}function O1(t){return ll(t)&&!qc(t).x_()&&t.Ia.size>0}function ll(t){return vt(t).Ea.size===0}function Tk(t){t.Va=void 0}async function vM(t){t.Ra.set("Online")}async function yM(t){t.Ia.forEach(((e,n)=>{P1(t,e)}))}async function bM(t,e){Tk(t),O1(t)?(t.Ra.ha(e),M1(t)):t.Ra.set("Unknown")}async function xM(t,e,n){if(t.Ra.set("Online"),e instanceof ck&&e.state===2&&e.cause)try{await(async function(a,o){const u=o.cause;for(const h of o.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,u),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(r){Ge(Wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Um(t,r)}else if(e instanceof cm?t.Va.Ze(e):e instanceof lk?t.Va.st(e):t.Va.tt(e),!n.isEqual(pt.min()))try{const r=await xk(t.localStore);n.compareTo(r)>=0&&await(function(o,u){const h=o.Va.Tt(u);return h.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const y=o.Ia.get(p);y&&o.Ia.set(p,y.withResumeToken(f.resumeToken,u))}})),h.targetMismatches.forEach(((f,p)=>{const y=o.Ia.get(f);if(!y)return;o.Ia.set(f,y.withResumeToken(fr.EMPTY_BYTE_STRING,y.snapshotVersion)),Sk(o,f);const b=new $a(y.target,f,p,y.sequenceNumber);P1(o,b)})),o.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(r){Ge(Wo,"Failed to raise snapshot:",r),await Um(t,r)}}async function Um(t,e,n){if(!$c(e))throw e;t.Ea.add(1),await sh(t),t.Ra.set("Offline"),n||(n=()=>xk(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ge(Wo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ip(t)}))}function Ck(t,e){return e().catch((n=>Um(t,n,e)))}async function jp(t){const e=vt(t),n=ao(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:x1;for(;_M(e);)try{const a=await nM(e.localStore,r);if(a===null){e.Ta.length===0&&n.L_();break}r=a.batchId,wM(e,a)}catch(a){await Um(e,a)}kk(e)&&Nk(e)}function _M(t){return ll(t)&&t.Ta.length<10}function wM(t,e){t.Ta.push(e);const n=ao(t);n.O_()&&n.X_&&n.ea(e.mutations)}function kk(t){return ll(t)&&!ao(t).x_()&&t.Ta.length>0}function Nk(t){ao(t).start()}async function EM(t){ao(t).ra()}async function SM(t){const e=ao(t);for(const n of t.Ta)e.ea(n.mutations)}async function TM(t,e,n){const r=t.Ta.shift(),a=C1.from(r,e,n);await Ck(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await jp(t)}async function CM(t,e){e&&ao(t).X_&&await(async function(r,a){if((function(u){return oP(u)&&u!==pe.ABORTED})(a.code)){const o=r.Ta.shift();ao(r).B_(),await Ck(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,a))),await jp(r)}})(t,e),kk(t)&&Nk(t)}async function OE(t,e){const n=vt(t);n.asyncQueue.verifyOperationInProgress(),Ge(Wo,"RemoteStore received new credentials");const r=ll(n);n.Ea.add(3),await sh(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ip(n)}async function kM(t,e){const n=vt(t);e?(n.Ea.delete(2),await Ip(n)):e||(n.Ea.add(2),await sh(n),n.Ra.set("Unknown"))}function qc(t){return t.ma||(t.ma=(function(n,r,a){const o=vt(n);return o.sa(),new dM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:vM.bind(null,t),t_:yM.bind(null,t),r_:bM.bind(null,t),H_:xM.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),O1(t)?M1(t):t.Ra.set("Unknown")):(await t.ma.stop(),Tk(t))}))),t.ma}function ao(t){return t.fa||(t.fa=(function(n,r,a){const o=vt(n);return o.sa(),new hM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:EM.bind(null,t),r_:CM.bind(null,t),ta:SM.bind(null,t),na:TM.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await jp(t)):(await t.fa.stop(),t.Ta.length>0&&(Ge(Wo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class L1{constructor(e,n,r,a,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=o,this.deferred=new Yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,a,o){const u=Date.now()+r,h=new L1(e,n,u,a,o);return h.start(r),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Be(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function V1(t,e){if(Zi("AsyncQueue",`${e}: ${t}`),$c(t))return new Be(pe.UNAVAILABLE,`${e}: ${t}`);throw t}class fc{static emptySet(e){return new fc(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||tt.comparator(n.key,r.key):(n,r)=>tt.comparator(n.key,r.key),this.keyedMap=ud(),this.sortedSet=new xn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof fc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new fc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class LE{constructor(){this.ga=new xn(tt.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ft(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class kc{constructor(e,n,r,a,o,u,h,f,p){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,n,r,a,o){const u=[];return n.forEach((h=>{u.push({type:0,doc:h})})),new kc(e,n,fc.emptySet(n),u,r,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ep(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}class NM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class AM{constructor(){this.queries=VE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const a=vt(n),o=a.queries;a.queries=VE(),o.forEach(((u,h)=>{for(const f of h.Sa)f.onError(r)}))})(this,new Be(pe.ABORTED,"Firestore shutting down"))}}function VE(){return new ol((t=>KC(t)),Ep)}async function U1(t,e){const n=vt(t);let r=3;const a=e.query;let o=n.queries.get(a);o?!o.ba()&&e.Da()&&(r=2):(o=new NM,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(a,!0);break;case 1:o.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const h=V1(u,`Initialization of query '${sc(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,o),o.Sa.push(e),e.va(n.onlineState),o.wa&&e.Fa(o.wa)&&B1(n)}async function z1(t,e){const n=vt(t),r=e.query;let a=3;const o=n.queries.get(r);if(o){const u=o.Sa.indexOf(e);u>=0&&(o.Sa.splice(u,1),o.Sa.length===0?a=e.Da()?0:1:!o.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function RM(t,e){const n=vt(t);let r=!1;for(const a of e){const o=a.query,u=n.queries.get(o);if(u){for(const h of u.Sa)h.Fa(a)&&(r=!0);u.wa=a}}r&&B1(n)}function IM(t,e,n){const r=vt(t),a=r.queries.get(e);if(a)for(const o of a.Sa)o.onError(n);r.queries.delete(e)}function B1(t){t.Ca.forEach((e=>{e.next()}))}var hy,UE;(UE=hy||(hy={})).Ma="default",UE.Cache="cache";class F1{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new kc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=kc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hy.Cache}}class Ak{constructor(e){this.key=e}}class Rk{constructor(e){this.key=e}}class jM{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Lt(),this.mutatedKeys=Lt(),this.eu=QC(e),this.tu=new fc(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new LE,a=n?n.tu:this.tu;let o=n?n.mutatedKeys:this.mutatedKeys,u=a,h=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((y,b)=>{const x=a.get(y),k=Sp(this.query,b)?b:null,I=!!x&&this.mutatedKeys.has(x.key),A=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let N=!1;x&&k?x.data.isEqual(k.data)?I!==A&&(r.track({type:3,doc:k}),N=!0):this.su(x,k)||(r.track({type:2,doc:k}),N=!0,(f&&this.eu(k,f)>0||p&&this.eu(k,p)<0)&&(h=!0)):!x&&k?(r.track({type:0,doc:k}),N=!0):x&&!k&&(r.track({type:1,doc:x}),N=!0,(f||p)&&(h=!0)),N&&(k?(u=u.add(k),o=A?o.add(y):o.delete(y)):(u=u.delete(y),o=o.delete(y)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const y=this.query.limitType==="F"?u.last():u.first();u=u.delete(y.key),o=o.delete(y.key),r.track({type:1,doc:y})}return{tu:u,iu:r,Cs:h,mutatedKeys:o}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,a){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((y,b)=>(function(k,I){const A=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft(20277,{Rt:N})}};return A(k)-A(I)})(y.type,b.type)||this.eu(y.doc,b.doc))),this.ou(r),a=a??!1;const h=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,p=f!==this.Za;return this.Za=f,u.length!==0||p?{snapshot:new kc(this.query,e.tu,o,u,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new LE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Lt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new Rk(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new Ak(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=Lt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return kc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const H1="SyncEngine";class DM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class PM{constructor(e){this.key=e,this.hu=!1}}class MM{constructor(e,n,r,a,o,u){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new ol((h=>KC(h)),Ep),this.Iu=new Map,this.Eu=new Set,this.du=new xn(tt.comparator),this.Au=new Map,this.Ru=new A1,this.Vu={},this.mu=new Map,this.fu=Cc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function OM(t,e,n=!0){const r=Ok(t);let a;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.lu()):a=await Ik(r,e,n,!0),a}async function LM(t,e){const n=Ok(t);await Ik(n,e,!0,!1)}async function Ik(t,e,n,r){const a=await rM(t.localStore,si(e)),o=a.targetId,u=t.sharedClientState.addLocalQueryTarget(o,n);let h;return r&&(h=await VM(t,e,o,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&Ek(t.remoteStore,a),h}async function VM(t,e,n,r,a){t.pu=(b,x,k)=>(async function(A,N,V,F){let j=N.view.ru(V);j.Cs&&(j=await IE(A.localStore,N.query,!1).then((({documents:w})=>N.view.ru(w,j))));const O=F&&F.targetChanges.get(N.targetId),B=F&&F.targetMismatches.get(N.targetId)!=null,H=N.view.applyChanges(j,A.isPrimaryClient,O,B);return BE(A,N.targetId,H.au),H.snapshot})(t,b,x,k);const o=await IE(t.localStore,e,!0),u=new jM(e,o.Qs),h=u.ru(o.documents),f=rh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",a),p=u.applyChanges(h,t.isPrimaryClient,f);BE(t,n,p.au);const y=new DM(e,n,u);return t.Tu.set(e,y),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),p.snapshot}async function UM(t,e,n){const r=vt(t),a=r.Tu.get(e),o=r.Iu.get(a.targetId);if(o.length>1)return r.Iu.set(a.targetId,o.filter((u=>!Ep(u,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await uy(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),n&&D1(r.remoteStore,a.targetId),fy(r,a.targetId)})).catch(Hc)):(fy(r,a.targetId),await uy(r.localStore,a.targetId,!0))}async function zM(t,e){const n=vt(t),r=n.Tu.get(e),a=n.Iu.get(r.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),D1(n.remoteStore,r.targetId))}async function BM(t,e,n){const r=KM(t);try{const a=await(function(u,h){const f=vt(u),p=hn.now(),y=h.reduce(((k,I)=>k.add(I.key)),Lt());let b,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(k=>{let I=ea(),A=Lt();return f.Ns.getEntries(k,y).next((N=>{I=N,I.forEach(((V,F)=>{F.isValidDocument()||(A=A.add(V))}))})).next((()=>f.localDocuments.getOverlayedDocuments(k,I))).next((N=>{b=N;const V=[];for(const F of h){const j=nP(F,b.get(F.key).overlayedDocument);j!=null&&V.push(new uo(F.key,j,BC(j.value.mapValue),kr.exists(!0)))}return f.mutationQueue.addMutationBatch(k,p,V,h)})).next((N=>{x=N;const V=N.applyToLocalDocumentSet(b,A);return f.documentOverlayCache.saveOverlays(k,N.batchId,V)}))})).then((()=>({batchId:x.batchId,changes:WC(b)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(u,h,f){let p=u.Vu[u.currentUser.toKey()];p||(p=new xn(Ot)),p=p.insert(h,f),u.Vu[u.currentUser.toKey()]=p})(r,a.batchId,n),await ih(r,a.changes),await jp(r.remoteStore)}catch(a){const o=V1(a,"Failed to persist write");n.reject(o)}}async function jk(t,e){const n=vt(t);try{const r=await eM(n.localStore,e);e.targetChanges.forEach(((a,o)=>{const u=n.Au.get(o);u&&(Qt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?Qt(u.hu,14607):a.removedDocuments.size>0&&(Qt(u.hu,42227),u.hu=!1))})),await ih(n,r,e)}catch(r){await Hc(r)}}function zE(t,e,n){const r=vt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.Tu.forEach(((o,u)=>{const h=u.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(u,h){const f=vt(u);f.onlineState=h;let p=!1;f.queries.forEach(((y,b)=>{for(const x of b.Sa)x.va(h)&&(p=!0)})),p&&B1(f)})(r.eventManager,e),a.length&&r.Pu.H_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function FM(t,e,n){const r=vt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.Au.get(e),o=a&&a.key;if(o){let u=new xn(tt.comparator);u=u.insert(o,yr.newNoDocument(o,pt.min()));const h=Lt().add(o),f=new Ap(pt.min(),new Map,new xn(Ot),u,h);await jk(r,f),r.du=r.du.remove(o),r.Au.delete(e),$1(r)}else await uy(r.localStore,e,!1).then((()=>fy(r,e,n))).catch(Hc)}async function HM(t,e){const n=vt(t),r=e.batch.batchId;try{const a=await ZP(n.localStore,e);Pk(n,r,null),Dk(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ih(n,a)}catch(a){await Hc(a)}}async function $M(t,e,n){const r=vt(t);try{const a=await(function(u,h){const f=vt(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let y;return f.mutationQueue.lookupMutationBatch(p,h).next((b=>(Qt(b!==null,37113),y=b.keys(),f.mutationQueue.removeMutationBatch(p,b)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,y,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y))).next((()=>f.localDocuments.getDocuments(p,y)))}))})(r.localStore,e);Pk(r,e,n),Dk(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ih(r,a)}catch(a){await Hc(a)}}function Dk(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Pk(t,e,n){const r=vt(t);let a=r.Vu[r.currentUser.toKey()];if(a){const o=a.get(e);o&&(n?o.reject(n):o.resolve(),a=a.remove(e)),r.Vu[r.currentUser.toKey()]=a}}function fy(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||Mk(t,r)}))}function Mk(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(D1(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),$1(t))}function BE(t,e,n){for(const r of n)r instanceof Ak?(t.Ru.addReference(r.key,e),qM(t,r)):r instanceof Rk?(Ge(H1,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Mk(t,r.key)):ft(19791,{wu:r})}function qM(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Ge(H1,"New document in limbo: "+n),t.Eu.add(r),$1(t))}function $1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new tt(an.fromString(e)),r=t.fu.next();t.Au.set(r,new PM(n)),t.du=t.du.insert(n,r),Ek(t.remoteStore,new $a(si(wp(n.path)),r,"TargetPurposeLimboResolution",yp.ce))}}async function ih(t,e,n){const r=vt(t),a=[],o=[],u=[];r.Tu.isEmpty()||(r.Tu.forEach(((h,f)=>{u.push(r.pu(f,e,n).then((p=>{if((p||n)&&r.isPrimaryClient){const y=p?!p.fromCache:n?.targetChanges.get(f.targetId)?.current;r.sharedClientState.updateQueryState(f.targetId,y?"current":"not-current")}if(p){a.push(p);const y=I1.As(f.targetId,p);o.push(y)}})))})),await Promise.all(u),r.Pu.H_(a),await(async function(f,p){const y=vt(f);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>we.forEach(p,(x=>we.forEach(x.Es,(k=>y.persistence.referenceDelegate.addReference(b,x.targetId,k))).next((()=>we.forEach(x.ds,(k=>y.persistence.referenceDelegate.removeReference(b,x.targetId,k)))))))))}catch(b){if(!$c(b))throw b;Ge(j1,"Failed to update sequence numbers: "+b)}for(const b of p){const x=b.targetId;if(!b.fromCache){const k=y.Ms.get(x),I=k.snapshotVersion,A=k.withLastLimboFreeSnapshotVersion(I);y.Ms=y.Ms.insert(x,A)}}})(r.localStore,o))}async function GM(t,e){const n=vt(t);if(!n.currentUser.isEqual(e)){Ge(H1,"User change. New user:",e.toKey());const r=await bk(n.localStore,e);n.currentUser=e,(function(o,u){o.mu.forEach((h=>{h.forEach((f=>{f.reject(new Be(pe.CANCELLED,u))}))})),o.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ih(n,r.Ls)}}function YM(t,e){const n=vt(t),r=n.Au.get(e);if(r&&r.hu)return Lt().add(r.key);{let a=Lt();const o=n.Iu.get(e);if(!o)return a;for(const u of o){const h=n.Tu.get(u);a=a.unionWith(h.view.nu)}return a}}function Ok(t){const e=vt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FM.bind(null,e),e.Pu.H_=RM.bind(null,e.eventManager),e.Pu.yu=IM.bind(null,e.eventManager),e}function KM(t){const e=vt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$M.bind(null,e),e}class zm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Rp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return JP(this.persistence,new QP,e.initialUser,this.serializer)}Cu(e){return new yk(R1.mi,this.serializer)}Du(e){return new iM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zm.provider={build:()=>new zm};class QM extends zm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Qt(this.persistence.referenceDelegate instanceof Vm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new PP(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Vr.withCacheSize(this.cacheSizeBytes):Vr.DEFAULT;return new yk((r=>Vm.mi(r,n)),this.serializer)}}class my{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=GM.bind(null,this.syncEngine),await kM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new AM})()}createDatastore(e){const n=Rp(e.databaseInfo.databaseId),r=(function(o){return new uM(o)})(e.databaseInfo);return(function(o,u,h,f){return new mM(o,u,h,f)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,a,o,u,h){return new gM(r,a,o,u,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>zE(this.syncEngine,n,0)),(function(){return PE.v()?new PE:new aM})())}createSyncEngine(e,n){return(function(a,o,u,h,f,p,y){const b=new MM(a,o,u,h,f,p);return y&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=vt(n);Ge(Wo,"RemoteStore shutting down."),r.Ea.add(5),await sh(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}my.provider={build:()=>new my};class q1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const oo="FirestoreClient";class XM{constructor(e,n,r,a,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=gr.UNAUTHENTICATED,this.clientId=b1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async u=>{Ge(oo,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(r,(u=>(Ge(oo,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=V1(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function v0(t,e){t.asyncQueue.verifyOperationInProgress(),Ge(oo,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async a=>{r.isEqual(a)||(await bk(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function FE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await WM(t);Ge(oo,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>OE(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,a)=>OE(e.remoteStore,a))),t._onlineComponents=e}async function WM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ge(oo,"Using user provided OfflineComponentProvider");try{await v0(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===pe.FAILED_PRECONDITION||a.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;bc("Error using user provided cache. Falling back to memory cache: "+n),await v0(t,new zm)}}else Ge(oo,"Using default OfflineComponentProvider"),await v0(t,new QM(void 0));return t._offlineComponents}async function Lk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ge(oo,"Using user provided OnlineComponentProvider"),await FE(t,t._uninitializedComponentsProvider._online)):(Ge(oo,"Using default OnlineComponentProvider"),await FE(t,new my))),t._onlineComponents}function JM(t){return Lk(t).then((e=>e.syncEngine))}async function Bm(t){const e=await Lk(t),n=e.eventManager;return n.onListen=OM.bind(null,e.syncEngine),n.onUnlisten=UM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=LM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=zM.bind(null,e.syncEngine),n}function ZM(t,e,n={}){const r=new Yi;return t.asyncQueue.enqueueAndForget((async()=>(function(o,u,h,f,p){const y=new q1({next:x=>{y.Nu(),u.enqueueAndForget((()=>z1(o,b)));const k=x.docs.has(h);!k&&x.fromCache?p.reject(new Be(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&x.fromCache&&f&&f.source==="server"?p.reject(new Be(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(x)},error:x=>p.reject(x)}),b=new F1(wp(h.path),y,{includeMetadataChanges:!0,qa:!0});return U1(o,b)})(await Bm(t),t.asyncQueue,e,n,r))),r.promise}function eO(t,e,n={}){const r=new Yi;return t.asyncQueue.enqueueAndForget((async()=>(function(o,u,h,f,p){const y=new q1({next:x=>{y.Nu(),u.enqueueAndForget((()=>z1(o,b))),x.fromCache&&f.source==="server"?p.reject(new Be(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(x)},error:x=>p.reject(x)}),b=new F1(h,y,{includeMetadataChanges:!0,qa:!0});return U1(o,b)})(await Bm(t),t.asyncQueue,e,n,r))),r.promise}function Vk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const HE=new Map;const Uk="firestore.googleapis.com",$E=!0;class qE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Be(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Uk,this.ssl=$E}else this.host=e.host,this.ssl=e.ssl??$E;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jP)throw new Be(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vk(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Be(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Be(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Be(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dp{constructor(e,n,r,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Be(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Be(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new aD;switch(r.type){case"firstParty":return new uD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Be(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=HE.get(n);r&&(Ge("ComponentProvider","Removing Datastore"),HE.delete(n),r.terminate())})(this),Promise.resolve()}}function tO(t,e,n,r={}){t=Cr(t,Dp);const a=rl(e),o=t._getSettings(),u={...o,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(Yy(`https://${h}`),Ky("Firestore",!0)),o.host!==Uk&&o.host!==h&&bc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:h,ssl:a,emulatorOptions:r};if(!Qi(f,u)&&(t._setSettings(f),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=gr.MOCK_USER;else{p=rT(r.mockUserToken,t._app?.options.projectId);const b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new Be(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new gr(b)}t._authCredentials=new oD(new AC(p,y))}}class mi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mi(this.firestore,e,this._query)}}class En{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Za(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new En(this.firestore,e,this._key)}toJSON(){return{type:En._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(th(n,En._jsonSchema))return new En(e,r||null,new tt(an.fromString(n.referencePath)))}}En._jsonSchemaVersion="firestore/documentReference/1.0",En._jsonSchema={type:Hn("string",En._jsonSchemaVersion),referencePath:Hn("string")};class Za extends mi{constructor(e,n,r){super(e,n,wp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new En(this.firestore,null,new tt(e))}withConverter(e){return new Za(this.firestore,e,this._path)}}function _t(t,e,...n){if(t=at(t),RC("collection","path",e),t instanceof Dp){const r=an.fromString(e,...n);return iE(r),new Za(t,null,r)}{if(!(t instanceof En||t instanceof Za))throw new Be(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(an.fromString(e,...n));return iE(r),new Za(t.firestore,null,r)}}function Ne(t,e,...n){if(t=at(t),arguments.length===1&&(e=b1.newId()),RC("doc","path",e),t instanceof Dp){const r=an.fromString(e,...n);return sE(r),new En(t,null,new tt(r))}{if(!(t instanceof En||t instanceof Za))throw new Be(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(an.fromString(e,...n));return sE(r),new En(t.firestore,t instanceof Za?t.converter:null,new tt(r))}}const GE="AsyncQueue";class YE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _k(this,"async_queue_retry"),this._c=()=>{const r=g0();r&&Ge(GE,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=g0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=g0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Yi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!$c(e))throw e;Ge(GE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Zi("INTERNAL UNHANDLED ERROR: ",KE(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=L1.createAndSchedule(this,e,n,r,(o=>this.hc(o)));return this.tc.push(a),a}uc(){this.nc&&ft(47125,{Pc:KE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function KE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function QE(t){return(function(n,r){if(typeof n!="object"||n===null)return!1;const a=n;for(const o of r)if(o in a&&typeof a[o]=="function")return!0;return!1})(t,["next","error","complete"])}class ui extends Dp{constructor(e,n,r,a){super(e,n,r,a),this.type="firestore",this._queue=new YE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new YE(e),this._firestoreClient=void 0,await e}}}function nO(t,e){const n=typeof t=="object"?t:Wy(),r=typeof t=="string"?t:Dm,a=op(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const o=eT("firestore");o&&tO(a,...o)}return a}function ah(t){if(t._terminated)throw new Be(pe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||rO(t),t._firestoreClient}function rO(t){const e=t._freezeSettings(),n=(function(a,o,u,h){return new ND(a,o,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Vk(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new XM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const o=a?._online.build();return{_offline:a?._offline.build(o),_online:o}})(t._componentsProvider))}class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(fr.fromBase64String(e))}catch(n){throw new Be(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ms(fr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ms._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(th(e,ms._jsonSchema))return ms.fromBase64String(e.bytes)}}ms._jsonSchemaVersion="firestore/bytes/1.0",ms._jsonSchema={type:Hn("string",ms._jsonSchemaVersion),bytes:Hn("string")};class oh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Be(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cl{constructor(e){this._methodName=e}}class ai{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Be(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Be(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ot(this._lat,e._lat)||Ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ai._jsonSchemaVersion}}static fromJSON(e){if(th(e,ai._jsonSchema))return new ai(e.latitude,e.longitude)}}ai._jsonSchemaVersion="firestore/geoPoint/1.0",ai._jsonSchema={type:Hn("string",ai._jsonSchemaVersion),latitude:Hn("number"),longitude:Hn("number")};class oi{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==a[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:oi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(th(e,oi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new oi(e.vectorValues);throw new Be(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}oi._jsonSchemaVersion="firestore/vectorValue/1.0",oi._jsonSchema={type:Hn("string",oi._jsonSchemaVersion),vectorValues:Hn("object")};const sO=/^__.*__$/;class iO{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new uo(e,this.data,this.fieldMask,n,this.fieldTransforms):new nh(e,this.data,n,this.fieldTransforms)}}class zk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new uo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Bk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft(40011,{Ac:t})}}class Pp{constructor(e,n,r,a,o,u){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Pp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Bk(this.Ac)&&sO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class aO{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Rp(e)}Cc(e,n,r,a=!1){return new Pp({Ac:e,methodName:n,Dc:r,path:hr.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gc(t){const e=t._freezeSettings(),n=Rp(t._databaseId);return new aO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function G1(t,e,n,r,a,o={}){const u=t.Cc(o.merge||o.mergeFields?2:0,e,n,a);W1("Data must be an object, but it was:",u,r);const h=Gk(r,u);let f,p;if(o.merge)f=new es(u.fieldMask),p=u.fieldTransforms;else if(o.mergeFields){const y=[];for(const b of o.mergeFields){const x=py(e,b,n);if(!u.contains(x))throw new Be(pe.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);Kk(y,x)||y.push(x)}f=new es(y),p=u.fieldTransforms.filter((b=>f.covers(b.field)))}else f=null,p=u.fieldTransforms;return new iO(new Ur(h),f,p)}class lh extends cl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lh}}function Fk(t,e,n){return new Pp({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Y1 extends cl{_toFieldTransform(e){return new Cp(e.path,new Od)}isEqual(e){return e instanceof Y1}}class K1 extends cl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=Fk(this,e,!0),r=this.vc.map((o=>ul(o,n))),a=new Sc(r);return new Cp(e.path,a)}isEqual(e){return e instanceof K1&&Qi(this.vc,e.vc)}}class Q1 extends cl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=Fk(this,e,!0),r=this.vc.map((o=>ul(o,n))),a=new Tc(r);return new Cp(e.path,a)}isEqual(e){return e instanceof Q1&&Qi(this.vc,e.vc)}}class X1 extends cl{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Ld(e.serializer,ek(e.serializer,this.Fc));return new Cp(e.path,n)}isEqual(e){return e instanceof X1&&this.Fc===e.Fc}}function Hk(t,e,n,r){const a=t.Cc(1,e,n);W1("Data must be an object, but it was:",a,r);const o=[],u=Ur.empty();co(r,((f,p)=>{const y=J1(e,f,n);p=at(p);const b=a.yc(y);if(p instanceof lh)o.push(y);else{const x=ul(p,b);x!=null&&(o.push(y),u.set(y,x))}}));const h=new es(o);return new zk(u,h,a.fieldTransforms)}function $k(t,e,n,r,a,o){const u=t.Cc(1,e,n),h=[py(e,r,n)],f=[a];if(o.length%2!=0)throw new Be(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)h.push(py(e,o[x])),f.push(o[x+1]);const p=[],y=Ur.empty();for(let x=h.length-1;x>=0;--x)if(!Kk(p,h[x])){const k=h[x];let I=f[x];I=at(I);const A=u.yc(k);if(I instanceof lh)p.push(k);else{const N=ul(I,A);N!=null&&(p.push(k),y.set(k,N))}}const b=new es(p);return new zk(y,b,u.fieldTransforms)}function qk(t,e,n,r=!1){return ul(n,t.Cc(r?4:3,e))}function ul(t,e){if(Yk(t=at(t)))return W1("Unsupported field value:",e,t),Gk(t,e);if(t instanceof cl)return(function(r,a){if(!Bk(a.Ac))throw a.Sc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(a);o&&a.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,a){const o=[];let u=0;for(const h of r){let f=ul(h,a.wc(u));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),u++}return{arrayValue:{values:o}}})(t,e)}return(function(r,a){if((r=at(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ek(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=hn.fromDate(r);return{timestampValue:Lm(a.serializer,o)}}if(r instanceof hn){const o=new hn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Lm(a.serializer,o)}}if(r instanceof ai)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ms)return{bytesValue:uk(a.serializer,r._byteString)};if(r instanceof En){const o=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(o))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:N1(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof oi)return(function(u,h){return{mapValue:{fields:{[UC]:{stringValue:zC},[Pm]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return T1(h.serializer,p)}))}}}}}})(r,a);throw a.Sc(`Unsupported field value: ${vp(r)}`)})(t,e)}function Gk(t,e){const n={};return DC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):co(t,((r,a)=>{const o=ul(a,e.mc(r));o!=null&&(n[r]=o)})),{mapValue:{fields:n}}}function Yk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof hn||t instanceof ai||t instanceof ms||t instanceof En||t instanceof cl||t instanceof oi)}function W1(t,e,n){if(!Yk(n)||!IC(n)){const r=vp(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function py(t,e,n){if((e=at(e))instanceof oh)return e._internalPath;if(typeof e=="string")return J1(t,e);throw Fm("Field path arguments must be of type string or ",t,!1,void 0,n)}const oO=new RegExp("[~\\*/\\[\\]]");function J1(t,e,n){if(e.search(oO)>=0)throw Fm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new oh(...e.split("."))._internalPath}catch{throw Fm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Fm(t,e,n,r,a){const o=r&&!r.isEmpty(),u=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||u)&&(f+=" (found",o&&(f+=` in field ${r}`),u&&(f+=` in document ${a}`),f+=")"),new Be(pe.INVALID_ARGUMENT,h+t+f)}function Kk(t,e){return t.some((n=>n.isEqual(e)))}class Z1{constructor(e,n,r,a,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new En(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Mp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lO extends Z1{data(){return super.data()}}function Mp(t,e){return typeof e=="string"?J1(t,e):e instanceof oh?e._internalPath:e._delegate._internalPath}function Qk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Be(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eb{}class Op extends eb{}function zr(t,e,...n){let r=[];e instanceof eb&&r.push(e),r=r.concat(n),(function(o){const u=o.filter((f=>f instanceof tb)).length,h=o.filter((f=>f instanceof Lp)).length;if(u>1||u>0&&h>0)throw new Be(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)t=a._apply(t);return t}class Lp extends Op{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Lp(e,n,r)}_apply(e){const n=this._parse(e);return Xk(e._query,n),new mi(e.firestore,e.converter,iy(e._query,n))}_parse(e){const n=Gc(e.firestore);return(function(o,u,h,f,p,y,b){let x;if(p.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new Be(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){WE(b,y);const I=[];for(const A of b)I.push(XE(f,o,A));x={arrayValue:{values:I}}}else x=XE(f,o,b)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||WE(b,y),x=qk(h,u,b,y==="in"||y==="not-in");return Fn.create(p,y,x)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Vi(t,e,n){const r=e,a=Mp("where",t);return Lp._create(a,r,n)}class tb extends eb{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new tb(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Ms.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,o){let u=a;const h=o.getFlattenedFilters();for(const f of h)Xk(u,f),u=iy(u,f)})(e._query,n),new mi(e.firestore,e.converter,iy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class nb extends Op{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new nb(e,n)}_apply(e){const n=(function(a,o,u){if(a.startAt!==null)throw new Be(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Be(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Md(o,u)})(e._query,this._field,this._direction);return new mi(e.firestore,e.converter,(function(a,o){const u=a.explicitOrderBy.concat([o]);return new al(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,n))}}function Hm(t,e="asc"){const n=e,r=Mp("orderBy",t);return nb._create(r,n)}class rb extends Op{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new rb(e,n,r)}_apply(e){return new mi(e.firestore,e.converter,Om(e._query,this._limit,this._limitType))}}function gy(t){return vD("limit",t),rb._create("limit",t,"F")}class sb extends Op{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new sb(e,n,r)}_apply(e){const n=uO(e,this.type,this._docOrFields,this._inclusive);return new mi(e.firestore,e.converter,(function(a,o){return new al(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,o,a.endAt)})(e._query,n))}}function cO(...t){return sb._create("startAfter",t,!1)}function uO(t,e,n,r){if(n[0]=at(n[0]),n[0]instanceof Z1)return(function(o,u,h,f,p){if(!f)throw new Be(pe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const y=[];for(const b of hc(o))if(b.field.isKeyField())y.push(Mm(u,f.key));else{const x=f.data.field(b.field);if(xp(x))throw new Be(pe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(x===null){const k=b.field.canonicalString();throw new Be(pe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${k}' (used as the orderBy) does not exist.`)}y.push(x)}return new Ec(y,p)})(t._query,t.firestore._databaseId,e,n[0]._document,r);{const a=Gc(t.firestore);return(function(u,h,f,p,y,b){const x=u.explicitOrderBy;if(y.length>x.length)throw new Be(pe.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const k=[];for(let I=0;I<y.length;I++){const A=y[I];if(x[I].field.isKeyField()){if(typeof A!="string")throw new Be(pe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof A}`);if(!S1(u)&&A.indexOf("/")!==-1)throw new Be(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${A}' contains a slash.`);const N=u.path.child(an.fromString(A));if(!tt.isDocumentKey(N))throw new Be(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const V=new tt(N);k.push(Mm(h,V))}else{const N=qk(f,p,A);k.push(N)}}return new Ec(k,b)})(t._query,t.firestore._databaseId,a,e,n,r)}}function XE(t,e,n){if(typeof(n=at(n))=="string"){if(n==="")throw new Be(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!S1(e)&&n.indexOf("/")!==-1)throw new Be(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(an.fromString(n));if(!tt.isDocumentKey(r))throw new Be(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Mm(t,new tt(r))}if(n instanceof En)return Mm(t,n._key);throw new Be(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vp(n)}.`)}function WE(t,e){if(!Array.isArray(t)||t.length===0)throw new Be(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Xk(t,e){const n=(function(a,o){for(const u of a)for(const h of u.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Be(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Be(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class dO{convertValue(e,n="none"){switch(io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return An(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ft(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return co(e,((a,o)=>{r[a]=this.convertValue(o,n)})),r}convertVectorValue(e){const n=e.fields?.[Pm].arrayValue?.values?.map((r=>An(r.doubleValue)));return new oi(n)}convertGeoPoint(e){return new ai(An(e.latitude),An(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=_p(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jd(e));default:return null}}convertTimestamp(e){const n=ro(e);return new hn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=an.fromString(e);Qt(gk(r),9688,{name:e});const a=new Dd(r.get(1),r.get(3)),o=new tt(r.popFirst(5));return a.isEqual(n)||Zi(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}function ib(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class hd{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qo extends Z1{constructor(e,n,r,a,o,u){super(e,n,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new um(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Mp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Be(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=qo._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",qo._jsonSchema={type:Hn("string",qo._jsonSchemaVersion),bundleSource:Hn("string","DocumentSnapshot"),bundleName:Hn("string"),bundle:Hn("string")};class um extends qo{data(e={}){return super.data(e)}}class Go{constructor(e,n,r,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new hd(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new um(this._firestore,this._userDataWriter,r.key,r,new hd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Be(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,o){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((h=>{const f=new um(a._firestore,a._userDataWriter,h.doc.key,h.doc,new hd(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const f=new um(a._firestore,a._userDataWriter,h.doc.key,h.doc,new hd(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,y=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),y=u.indexOf(h.doc.key)),{type:hO(h.type),doc:f,oldIndex:p,newIndex:y}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Be(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Go._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=b1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],a=[];return this.docs.forEach((o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function hO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft(61501,{type:t})}}function Jo(t){t=Cr(t,En);const e=Cr(t.firestore,ui);return ZM(ah(e),t._key).then((n=>Wk(e,t,n)))}Go._jsonSchemaVersion="firestore/querySnapshot/1.0",Go._jsonSchema={type:Hn("string",Go._jsonSchemaVersion),bundleSource:Hn("string","QuerySnapshot"),bundleName:Hn("string"),bundle:Hn("string")};class ab extends dO{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,n)}}function di(t){t=Cr(t,mi);const e=Cr(t.firestore,ui),n=ah(e),r=new ab(e);return Qk(t._query),eO(n,t._query).then((a=>new Go(e,r,t,a)))}function Xn(t,e,n){t=Cr(t,En);const r=Cr(t.firestore,ui),a=ib(t.converter,e,n);return ch(r,[G1(Gc(r),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,kr.none())])}function it(t,e,n,...r){t=Cr(t,En);const a=Cr(t.firestore,ui),o=Gc(a);let u;return u=typeof(e=at(e))=="string"||e instanceof oh?$k(o,"updateDoc",t._key,e,n,r):Hk(o,"updateDoc",t._key,e),ch(a,[u.toMutation(t._key,kr.exists(!0))])}function ts(t){return ch(Cr(t.firestore,ui),[new Np(t._key,kr.none())])}function Kn(t,e){const n=Cr(t.firestore,ui),r=Ne(t),a=ib(t.converter,e);return ch(n,[G1(Gc(t.firestore),"addDoc",r._key,a,t.converter!==null,{}).toMutation(r._key,kr.exists(!1))]).then((()=>r))}function Sr(t,...e){t=at(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||QE(e[r])||(n=e[r++]);const a={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(QE(e[r])){const f=e[r];e[r]=f.next?.bind(f),e[r+1]=f.error?.bind(f),e[r+2]=f.complete?.bind(f)}let o,u,h;if(t instanceof En)u=Cr(t.firestore,ui),h=wp(t._key.path),o={next:f=>{e[r]&&e[r](Wk(u,t,f))},error:e[r+1],complete:e[r+2]};else{const f=Cr(t,mi);u=Cr(f.firestore,ui),h=f._query;const p=new ab(u);o={next:y=>{e[r]&&e[r](new Go(u,p,f,y))},error:e[r+1],complete:e[r+2]},Qk(t._query)}return(function(p,y,b,x){const k=new q1(x),I=new F1(y,k,b);return p.asyncQueue.enqueueAndForget((async()=>U1(await Bm(p),I))),()=>{k.Nu(),p.asyncQueue.enqueueAndForget((async()=>z1(await Bm(p),I)))}})(ah(u),h,a,o)}function ch(t,e){return(function(r,a){const o=new Yi;return r.asyncQueue.enqueueAndForget((async()=>BM(await JM(r),a,o))),o.promise})(ah(t),e)}function Wk(t,e,n){const r=n.docs.get(e._key),a=new ab(t);return new qo(t,a,e._key,r,new hd(n.hasPendingWrites,n.fromCache),e.converter)}class fO{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Gc(e)}set(e,n,r){this._verifyNotCommitted();const a=y0(e,this._firestore),o=ib(a.converter,n,r),u=G1(this._dataReader,"WriteBatch.set",a._key,o,a.converter!==null,r);return this._mutations.push(u.toMutation(a._key,kr.none())),this}update(e,n,r,...a){this._verifyNotCommitted();const o=y0(e,this._firestore);let u;return u=typeof(n=at(n))=="string"||n instanceof oh?$k(this._dataReader,"WriteBatch.update",o._key,n,r,a):Hk(this._dataReader,"WriteBatch.update",o._key,n),this._mutations.push(u.toMutation(o._key,kr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=y0(e,this._firestore);return this._mutations=this._mutations.concat(new Np(n._key,kr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Be(pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function y0(t,e){if((t=at(t)).firestore!==e)throw new Be(pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function JE(){return new lh("deleteField")}function ht(){return new Y1("serverTimestamp")}function uh(...t){return new K1("arrayUnion",t)}function Vd(...t){return new Q1("arrayRemove",t)}function Ui(t){return new X1("increment",t)}function ZE(t){return ah(t=Cr(t,ui)),new fO(t,(e=>ch(t,e)))}(function(e,n=!0){(function(a){Fc=a})(sl),Qo(new to("firestore",((r,{instanceIdentifier:a,options:o})=>{const u=r.getProvider("app").getImmediate(),h=new ui(new lD(r.getProvider("auth-internal")),new dD(u,r.getProvider("app-check-internal")),(function(p,y){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Be(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dd(p.options.projectId,y)})(u,a),u);return o={useFetchStreams:n,...o},h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),ri(eE,tE,e),ri(eE,tE,"esm2020")})();const Jk="firebasestorage.googleapis.com",mO="storageBucket",pO=120*1e3,gO=600*1e3;class pi extends fi{constructor(e,n,r=0){super(b0(e),`Firebase Storage: ${n} (${b0(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,pi.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return b0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hi;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hi||(hi={}));function b0(t){return"storage/"+t}function vO(){const t="An unknown error occurred, please check the error payload for server response.";return new pi(hi.UNKNOWN,t)}function yO(){return new pi(hi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bO(){return new pi(hi.CANCELED,"User canceled the upload/download.")}function xO(t){return new pi(hi.INVALID_URL,"Invalid URL '"+t+"'.")}function _O(t){return new pi(hi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function eS(t){return new pi(hi.INVALID_ARGUMENT,t)}function Zk(){return new pi(hi.APP_DELETED,"The Firebase app was deleted.")}function wO(t){return new pi(hi.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class js{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=js.makeFromUrl(e,n)}catch{return new js(e,"")}if(r.path==="")return r;throw _O(e)}static makeFromUrl(e,n){let r=null;const a="([A-Za-z0-9.\\-_]+)";function o(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const u="(/(.*))?$",h=new RegExp("^gs://"+a+u,"i"),f={bucket:1,path:3};function p(O){O.path_=decodeURIComponent(O.path)}const y="v[A-Za-z0-9_]+",b=n.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",k=new RegExp(`^https?://${b}/${y}/b/${a}/o${x}`,"i"),I={bucket:1,path:3},A=n===Jk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",V=new RegExp(`^https?://${A}/${a}/${N}`,"i"),j=[{regex:h,indices:f,postModify:o},{regex:k,indices:I,postModify:p},{regex:V,indices:{bucket:1,path:2},postModify:p}];for(let O=0;O<j.length;O++){const B=j[O],H=B.regex.exec(e);if(H){const w=H[B.indices.bucket];let S=H[B.indices.path];S||(S=""),r=new js(w,S),B.postModify(r);break}}if(r==null)throw xO(e);return r}}class EO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function SO(t,e,n){let r=1,a=null,o=null,u=!1,h=0;function f(){return h===2}let p=!1;function y(...N){p||(p=!0,e.apply(null,N))}function b(N){a=setTimeout(()=>{a=null,t(k,f())},N)}function x(){o&&clearTimeout(o)}function k(N,...V){if(p){x();return}if(N){x(),y.call(null,N,...V);return}if(f()||u){x(),y.call(null,N,...V);return}r<64&&(r*=2);let j;h===1?(h=2,j=0):j=(r+Math.random())*1e3,b(j)}let I=!1;function A(N){I||(I=!0,x(),!p&&(a!==null?(N||(h=2),clearTimeout(a),b(0)):N||(h=1)))}return b(0),o=setTimeout(()=>{u=!0,A(!0)},n),A}function TO(t){t(!1)}function CO(t){return t!==void 0}function tS(t,e,n,r){if(r<e)throw eS(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw eS(`Invalid value for '${t}'. Expected ${n} or less.`)}function kO(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const a=e(r)+"="+e(t[r]);n=n+a+"&"}return n=n.slice(0,-1),n}var $m;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})($m||($m={}));function NO(t,e){const n=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||a||o}class AO{constructor(e,n,r,a,o,u,h,f,p,y,b,x=!0,k=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=h,this.errorCallback_=f,this.timeout_=p,this.progressCallback_=y,this.connectionFactory_=b,this.retry=x,this.isUsingEmulator=k,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,A)=>{this.resolve_=I,this.reject_=A,this.start_()})}start_(){const e=(r,a)=>{if(a){r(!1,new $f(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const u=h=>{const f=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,p)};this.progressCallback_!==null&&o.addUploadProgressListener(u),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(u),this.pendingConnection_=null;const h=o.getErrorCode()===$m.NO_ERROR,f=o.getStatus();if(!h||NO(f,this.additionalRetryCodes_)&&this.retry){const y=o.getErrorCode()===$m.ABORT;r(!1,new $f(!1,null,y));return}const p=this.successCodes_.indexOf(f)!==-1;r(!0,new $f(p,o))})},n=(r,a)=>{const o=this.resolve_,u=this.reject_,h=a.connection;if(a.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());CO(f)?o(f):o()}catch(f){u(f)}else if(h!==null){const f=vO();f.serverResponse=h.getErrorText(),this.errorCallback_?u(this.errorCallback_(h,f)):u(f)}else if(a.canceled){const f=this.appDelete_?Zk():bO();u(f)}else{const f=yO();u(f)}};this.canceled_?n(!1,new $f(!1,null,!0)):this.backoffId_=SO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class $f{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function RO(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IO(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function jO(t,e){e&&(t["X-Firebase-GMPID"]=e)}function DO(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function PO(t,e,n,r,a,o,u=!0,h=!1){const f=kO(t.urlParams),p=t.url+f,y=Object.assign({},t.headers);return jO(y,e),RO(y,n),IO(y,o),DO(y,r),new AO(p,t.method,y,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,u,h)}function MO(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function OO(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class qm{constructor(e,n){this._service=e,n instanceof js?this._location=n:this._location=js.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new qm(e,n)}get root(){const e=new js(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return OO(this._location.path)}get storage(){return this._service}get parent(){const e=MO(this._location.path);if(e===null)return null;const n=new js(this._location.bucket,e);return new qm(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw wO(e)}}function nS(t,e){const n=e?.[mO];return n==null?null:js.makeFromBucketSpec(n,t)}function LO(t,e,n,r={}){t.host=`${e}:${n}`;const a=rl(e);a&&(Yy(`https://${t.host}/b`),Ky("Storage",!0)),t._isUsingEmulator=!0,t._protocol=a?"https":"http";const{mockUserToken:o}=r;o&&(t._overrideAuthToken=typeof o=="string"?o:rT(o,t.app.options.projectId))}class VO{constructor(e,n,r,a,o,u=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=a,this._firebaseVersion=o,this._isUsingEmulator=u,this._bucket=null,this._host=Jk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=pO,this._maxUploadRetryTime=gO,this._requests=new Set,a!=null?this._bucket=js.makeFromBucketSpec(a,this._host):this._bucket=nS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=js.makeFromBucketSpec(this._url,e):this._bucket=nS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qm(this,e)}_makeRequest(e,n,r,a,o=!0){if(this._deleted)return new EO(Zk());{const u=PO(e,this._appId,r,a,n,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,n){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,a).getPromise()}}const rS="@firebase/storage",sS="0.14.0";const eN="storage";function UO(t=Wy(),e){t=at(t);const r=op(t,eN).getImmediate({identifier:e}),a=eT("storage");return a&&zO(r,...a),r}function zO(t,e,n,r={}){LO(t,e,n,r)}function BO(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new VO(n,r,a,e,sl)}function FO(){Qo(new to(eN,BO,"PUBLIC").setMultipleInstances(!0)),ri(rS,sS,""),ri(rS,sS,"esm2020")}FO();const HO={apiKey:"AIzaSyAaaBO8Nw49Xsyo4QG1ropL0UYWeY2zrlU",authDomain:"meydan-academy.firebaseapp.com",projectId:"meydan-academy",storageBucket:"meydan-academy.firebasestorage.app",messagingSenderId:"267697346186",appId:"1:267697346186:web:d53b7d91fe0fabf8d37f73"},ob=aT(HO),ks=_C(ob),le=nO(ob);UO(ob);var Nc;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Nc||(Nc={}));class x0 extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const $O=t=>{var e,n;return t?.androidBridge?"android":!((n=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},qO=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},a=()=>e!==null?e.name:$O(t),o=()=>a()!=="web",u=b=>{const x=p.get(b);return!!(x?.platforms.has(a())||h(b))},h=b=>{var x;return(x=n.PluginHeaders)===null||x===void 0?void 0:x.find(k=>k.name===b)},f=b=>t.console.error(b),p=new Map,y=(b,x={})=>{const k=p.get(b);if(k)return console.warn(`Capacitor plugin "${b}" already registered. Cannot register plugins twice.`),k.proxy;const I=a(),A=h(b);let N;const V=async()=>(!N&&I in x?N=typeof x[I]=="function"?N=await x[I]():N=x[I]:e!==null&&!N&&"web"in x&&(N=typeof x.web=="function"?N=await x.web():N=x.web),N),F=(S,R)=>{var D,L;if(A){const U=A?.methods.find(P=>R===P.name);if(U)return U.rtype==="promise"?P=>n.nativePromise(b,R.toString(),P):(P,ne)=>n.nativeCallback(b,R.toString(),P,ne);if(S)return(D=S[R])===null||D===void 0?void 0:D.bind(S)}else{if(S)return(L=S[R])===null||L===void 0?void 0:L.bind(S);throw new x0(`"${b}" plugin is not implemented on ${I}`,Nc.Unimplemented)}},j=S=>{let R;const D=(...L)=>{const U=V().then(P=>{const ne=F(P,S);if(ne){const oe=ne(...L);return R=oe?.remove,oe}else throw new x0(`"${b}.${S}()" is not implemented on ${I}`,Nc.Unimplemented)});return S==="addListener"&&(U.remove=async()=>R()),U};return D.toString=()=>`${S.toString()}() { [capacitor code] }`,Object.defineProperty(D,"name",{value:S,writable:!1,configurable:!1}),D},O=j("addListener"),B=j("removeListener"),H=(S,R)=>{const D=O({eventName:S},R),L=async()=>{const P=await D;B({eventName:S,callbackId:P},R)},U=new Promise(P=>D.then(()=>P({remove:L})));return U.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await L()},U},w=new Proxy({},{get(S,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return A?H:O;case"removeListener":return B;default:return j(R)}}});return r[b]=w,p.set(b,{name:b,proxy:w,platforms:new Set([...Object.keys(x),...A?[I]:[]])}),w};return n.convertFileSrc||(n.convertFileSrc=b=>b),n.getPlatform=a,n.handleError=f,n.isNativePlatform=o,n.isPluginAvailable=u,n.registerPlugin=y,n.Exception=x0,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},GO=t=>t.Capacitor=qO(t),ta=GO(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),dh=ta.registerPlugin;class lb{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),r&&this.sendRetainedArgumentsForEvent(e);const u=async()=>this.removeListener(e,n);return Promise.resolve({remove:u})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const a=this.listeners[e];if(!a){if(r){let o=this.retainedEventArguments[e];o||(o=[]),o.push(n),this.retainedEventArguments[e]=o}return}a.forEach(o=>o(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new ta.Exception(e,Nc.Unimplemented)}unavailable(e="not available"){return new ta.Exception(e,Nc.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const a=r.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const iS=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),aS=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class YO extends lb{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,o]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=aS(a).trim(),o=aS(o).trim(),n[a]=o}),n}async setCookie(e){try{const n=iS(e.key),r=iS(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),u=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${a}; path=${o}; ${u};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}dh("CapacitorCookies",{web:()=>new YO});const KO=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>n(a),r.readAsDataURL(t)}),QO=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,o,u)=>(a[o]=t[e[u]],a),{})},XO=(t,e=!0)=>t?Object.entries(t).reduce((r,a)=>{const[o,u]=a;let h,f;return Array.isArray(u)?(f="",u.forEach(p=>{h=e?encodeURIComponent(p):p,f+=`${o}=${h}&`}),f.slice(0,-1)):(h=e?encodeURIComponent(u):u,f=`${o}=${h}`),`${r}&${f}`},"").substr(1):null,WO=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=QO(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[u,h]of Object.entries(t.data||{}))o.set(u,h);n.body=o.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const o=new FormData;if(t.data instanceof FormData)t.data.forEach((h,f)=>{o.append(f,h)});else for(const h of Object.keys(t.data))o.append(h,t.data[h]);n.body=o;const u=new Headers(n.headers);u.delete("content-type"),n.headers=u}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class JO extends lb{async request(e){const n=WO(e,e.webFetchExtra),r=XO(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,o=await fetch(a,n),u=o.headers.get("content-type")||"";let{responseType:h="text"}=o.ok?e:{};u.includes("application/json")&&(h="json");let f,p;switch(h){case"arraybuffer":case"blob":p=await o.blob(),f=await KO(p);break;case"json":f=await o.json();break;case"document":case"text":default:f=await o.text()}const y={};return o.headers.forEach((b,x)=>{y[x]=b}),{data:f,headers:y,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}dh("CapacitorHttp",{web:()=>new JO});var oS;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(oS||(oS={}));var lS;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})(lS||(lS={}));class ZO extends lb{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}dh("SystemBars",{web:()=>new ZO});const e7="modulepreload",t7=function(t,e){return new URL(t,e).href},cS={},tN=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let p=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const u=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),f=h?.nonce||h?.getAttribute("nonce");a=p(n.map(y=>{if(y=t7(y,r),y in cS)return;cS[y]=!0;const b=y.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(r)for(let I=u.length-1;I>=0;I--){const A=u[I];if(A.href===y&&(!b||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${x}`))return;const k=document.createElement("link");if(k.rel=b?"stylesheet":e7,b||(k.as="script"),k.crossOrigin="",k.href=y,f&&k.setAttribute("nonce",f),document.head.appendChild(k),b)return new Promise((I,A)=>{k.addEventListener("load",I),k.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${y}`)))})}))}function o(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return a.then(u=>{for(const h of u||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})},nN=dh("GoogleAuth",{web:()=>tN(()=>import("./web-lClm3k81.js"),[],import.meta.url).then(t=>new t.GoogleAuthWeb)}),rN=T.createContext({}),yn=()=>{const t=T.useContext(rN);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},n7=({children:t})=>{const[e,n]=T.useState(null),[r,a]=T.useState(null),[o,u]=T.useState(!0),h=async(A,N=!0)=>{if(A)try{await Xn(Ne(le,"users",A),{isOnline:N,lastSeen:ht()},{merge:!0})}catch(V){console.error("Presence update failed:",V)}};T.useEffect(()=>{let A=null;const N=ZT(ks,async V=>{A&&(A(),A=null),n(V),V?(A=Sr(Ne(le,"users",V.uid),F=>{F.exists()&&a({id:F.id,...F.data()})},F=>console.error("[AuthContext] Profile listener error:",F)),h(V.uid).catch(()=>{}),u(!1)):(a(null),u(!1))});return()=>{N(),A&&A()}},[]);const I={currentUser:e,userProfile:r,register:async(A,N,V)=>{const F=await qT(ks,A,N);try{await W0(F.user)}catch(j){console.error("Error sending verification email:",j)}return await Xn(Ne(le,"users",F.user.uid),{displayName:V,email:A,role:"member",createdAt:ht(),isOnline:!0,lastSeen:ht(),isUsernameSet:!0}),F},login:async(A,N)=>{const V=await GT(ks,A,N),F=await Jo(Ne(le,"users",V.user.uid)),j={isOnline:!0,lastSeen:ht()};return F.exists()&&F.data()?.isUsernameSet===void 0&&F.data()?.displayName&&(j.isUsernameSet=!0),await Xn(Ne(le,"users",V.user.uid),j,{merge:!0}),V},logout:async()=>{if(e)try{await h(e.uid,!1)}catch{console.log("[AuthContext] Final presence update skipped or failed during logout")}return eC(ks)},signInWithGoogle:async()=>{let A;try{if(ta.isNativePlatform()){console.log("[GoogleAuth] Starting native sign-in...");const V=await nN.signIn();console.log("[GoogleAuth] Got Google user:",JSON.stringify(V,null,2));const F=Rs.credential(V.authentication.idToken);console.log("[GoogleAuth] Created Firebase credential, signing in..."),A=await Jd(ks,F),console.log("[GoogleAuth] Firebase sign-in successful!")}else{const V=new Rs;A=await dC(ks,V)}const N=await Jo(Ne(le,"users",A.user.uid));if(!N.exists())await Xn(Ne(le,"users",A.user.uid),{displayName:A.user.displayName,email:A.user.email,photoURL:A.user.photoURL,role:"member",createdAt:ht(),isOnline:!0,lastSeen:ht(),isUsernameSet:!1});else{const V={isOnline:!0,lastSeen:ht()};N.data()?.isUsernameSet===void 0&&N.data()?.displayName&&(V.isUsernameSet=!0),await Xn(Ne(le,"users",A.user.uid),V,{merge:!0})}return A}catch(N){throw console.error("[GoogleAuth] ERROR:",N),console.error("[GoogleAuth] Error code:",N.code),console.error("[GoogleAuth] Error message:",N.message),console.error("[GoogleAuth] Full error:",JSON.stringify(N,Object.getOwnPropertyNames(N),2)),N}},resetPassword:A=>c1(ks,A),resendVerification:async()=>{let A=ks.currentUser||e;if(!A)throw new Error("No user currently signed in.");if(A.email||(await A.reload(),A=ks.currentUser),!A.email)throw new Error("No email associated with this account. Please sign in again.");return W0(A)}};return c.jsx(rN.Provider,{value:I,children:!o&&t})};let _0=null;const r7=()=>(_0||(_0=new(window.AudioContext||window.webkitAudioContext)),_0),vy=()=>{try{const t=r7(),e=t.currentTime,n=t.createOscillator(),r=t.createGain();n.connect(r),r.connect(t.destination),n.frequency.value=880,n.type="sine",r.gain.setValueAtTime(0,e),r.gain.linearRampToValueAtTime(.2,e+.01),r.gain.linearRampToValueAtTime(0,e+.1),n.start(e),n.stop(e+.1);const a=t.createOscillator(),o=t.createGain();a.connect(o),o.connect(t.destination),a.frequency.value=660,a.type="sine",o.gain.setValueAtTime(0,e+.08),o.gain.linearRampToValueAtTime(.2,e+.09),o.gain.linearRampToValueAtTime(0,e+.25),a.start(e+.08),a.stop(e+.25)}catch(t){console.error("Error playing notification sound:",t)}},s7=(t,e)=>!t||!e?!1:/@everyone\b/i.test(t)?!0:new RegExp(`@${e}\\b`,"i").test(t),sN=T.createContext(),aa=()=>{const t=T.useContext(sN);if(!t)throw new Error("useData must be used within DataProvider");return t},i7=({children:t})=>{const{currentUser:e}=yn(),[n,r]=T.useState([]),[a,o]=T.useState([]),[u,h]=T.useState(null),[f,p]=T.useState([]),[y,b]=T.useState(null),[x,k]=T.useState({}),[I,A]=T.useState({}),[N,V]=T.useState([]),F=T.useRef({}),j=T.useRef(!0);T.useEffect(()=>{if(r([]),!u)return;const w=Sr(_t(le,"servers",u,"members"),async D=>{const L=[],U=[],P=new Map;if(D.docChanges().forEach(ne=>{const oe=ne.doc.data();ne.type==="added"&&(L.push(oe.userId),P.set(oe.userId,oe.role)),ne.type==="removed"&&U.push(oe.userId),ne.type==="modified"&&P.set(oe.userId,oe.role)}),n.length===0&&L.length>0){const ne=new Map;D.docs.forEach(Z=>{ne.set(Z.data().userId,Z.data().role||"member")});const oe=Array.from(ne.keys()),G=[];for(let Z=0;Z<oe.length;Z+=10){const J=oe.slice(Z,Z+10),Se=zr(_t(le,"users"),Vi("__name__","in",J));(await di(Se)).forEach($=>{G.push({id:$.id,...$.data(),serverRole:ne.get($.id)})})}r(G);return}if(L.length>0&&n.length>0){const ne=[];for(let oe=0;oe<L.length;oe+=10){const G=L.slice(oe,oe+10),Z=zr(_t(le,"users"),Vi("__name__","in",G));(await di(Z)).forEach(Se=>{ne.push({id:Se.id,...Se.data(),serverRole:P.get(Se.id)})})}r(oe=>[...oe,...ne])}U.length>0&&r(ne=>ne.filter(oe=>!U.includes(oe.id))),D.docChanges().some(ne=>ne.type==="modified")&&r(ne=>ne.map(oe=>P.has(oe.id)?{...oe,serverRole:P.get(oe.id)}:oe))}),S=zr(_t(le,"users"),Vi("servers","array-contains",u),Vi("isOnline","==",!0)),R=Sr(S,D=>{r(L=>{const U=new Map;return D.forEach(P=>{const ne=P.data();U.set(P.id,{presence:ne.presence,isOnline:ne.isOnline,status:ne.status,lastSeen:ne.lastSeen,displayName:ne.displayName,photoUrl:ne.photoUrl||ne.photoURL,bio:ne.bio,role:ne.role})}),L.map(P=>{const ne=U.get(P.id);return ne?{...P,...ne}:{...P,isOnline:!1,presence:"offline",status:null}})})});return()=>{w(),R()}},[u]);const[O,B]=T.useState([]);T.useEffect(()=>{if(!e){o([]),h(null),B([]);return}return Sr(Ne(le,"users",e.uid),S=>{if(!S.exists())return;const R=S.data(),D=R?.servers||[],L=R?.unreadMentions||{};Object.keys(L).forEach(U=>{const P=F.current[U]||0;(L[U]?.count||0)>P&&U!==u&&vy()}),F.current=Object.fromEntries(Object.entries(L).map(([U,P])=>[U,P.count])),k(L),A(R?.unreadDms||{}),B(U=>JSON.stringify(U)!==JSON.stringify(D)?D:U),h(U=>{const P=R?.currentServer;return U?U==="home"||D.includes(U)?U:D.length>0?D[0]:"home":P&&(P==="home"||D.includes(P))?P:D.length>0?D[0]:"home"})})},[e]),T.useEffect(()=>{if(o(S=>S.filter(R=>O.includes(R.id))),O.length===0){o([]);return}const w=[];for(let S=0;S<O.length;S+=10){const R=O.slice(S,S+10),D=zr(_t(le,"servers"),Vi("__name__","in",R)),L=Sr(D,U=>{const P=[];U.forEach(ne=>{P.push({id:ne.id,...ne.data()})}),o(ne=>[...ne.filter(Z=>!R.includes(Z.id)),...P].sort((Z,J)=>O.indexOf(Z.id)-O.indexOf(J.id)))});w.push(L)}return()=>{w.forEach(S=>S())}},[O]),T.useEffect(()=>{if(!e){V([]);return}j.current=!0;const w=zr(_t(le,"dms"),Vi("participants","array-contains",e.uid)),S=Sr(w,R=>{const D=[];R.forEach(U=>{D.push({id:U.id,...U.data()})}),D.sort((U,P)=>{const ne=U.updatedAt?.toMillis()||0;return(P.updatedAt?.toMillis()||0)-ne});const L=D.filter(U=>!U.hiddenFor||!U.hiddenFor.includes(e.uid));V(L),j.current||R.docChanges().forEach(U=>{if(U.type==="modified"||U.type==="added"){const P=U.doc.data();if(P.lastMessage&&P.lastMessage.userId!==e.uid){const ne=Date.now(),oe=P.lastMessage.timestamp?.toMillis()||0;ne-oe<3e4&&vy()}}}),j.current=!1});return()=>S()},[e]),T.useEffect(()=>{if(!u){p([]),b(null);return}const w=a.find(R=>R.id===u);b(w||null);const S=Sr(_t(le,"servers",u,"channels"),R=>{const D=[];R.forEach(L=>{D.push({id:L.id,...L.data()})}),p(D.sort((L,U)=>L.position-U.position))});return()=>{S()}},[u,a]);const H={users:n,servers:a,currentServer:u,setCurrentServer:h,channels:f,server:y,dms:N,unreadMentions:x,unreadDms:I};return c.jsx(sN.Provider,{value:H,children:t})};var iN={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},uS=ve.createContext&&ve.createContext(iN),a7=["attr","size","title"];function o7(t,e){if(t==null)return{};var n=l7(t,e),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function l7(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Gm(){return Gm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gm.apply(this,arguments)}function dS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Ym(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dS(Object(n),!0).forEach(function(r){c7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function c7(t,e,n){return e=u7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u7(t){var e=d7(t,"string");return typeof e=="symbol"?e:e+""}function d7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aN(t){return t&&t.map((e,n)=>ve.createElement(e.tag,Ym({key:n},e.attr),aN(e.child)))}function Pe(t){return e=>ve.createElement(h7,Gm({attr:Ym({},t.attr)},e),aN(t.child))}function h7(t){var e=n=>{var{attr:r,size:a,title:o}=t,u=o7(t,a7),h=a||n.size||"1em",f;return n.className&&(f=n.className),t.className&&(f=(f?f+" ":"")+t.className),ve.createElement("svg",Gm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,u,{className:f,style:Ym(Ym({color:t.color||n.color},n.style),t.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),o&&ve.createElement("title",null,o),t.children)};return uS!==void 0?ve.createElement(uS.Consumer,null,n=>e(n)):e(iN)}function oN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6z"},child:[]},{tag:"path",attr:{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12zm0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17z"},child:[]}]})(t)}function lN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m17.6 9.48 1.84-3.18c.16-.31.04-.69-.26-.85a.637.637 0 0 0-.83.22l-1.88 3.24a11.463 11.463 0 0 0-8.94 0L5.65 5.67a.643.643 0 0 0-.87-.2c-.28.18-.37.54-.22.83L6.4 9.48A10.78 10.78 0 0 0 1 18h22a10.78 10.78 0 0 0-5.4-8.52zM7 15.25a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5zm10 0a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5z"},child:[]}]})(t)}function f7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"},child:[]}]})(t)}function m7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"},child:[]}]})(t)}function Ki(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(t)}function p7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10.09 15.59 11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5a2 2 0 0 0-2 2v4h2V5h14v14H5v-4H3v4a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"},child:[]}]})(t)}function g7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42A8.954 8.954 0 0 0 13 21a9 9 0 0 0 0-18zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"},child:[]}]})(t)}function Km(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},child:[]}]})(t)}function v7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"},child:[]}]})(t)}function y7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"},child:[]}]})(t)}function Vp(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"},child:[]}]})(t)}function Zo(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9.19 6.35c-2.04 2.29-3.44 5.58-3.57 5.89L2 10.69l4.05-4.05c.47-.47 1.15-.68 1.81-.55l1.33.26zM11.17 17s3.74-1.55 5.89-3.7c5.4-5.4 4.5-9.62 4.21-10.57-.95-.3-5.17-1.19-10.57 4.21C8.55 9.09 7 12.83 7 12.83L11.17 17zm6.48-2.19c-2.29 2.04-5.58 3.44-5.89 3.57L13.31 22l4.05-4.05c.47-.47.68-1.15.55-1.81l-.26-1.33zM9 18c0 .83-.34 1.58-.88 2.12C6.94 21.3 2 22 2 22s.7-4.94 1.88-6.12A2.996 2.996 0 0 1 9 18zm4-9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z"},child:[]}]})(t)}function cb(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"},child:[]}]})(t)}function Up(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(t)}function b7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z"},child:[]}]})(t)}function x7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"},child:[]}]})(t)}function _7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"},child:[]}]})(t)}function yy(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3 3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"},child:[]}]})(t)}function by(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"},child:[]}]})(t)}function cN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.5 16.5v-9l7 4.5-7 4.5z"},child:[]}]})(t)}function w7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 6h12v12H6z"},child:[]}]})(t)}function xy(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m21 6.5-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2 2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"},child:[]}]})(t)}function Ud(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"},child:[]}]})(t)}function E7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 9v6h4l5 5V4l-5 5H7z"},child:[]}]})(t)}function hS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.796 8.796 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4 9.91 6.09 12 8.18V4z"},child:[]}]})(t)}function fS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"},child:[]}]})(t)}function w0(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08a.956.956 0 0 1-.29-.7c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28a11.27 11.27 0 0 0-2.67-1.85.996.996 0 0 1-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"},child:[]}]})(t)}function S7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"},child:[]}]})(t)}function T7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"},child:[]}]})(t)}function C7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"},child:[]}]})(t)}function Qm(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6a2 2 0 0 0-2-2H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2H0v2h24v-2h-4zm-7-3.53v-2.19c-2.78 0-4.61.85-6 2.72.56-2.67 2.11-5.33 6-5.87V7l4 3.73-4 3.74z"},child:[]}]})(t)}function k7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m21.22 18.02 2 2H24v-2h-2.78zm.77-2 .01-10a2 2 0 0 0-2-2H7.22l5.23 5.23c.18-.04.36-.07.55-.1V7.02l4 3.73-1.58 1.47 5.54 5.54c.61-.33 1.03-.99 1.03-1.74zM2.39 1.73 1.11 3l1.54 1.54c-.4.36-.65.89-.65 1.48v10a2 2 0 0 0 2 2H0v2h18.13l2.71 2.71 1.27-1.27L2.39 1.73zM7 15.02c.31-1.48.92-2.95 2.07-4.06l1.59 1.59c-1.54.38-2.7 1.18-3.66 2.47z"},child:[]}]})(t)}function mS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"},child:[]}]})(t)}function Yo(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(t)}function uN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"},child:[]}]})(t)}function mc(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3z"},child:[]}]})(t)}function N7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"},child:[]}]})(t)}function pS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"},child:[]}]})(t)}function dN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4h4zm-6 4h-4v-4h4v4z"},child:[]}]})(t)}function Xm(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 18h2V6H7v12zm4 4h2V2h-2v20zm-8-8h2v-4H3v4zm12 4h2V6h-2v12zm4-8v4h2v-4h-2z"},child:[]}]})(t)}function A7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"},child:[]}]})(t)}function hN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"},child:[]}]})(t)}function _y(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"},child:[]}]})(t)}function R7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 3H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h6v2H8v2h8v-2h-2v-2h6c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"},child:[]}]})(t)}function I7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 4c3.87 0 7 3.13 7 7v2h-2.92L21 17.92V11a9 9 0 0 0-9-9c-1.95 0-3.76.62-5.23 1.68l1.44 1.44A6.914 6.914 0 0 1 12 4zM2.27 1.72 1 3l3.33 3.32A8.899 8.899 0 0 0 3 11v7c0 1.66 1.34 3 3 3h3v-8H5v-2c0-1.17.29-2.26.79-3.22L15 17v4h3c.3 0 .59-.06.86-.14L21 23l1.27-1.27-20-20.01z"},child:[]}]})(t)}function j7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"},child:[]}]})(t)}function D7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]}]})(t)}function P7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"},child:[]}]})(t)}function M7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8h-3zM5 19l3-4 2 3 3-4 4 5H5z"},child:[]}]})(t)}function O7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m19 9 1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"},child:[]}]})(t)}function pc(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(t)}function Wm(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"},child:[]}]})(t)}function L7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"},child:[]}]})(t)}function V7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10a2.5 2.5 0 0 0 2.5-2.5c0-.61-.23-1.2-.64-1.67a.528.528 0 0 1-.13-.33c0-.28.22-.5.5-.5H16c3.31 0 6-2.69 6-6 0-4.96-4.49-9-10-9zm5.5 11c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm-3-4c-.83 0-1.5-.67-1.5-1.5S13.67 6 14.5 6s1.5.67 1.5 1.5S15.33 9 14.5 9zM5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S7.33 13 6.5 13 5 12.33 5 11.5zm6-4c0 .83-.67 1.5-1.5 1.5S8 8.33 8 7.5 8.67 6 9.5 6s1.5.67 1.5 1.5z"},child:[]}]})(t)}function U7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 11h-1V3c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v8H8c-2.76 0-5 2.24-5 5v7h18v-7c0-2.76-2.24-5-5-5zm3 10h-2v-3c0-.55-.45-1-1-1s-1 .45-1 1v3h-2v-3c0-.55-.45-1-1-1s-1 .45-1 1v3H9v-3c0-.55-.45-1-1-1s-1 .45-1 1v3H5v-5c0-1.65 1.35-3 3-3h8c1.65 0 3 1.35 3 3v5z"},child:[]}]})(t)}function z7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12.16 3h-.32L9.21 8.25h5.58zM16.46 8.25h5.16L19 3h-5.16zM21.38 9.75h-8.63V20.1zM11.25 20.1V9.75H2.62zM7.54 8.25 10.16 3H5L2.38 8.25z"},child:[]}]})(t)}function el(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},child:[]}]})(t)}function $n(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(t)}function B7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"},child:[]}]})(t)}function F7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"},child:[]}]})(t)}function gS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(t)}function H7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(t)}function $7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},child:[]}]})(t)}function q7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 12.22C21 6.73 16.74 3 12 3c-4.69 0-9 3.65-9 9.28-.6.34-1 .98-1 1.72v2c0 1.1.9 2 2 2h1v-6.1c0-3.87 3.13-7 7-7s7 3.13 7 7V19h-8v2h8c1.1 0 2-.9 2-2v-1.22c.59-.31 1-.92 1-1.64v-2.3c0-.7-.41-1.31-1-1.62z"},child:[]},{tag:"circle",attr:{cx:"9",cy:"13",r:"1"},child:[]},{tag:"circle",attr:{cx:"15",cy:"13",r:"1"},child:[]},{tag:"path",attr:{d:"M18 11.03A6.04 6.04 0 0 0 12.05 6c-3.03 0-6.29 2.51-6.03 6.45a8.075 8.075 0 0 0 4.86-5.89c1.31 2.63 4 4.44 7.12 4.47z"},child:[]}]})(t)}function G7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"},child:[]}]})(t)}function Y7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 11V3H5c-1.1 0-2 .9-2 2v6h8zm2 0h8V5c0-1.1-.9-2-2-2h-6v8zm-2 2H3v6c0 1.1.9 2 2 2h6v-8zm2 0v8h6c1.1 0 2-.9 2-2v-6h-8z"},child:[]}]})(t)}function vS(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M18 9V7h-2V2.84A9.929 9.929 0 0 0 11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12c0-1.05-.17-2.05-.47-3H18zm-2.5-1c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm-7 0c.83 0 1.5.67 1.5 1.5S9.33 11 8.5 11 7 10.33 7 9.5 7.67 8 8.5 8zm3.5 9.5c-2.33 0-4.31-1.46-5.11-3.5h10.22c-.8 2.04-2.78 3.5-5.11 3.5zM22 3h2v2h-2v2h-2V5h-2V3h2V1h2v2z"},child:[]}]})(t)}function fN(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM8.5 8c.83 0 1.5.67 1.5 1.5S9.33 11 8.5 11 7 10.33 7 9.5 7.67 8 8.5 8zM12 18c-2.28 0-4.22-1.66-5-4h10c-.78 2.34-2.72 4-5 4zm3.5-7c-.83 0-1.5-.67-1.5-1.5S14.67 8 15.5 8s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"},child:[]}]})(t)}function K7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"},child:[]}]})(t)}function ub(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"},child:[]}]})(t)}function Q7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"},child:[]}]})(t)}function X7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"},child:[]}]})(t)}function db(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"},child:[]}]})(t)}function W7(t){return Pe({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"},child:[]}]})(t)}const mN=T.createContext(),Fr=()=>{const t=T.useContext(mN);if(!t)throw new Error("useToast must be used within ToastProvider");return t},J7=({children:t})=>{const[e,n]=T.useState([]),r=T.useCallback((p,y="info")=>{const b=Date.now();n(x=>[...x,{id:b,message:p,type:y}]),setTimeout(()=>{n(x=>x.filter(k=>k.id!==b))},4e3)},[]),a=T.useCallback(p=>{n(y=>y.filter(b=>b.id!==p))},[]),o=T.useCallback(p=>r(p,"success"),[r]),u=T.useCallback(p=>r(p,"error"),[r]),h=T.useCallback(p=>r(p,"info"),[r]),f=T.useCallback(p=>r(p,"warning"),[r]);return c.jsxs(mN.Provider,{value:{success:o,error:u,info:h,warning:f},children:[t,c.jsx(Z7,{toasts:e,removeToast:a})]})},Z7=({toasts:t,removeToast:e})=>c.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:t.map(n=>c.jsx(eL,{toast:n,onClose:()=>e(n.id)},n.id))}),eL=({toast:t,onClose:e})=>{const n={success:c.jsx(f7,{size:20}),error:c.jsx(x7,{size:20}),warning:c.jsx(_7,{size:20}),info:c.jsx(Km,{size:20})},r={success:"bg-green-600 border-green-500",error:"bg-red-600 border-red-500",warning:"bg-yellow-600 border-yellow-500",info:"bg-blue-600 border-blue-500"};return c.jsxs("div",{className:`${r[t.type]} border-l-4 text-white px-4 py-3 rounded-lg shadow-lg 
                  flex items-center gap-3 min-w-[300px] max-w-md animate-slide-in`,children:[c.jsx("div",{className:"flex-shrink-0",children:n[t.type]}),c.jsx("div",{className:"flex-1 text-sm font-medium",children:t.message}),c.jsx("button",{onClick:e,className:"flex-shrink-0 hover:bg-white/20 rounded p-1 transition-colors",children:c.jsx($n,{size:18})})]})};class tL extends ve.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({errorInfo:n})}render(){return this.state.hasError?c.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-8 flex flex-col items-center justify-center text-center",children:[c.jsx("h1",{className:"text-2xl font-bold text-red-500 mb-4",children:"Something went wrong"}),c.jsxs("div",{className:"bg-gray-800 p-4 rounded overflow-auto max-w-full text-left font-mono text-xs",children:[c.jsx("p",{className:"font-bold text-yellow-400 mb-2",children:this.state.error&&this.state.error.toString()}),c.jsx("pre",{className:"text-gray-400 whitespace-pre-wrap",children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}),c.jsx("button",{className:"mt-6 px-4 py-2 bg-blue-600 rounded hover:bg-blue-700",onClick:()=>window.location.reload(),children:"Reload App"})]}):this.props.children}}const Lo=dh("PushNotifications",{}),nL=()=>{const{currentUser:t}=yn();T.useEffect(()=>{let e,n,r,a;return ta.getPlatform()!=="web"&&t&&(async()=>{console.log("PushNotifications hook: Initializing for user",t.uid);let u=await Lo.checkPermissions();if(u.receive==="prompt"&&(u=await Lo.requestPermissions()),u.receive!=="granted"){console.warn("PushNotifications hook: User denied permissions!");return}e=await Lo.addListener("registration",async h=>{console.log("Push registration success, token: "+h.value);try{const f=Ne(le,"users",t.uid);await Xn(f,{fcmTokens:h.value},{merge:!0}),console.log("FCM Token saved to Firestore for user:",t.uid)}catch(f){console.error("Error saving FCM token to Firestore:",f)}}),n=await Lo.addListener("registrationError",h=>{console.error("Error on registration: "+JSON.stringify(h))}),r=await Lo.addListener("pushNotificationReceived",h=>{console.log("Push received: "+JSON.stringify(h))}),a=await Lo.addListener("pushNotificationActionPerformed",h=>{console.log("Push action performed: "+JSON.stringify(h))}),console.log("PushNotifications hook: Requesting registration..."),await Lo.register()})(),()=>{e&&e.remove(),n&&n.remove(),r&&r.remove(),a&&a.remove()}},[t])};function pN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=pN(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function rL(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=pN(t))&&(r&&(r+=" "),r+=e);return r}const sL=(t,e)=>{const n=new Array(t.length+e.length);for(let r=0;r<t.length;r++)n[r]=t[r];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n},iL=(t,e)=>({classGroupId:t,validator:e}),gN=(t=new Map,e=null,n)=>({nextPart:t,validators:e,classGroupId:n}),Jm="-",yS=[],aL="arbitrary..",oL=t=>{const e=cL(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:u=>{if(u.startsWith("[")&&u.endsWith("]"))return lL(u);const h=u.split(Jm),f=h[0]===""&&h.length>1?1:0;return vN(h,f,e)},getConflictingClassGroupIds:(u,h)=>{if(h){const f=r[u],p=n[u];return f?p?sL(p,f):f:p||yS}return n[u]||yS}}},vN=(t,e,n)=>{if(t.length-e===0)return n.classGroupId;const a=t[e],o=n.nextPart.get(a);if(o){const p=vN(t,e+1,o);if(p)return p}const u=n.validators;if(u===null)return;const h=e===0?t.join(Jm):t.slice(e).join(Jm),f=u.length;for(let p=0;p<f;p++){const y=u[p];if(y.validator(h))return y.classGroupId}},lL=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),n=e.indexOf(":"),r=e.slice(0,n);return r?aL+r:void 0})(),cL=t=>{const{theme:e,classGroups:n}=t;return uL(n,e)},uL=(t,e)=>{const n=gN();for(const r in t){const a=t[r];hb(a,n,r,e)}return n},hb=(t,e,n,r)=>{const a=t.length;for(let o=0;o<a;o++){const u=t[o];dL(u,e,n,r)}},dL=(t,e,n,r)=>{if(typeof t=="string"){hL(t,e,n);return}if(typeof t=="function"){fL(t,e,n,r);return}mL(t,e,n,r)},hL=(t,e,n)=>{const r=t===""?e:yN(e,t);r.classGroupId=n},fL=(t,e,n,r)=>{if(pL(t)){hb(t(r),e,n,r);return}e.validators===null&&(e.validators=[]),e.validators.push(iL(n,t))},mL=(t,e,n,r)=>{const a=Object.entries(t),o=a.length;for(let u=0;u<o;u++){const[h,f]=a[u];hb(f,yN(e,h),n,r)}},yN=(t,e)=>{let n=t;const r=e.split(Jm),a=r.length;for(let o=0;o<a;o++){const u=r[o];let h=n.nextPart.get(u);h||(h=gN(),n.nextPart.set(u,h)),n=h}return n},pL=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,gL=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),r=Object.create(null);const a=(o,u)=>{n[o]=u,e++,e>t&&(e=0,r=n,n=Object.create(null))};return{get(o){let u=n[o];if(u!==void 0)return u;if((u=r[o])!==void 0)return a(o,u),u},set(o,u){o in n?n[o]=u:a(o,u)}}},wy="!",bS=":",vL=[],xS=(t,e,n,r,a)=>({modifiers:t,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:r,isExternal:a}),yL=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=a=>{const o=[];let u=0,h=0,f=0,p;const y=a.length;for(let A=0;A<y;A++){const N=a[A];if(u===0&&h===0){if(N===bS){o.push(a.slice(f,A)),f=A+1;continue}if(N==="/"){p=A;continue}}N==="["?u++:N==="]"?u--:N==="("?h++:N===")"&&h--}const b=o.length===0?a:a.slice(f);let x=b,k=!1;b.endsWith(wy)?(x=b.slice(0,-1),k=!0):b.startsWith(wy)&&(x=b.slice(1),k=!0);const I=p&&p>f?p-f:void 0;return xS(o,k,x,I)};if(e){const a=e+bS,o=r;r=u=>u.startsWith(a)?o(u.slice(a.length)):xS(vL,!1,u,void 0,!0)}if(n){const a=r;r=o=>n({className:o,parseClassName:a})}return r},bL=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((n,r)=>{e.set(n,1e6+r)}),n=>{const r=[];let a=[];for(let o=0;o<n.length;o++){const u=n[o],h=u[0]==="[",f=e.has(u);h||f?(a.length>0&&(a.sort(),r.push(...a),a=[]),r.push(u)):a.push(u)}return a.length>0&&(a.sort(),r.push(...a)),r}},xL=t=>({cache:gL(t.cacheSize),parseClassName:yL(t),sortModifiers:bL(t),...oL(t)}),_L=/\s+/,wL=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a,sortModifiers:o}=e,u=[],h=t.trim().split(_L);let f="";for(let p=h.length-1;p>=0;p-=1){const y=h[p],{isExternal:b,modifiers:x,hasImportantModifier:k,baseClassName:I,maybePostfixModifierPosition:A}=n(y);if(b){f=y+(f.length>0?" "+f:f);continue}let N=!!A,V=r(N?I.substring(0,A):I);if(!V){if(!N){f=y+(f.length>0?" "+f:f);continue}if(V=r(I),!V){f=y+(f.length>0?" "+f:f);continue}N=!1}const F=x.length===0?"":x.length===1?x[0]:o(x).join(":"),j=k?F+wy:F,O=j+V;if(u.indexOf(O)>-1)continue;u.push(O);const B=a(V,N);for(let H=0;H<B.length;++H){const w=B[H];u.push(j+w)}f=y+(f.length>0?" "+f:f)}return f},EL=(...t)=>{let e=0,n,r,a="";for(;e<t.length;)(n=t[e++])&&(r=bN(n))&&(a&&(a+=" "),a+=r);return a},bN=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=bN(t[r]))&&(n&&(n+=" "),n+=e);return n},SL=(t,...e)=>{let n,r,a,o;const u=f=>{const p=e.reduce((y,b)=>b(y),t());return n=xL(p),r=n.cache.get,a=n.cache.set,o=h,h(f)},h=f=>{const p=r(f);if(p)return p;const y=wL(f,n);return a(f,y),y};return o=u,(...f)=>o(EL(...f))},TL=[],Yn=t=>{const e=n=>n[t]||TL;return e.isThemeGetter=!0,e},xN=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_N=/^\((?:(\w[\w-]*):)?(.+)\)$/i,CL=/^\d+\/\d+$/,kL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,NL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,AL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,RL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,IL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ec=t=>CL.test(t),Nt=t=>!!t&&!Number.isNaN(Number(t)),za=t=>!!t&&Number.isInteger(Number(t)),E0=t=>t.endsWith("%")&&Nt(t.slice(0,-1)),Mi=t=>kL.test(t),jL=()=>!0,DL=t=>NL.test(t)&&!AL.test(t),wN=()=>!1,PL=t=>RL.test(t),ML=t=>IL.test(t),OL=t=>!Ke(t)&&!Qe(t),LL=t=>Yc(t,TN,wN),Ke=t=>xN.test(t),Vo=t=>Yc(t,CN,DL),S0=t=>Yc(t,FL,Nt),_S=t=>Yc(t,EN,wN),VL=t=>Yc(t,SN,ML),qf=t=>Yc(t,kN,PL),Qe=t=>_N.test(t),ed=t=>Kc(t,CN),UL=t=>Kc(t,HL),wS=t=>Kc(t,EN),zL=t=>Kc(t,TN),BL=t=>Kc(t,SN),Gf=t=>Kc(t,kN,!0),Yc=(t,e,n)=>{const r=xN.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Kc=(t,e,n=!1)=>{const r=_N.exec(t);return r?r[1]?e(r[1]):n:!1},EN=t=>t==="position"||t==="percentage",SN=t=>t==="image"||t==="url",TN=t=>t==="length"||t==="size"||t==="bg-size",CN=t=>t==="length",FL=t=>t==="number",HL=t=>t==="family-name",kN=t=>t==="shadow",$L=()=>{const t=Yn("color"),e=Yn("font"),n=Yn("text"),r=Yn("font-weight"),a=Yn("tracking"),o=Yn("leading"),u=Yn("breakpoint"),h=Yn("container"),f=Yn("spacing"),p=Yn("radius"),y=Yn("shadow"),b=Yn("inset-shadow"),x=Yn("text-shadow"),k=Yn("drop-shadow"),I=Yn("blur"),A=Yn("perspective"),N=Yn("aspect"),V=Yn("ease"),F=Yn("animate"),j=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],B=()=>[...O(),Qe,Ke],H=()=>["auto","hidden","clip","visible","scroll"],w=()=>["auto","contain","none"],S=()=>[Qe,Ke,f],R=()=>[ec,"full","auto",...S()],D=()=>[za,"none","subgrid",Qe,Ke],L=()=>["auto",{span:["full",za,Qe,Ke]},za,Qe,Ke],U=()=>[za,"auto",Qe,Ke],P=()=>["auto","min","max","fr",Qe,Ke],ne=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],oe=()=>["start","end","center","stretch","center-safe","end-safe"],G=()=>["auto",...S()],Z=()=>[ec,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...S()],J=()=>[t,Qe,Ke],Se=()=>[...O(),wS,_S,{position:[Qe,Ke]}],Le=()=>["no-repeat",{repeat:["","x","y","space","round"]}],$=()=>["auto","cover","contain",zL,LL,{size:[Qe,Ke]}],X=()=>[E0,ed,Vo],re=()=>["","none","full",p,Qe,Ke],he=()=>["",Nt,ed,Vo],Te=()=>["solid","dashed","dotted","double"],Ue=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],te=()=>[Nt,E0,wS,_S],Oe=()=>["","none",I,Qe,Ke],Ie=()=>["none",Nt,Qe,Ke],We=()=>["none",Nt,Qe,Ke],ke=()=>[Nt,Qe,Ke],fe=()=>[ec,"full",...S()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Mi],breakpoint:[Mi],color:[jL],container:[Mi],"drop-shadow":[Mi],ease:["in","out","in-out"],font:[OL],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Mi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Mi],shadow:[Mi],spacing:["px",Nt],text:[Mi],"text-shadow":[Mi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ec,Ke,Qe,N]}],container:["container"],columns:[{columns:[Nt,Ke,Qe,h]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:B()}],overflow:[{overflow:H()}],"overflow-x":[{"overflow-x":H()}],"overflow-y":[{"overflow-y":H()}],overscroll:[{overscroll:w()}],"overscroll-x":[{"overscroll-x":w()}],"overscroll-y":[{"overscroll-y":w()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:R()}],"inset-x":[{"inset-x":R()}],"inset-y":[{"inset-y":R()}],start:[{start:R()}],end:[{end:R()}],top:[{top:R()}],right:[{right:R()}],bottom:[{bottom:R()}],left:[{left:R()}],visibility:["visible","invisible","collapse"],z:[{z:[za,"auto",Qe,Ke]}],basis:[{basis:[ec,"full","auto",h,...S()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Nt,ec,"auto","initial","none",Ke]}],grow:[{grow:["",Nt,Qe,Ke]}],shrink:[{shrink:["",Nt,Qe,Ke]}],order:[{order:[za,"first","last","none",Qe,Ke]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":P()}],"auto-rows":[{"auto-rows":P()}],gap:[{gap:S()}],"gap-x":[{"gap-x":S()}],"gap-y":[{"gap-y":S()}],"justify-content":[{justify:[...ne(),"normal"]}],"justify-items":[{"justify-items":[...oe(),"normal"]}],"justify-self":[{"justify-self":["auto",...oe()]}],"align-content":[{content:["normal",...ne()]}],"align-items":[{items:[...oe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...oe(),{baseline:["","last"]}]}],"place-content":[{"place-content":ne()}],"place-items":[{"place-items":[...oe(),"baseline"]}],"place-self":[{"place-self":["auto",...oe()]}],p:[{p:S()}],px:[{px:S()}],py:[{py:S()}],ps:[{ps:S()}],pe:[{pe:S()}],pt:[{pt:S()}],pr:[{pr:S()}],pb:[{pb:S()}],pl:[{pl:S()}],m:[{m:G()}],mx:[{mx:G()}],my:[{my:G()}],ms:[{ms:G()}],me:[{me:G()}],mt:[{mt:G()}],mr:[{mr:G()}],mb:[{mb:G()}],ml:[{ml:G()}],"space-x":[{"space-x":S()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":S()}],"space-y-reverse":["space-y-reverse"],size:[{size:Z()}],w:[{w:[h,"screen",...Z()]}],"min-w":[{"min-w":[h,"screen","none",...Z()]}],"max-w":[{"max-w":[h,"screen","none","prose",{screen:[u]},...Z()]}],h:[{h:["screen","lh",...Z()]}],"min-h":[{"min-h":["screen","lh","none",...Z()]}],"max-h":[{"max-h":["screen","lh",...Z()]}],"font-size":[{text:["base",n,ed,Vo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Qe,S0]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",E0,Ke]}],"font-family":[{font:[UL,Ke,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Qe,Ke]}],"line-clamp":[{"line-clamp":[Nt,"none",Qe,S0]}],leading:[{leading:[o,...S()]}],"list-image":[{"list-image":["none",Qe,Ke]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Qe,Ke]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:J()}],"text-color":[{text:J()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Te(),"wavy"]}],"text-decoration-thickness":[{decoration:[Nt,"from-font","auto",Qe,Vo]}],"text-decoration-color":[{decoration:J()}],"underline-offset":[{"underline-offset":[Nt,"auto",Qe,Ke]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Qe,Ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Qe,Ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Se()}],"bg-repeat":[{bg:Le()}],"bg-size":[{bg:$()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},za,Qe,Ke],radial:["",Qe,Ke],conic:[za,Qe,Ke]},BL,VL]}],"bg-color":[{bg:J()}],"gradient-from-pos":[{from:X()}],"gradient-via-pos":[{via:X()}],"gradient-to-pos":[{to:X()}],"gradient-from":[{from:J()}],"gradient-via":[{via:J()}],"gradient-to":[{to:J()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:he()}],"border-w-x":[{"border-x":he()}],"border-w-y":[{"border-y":he()}],"border-w-s":[{"border-s":he()}],"border-w-e":[{"border-e":he()}],"border-w-t":[{"border-t":he()}],"border-w-r":[{"border-r":he()}],"border-w-b":[{"border-b":he()}],"border-w-l":[{"border-l":he()}],"divide-x":[{"divide-x":he()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":he()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Te(),"hidden","none"]}],"divide-style":[{divide:[...Te(),"hidden","none"]}],"border-color":[{border:J()}],"border-color-x":[{"border-x":J()}],"border-color-y":[{"border-y":J()}],"border-color-s":[{"border-s":J()}],"border-color-e":[{"border-e":J()}],"border-color-t":[{"border-t":J()}],"border-color-r":[{"border-r":J()}],"border-color-b":[{"border-b":J()}],"border-color-l":[{"border-l":J()}],"divide-color":[{divide:J()}],"outline-style":[{outline:[...Te(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Nt,Qe,Ke]}],"outline-w":[{outline:["",Nt,ed,Vo]}],"outline-color":[{outline:J()}],shadow:[{shadow:["","none",y,Gf,qf]}],"shadow-color":[{shadow:J()}],"inset-shadow":[{"inset-shadow":["none",b,Gf,qf]}],"inset-shadow-color":[{"inset-shadow":J()}],"ring-w":[{ring:he()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:J()}],"ring-offset-w":[{"ring-offset":[Nt,Vo]}],"ring-offset-color":[{"ring-offset":J()}],"inset-ring-w":[{"inset-ring":he()}],"inset-ring-color":[{"inset-ring":J()}],"text-shadow":[{"text-shadow":["none",x,Gf,qf]}],"text-shadow-color":[{"text-shadow":J()}],opacity:[{opacity:[Nt,Qe,Ke]}],"mix-blend":[{"mix-blend":[...Ue(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ue()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Nt]}],"mask-image-linear-from-pos":[{"mask-linear-from":te()}],"mask-image-linear-to-pos":[{"mask-linear-to":te()}],"mask-image-linear-from-color":[{"mask-linear-from":J()}],"mask-image-linear-to-color":[{"mask-linear-to":J()}],"mask-image-t-from-pos":[{"mask-t-from":te()}],"mask-image-t-to-pos":[{"mask-t-to":te()}],"mask-image-t-from-color":[{"mask-t-from":J()}],"mask-image-t-to-color":[{"mask-t-to":J()}],"mask-image-r-from-pos":[{"mask-r-from":te()}],"mask-image-r-to-pos":[{"mask-r-to":te()}],"mask-image-r-from-color":[{"mask-r-from":J()}],"mask-image-r-to-color":[{"mask-r-to":J()}],"mask-image-b-from-pos":[{"mask-b-from":te()}],"mask-image-b-to-pos":[{"mask-b-to":te()}],"mask-image-b-from-color":[{"mask-b-from":J()}],"mask-image-b-to-color":[{"mask-b-to":J()}],"mask-image-l-from-pos":[{"mask-l-from":te()}],"mask-image-l-to-pos":[{"mask-l-to":te()}],"mask-image-l-from-color":[{"mask-l-from":J()}],"mask-image-l-to-color":[{"mask-l-to":J()}],"mask-image-x-from-pos":[{"mask-x-from":te()}],"mask-image-x-to-pos":[{"mask-x-to":te()}],"mask-image-x-from-color":[{"mask-x-from":J()}],"mask-image-x-to-color":[{"mask-x-to":J()}],"mask-image-y-from-pos":[{"mask-y-from":te()}],"mask-image-y-to-pos":[{"mask-y-to":te()}],"mask-image-y-from-color":[{"mask-y-from":J()}],"mask-image-y-to-color":[{"mask-y-to":J()}],"mask-image-radial":[{"mask-radial":[Qe,Ke]}],"mask-image-radial-from-pos":[{"mask-radial-from":te()}],"mask-image-radial-to-pos":[{"mask-radial-to":te()}],"mask-image-radial-from-color":[{"mask-radial-from":J()}],"mask-image-radial-to-color":[{"mask-radial-to":J()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":O()}],"mask-image-conic-pos":[{"mask-conic":[Nt]}],"mask-image-conic-from-pos":[{"mask-conic-from":te()}],"mask-image-conic-to-pos":[{"mask-conic-to":te()}],"mask-image-conic-from-color":[{"mask-conic-from":J()}],"mask-image-conic-to-color":[{"mask-conic-to":J()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Se()}],"mask-repeat":[{mask:Le()}],"mask-size":[{mask:$()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Qe,Ke]}],filter:[{filter:["","none",Qe,Ke]}],blur:[{blur:Oe()}],brightness:[{brightness:[Nt,Qe,Ke]}],contrast:[{contrast:[Nt,Qe,Ke]}],"drop-shadow":[{"drop-shadow":["","none",k,Gf,qf]}],"drop-shadow-color":[{"drop-shadow":J()}],grayscale:[{grayscale:["",Nt,Qe,Ke]}],"hue-rotate":[{"hue-rotate":[Nt,Qe,Ke]}],invert:[{invert:["",Nt,Qe,Ke]}],saturate:[{saturate:[Nt,Qe,Ke]}],sepia:[{sepia:["",Nt,Qe,Ke]}],"backdrop-filter":[{"backdrop-filter":["","none",Qe,Ke]}],"backdrop-blur":[{"backdrop-blur":Oe()}],"backdrop-brightness":[{"backdrop-brightness":[Nt,Qe,Ke]}],"backdrop-contrast":[{"backdrop-contrast":[Nt,Qe,Ke]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Nt,Qe,Ke]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Nt,Qe,Ke]}],"backdrop-invert":[{"backdrop-invert":["",Nt,Qe,Ke]}],"backdrop-opacity":[{"backdrop-opacity":[Nt,Qe,Ke]}],"backdrop-saturate":[{"backdrop-saturate":[Nt,Qe,Ke]}],"backdrop-sepia":[{"backdrop-sepia":["",Nt,Qe,Ke]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":S()}],"border-spacing-x":[{"border-spacing-x":S()}],"border-spacing-y":[{"border-spacing-y":S()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Qe,Ke]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Nt,"initial",Qe,Ke]}],ease:[{ease:["linear","initial",V,Qe,Ke]}],delay:[{delay:[Nt,Qe,Ke]}],animate:[{animate:["none",F,Qe,Ke]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[A,Qe,Ke]}],"perspective-origin":[{"perspective-origin":B()}],rotate:[{rotate:Ie()}],"rotate-x":[{"rotate-x":Ie()}],"rotate-y":[{"rotate-y":Ie()}],"rotate-z":[{"rotate-z":Ie()}],scale:[{scale:We()}],"scale-x":[{"scale-x":We()}],"scale-y":[{"scale-y":We()}],"scale-z":[{"scale-z":We()}],"scale-3d":["scale-3d"],skew:[{skew:ke()}],"skew-x":[{"skew-x":ke()}],"skew-y":[{"skew-y":ke()}],transform:[{transform:[Qe,Ke,"","none","gpu","cpu"]}],"transform-origin":[{origin:B()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:fe()}],"translate-x":[{"translate-x":fe()}],"translate-y":[{"translate-y":fe()}],"translate-z":[{"translate-z":fe()}],"translate-none":["translate-none"],accent:[{accent:J()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:J()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Qe,Ke]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Qe,Ke]}],fill:[{fill:["none",...J()]}],"stroke-w":[{stroke:[Nt,ed,Vo,S0]}],stroke:[{stroke:["none",...J()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},qL=SL($L);function Ht(...t){return qL(rL(t))}function zp(t){if(!t)return"";const e=t.toDate?t.toDate():new Date(t),r=new Date-e;return r<6e4?"Just now":r<36e5?`${Math.floor(r/6e4)}m ago`:r<864e5?`${Math.floor(r/36e5)}h ago`:r<6048e5?`${Math.floor(r/864e5)}d ago`:e.toLocaleDateString()}function GL(t){switch(t){case"admin":return"bg-admin/20 text-admin border-admin/30";case"moderator":return"bg-moderator/20 text-moderator border-moderator/30";default:return"bg-member/20 text-member border-member/30"}}const bn=({label:t,error:e,className:n,containerClassName:r,...a})=>c.jsxs("div",{className:Ht("flex flex-col gap-1.5",r),children:[t&&c.jsx("label",{className:"text-sm font-medium text-dark-text",children:t}),c.jsx("input",{className:Ht("bg-dark-input text-dark-text px-4 py-2.5 rounded-md","border border-transparent focus:border-brand-primary","outline-none transition-colors duration-200","placeholder:text-dark-muted",e&&"border-admin",n),...a}),e&&c.jsx("span",{className:"text-sm text-admin",children:e})]}),st=({children:t,variant:e="primary",size:n="md",className:r,disabled:a,...o})=>{const u="font-medium rounded-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",h={primary:"bg-brand-primary hover:bg-brand-hover text-white",secondary:"bg-dark-input hover:bg-dark-hover text-dark-text",danger:"bg-admin hover:bg-admin/80 text-white",ghost:"hover:bg-dark-hover text-dark-text"},f={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return c.jsx("button",{className:Ht(u,h[e],f[n],r),disabled:a,...o,children:t})},YL=({isOpen:t,onClose:e})=>{const[n,r]=T.useState(""),[a,o]=T.useState(!1),[u,h]=T.useState(!1),{success:f,error:p}=Fr(),y=async b=>{b.preventDefault(),o(!0);try{await c1(ks,n),h(!0),f("Password reset email sent! Check your inbox."),setTimeout(()=>{e(),h(!1),r("")},3e3)}catch(x){console.error("Password reset error:",x),x.code==="auth/user-not-found"?p("No account found with this email address."):x.code==="auth/invalid-email"?p("Invalid email address."):p("Failed to send reset email. Please try again.")}finally{o(!1)}};return t?c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-dark-sidebar rounded-lg shadow-2xl w-full max-w-md p-6 relative",children:[c.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:24})}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-dark-text mb-2",children:"Reset Password"}),c.jsx("p",{className:"text-dark-muted text-sm",children:"Enter your email address and we'll send you a link to reset your password."})]}),u?c.jsx("div",{className:"bg-green-500/10 border border-green-500/30 text-green-400 px-4 py-3 rounded-md text-sm text-center",children:" Reset email sent successfully! Check your inbox."}):c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsx(bn,{label:"Email Address",type:"email",placeholder:"your@email.com",value:n,onChange:b=>r(b.target.value),required:!0,autoFocus:!0}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(st,{type:"button",variant:"secondary",onClick:e,className:"flex-1",children:"Cancel"}),c.jsx(st,{type:"submit",variant:"primary",className:"flex-1",disabled:a||!n,children:a?"Sending...":"Send Reset Link"})]})]})]})}):null},KL=({onSwitchToRegister:t,onSwitchToReset:e,onSwitchToSSOTest:n})=>{const{login:r,signInWithGoogle:a}=yn(),[o,u]=T.useState({email:"",password:""}),[h,f]=T.useState(""),[p,y]=T.useState(!1),[b,x]=T.useState(!1),[k,I]=T.useState(!1),A=async V=>{V.preventDefault(),f(""),y(!0);try{await r(o.email,o.password)}catch(F){f(F.message||"Failed to login")}finally{y(!1)}},N=async()=>{f(""),x(!0);try{await a()}catch(V){f(V.message||"Failed to sign in with Google")}finally{x(!1)}};return c.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:[c.jsxs("div",{className:"w-full max-w-md bg-dark-sidebar rounded-lg shadow-2xl p-8",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-dark-text mb-2",children:"Welcome Back!"}),c.jsx("p",{className:"text-dark-muted",children:"Login to Lumo"})]}),c.jsxs("form",{onSubmit:A,className:"space-y-4",children:[c.jsx(bn,{label:"Email",type:"email",placeholder:"Enter your email",value:o.email,onChange:V=>u({...o,email:V.target.value}),required:!0}),c.jsxs("div",{children:[c.jsx(bn,{label:"Password",type:"password",placeholder:"Enter your password",value:o.password,onChange:V=>u({...o,password:V.target.value}),required:!0}),c.jsx("div",{className:"mt-2 text-right",children:c.jsx("button",{type:"button",onClick:()=>I(!0),className:"text-sm text-brand-primary hover:underline",children:"Forgot Password?"})})]}),h&&c.jsx("div",{className:"bg-admin/10 border border-admin/30 text-admin px-4 py-3 rounded-md text-sm",children:h}),c.jsx(st,{type:"submit",variant:"primary",className:"w-full",disabled:p,children:p?"Logging in...":"Login"})]}),c.jsxs("div",{className:"mt-6 flex items-center",children:[c.jsx("div",{className:"flex-1 border-t border-dark-border"}),c.jsx("span",{className:"px-4 text-dark-muted text-sm",children:"or"}),c.jsx("div",{className:"flex-1 border-t border-dark-border"})]}),c.jsx("div",{className:"mt-6",children:c.jsxs("button",{type:"button",onClick:N,disabled:b||p,className:"w-full flex items-center justify-center gap-3 bg-white hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-md border border-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),b?"Signing in...":"Sign in with Google"]})}),c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("div",{className:"text-dark-muted text-sm",children:["Don't have an account?"," ",c.jsx("button",{onClick:t,className:"text-brand-primary hover:underline",children:"Register"})]})})]}),c.jsx(YL,{isOpen:k,onClose:()=>I(!1)})]})},QL=({onSwitchToLogin:t})=>{const{register:e}=yn(),[n,r]=T.useState({displayName:"",email:"",password:"",confirmPassword:""}),[a,o]=T.useState(""),[u,h]=T.useState(""),[f,p]=T.useState(!1),[y,b]=T.useState([]);T.useEffect(()=>{(async()=>{try{const I=_t(le,"users"),A=await di(I),N=[];A.forEach(V=>{const F=V.data().displayName;F&&N.push(F.toLowerCase())}),b(N)}catch(I){console.error("Error loading usernames:",I)}})()},[]),T.useEffect(()=>{const k=n.displayName;if(k){if(k.length<3){h("Username must be at least 3 characters");return}if(!/^[a-zA-Z0-9-_]+$/.test(k)){h("Only letters, numbers, hyphens (-) and underscores (_) allowed");return}const I=k.toLowerCase();y.includes(I)?h("This username is already taken"):h("")}else h("")},[n.displayName,y]);const x=async k=>{if(k.preventDefault(),o(""),u){o(u);return}if(n.password!==n.confirmPassword){o("Passwords do not match");return}if(n.password.length<6){o("Password must be at least 6 characters");return}p(!0);try{await e(n.email,n.password,n.displayName)}catch(I){o(I.message||"Failed to register")}finally{p(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:c.jsxs("div",{className:"w-full max-w-md bg-dark-sidebar rounded-lg shadow-2xl p-8",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-dark-text mb-2",children:"Create Account"}),c.jsx("p",{className:"text-dark-muted",children:"Join Lumo"})]}),c.jsxs("form",{onSubmit:x,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(bn,{label:"Display Name",type:"text",placeholder:"Enter your display name",value:n.displayName,onChange:k=>r({...n,displayName:k.target.value}),required:!0}),u&&c.jsx("p",{className:"text-xs text-admin mt-1",children:u}),n.displayName&&!u&&c.jsx("p",{className:"text-xs text-green-500 mt-1",children:" Username available"})]}),c.jsx(bn,{label:"Email",type:"email",placeholder:"Enter your email",value:n.email,onChange:k=>r({...n,email:k.target.value}),required:!0}),c.jsx(bn,{label:"Password",type:"password",placeholder:"Enter your password",value:n.password,onChange:k=>r({...n,password:k.target.value}),required:!0}),c.jsx(bn,{label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:n.confirmPassword,onChange:k=>r({...n,confirmPassword:k.target.value}),required:!0}),a&&c.jsx("div",{className:"bg-admin/10 border border-admin/30 text-admin px-4 py-3 rounded-md text-sm",children:a}),c.jsx(st,{type:"submit",variant:"primary",className:"w-full",disabled:f||!!u,children:f?"Creating account...":"Register"})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("div",{className:"text-dark-muted text-sm",children:["Already have an account?"," ",c.jsx("button",{onClick:t,className:"text-brand-primary hover:underline",children:"Login"})]})})]})})},XL=({onSwitchToLogin:t})=>{const{resetPassword:e}=yn(),[n,r]=T.useState(""),[a,o]=T.useState(""),[u,h]=T.useState(!1),[f,p]=T.useState(!1),y=async b=>{b.preventDefault(),o(""),h(!1),p(!0);try{await e(n),h(!0)}catch(x){o(x.message||"Failed to send reset email")}finally{p(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:c.jsxs("div",{className:"w-full max-w-md bg-dark-sidebar rounded-lg shadow-2xl p-8",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-dark-text mb-2",children:"Reset Password"}),c.jsx("p",{className:"text-dark-muted",children:"Enter your email to receive a reset link"})]}),c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsx(bn,{label:"Email",type:"email",placeholder:"Enter your email",value:n,onChange:b=>r(b.target.value),required:!0}),a&&c.jsx("div",{className:"bg-admin/10 border border-admin/30 text-admin px-4 py-3 rounded-md text-sm",children:a}),u&&c.jsx("div",{className:"bg-green-500/10 border border-green-500/30 text-green-500 px-4 py-3 rounded-md text-sm",children:"Password reset email sent! Check your inbox."}),c.jsx(st,{type:"submit",variant:"primary",className:"w-full",disabled:f,children:f?"Sending...":"Send Reset Link"})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx("button",{onClick:t,className:"text-brand-primary hover:underline text-sm",children:"Back to Login"})})]})})},WL=({onBack:t})=>{const{currentUser:e}=yn(),[n,r]=T.useState(!1),[a,o]=T.useState(null),[u,h]=T.useState(null),f="https://lumobuildvercel.vercel.app/api/sso-token",p=async()=>{r(!0),o(null),h(null);try{if(!e)throw new Error("nce Google ile giri yapn!");console.log(" Testing SSO Backend..."),console.log("User:",e.email);const y=await e.getIdToken();console.log(" Google ID Token alnd"),console.log(" Backend'e istek gnderiliyor:",f);const b=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({googleIdToken:y,email:e.email})});console.log(" Response status:",b.status);const x=await b.json();if(console.log(" Response data:",x),x.success)o({success:!0,customToken:x.customToken,user:x.user,message:" Backend alyor! Custom token baaryla oluturuldu."});else throw new Error(x.message||x.error||"Bilinmeyen hata")}catch(y){console.error(" Test failed:",y),h(y.message)}finally{r(!1)}};return c.jsx("div",{className:"min-h-screen bg-dark-bg p-8",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-dark-text",children:" SSO Backend Test"}),t&&c.jsx("button",{onClick:t,className:"px-4 py-2 bg-dark-sidebar hover:bg-dark-border text-dark-text rounded-md transition-colors",children:" Back to Login"})]}),c.jsxs("div",{className:"bg-dark-sidebar rounded-lg p-6 mb-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-dark-text mb-4",children:"Kullanc Bilgileri"}),e?c.jsxs("div",{className:"space-y-2 text-dark-muted",children:[c.jsx("p",{children:" Giri yapld"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," ",e.email]}),c.jsxs("p",{children:[c.jsx("strong",{children:"UID:"})," ",e.uid]})]}):c.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded p-4",children:[c.jsx("p",{className:"text-yellow-500 mb-3",children:" Giri yapmanz gerekiyor"}),c.jsx("p",{className:"text-dark-muted text-sm mb-3",children:"SSO backend'i test etmek iin nce Google ile giri yapmalsnz."}),t?c.jsx("button",{onClick:t,className:"w-full bg-brand-primary hover:bg-brand-primary/80 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Login Sayfasna Git"}):c.jsx("p",{className:"text-sm text-dark-muted",children:"Ltfen ana sayfaya gidip Google ile giri yapn."})]})]}),c.jsxs("div",{className:"bg-dark-sidebar rounded-lg p-6 mb-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-dark-text mb-4",children:"Backend Testi"}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-dark-muted mb-2",children:"Vercel API URL:"}),c.jsx("input",{type:"text",value:f,readOnly:!0,className:"w-full bg-dark-input text-dark-text px-4 py-2 rounded-md border border-dark-border"}),c.jsx("p",{className:"text-sm text-dark-muted mt-2",children:" Yukardaki URL'i kendi Vercel project URL'iniz ile deitirin"})]}),c.jsx("button",{onClick:p,disabled:!e||n,className:"w-full bg-brand-primary hover:bg-brand-primary/80 text-white font-medium py-3 px-6 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Test ediliyor..."]}):" Backend'i Test Et"})]}),a&&c.jsxs("div",{className:"bg-green-900/20 border border-green-500 rounded-lg p-6 mb-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-green-500 mb-4",children:a.message}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-dark-muted mb-1",children:"User Info:"}),c.jsx("pre",{className:"bg-dark-bg p-3 rounded text-sm text-dark-text overflow-x-auto",children:JSON.stringify(a.user,null,2)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-dark-muted mb-1",children:"Custom Token:"}),c.jsx("pre",{className:"bg-dark-bg p-3 rounded text-sm text-dark-text overflow-x-auto break-all",children:a.customToken})]}),c.jsxs("div",{className:"bg-green-900/30 p-4 rounded",children:[c.jsx("p",{className:"text-green-400 font-medium mb-2",children:" Test Baarl!"}),c.jsxs("ul",{className:"text-sm text-dark-muted space-y-1",children:[c.jsx("li",{children:" Backend API eriilebilir"}),c.jsx("li",{children:" Google ID token doruland"}),c.jsx("li",{children:" Custom token oluturuldu"}),c.jsx("li",{children:" SSO sistemi alyor!"})]})]})]})]}),u&&c.jsxs("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-red-500 mb-4",children:" Test Baarsz"}),c.jsx("p",{className:"text-dark-text mb-4",children:u}),c.jsxs("div",{className:"bg-red-900/30 p-4 rounded",children:[c.jsx("p",{className:"text-red-400 font-medium mb-2",children:"Olas Sorunlar:"}),c.jsxs("ul",{className:"text-sm text-dark-muted space-y-1",children:[c.jsx("li",{children:" Vercel URL yanl olabilir"}),c.jsx("li",{children:" Environment variables eksik olabilir"}),c.jsx("li",{children:" CORS hatas olabilir"}),c.jsx("li",{children:" Backend deploy edilmemi olabilir"})]})]})]}),c.jsxs("div",{className:"bg-dark-sidebar rounded-lg p-6 mt-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-dark-text mb-4",children:" Nasl Test Edilir?"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-muted",children:[c.jsx("li",{children:"Google ile giri yapn (ana sayfadan)"}),c.jsx("li",{children:"Yukardaki URL'i kendi Vercel project URL'iniz ile deitirin"}),c.jsx("li",{children:`"Backend'i Test Et" butonuna tklayn`}),c.jsx("li",{children:"Sonucu bekleyin"})]}),c.jsxs("div",{className:"mt-4 p-4 bg-dark-bg rounded",children:[c.jsx("p",{className:"text-sm text-dark-muted mb-2",children:c.jsx("strong",{children:"Vercel URL'inizi bulmak iin:"})}),c.jsxs("ol",{className:"text-sm text-dark-muted space-y-1 ml-4",children:[c.jsx("li",{children:"1. Vercel Dashboard'a gidin"}),c.jsx("li",{children:"2. Projenizi sein"}),c.jsx("li",{children:`3. "Visit" butonunun yanndaki URL'i kopyalayn`}),c.jsxs("li",{children:["4. Sonuna ",c.jsx("code",{className:"bg-dark-input px-1 rounded",children:"/api/sso-token"})," ekleyin"]})]})]})]}),c.jsxs("div",{className:"bg-dark-sidebar rounded-lg p-6 mt-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-dark-text mb-4",children:" Debug"}),c.jsx("p",{className:"text-dark-muted mb-2",children:"Detayl loglar iin tarayc console'unu an (F12)"}),c.jsx("p",{className:"text-sm text-dark-muted",children:"Test srasnda tm admlar console'a yazdrlacak."})]})]})})},JL=({onBackToLogin:t})=>{const{currentUser:e}=yn(),[n,r]=T.useState("idle"),[a,o]=T.useState("");T.useEffect(()=>{const h=new URLSearchParams(window.location.search),f=h.get("sso_token")||h.get("sso");f?u(f):t&&t()},[]);const u=async h=>{try{r("processing");const p=new URLSearchParams(window.location.search).get("sso_token");let y=h;if(p){console.log(" Exchanging Google ID token for custom token...");const A=await(await fetch("https://lumobuild.vercel.app/api/sso-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({googleIdToken:h})})).json();if(!A.success)throw new Error(A.message||"Failed to exchange token");y=A.customToken,console.log(" Custom token received from backend")}console.log(" Logging in with custom token...");const b=await HT(ks,y);console.log(" SSO Login successful:",b.user.email);const x=Ne(le,"users",b.user.uid),k=await Jo(x);if(!k.exists())console.log("Creating new user profile for SSO user..."),await Xn(x,{displayName:b.user.displayName||"User",email:b.user.email||null,photoURL:b.user.photoURL||null,role:"member",createdAt:ht(),isOnline:!0,lastSeen:ht(),isUsernameSet:!1});else{const I={isOnline:!0,lastSeen:ht()};k.data().isUsernameSet===void 0&&k.data().displayName&&(I.isUsernameSet=!0),await Xn(x,I,{merge:!0})}r("success"),setTimeout(()=>{window.location.reload()},1500)}catch(f){console.error(" SSO Login failed:",f),r("error"),f.code==="auth/invalid-custom-token"?o("Invalid or expired token. Please try again."):f.code==="auth/network-request-failed"?o("Network error. Please check your connection."):o(f.message||"Login failed. Please try again.")}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:c.jsx("div",{className:"max-w-md w-full bg-dark-sidebar rounded-lg shadow-2xl p-8",children:c.jsxs("div",{className:"text-center",children:[n==="processing"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-brand-primary mx-auto mb-4"}),c.jsx("h2",{className:"text-2xl font-bold text-dark-text mb-2",children:"Logging you in..."}),c.jsx("p",{className:"text-dark-muted",children:"Please wait while we verify your credentials"})]}),n==="success"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-green-500 mb-2",children:"Welcome to Lumo!"}),c.jsx("p",{className:"text-dark-muted",children:"Redirecting to your dashboard..."})]}),n==="error"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-2",children:"Login Failed"}),c.jsx("p",{className:"text-dark-text mb-4",children:a}),c.jsx("button",{onClick:t,className:"bg-brand-primary hover:bg-brand-primary/80 text-white font-medium py-2 px-6 rounded-md transition-colors",children:"Go to Login"})]})]})})})},ZL=({onSwipeLeft:t,onSwipeRight:e,minSwipeDistance:n=50})=>{const r=T.useRef(null),a=T.useRef(null);return{onTouchStart:f=>{a.current=null,r.current=f.targetTouches[0].clientX},onTouchMove:f=>{a.current=f.targetTouches[0].clientX},onTouchEnd:()=>{if(!r.current||!a.current)return;const f=r.current-a.current,p=f>n,y=f<-n;p&&t&&t(),y&&e&&e()}}},eV=()=>{const[t,e]=T.useState({camera:"unknown",microphone:"unknown",notifications:"unknown"});return T.useEffect(()=>{if(ta.getPlatform()!=="android")return;const r=setTimeout(async()=>{console.log("[AndroidPermissions] Requesting permissions on Android startup...");try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(o=>o.stop()),e(o=>({...o,camera:"granted",microphone:"granted"})),console.log("[AndroidPermissions] Camera and microphone permissions granted")}catch(a){console.log("[AndroidPermissions] Camera/microphone permission result:",a.name),a.name==="NotAllowedError"&&e(o=>({...o,camera:"denied",microphone:"denied"}))}if("Notification"in window&&Notification.permission==="default")try{const a=await Notification.requestPermission();e(o=>({...o,notifications:a})),console.log("[AndroidPermissions] Notification permission:",a)}catch(a){console.log("[AndroidPermissions] Notification permission error:",a)}},1e3);return()=>clearTimeout(r)},[]),t};function tV(t){return Pe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"},child:[]}]})(t)}function ES(t){return Pe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(t)}function nV(t){return Pe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"},child:[]}]})(t)}function SS(t){return Pe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(t)}function rV(t){return Pe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 192H312c-13.3 0-24-10.7-24-24V44c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v84h84c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm-276-24V44c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v84H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24zm0 300V344c0-13.3-10.7-24-24-24H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-84h84c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12H312c-13.3 0-24 10.7-24 24v124c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12z"},child:[]}]})(t)}function fb(t){return Pe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"},child:[]}]})(t)}function NN(t){return Pe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"},child:[]}]})(t)}function Bp(t){return Pe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"},child:[]}]})(t)}function sV(t){return Pe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.52 32 0 146.496 0 288v48a32 32 0 0 0 17.689 28.622l14.383 7.191C34.083 431.903 83.421 480 144 480h24c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-24c-31.342 0-59.671 12.879-80 33.627V288c0-105.869 86.131-192 192-192s192 86.131 192 192v1.627C427.671 268.879 399.342 256 368 256h-24c-13.255 0-24 10.745-24 24v176c0 13.255 10.745 24 24 24h24c60.579 0 109.917-48.098 111.928-108.187l14.382-7.191A32 32 0 0 0 512 336v-48c0-141.479-114.496-256-256-256z"},child:[]}]})(t)}function mb(t){return Pe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function iV(t){return Pe({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function aV(t){return Pe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M268.2 381.4l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48c-10.7 4.6-16.5 16.1-13.9 27.5l24 104c2.5 10.8 12.1 18.6 23.4 18.6 100.7 0 193.7-32.4 269.7-86.9l-80-61.8c-10.9 6.5-22.1 12.7-33.6 18.1zm365.6 76.7L475.1 335.5C537.9 256.4 576 156.9 576 48c0-11.2-7.7-20.9-18.6-23.4l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-12.2 26.1-27.9 50.3-46 72.8L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3z"},child:[]}]})(t)}function TS(t){return Pe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(t)}function oV(t){return Pe({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(t)}function lV(t){return Pe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1L362.3 248.3C412.1 230.7 448 183.8 448 128 448 57.3 390.7 0 320 0c-67.1 0-121.5 51.8-126.9 117.4L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3zM96 422.4V464c0 26.5 21.5 48 48 48h350.2L207.4 290.3C144.2 301.3 96 356 96 422.4z"},child:[]}]})(t)}function cV(t){return Pe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1l-55-42.5c15.4-1.4 29.2-13.7 29.2-31.1v-257c0-25.5-29.1-40.4-50.4-25.8L448 177.3v137.2l-32-24.7v-178c0-26.4-21.4-47.8-47.8-47.8H123.9L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4L42.7 82 416 370.6l178.5 138c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.5-6.9 4.2-17-2.8-22.4zM32 400.2c0 26.4 21.4 47.8 47.8 47.8h288.4c11.2 0 21.4-4 29.6-10.5L32 154.7v245.5z"},child:[]}]})(t)}function AN(t){return Pe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"},child:[]}]})(t)}function RN(t){return Pe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const Ds=({isOpen:t,onClose:e,title:n,children:r,size:a="md",showCloseButton:o=!0})=>{if(T.useEffect(()=>{const h=f=>{f.key==="Escape"&&t&&e()};return t?(document.body.style.overflow="hidden",document.addEventListener("keydown",h)):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset",document.removeEventListener("keydown",h)}},[t,e]),!t)return null;const u={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return c.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:e}),c.jsxs("div",{className:Ht("relative bg-dark-sidebar rounded-lg shadow-2xl","w-full mx-4 max-h-[90vh] overflow-y-auto",u[a]),children:[(n||o)&&c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-hover",children:[c.jsx("h2",{className:"text-xl font-semibold text-dark-text",children:n}),o&&c.jsx("button",{onClick:e,className:"text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:24})})]}),c.jsx("div",{className:"p-6",children:r})]})]})},pb={premium:{id:"premium",label:"Premium Member",description:"Premium Member",icon:Zo,color:"#F47FFF"},admin:{id:"admin",label:"Admin",description:"Server Administrator",icon:oN,color:"#f23f42"},verified:{id:"verified",label:"Verified",description:"Verified Member",icon:b7,color:"#3ba55c"},developer:{id:"developer",label:"Developer",description:"App Developer",icon:m7,color:"#5865F2"}},uV=t=>pb[t];class dV{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return hV(e).buffer}}function hV(t){let e=0;for(const a of t)e+=a.byteLength;const n=new Uint8Array(e);let r=0;for(const a of t){const o=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);n.set(o,r),r+=a.byteLength}return n}function IN(t){return new fV(t).unpack()}function jN(t){const e=new mV,n=e.pack(t);return n instanceof Promise?n.then(()=>e.getBuffer()):e.getBuffer()}class fV{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let n;if((n=e^160)<=15)return this.unpack_raw(n);if((n=e^176)<=15)return this.unpack_string(n);if((n=e^144)<=15)return this.unpack_array(n);if((n=e^128)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),n=(e[0]&255)*256+(e[1]&255);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let r=0,a="",o,u;for(;r<e;)o=n[r],o<160?(u=o,r++):(o^192)<32?(u=(o&31)<<6|n[r+1]&63,r+=2):(o^224)<16?(u=(o&15)<<12|(n[r+1]&63)<<6|n[r+2]&63,r+=3):(u=(o&7)<<18|(n[r+1]&63)<<12|(n[r+2]&63)<<6|n[r+3]&63,r+=4),a+=String.fromCodePoint(u);return this.index+=e,a}unpack_array(e){const n=new Array(e);for(let r=0;r<e;r++)n[r]=this.unpack();return n}unpack_map(e){const n={};for(let r=0;r<e;r++){const a=this.unpack();n[a]=this.unpack()}return n}unpack_float(){const e=this.unpack_uint32(),n=e>>31,r=(e>>23&255)-127,a=e&8388607|8388608;return(n===0?1:-1)*a*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),n=this.unpack_uint32(),r=e>>31,a=(e>>20&2047)-1023,u=(e&1048575|1048576)*2**(a-20)+n*2**(a-52);return(r===0?1:-1)*u}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class mV{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),r=n.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const r=a=>{if(a<n){const o=this.pack(e[a]);return o instanceof Promise?o.then(()=>r(a+1)):r(a+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let n=0;e<0&&(n=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),a=e/2**r-1,o=Math.floor(a*2**52),u=2**32,h=n<<31|r+1023<<20|o/u&1048575,f=o%u;this._bufferBuilder.append(203),this.pack_int32(h),this.pack_int32(f)}pack_object(e){const n=Object.keys(e),r=n.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const a=o=>{if(o<n.length){const u=n[o];if(e.hasOwnProperty(u)){this.pack(u);const h=this.pack(e[u]);if(h instanceof Promise)return h.then(()=>a(o+1))}return a(o+1)}};return a(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const n=e&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(e){const n=e/4294967296,r=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const n=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new dV,this._textEncoder=new TextEncoder}}let DN=!0,PN=!0;function fd(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseFloat(r[n],10)}function dl(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,a=r.addEventListener;r.addEventListener=function(u,h){if(u!==e)return a.apply(this,arguments);const f=p=>{const y=n(p);y&&(h.handleEvent?h.handleEvent(y):h(y))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(h,f),a.apply(this,[u,f])};const o=r.removeEventListener;r.removeEventListener=function(u,h){if(u!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(h))return o.apply(this,arguments);const f=this._eventMap[e].get(h);return this._eventMap[e].delete(h),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[u,f])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function pV(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(DN=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function gV(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(PN=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function MN(){if(typeof window=="object"){if(DN)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function gb(t,e){PN&&console.warn(t+" is deprecated, please use "+e+" instead.")}function vV(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(a=>a.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(fd(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(fd(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(fd(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,e._safariVersion=fd(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function CS(t){return Object.prototype.toString.call(t)==="[object Object]"}function ON(t){return CS(t)?Object.keys(t).reduce(function(e,n){const r=CS(t[n]),a=r?ON(t[n]):t[n],o=r&&!Object.keys(a).length;return a===void 0||o?e:Object.assign(e,{[n]:a})},{}):t}function Ey(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Ey(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(a=>{Ey(t,t.get(a),n)})}))}function kS(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const o=[];return t.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&o.push(u)}),o.forEach(u=>{t.forEach(h=>{h.type===r&&h.trackId===u.id&&Ey(t,h,a)})}),a}const NS=MN;function LN(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(h){if(typeof h!="object"||h.mandatory||h.optional)return h;const f={};return Object.keys(h).forEach(p=>{if(p==="require"||p==="advanced"||p==="mediaSource")return;const y=typeof h[p]=="object"?h[p]:{ideal:h[p]};y.exact!==void 0&&typeof y.exact=="number"&&(y.min=y.max=y.exact);const b=function(x,k){return x?x+k.charAt(0).toUpperCase()+k.slice(1):k==="deviceId"?"sourceId":k};if(y.ideal!==void 0){f.optional=f.optional||[];let x={};typeof y.ideal=="number"?(x[b("min",p)]=y.ideal,f.optional.push(x),x={},x[b("max",p)]=y.ideal,f.optional.push(x)):(x[b("",p)]=y.ideal,f.optional.push(x))}y.exact!==void 0&&typeof y.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[b("",p)]=y.exact):["min","max"].forEach(x=>{y[x]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[b(x,p)]=y[x])})}),h.advanced&&(f.optional=(f.optional||[]).concat(h.advanced)),f},a=function(h,f){if(e.version>=61)return f(h);if(h=JSON.parse(JSON.stringify(h)),h&&typeof h.audio=="object"){const p=function(y,b,x){b in y&&!(x in y)&&(y[x]=y[b],delete y[b])};h=JSON.parse(JSON.stringify(h)),p(h.audio,"autoGainControl","googAutoGainControl"),p(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=r(h.audio)}if(h&&typeof h.video=="object"){let p=h.video.facingMode;p=p&&(typeof p=="object"?p:{ideal:p});const y=e.version<66;if(p&&(p.exact==="user"||p.exact==="environment"||p.ideal==="user"||p.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!y)){delete h.video.facingMode;let b;if(p.exact==="environment"||p.ideal==="environment"?b=["back","rear"]:(p.exact==="user"||p.ideal==="user")&&(b=["front"]),b)return n.mediaDevices.enumerateDevices().then(x=>{x=x.filter(I=>I.kind==="videoinput");let k=x.find(I=>b.some(A=>I.label.toLowerCase().includes(A)));return!k&&x.length&&b.includes("back")&&(k=x[x.length-1]),k&&(h.video.deviceId=p.exact?{exact:k.deviceId}:{ideal:k.deviceId}),h.video=r(h.video),NS("chrome: "+JSON.stringify(h)),f(h)})}h.video=r(h.video)}return NS("chrome: "+JSON.stringify(h)),f(h)},o=function(h){return e.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(h,f,p){a(h,y=>{n.webkitGetUserMedia(y,f,b=>{p&&p(o(b))})})};if(n.getUserMedia=u.bind(n),n.mediaDevices.getUserMedia){const h=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(f){return a(f,p=>h(p).then(y=>{if(p.audio&&!y.getAudioTracks().length||p.video&&!y.getVideoTracks().length)throw y.getTracks().forEach(b=>{b.stop()}),new DOMException("","NotFoundError");return y},y=>Promise.reject(o(y))))}}}function VN(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function UN(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",a=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(h=>h.track&&h.track.id===a.track.id):o={track:a.track};const u=new Event("track");u.track=a.track,u.receiver=o,u.transceiver={receiver:o},u.streams=[r.stream],this.dispatchEvent(u)}),r.stream.getTracks().forEach(a=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(h=>h.track&&h.track.id===a.id):o={track:a};const u=new Event("track");u.track=a,u.receiver=o,u.transceiver={receiver:o},u.streams=[r.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else dl(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function zN(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(a,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=a.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:a}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(h,f){let p=a.apply(this,arguments);return p||(p=e(this,h),this._senders.push(p)),p};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(h){o.apply(this,arguments);const f=this._senders.indexOf(h);f!==-1&&this._senders.splice(f,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(u=>{this._senders.push(e(this,u))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(u=>{const h=this._senders.find(f=>f.track===u);h&&this._senders.splice(this._senders.indexOf(h),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(a=>a._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function BN(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(u=>u._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(u=>kS(u,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const a=n.apply(this,[]);return a.forEach(o=>o._pc=this),a}),dl(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(o=>kS(o,a.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let a,o,u;return this.getSenders().forEach(h=>{h.track===r&&(a?u=!0:a=h)}),this.getReceivers().forEach(h=>(h.track===r&&(o?u=!0:o=h),h.track===r)),u||a&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function FN(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,h){if(!h)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[h.id]?this._shimmedLocalStreams[h.id].indexOf(f)===-1&&this._shimmedLocalStreams[h.id].push(f):this._shimmedLocalStreams[h.id]=[h,f],f};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(p=>{if(this.getSenders().find(b=>b.track===p))throw new DOMException("Track already exists.","InvalidAccessError")});const h=this.getSenders();n.apply(this,arguments);const f=this.getSenders().filter(p=>h.indexOf(p)===-1);this._shimmedLocalStreams[u.id]=[u].concat(f)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],r.apply(this,arguments)};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(h=>{const f=this._shimmedLocalStreams[h].indexOf(u);f!==-1&&this._shimmedLocalStreams[h].splice(f,1),this._shimmedLocalStreams[h].length===1&&delete this._shimmedLocalStreams[h]}),a.apply(this,arguments)}}function HN(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return FN(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const y=n.apply(this);return this._reverseStreams=this._reverseStreams||{},y.map(b=>this._reverseStreams[b.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(y){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},y.getTracks().forEach(b=>{if(this.getSenders().find(k=>k.track===b))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[y.id]){const b=new t.MediaStream(y.getTracks());this._streams[y.id]=b,this._reverseStreams[b.id]=y,y=b}r.apply(this,[y])};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(y){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[y.id]||y]),delete this._reverseStreams[this._streams[y.id]?this._streams[y.id].id:y.id],delete this._streams[y.id]},t.RTCPeerConnection.prototype.addTrack=function(y,b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const x=[].slice.call(arguments,1);if(x.length!==1||!x[0].getTracks().find(A=>A===y))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(A=>A.track===y))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const I=this._streams[b.id];if(I)I.addTrack(y),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const A=new t.MediaStream([y]);this._streams[b.id]=A,this._reverseStreams[A.id]=b,this.addStream(A)}return this.getSenders().find(A=>A.track===y)};function o(p,y){let b=y.sdp;return Object.keys(p._reverseStreams||[]).forEach(x=>{const k=p._reverseStreams[x],I=p._streams[k.id];b=b.replace(new RegExp(I.id,"g"),k.id)}),new RTCSessionDescription({type:y.type,sdp:b})}function u(p,y){let b=y.sdp;return Object.keys(p._reverseStreams||[]).forEach(x=>{const k=p._reverseStreams[x],I=p._streams[k.id];b=b.replace(new RegExp(k.id,"g"),I.id)}),new RTCSessionDescription({type:y.type,sdp:b})}["createOffer","createAnswer"].forEach(function(p){const y=t.RTCPeerConnection.prototype[p],b={[p](){const x=arguments;return arguments.length&&typeof arguments[0]=="function"?y.apply(this,[I=>{const A=o(this,I);x[0].apply(null,[A])},I=>{x[1]&&x[1].apply(null,I)},arguments[2]]):y.apply(this,arguments).then(I=>o(this,I))}};t.RTCPeerConnection.prototype[p]=b[p]});const h=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?h.apply(this,arguments):(arguments[0]=u(this,arguments[0]),h.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const p=f.get.apply(this);return p.type===""?p:o(this,p)}}),t.RTCPeerConnection.prototype.removeTrack=function(y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!y._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(y._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let x;Object.keys(this._streams).forEach(k=>{this._streams[k].getTracks().find(A=>y.track===A)&&(x=this._streams[k])}),x&&(x.getTracks().length===1?this.removeStream(this._reverseStreams[x.id]):x.removeTrack(y.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Sy(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=a[n]})}function $N(t,e){dl(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}const AS=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:$N,shimAddTrackRemoveTrack:HN,shimAddTrackRemoveTrackWithNative:FN,shimGetSendersWithDtmf:zN,shimGetUserMedia:LN,shimMediaStream:VN,shimOnTrack:UN,shimPeerConnection:Sy,shimSenderReceiverGetStats:BN},Symbol.toStringTag,{value:"Module"}));function qN(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(a,o,u){gb("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(a).then(o,u)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const a=function(u,h,f){h in u&&!(f in u)&&(u[f]=u[h],delete u[h])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u.audio,"autoGainControl","mozAutoGainControl"),a(u.audio,"noiseSuppression","mozNoiseSuppression")),o(u)},r&&r.prototype.getSettings){const u=r.prototype.getSettings;r.prototype.getSettings=function(){const h=u.apply(this,arguments);return a(h,"mozAutoGainControl","autoGainControl"),a(h,"mozNoiseSuppression","noiseSuppression"),h}}if(r&&r.prototype.applyConstraints){const u=r.prototype.applyConstraints;r.prototype.applyConstraints=function(h){return this.kind==="audio"&&typeof h=="object"&&(h=JSON.parse(JSON.stringify(h)),a(h,"autoGainControl","mozAutoGainControl"),a(h,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[h])}}}}function yV(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function GN(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ty(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const o=t.RTCPeerConnection.prototype[a],u={[a](){return arguments[0]=new(a==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[a]=u[a]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,u,h]=arguments;return r.apply(this,[o||null]).then(f=>{if(e.version<53&&!u)try{f.forEach(p=>{p.type=n[p.type]||p.type})}catch(p){if(p.name!=="TypeError")throw p;f.forEach((y,b)=>{f.set(b,Object.assign({},y,{type:n[y.type]||y.type}))})}return f}).then(u,h)}}function YN(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=e.apply(this,[]);return a.forEach(o=>o._pc=this),a});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function KN(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(a=>a._pc=this),r}),dl(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function QN(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){gb("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function XN(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function WN(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const a=r.length>0;a&&r.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(a){const{sender:u}=o,h=u.getParameters();(!("encodings"in h)||h.encodings.length===1&&Object.keys(h.encodings[0]).length===0)&&(h.encodings=r,u.sendEncodings=r,this.setParametersPromises.push(u.setParameters(h).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return o})}function JN(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function ZN(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function eA(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const RS=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:WN,shimCreateAnswer:eA,shimCreateOffer:ZN,shimGetDisplayMedia:yV,shimGetParameters:JN,shimGetUserMedia:qN,shimOnTrack:GN,shimPeerConnection:Ty,shimRTCDataChannel:XN,shimReceiverGetStats:KN,shimRemoveStream:QN,shimSenderGetStats:YN},Symbol.toStringTag,{value:"Module"}));function tA(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(a=>e.call(this,a,r)),r.getVideoTracks().forEach(a=>e.call(this,a,r))},t.RTCPeerConnection.prototype.addTrack=function(r,...a){return a&&a.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const a=n.getTracks();this.getSenders().forEach(o=>{a.includes(o.track)&&this.removeTrack(o)})})}}function nA(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const o=new Event("addstream");o.stream=a,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const u=new Event("addstream");u.stream=o,r.dispatchEvent(u)})}),e.apply(r,arguments)}}}function rA(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,a=e.setLocalDescription,o=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(p,y){const b=arguments.length>=2?arguments[2]:arguments[0],x=n.apply(this,[b]);return y?(x.then(p,y),Promise.resolve()):x},e.createAnswer=function(p,y){const b=arguments.length>=2?arguments[2]:arguments[0],x=r.apply(this,[b]);return y?(x.then(p,y),Promise.resolve()):x};let h=function(f,p,y){const b=a.apply(this,[f]);return y?(b.then(p,y),Promise.resolve()):b};e.setLocalDescription=h,h=function(f,p,y){const b=o.apply(this,[f]);return y?(b.then(p,y),Promise.resolve()):b},e.setRemoteDescription=h,h=function(f,p,y){const b=u.apply(this,[f]);return y?(b.then(p,y),Promise.resolve()):b},e.addIceCandidate=h}function sA(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=a=>r(iA(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,a,o){e.mediaDevices.getUserMedia(r).then(a,o)}).bind(e))}function iA(t){return t&&t.video!==void 0?Object.assign({},t,{video:ON(t.video)}):t}function aA(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,a){if(r&&r.iceServers){const o=[];for(let u=0;u<r.iceServers.length;u++){let h=r.iceServers[u];h.urls===void 0&&h.url?(gb("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,o.push(h)):o.push(r.iceServers[u])}r.iceServers=o}return new e(r,a)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function oA(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function lA(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const a=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveAudio===!0&&!a&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(u=>u.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function cA(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const IS=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:cA,shimCallbacksAPI:rA,shimConstraints:iA,shimCreateOfferLegacy:lA,shimGetUserMedia:sA,shimLocalStreamsAPI:tA,shimRTCIceServerUrls:aA,shimRemoteStreamsAPI:nA,shimTrackEventTransceiver:oA},Symbol.toStringTag,{value:"Module"}));var T0={exports:{}},jS;function bV(){return jS||(jS=1,(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((a,o)=>(o>0?"m="+a:a).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(a=>a.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const a={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":a.relatedAddress=r[o+1];break;case"rport":a.relatedPort=parseInt(r[o+1],10);break;case"tcptype":a.tcpType=r[o+1];break;case"ufrag":a.ufrag=r[o+1],a.usernameFragment=r[o+1];break;default:a[r[o]]===void 0&&(a[r[o]]=r[o+1]);break}return a},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const a=n.component;a==="rtp"?r.push(1):a==="rtcp"?r.push(2):r.push(a),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const a={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),a.name=r[0],a.clockRate=parseInt(r[1],10),a.channels=r.length===3?parseInt(r[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const a=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let a;const o=n.substring(n.indexOf(" ")+1).split(";");for(let u=0;u<o.length;u++)a=o[u].trim().split("="),r[a[0].trim()]=a[1];return r},e.writeFmtp=function(n){let r="",a=n.payloadType;if(n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(u=>{n.parameters[u]!==void 0?o.push(u+"="+n.parameters[u]):o.push(u)}),r+="a=fmtp:"+a+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",a=n.payloadType;return n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+a+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),a={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(a.attribute=n.substring(r+1,o),a.value=n.substring(o+1)):a.attribute=n.substring(r+1),a},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(a=>parseInt(a,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let a="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{a+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),a},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const a=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return a&&o?{usernameFragment:a.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let h=3;h<o.length;h++){const f=o[h],p=e.matchPrefix(n,"a=rtpmap:"+f+" ")[0];if(p){const y=e.parseRtpMap(p),b=e.matchPrefix(n,"a=fmtp:"+f+" ");switch(y.parameters=b.length?e.parseFmtp(b[0]):{},y.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),r.codecs.push(y),y.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(y.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(h=>{r.headerExtensions.push(e.parseExtmap(h))});const u=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(h=>{u.forEach(f=>{h.rtcpFeedback.find(y=>y.type===f.type&&y.parameter===f.parameter)||h.rtcpFeedback.push(f)})}),r},e.writeRtpDescription=function(n,r){let a="";a+="m="+n+" ",a+=r.codecs.length>0?"9":"0",a+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=r.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(u=>{a+=e.writeRtpMap(u),a+=e.writeFmtp(u),a+=e.writeRtcpFb(u)});let o=0;return r.codecs.forEach(u=>{u.maxptime>o&&(o=u.maxptime)}),o>0&&(a+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(u=>{a+=e.writeExtmap(u)}),a},e.parseRtpEncodingParameters=function(n){const r=[],a=e.parseRtpParameters(n),o=a.fecMechanisms.indexOf("RED")!==-1,u=a.fecMechanisms.indexOf("ULPFEC")!==-1,h=e.matchPrefix(n,"a=ssrc:").map(x=>e.parseSsrcMedia(x)).filter(x=>x.attribute==="cname"),f=h.length>0&&h[0].ssrc;let p;const y=e.matchPrefix(n,"a=ssrc-group:FID").map(x=>x.substring(17).split(" ").map(I=>parseInt(I,10)));y.length>0&&y[0].length>1&&y[0][0]===f&&(p=y[0][1]),a.codecs.forEach(x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let k={ssrc:f,codecPayloadType:parseInt(x.parameters.apt,10)};f&&p&&(k.rtx={ssrc:p}),r.push(k),o&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:f,mechanism:u?"red+ulpfec":"red"},r.push(k))}}),r.length===0&&f&&r.push({ssrc:f});let b=e.matchPrefix(n,"b=");return b.length&&(b[0].indexOf("b=TIAS:")===0?b=parseInt(b[0].substring(7),10):b[0].indexOf("b=AS:")===0?b=parseInt(b[0].substring(5),10)*1e3*.95-2e3*8:b=void 0,r.forEach(x=>{x.maxBitrate=b})),r},e.parseRtcpParameters=function(n){const r={},a=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname")[0];a&&(r.cname=a.value,r.ssrc=a.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const u=e.matchPrefix(n,"a=rtcp-mux");return r.mux=u.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const a=e.matchPrefix(n,"a=msid:");if(a.length===1)return r=a[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),a=e.matchPrefix(n,"a=max-message-size:");let o;a.length>0&&(o=parseInt(a[0].substring(19),10)),isNaN(o)&&(o=65536);const u=e.matchPrefix(n,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const h=e.matchPrefix(n,"a=sctpmap:");if(h.length>0){const f=h[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let a=[];return n.protocol!=="DTLS/SCTP"?a=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:a=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&a.push("a=max-message-size:"+r.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,a){let o;const u=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+o+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const a=e.splitLines(n);for(let o=0;o<a.length;o++)switch(a[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const a=e.splitLines(n)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},e.parseOLine=function(n){const a=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let a=0;a<r.length;a++)if(r[a].length<2||r[a].charAt(1)!=="=")return!1;return!0},t.exports=e})(T0)),T0.exports}var uA=bV();const gc=Kd(uA),xV=q6({__proto__:null,default:gc},[uA]);function dm(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const a=new e(r),o=gc.parseCandidate(r.candidate);for(const u in o)u in a||Object.defineProperty(a,u,{value:o[u]});return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,dl(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Cy(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||dl(t,"icecandidate",e=>{if(e.candidate){const n=gc.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function hm(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(h){if(!h||!h.sdp)return!1;const f=gc.splitSections(h.sdp);return f.shift(),f.some(p=>{const y=gc.parseMLine(p);return y&&y.kind==="application"&&y.protocol.indexOf("SCTP")!==-1})},r=function(h){const f=h.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const p=parseInt(f[1],10);return p!==p?-1:p},a=function(h){let f=65536;return e.browser==="firefox"&&(e.version<57?h===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},o=function(h,f){let p=65536;e.browser==="firefox"&&e.version===57&&(p=65535);const y=gc.matchPrefix(h.sdp,"a=max-message-size:");return y.length>0?p=parseInt(y[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(p=2147483637),p},u=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const f=r(arguments[0]),p=a(f),y=o(arguments[0],f);let b;p===0&&y===0?b=Number.POSITIVE_INFINITY:p===0||y===0?b=Math.max(p,y):b=Math.min(p,y);const x={};Object.defineProperty(x,"maxMessageSize",{get(){return b}}),this._sctp=x}return u.apply(this,arguments)}}function fm(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,a){const o=r.send;r.send=function(){const h=arguments[0],f=h.length||h.size||h.byteLength;if(r.readyState==="open"&&a.sctp&&f>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const a=n.apply(this,arguments);return e(a,this),a},dl(t,"datachannel",r=>(e(r.channel,r.target),r))}function ky(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const o=a.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const u=new Event("connectionstatechange",a);o.dispatchEvent(u)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Ny(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=a.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&a instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:a.type,sdp:o}):a.sdp=o}return n.apply(this,arguments)}}function mm(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function pm(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return n.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer";break}return a.sdp||a.type!=="offer"&&a.type!=="answer"?n.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>n.apply(this,[u]))})}const _V=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Ny,shimAddIceCandidateNullOrEmpty:mm,shimConnectionState:ky,shimMaxMessageSize:hm,shimParameterlessSetLocalDescription:pm,shimRTCIceCandidate:dm,shimRTCIceCandidateRelayProtocol:Cy,shimSendThrowTypeError:fm},Symbol.toStringTag,{value:"Module"}));function wV({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=MN,r=vV(t),a={browserDetails:r,commonShim:_V,extractVersion:fd,disableLog:pV,disableWarnings:gV,sdp:xV};switch(r.browser){case"chrome":if(!AS||!Sy||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),a;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),a;n("adapter.js shimming chrome."),a.browserShim=AS,mm(t,r),pm(t),LN(t,r),VN(t),Sy(t,r),UN(t),HN(t,r),zN(t),BN(t),$N(t,r),dm(t),Cy(t),ky(t),hm(t,r),fm(t),Ny(t,r);break;case"firefox":if(!RS||!Ty||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),a;n("adapter.js shimming firefox."),a.browserShim=RS,mm(t,r),pm(t),qN(t,r),Ty(t,r),GN(t),QN(t),YN(t),KN(t),XN(t),WN(t),JN(t),ZN(t),eA(t),dm(t),ky(t),hm(t,r),fm(t);break;case"safari":if(!IS||!e.shimSafari)return n("Safari shim is not included in this adapter release."),a;n("adapter.js shimming safari."),a.browserShim=IS,mm(t,r),pm(t),aA(t),lA(t),rA(t),tA(t),nA(t),oA(t),sA(t),cA(t),dm(t),Cy(t),hm(t,r),fm(t),Ny(t,r);break;default:n("Unsupported browser!");break}return a}const DS=wV({window:typeof window>"u"?void 0:window});function hl(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}class dA{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],r=e.byteLength,a=Math.ceil(r/this.chunkedMTU);let o=0,u=0;for(;u<r;){const h=Math.min(r,u+this.chunkedMTU),f=e.slice(u,h),p={__peerData:this._dataCount,n:o,data:f,total:a};n.push(p),u=h,o++}return this._dataCount++,n}}}function EV(t){let e=0;for(const a of t)e+=a.byteLength;const n=new Uint8Array(e);let r=0;for(const a of t)n.set(a,r),r+=a.byteLength;return n}const C0=DS.default||DS,td=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return C0.browserDetails.browser}getVersion(){return C0.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=C0.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,r=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),r=!0}catch{}finally{n&&n.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},SV=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),hA=()=>Math.random().toString(36).slice(2),PS={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class TV extends dA{noop(){}blobToArrayBuffer(e,n){const r=new FileReader;return r.onload=function(a){a.target&&n(a.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=PS,this.browser=td.getBrowser(),this.browserVersion=td.getVersion(),this.pack=jN,this.unpack=IN,this.supports=(function(){const n={browser:td.isBrowserSupported(),webRTC:td.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let r;try{r=new RTCPeerConnection(PS),n.audioVideo=!0;let a;try{a=r.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!a.ordered;try{a.binaryType="blob",n.binaryBlob=!td.isIOS}catch{}}catch{}finally{a&&a.close()}}catch{}finally{r&&r.close()}return n})(),this.validateId=SV,this.randomToken=hA}}const Lr=new TV,CV="PeerJS: ";class kV{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...n){const r=[CV,...n];for(const a in r)r[a]instanceof Error&&(r[a]="("+r[a].name+") "+r[a].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var Xe=new kV,vb={},NV=Object.prototype.hasOwnProperty,Nr="~";function zd(){}Object.create&&(zd.prototype=Object.create(null),new zd().__proto__||(Nr=!1));function AV(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function fA(t,e,n,r,a){if(typeof n!="function")throw new TypeError("The listener must be a function");var o=new AV(n,r||t,a),u=Nr?Nr+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],o]:t._events[u].push(o):(t._events[u]=o,t._eventsCount++),t}function gm(t,e){--t._eventsCount===0?t._events=new zd:delete t._events[e]}function _r(){this._events=new zd,this._eventsCount=0}_r.prototype.eventNames=function(){var e=[],n,r;if(this._eventsCount===0)return e;for(r in n=this._events)NV.call(n,r)&&e.push(Nr?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};_r.prototype.listeners=function(e){var n=Nr?Nr+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,o=r.length,u=new Array(o);a<o;a++)u[a]=r[a].fn;return u};_r.prototype.listenerCount=function(e){var n=Nr?Nr+e:e,r=this._events[n];return r?r.fn?1:r.length:0};_r.prototype.emit=function(e,n,r,a,o,u){var h=Nr?Nr+e:e;if(!this._events[h])return!1;var f=this._events[h],p=arguments.length,y,b;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,n),!0;case 3:return f.fn.call(f.context,n,r),!0;case 4:return f.fn.call(f.context,n,r,a),!0;case 5:return f.fn.call(f.context,n,r,a,o),!0;case 6:return f.fn.call(f.context,n,r,a,o,u),!0}for(b=1,y=new Array(p-1);b<p;b++)y[b-1]=arguments[b];f.fn.apply(f.context,y)}else{var x=f.length,k;for(b=0;b<x;b++)switch(f[b].once&&this.removeListener(e,f[b].fn,void 0,!0),p){case 1:f[b].fn.call(f[b].context);break;case 2:f[b].fn.call(f[b].context,n);break;case 3:f[b].fn.call(f[b].context,n,r);break;case 4:f[b].fn.call(f[b].context,n,r,a);break;default:if(!y)for(k=1,y=new Array(p-1);k<p;k++)y[k-1]=arguments[k];f[b].fn.apply(f[b].context,y)}}return!0};_r.prototype.on=function(e,n,r){return fA(this,e,n,r,!1)};_r.prototype.once=function(e,n,r){return fA(this,e,n,r,!0)};_r.prototype.removeListener=function(e,n,r,a){var o=Nr?Nr+e:e;if(!this._events[o])return this;if(!n)return gm(this,o),this;var u=this._events[o];if(u.fn)u.fn===n&&(!a||u.once)&&(!r||u.context===r)&&gm(this,o);else{for(var h=0,f=[],p=u.length;h<p;h++)(u[h].fn!==n||a&&!u[h].once||r&&u[h].context!==r)&&f.push(u[h]);f.length?this._events[o]=f.length===1?f[0]:f:gm(this,o)}return this};_r.prototype.removeAllListeners=function(e){var n;return e?(n=Nr?Nr+e:e,this._events[n]&&gm(this,n)):(this._events=new zd,this._eventsCount=0),this};_r.prototype.off=_r.prototype.removeListener;_r.prototype.addListener=_r.prototype.on;_r.prefixed=Nr;_r.EventEmitter=_r;vb=_r;var fl={};hl(fl,"ConnectionType",()=>eo);hl(fl,"PeerErrorType",()=>Vn);hl(fl,"BaseConnectionErrorType",()=>Ay);hl(fl,"DataConnectionErrorType",()=>yb);hl(fl,"SerializationType",()=>Fp);hl(fl,"SocketEventType",()=>qa);hl(fl,"ServerMessageType",()=>vr);var eo=(function(t){return t.Data="data",t.Media="media",t})({}),Vn=(function(t){return t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc",t})({}),Ay=(function(t){return t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed",t})({}),yb=(function(t){return t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big",t})({}),Fp=(function(t){return t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw",t})({}),qa=(function(t){return t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close",t})({}),vr=(function(t){return t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE",t})({});const mA="1.5.5";class RV extends vb.EventEmitter{constructor(e,n,r,a,o,u=5e3){super(),this.pingInterval=u,this._disconnected=!0,this._messagesQueue=[];const h=e?"wss://":"ws://";this._baseUrl=h+n+":"+r+a+"peerjs?key="+o}start(e,n){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+mA),this._disconnected=!1,this._socket.onmessage=a=>{let o;try{o=JSON.parse(a.data),Xe.log("Server message received:",o)}catch{Xe.log("Invalid server message",a.data);return}this.emit(qa.Message,o)},this._socket.onclose=a=>{this._disconnected||(Xe.log("Socket closed.",a),this._cleanup(),this._disconnected=!0,this.emit(qa.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Xe.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Xe.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:vr.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(qa.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class pA{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===eo.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const r=this.connection,a={ordered:!!e.reliable},o=n.createDataChannel(r.label,a);r._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Xe.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,r=this.connection.connectionId,a=this.connection.type,o=this.connection.provider;Xe.log("Listening for ICE candidates."),e.onicecandidate=u=>{!u.candidate||!u.candidate.candidate||(Xe.log(`Received ICE candidates for ${n}:`,u.candidate),o.socket.send({type:vr.Candidate,payload:{candidate:u.candidate,type:a,connectionId:r},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Xe.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(Ay.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":Xe.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(Ay.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":Xe.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Xe.log("Listening for data channel"),e.ondatachannel=u=>{Xe.log("Received data channel");const h=u.channel;o.getConnection(n,r)._initializeDataChannel(h)},Xe.log("Listening for remote stream"),e.ontrack=u=>{Xe.log("Received remote stream");const h=u.streams[0],f=o.getConnection(n,r);if(f.type===eo.Media){const p=f;this._addStreamToMediaConnection(h,p)}}}cleanup(){Xe.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const n=e.signalingState!=="closed";let r=!1;const a=this.connection.dataChannel;a&&(r=!!a.readyState&&a.readyState!=="closed"),(n||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);Xe.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Xe.log("Set localDescription:",r,`for:${this.connection.peer}`);let a={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===eo.Data){const o=this.connection;a={...a,label:o.label,reliable:o.reliable,serialization:o.serialization}}n.socket.send({type:vr.Offer,payload:a,dst:this.connection.peer})}catch(a){a!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(Vn.WebRTC,a),Xe.log("Failed to setLocalDescription, ",a))}}catch(r){n.emitError(Vn.WebRTC,r),Xe.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const r=await e.createAnswer();Xe.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Xe.log("Set localDescription:",r,`for:${this.connection.peer}`),n.socket.send({type:vr.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(a){n.emitError(Vn.WebRTC,a),Xe.log("Failed to setLocalDescription, ",a)}}catch(r){n.emitError(Vn.WebRTC,r),Xe.log("Failed to create answer, ",r)}}async handleSDP(e,n){n=new RTCSessionDescription(n);const r=this.connection.peerConnection,a=this.connection.provider;Xe.log("Setting remote description",n);const o=this;try{await r.setRemoteDescription(n),Xe.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await o._makeAnswer()}catch(u){a.emitError(Vn.WebRTC,u),Xe.log("Failed to setRemoteDescription, ",u)}}async handleCandidate(e){Xe.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Xe.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(Vn.WebRTC,n),Xe.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(e,n){if(Xe.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return Xe.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{n.addTrack(r,e)})}_addStreamToMediaConnection(e,n){Xe.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class gA extends vb.EventEmitter{emitError(e,n){Xe.error("Error:",n),this.emit("error",new IV(`${e}`,n))}}class IV extends Error{constructor(e,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=e}}class vA extends gA{get open(){return this._open}constructor(e,n,r){super(),this.peer=e,this.provider=n,this.options=r,this._open=!1,this.metadata=r.metadata}}class Zm extends vA{static#e=this.ID_PREFIX="mc_";get type(){return eo.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,r){super(e,n,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Zm.ID_PREFIX+Lr.randomToken(),this._negotiator=new pA(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Xe.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Xe.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Xe.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,r=e.payload;switch(e.type){case vr.Answer:this._negotiator.handleSDP(n,r.sdp),this._open=!0;break;case vr.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:Xe.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(e,n={}){if(this._localStream){Xe.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const a of r)this.handleMessage(a);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class jV{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:r,port:a,path:o,key:u}=this._options,h=new URL(`${n}://${r}:${a}${o}${u}/${e}`);return h.searchParams.set("ts",`${Date.now()}${Math.random()}`),h.searchParams.set("version",mA),fetch(h.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Xe.error("Error retrieving ID",e);let n="";throw this._options.path==="/"&&this._options.host!==Lr.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let n="";throw this._options.host===Lr.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Xe.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class ep extends vA{static#e=this.ID_PREFIX="dc_";static#t=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return eo.Data}constructor(e,n,r){super(e,n,r),this.connectionId=this.options.connectionId||ep.ID_PREFIX+hA(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new pA(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Xe.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{Xe.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{Xe.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,n=!1){if(!this.open){this.emitError(yb.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,n)}async handleMessage(e){const n=e.payload;switch(e.type){case vr.Answer:await this._negotiator.handleSDP(e.type,n.sdp);break;case vr.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:Xe.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class bb extends ep{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>ep.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return Xe.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class k0 extends bb{close(e){super.close(e),this._chunkedData={}}constructor(e,n,r){super(e,n,r),this.chunker=new dA,this.serialization=Fp.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=IN(e),r=n.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(e){const n=e.__peerData,r=this._chunkedData[n]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[n]=r,r.total===r.count){delete this._chunkedData[n];const a=EV(r.data);this._handleDataMessage({data:a})}}_send(e,n){const r=jN(e);if(r instanceof Promise)return this._send_blob(r);if(!n&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const n=await e;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(e){const n=this.chunker.chunk(e);Xe.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const r of n)this.send(r,!0)}}class DV extends bb{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=Fp.None}}class PV extends bb{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),r=n.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",n)}_send(e,n){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=Lr.chunkedMTU){this.emitError(yb.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=Fp.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class xb extends gA{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,r]of this._connections)e[n]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){super(),this._serializers={raw:DV,json:PV,binary:k0,"binary-utf8":k0,default:k0},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?n=e:e&&(r=e.toString()),n={debug:0,host:Lr.CLOUD_HOST,port:Lr.CLOUD_PORT,path:"/",key:xb.DEFAULT_KEY,token:Lr.randomToken(),config:Lr.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Lr.CLOUD_HOST?this._options.secure=Lr.isSecure():this._options.host==Lr.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Xe.setLogFunction(this._options.logFunction),Xe.logLevel=this._options.debug||0,this._api=new jV(n),this._socket=this._createServerConnection(),!Lr.supports.audioVideo&&!Lr.supports.data){this._delayedAbort(Vn.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!Lr.validateId(r)){this._delayedAbort(Vn.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(a=>this._initialize(a)).catch(a=>this._abort(Vn.ServerError,a))}_createServerConnection(){const e=new RV(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(qa.Message,n=>{this._handleMessage(n)}),e.on(qa.Error,n=>{this._abort(Vn.SocketError,n)}),e.on(qa.Disconnected,()=>{this.disconnected||(this.emitError(Vn.Network,"Lost connection to server."),this.disconnect())}),e.on(qa.Close,()=>{this.disconnected||this._abort(Vn.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,r=e.payload,a=e.src;switch(n){case vr.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case vr.Error:this._abort(Vn.ServerError,r.msg);break;case vr.IdTaken:this._abort(Vn.UnavailableID,`ID "${this.id}" is taken`);break;case vr.InvalidKey:this._abort(Vn.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case vr.Leave:Xe.log(`Received leave message from ${a}`),this._cleanupPeer(a),this._connections.delete(a);break;case vr.Expire:this.emitError(Vn.PeerUnavailable,`Could not connect to peer ${a}`);break;case vr.Offer:{const o=r.connectionId;let u=this.getConnection(a,o);if(u&&(u.close(),Xe.warn(`Offer received for existing Connection ID:${o}`)),r.type===eo.Media){const f=new Zm(a,this,{connectionId:o,_payload:r,metadata:r.metadata});u=f,this._addConnection(a,u),this.emit("call",f)}else if(r.type===eo.Data){const f=new this._serializers[r.serialization](a,this,{connectionId:o,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});u=f,this._addConnection(a,u),this.emit("connection",f)}else{Xe.warn(`Received malformed connection type:${r.type}`);return}const h=this._getMessages(o);for(const f of h)u.handleMessage(f);break}default:{if(!r){Xe.warn(`You received a malformed message from ${a} of type ${n}`);return}const o=r.connectionId,u=this.getConnection(a,o);u&&u.peerConnection?u.handleMessage(e):o?this._storeMessage(o,e):Xe.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected){Xe.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Vn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,r),r}call(e,n,r={}){if(this.disconnected){Xe.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Vn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){Xe.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const a=new Zm(e,this,{...r,_stream:n});return this._addConnection(e,a),a}_addConnection(e,n){Xe.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const r=this._connections.get(e);if(!r)return null;for(const a of r)if(a.connectionId===n)return a;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){Xe.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Xe.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const r of n)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;Xe.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Xe.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Xe.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=n=>{}){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(Vn.ServerError,n))}}var yA=xb;let N0=null,Bd=[],tp=[];const bA=()=>(N0||(N0=new(window.AudioContext||window.webkitAudioContext)),N0),Fd=()=>{Bd.forEach(t=>{try{t.stop(),t.disconnect()}catch{}}),Bd=[],tp.forEach(t=>{try{t.disconnect()}catch{}}),tp=[]},MV=()=>{try{const t=bA();t.state==="suspended"&&t.resume(),Fd();const e=t.createOscillator(),n=t.createGain();e.type="sine",e.frequency.value=440,e.connect(n),n.connect(t.destination);const r=t.currentTime;let a=!0;const o=()=>{if(!a)return;const h=t.createOscillator(),f=t.createGain();h.connect(f),f.connect(t.destination),h.frequency.value=425,h.type="sine";const p=t.currentTime,y=t.createOscillator();y.type="sine",y.frequency.value=20;const b=t.createGain();b.gain.value=500,y.connect(b),b.connect(h.frequency),y.start(p),y.stop(p+2),f.gain.setValueAtTime(0,p),f.gain.linearRampToValueAtTime(.1,p+.1),f.gain.setValueAtTime(.1,p+1.8),f.gain.linearRampToValueAtTime(0,p+2),h.start(p),h.stop(p+2),Bd.push(h),Bd.push(y),tp.push(f)};o();const u=setInterval(o,4e3);return()=>{a=!1,clearInterval(u),Fd()}}catch(t){return console.error("Error playing outgoing ring:",t),()=>{}}},OV=()=>{try{const t=bA();t.state==="suspended"&&t.resume(),Fd();let e=!0;const n=()=>{if(!e)return;const a=t.currentTime,o=(u,h)=>{const f=t.createOscillator(),p=t.createGain();f.connect(p),p.connect(t.destination),f.frequency.value=h,f.type="square",p.gain.setValueAtTime(0,u),p.gain.linearRampToValueAtTime(.1,u+.05),p.gain.setValueAtTime(.1,u+.2),p.gain.linearRampToValueAtTime(0,u+.25),f.start(u),f.stop(u+.3),Bd.push(f),tp.push(p)};o(a,880),o(a+.4,880),o(a+.8,880)};n();const r=setInterval(n,3e3);return()=>{e=!1,clearInterval(r),Fd()}}catch(t){return console.error("Error playing incoming ring:",t),()=>{}}},MS=()=>{Fd()},qi={SCREEN_SHARE:"screen_share",HIGH_QUALITY:"high_quality"},LV={admin:[qi.SCREEN_SHARE,qi.HIGH_QUALITY],moderator:[qi.SCREEN_SHARE],member:[]},VV={premium:[qi.SCREEN_SHARE,qi.HIGH_QUALITY],developer:[qi.SCREEN_SHARE,qi.HIGH_QUALITY],verified:[]},xA=(t,e)=>{if(!t)return!1;const n=t.role||"member";if((LV[n]||[]).includes(e))return!0;const a=t.badges||[];for(const o of a)if((VV[o]||[]).includes(e))return!0;return!1},vc=t=>t?!!(t.role==="admin"||t.role==="premium"||t.badges?.includes("premium")||t.badges?.includes("developer")||t.plan==="premium"||t.roles?.includes("premium")||t.roles?.includes("admin")):!1,_A=T.createContext(),A0=10,OS=300,_b=()=>{const t=T.useContext(_A);if(!t)throw new Error("useSoundboard must be used within SoundboardProvider");return t},UV=({children:t})=>{const{error:e}=Fr(),[n,r]=T.useState(()=>{try{const h=localStorage.getItem("dss_custom_sounds");return h?JSON.parse(h):[]}catch{return[]}});T.useEffect(()=>{localStorage.setItem("dss_custom_sounds",JSON.stringify(n))},[n]);const u={customSounds:n,addSound:async(h,f)=>n.length>=A0?(e(`Maximum ${A0} sounds allowed.`),!1):f.size>OS*1024?(e(`File too large. Max ${OS}KB.`),!1):new Promise(p=>{const y=new FileReader;y.onload=b=>{const x={id:Date.now().toString(),name:h.trim()||"Sound",src:b.target.result};r(k=>[...k,x]),p(!0)},y.readAsDataURL(f)}),removeSound:h=>{r(f=>f.filter(p=>p.id!==h))},MAX_SOUNDS:A0};return c.jsx(_A.Provider,{value:u,children:t})},wA=T.createContext(),Qc=()=>{const t=T.useContext(wA);if(!t)throw new Error("useCall must be used within CallProvider");return t},zV=({children:t})=>{const{currentUser:e,userProfile:n}=yn(),{error:r}=Fr(),[a,o]=T.useState(null),[u,h]=T.useState(null),[f,p]=T.useState("idle"),[y,b]=T.useState(null),[x,k]=T.useState(null),[I,A]=T.useState(null),[N,V]=T.useState(null),[F,j]=T.useState(null),[O,B]=T.useState(null),{customSounds:H,addSound:w,removeSound:S}=_b(),[R,D]=T.useState(!1),[L,U]=T.useState(!1),[P,ne]=T.useState(!1),[oe,G]=T.useState({audioInputs:[],videoInputs:[],audioOutputs:[]}),[Z,J]=T.useState(""),[Se,Le]=T.useState(""),$=me=>{if(P)return;const Ae=H.find(W=>W.id===me);if(!Ae)return;const xe=new Audio(Ae.src);xe.volume=.5,Te.current.push(xe),xe.onended=()=>{Te.current=Te.current.filter(W=>W!==xe)},xe.play().catch(W=>console.error("Error playing sound:",W)),O&&O.open?(console.log("Sending sound effect:",Ae.name),O.send({type:"SOUND_EFFECT",payload:{src:Ae.src,name:Ae.name}})):console.warn("Cannot send sound effect. Data connection missing or closed.")};T.useRef(null),T.useRef(null);const X=T.useRef(null),re=T.useRef(null),he=T.useRef(null),Te=T.useRef([]),Ue=()=>{Te.current.forEach(me=>{me.pause(),me.currentTime=0}),Te.current=[]},te=T.useRef(null);T.useEffect(()=>{re.current=N},[N]),T.useEffect(()=>{he.current=I},[I]),T.useEffect(()=>(te.current&&(te.current(),te.current=null),MS(),f==="incoming"?P||(te.current=OV()):f==="outgoing"&&(P||(te.current=MV())),()=>{te.current&&te.current(),MS()}),[f]),T.useEffect(()=>{if(!e)return;const me=new yA;return me.on("open",Ae=>{console.log("My Peer ID is:",Ae),h(Ae),o(me)}),me.on("call",Ae=>{console.log("Receiving PeerJS call connection..."),he.current&&he.current.peer===Ae.peer&&(console.log("Replacing existing call (upgrade/renegotiation detected)"),he.current.removeAllListeners&&he.current.removeAllListeners("close"),he.current.close());const xe=re.current||De.current;xe?(console.log("Answering call with local stream"),Ae.answer(xe)):(console.warn("No local stream found when answering! Answering audio-only or empty."),Ae.answer()),Ae.on("stream",W=>{console.log("Received remote stream"),j(W)}),Ae.on("close",()=>{fe()}),A(Ae),p("connected")}),me.on("error",Ae=>{console.error("PeerJS Error:",Ae),Ae.type}),me.on("connection",Ae=>{console.log("Data connection received from peer:",Ae.peer),Ae.on("open",()=>{console.log("Data connection open event fired."),B(Ae)}),Ae.on("data",xe=>{if(xe&&xe.type==="SOUND_EFFECT"&&xe.payload?.src){if(P)return;console.log("Received sound effect:",xe.payload.name);const W=new Audio(xe.payload.src);W.volume=.5,Te.current.push(W),W.onended=()=>{Te.current=Te.current.filter(He=>He!==W)},W.play().catch(He=>console.error("Error playing remote sound:",He))}}),Ae.on("close",()=>{console.log("Data connection closed."),B(null)}),Ae.on("error",xe=>console.error("Data connection error:",xe)),Ae.open&&(console.log("Data connection already open."),B(Ae))}),()=>{me.destroy()}},[e]),T.useEffect(()=>{if(!e)return;const me=zr(_t(le,"users",e.uid,"incomingCalls"),Vi("status","==","pending")),Ae=Sr(me,xe=>{xe.docChanges().forEach(W=>{if(W.type==="added"){const He=W.doc.data();b({id:W.doc.id,...He}),p("incoming")}W.type==="removed"&&b(He=>He&&He.id===W.doc.id?(p(ct=>(ct!=="connected"&&fe(!1),ct)),null):He)})});return()=>Ae()},[e]);const Oe=async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return console.warn("mediaDevices API not available"),{audioInputs:[],videoInputs:[],audioOutputs:[]};try{const me=await navigator.mediaDevices.enumerateDevices(),Ae=me.filter(He=>He.kind==="audioinput"),xe=me.filter(He=>He.kind==="videoinput"),W=me.filter(He=>He.kind==="audiooutput");return G({audioInputs:Ae,videoInputs:xe,audioOutputs:W}),!Z&&Ae.length>0&&J(Ae[0].deviceId),!Se&&xe.length>0&&Le(xe[0].deviceId),console.log("Devices enumerated:",{audioInputs:Ae.length,videoInputs:xe.length}),{audioInputs:Ae,videoInputs:xe,audioOutputs:W}}catch(me){return console.error("Failed to enumerate devices:",me),{audioInputs:[],videoInputs:[],audioOutputs:[]}}};T.useEffect(()=>{if(!navigator.mediaDevices){console.warn("mediaDevices API not available - skipping device enumeration");return}return Oe(),navigator.mediaDevices.addEventListener("devicechange",Oe),()=>navigator.mediaDevices.removeEventListener("devicechange",Oe)},[]);const Ie=async(me=!0)=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.error("mediaDevices API not available - requires HTTPS or localhost"),r("Kamera/mikrofon iin HTTPS veya localhost gerekli"),null;try{oe.audioInputs.length===0&&await Oe();const Ae={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:1,sampleRate:48e3,sampleSize:16,...Z&&{deviceId:{exact:Z}}},xe=me?{width:1280,height:720,...Se&&{deviceId:{exact:Se}}}:!1,W=await navigator.mediaDevices.getUserMedia({video:xe,audio:Ae});return console.log("Media stream acquired with selected devices"),V(W),W}catch(Ae){return console.error("Failed to get local stream",Ae),r("Could not access camera/microphone"),null}},We=async(me,Ae="video")=>{if(!a||!u){r("Connection not ready. Please wait a moment.");return}if(k(me),p("outgoing"),!await Ie(Ae==="video")){p("idle");return}U(Ae==="voice");try{const W=e.displayName||n?.displayName||"Unknown",He=e.photoURL||n?.photoURL||n?.photoUrl||null,ct=await Kn(_t(le,"users",me.id,"incomingCalls"),{callerId:e.uid,callerName:W,callerPhotoUrl:He,peerId:u,type:Ae,status:"pending",timestamp:ht()});X.current=ct.id;const on=Sr(Ne(le,"users",me.id,"incomingCalls",ct.id),Ee=>{const $e=X.current===ct.id;if(!Ee.exists())$e&&f==="outgoing"&&(r("Call ended or declined"),fe(!1)),on();else{const lt=Ee.data();lt.status==="accepted"?$e&&p("connected"):lt.status==="rejected"&&$e&&(r("Call declined"),fe(!0))}},Ee=>{console.warn("Call snapshot error:",Ee),X.current===ct.id&&(r("Call declined"),fe(!1))})}catch(W){console.error("Signaling failed:",W),r("Failed to direct call"),fe()}};T.useEffect(()=>{if(!I||!I.peerConnection)return;const me=()=>{const Ae=I.peerConnection.connectionState,xe=I.peerConnection.iceConnectionState;console.log(`Connection State: ${Ae}, ICE State: ${xe}`),(xe==="disconnected"||xe==="failed"||xe==="closed")&&(console.warn("Peer connection lost/failed. Ending call..."),xe==="failed"||xe==="closed"?fe():xe==="disconnected"&&he.current===I&&setTimeout(()=>{he.current&&he.current.peerConnection.iceConnectionState==="disconnected"&&(console.log("Connection still disconnected after timeout. Ending."),fe())},3e3))};return I.peerConnection.addEventListener("iceconnectionstatechange",me),I.peerConnection.addEventListener("connectionstatechange",me),()=>{I&&I.peerConnection&&(I.peerConnection.removeEventListener("iceconnectionstatechange",me),I.peerConnection.removeEventListener("connectionstatechange",me))}},[I]);const ke=async()=>{if(!y||!a)return;p("connected");const me=y.type==="video",Ae=await Ie(me);if(!Ae){console.error("Stream failed, rejecting call signal.");try{await it(Ne(le,"users",e.uid,"incomingCalls",y.id),{status:"rejected"})}catch{}fe(!1);return}if(me||U(!0),console.log("Connecting to peer:",y.peerId),(!a||a.disconnected)&&(r("Peer connection lost. Reconnecting..."),a?.reconnect(),await new Promise(xe=>setTimeout(xe,1e3)),!a||a.disconnected)){r("Could not establish P2P connection."),fe();return}try{const xe=a.call(y.peerId,Ae);if(!xe){r("Call failed to initialize."),fe();return}xe.on("stream",W=>{j(W)}),xe.on("close",()=>{fe()}),xe.on("error",W=>{console.error("Call error:",W),fe()}),A(xe);try{await it(Ne(le,"users",e.uid,"incomingCalls",y.id),{status:"accepted"})}catch(W){console.error("Error updating signal doc",W)}}catch(xe){console.error("Error calling peer:",xe),r("Failed to connect to peer."),fe()}try{console.log("Establishing data connection to caller:",y.peerId);const xe=a.connect(y.peerId);xe.on("open",()=>{console.log("Data connection opened (Callee side)!"),B(xe)}),xe.on("data",W=>{if(W&&W.type==="SOUND_EFFECT"&&W.payload?.src){if(P)return;const He=new Audio(W.payload.src);He.volume=.5,Te.current.push(He),He.onended=()=>{Te.current=Te.current.filter(ct=>ct!==He)},He.play().catch(ct=>console.error(ct))}}),xe.on("close",()=>B(null)),xe.on("error",W=>console.error("Data connection error (Callee):",W))}catch(xe){console.error("Failed to establish data connection",xe)}},fe=async(me=!0)=>{console.log("[CallContext] Ending call - starting cleanup..."),Ve.current&&(Ve.current.getTracks().forEach(xe=>{xe.stop(),console.log("[CallContext] Stopped screen track:",xe.kind)}),Ve.current=null),De.current=null;const Ae=re.current;if(Ae&&Ae.getTracks().forEach(xe=>{xe.stop(),console.log("[CallContext] Stopped local track:",xe.kind)}),N&&N.getTracks().forEach(xe=>{xe.stop(),console.log("[CallContext] Stopped local stream track (backup):",xe.kind)}),V(null),re.current=null,I&&(I.close(),A(null)),F&&F.getTracks().forEach(xe=>{xe.stop(),console.log("[CallContext] Stopped remote track:",xe.kind)}),j(null),p("idle"),b(null),k(null),D(!1),U(!1),ne(!1),O&&(O.close(),B(null)),Ue(),console.log("[CallContext] Call cleanup complete"),X.current&&me&&x)try{await ts(Ne(le,"users",x.id,"incomingCalls",X.current))}catch{}if(y&&me)try{f==="incoming"?await it(Ne(le,"users",e.uid,"incomingCalls",y.id),{status:"rejected"}):await ts(Ne(le,"users",e.uid,"incomingCalls",y.id))}catch{}X.current=null},Re=()=>{if(N){const me=N.getAudioTracks()[0];me&&(me.enabled=!me.enabled,D(!me.enabled))}},dt=()=>{if(N){const me=N.getVideoTracks()[0];me&&(me.enabled=!me.enabled,U(!me.enabled))}},ye=()=>{const me=!P;ne(me),F&&F.getAudioTracks().forEach(Ae=>{Ae.enabled=!me}),R||Re()};T.useEffect(()=>{F&&F.getAudioTracks().forEach(me=>{me.enabled=!P})},[F,P]);const Ve=T.useRef(null),De=T.useRef(null),K=async(me=null)=>{if(Ve.current){await ue();return}try{console.log("Requesting display media...",me);let Ae={},xe=me?.width||1280,W=me?.height||720,He=me?.frameRate||30;me||xA(n,qi.HIGH_QUALITY)&&(xe=1920,W=1080,He=60);let ct;if(me?.sourceId&&window.require){console.log("Using Electron getUserMedia with sourceId:",me.sourceId);try{ct=await navigator.mediaDevices.getUserMedia({audio:{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:me.sourceId,maxWidth:xe,maxHeight:W,maxFrameRate:He}}})}catch(Vt){throw console.error("Electron getUserMedia failed:",Vt),Vt}}else{const Vt={video:{width:{ideal:xe},height:{ideal:W},frameRate:{ideal:He},displaySurface:me?.displaySurface},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}};console.log("Using Web getDisplayMedia with constraints:",Vt),ct=await navigator.mediaDevices.getDisplayMedia(Vt)}const on=ct.getVideoTracks()[0];U(!1),console.log("Display media obtained:",on.label);const Ee=ct.getAudioTracks()[0];let $e=null;if(Ee){console.log("System audio captured! Mixing with microphone...");let Vt=N;if(!Vt&&oe.audioInputs.length>0)try{Vt=await navigator.mediaDevices.getUserMedia({audio:!0})}catch{console.warn("Failed to get mic for mixing")}if(Vt&&Vt.getAudioTracks().length>0){const kt=Vt.getAudioTracks()[0],nt=new(window.AudioContext||window.webkitAudioContext),Rt=nt.createMediaStreamDestination(),Xt=nt.createMediaStreamSource(new MediaStream([kt])),Fe=nt.createMediaStreamSource(new MediaStream([Ee])),Ce=nt.createGain(),Ze=nt.createGain();Ce.gain.value=1,Ze.gain.value=1,Xt.connect(Ce).connect(Rt),Fe.connect(Ze).connect(Rt),$e=Rt.stream.getAudioTracks()[0],Ve.currentAudioContext=nt}else $e=Ee}N&&!De.current&&(De.current=N),on.onended=()=>{console.log("Screen track ended by user/browser UI"),ue()},Ve.current=ct;const lt=$e?[$e]:N?N.getAudioTracks():[],yt=new MediaStream([on,...lt]);if(V(yt),I&&I.peerConnection){const Vt=I.peerConnection.getSenders(),kt=Vt.find(nt=>nt.track&&nt.track.kind==="video");if(kt&&await kt.replaceTrack(on),$e){const nt=Vt.find(Rt=>Rt.track&&Rt.track.kind==="audio");nt&&(console.log("Replacing audio sender with mixed track..."),await nt.replaceTrack($e))}if(!kt){console.log("Audio-only -> Screen Share upgrade. Renegotiating...");const nt=I.peer;if(a&&nt){I.removeAllListeners("close");const Rt=a.call(nt,yt);Rt.on("stream",Xt=>j(Xt)),Rt.on("close",()=>fe()),Rt.on("error",()=>fe()),A(Rt)}}}}catch(Ae){console.error("Error starting screen share:",Ae),r("Failed to start screen share")}},ue=async()=>{if(Ve.current)if(console.log("Stopping screen share..."),Ve.currentAudioContext&&(Ve.currentAudioContext.close(),Ve.currentAudioContext=null),Ve.current.getTracks().forEach(me=>me.stop()),Ve.current=null,De.current){console.log("Reverting to previous stream state...");const me=De.current.getVideoTracks()[0],Ae=De.current.getAudioTracks();if(I&&I.peerConnection){const xe=I.peerConnection.getSenders(),W=xe.find(ct=>ct.track&&ct.track.kind==="video");if(me&&W)try{await W.replaceTrack(me)}catch{}const He=xe.find(ct=>ct.track&&ct.track.kind==="audio");He&&Ae.length>0&&(console.log("Reverting audio sender to original mic..."),await He.replaceTrack(Ae[0]))}V(De.current),De.current=null}else{console.log("No stored camera stream, requesting new user media...");try{const me=await Ie(!0);if(me&&I&&I.peerConnection){const Ae=me.getVideoTracks()[0],xe=I.peerConnection.getSenders().find(W=>W.track&&W.track.kind==="video");xe&&await xe.replaceTrack(Ae)}}catch(me){console.error("Failed to restore camera:",me)}}},je={startCall:We,answerCall:ke,endCall:fe,toggleAudio:Re,toggleVideo:dt,callStatus:f,incomingCall:y,outgoingCallUser:x,localStream:N,remoteStream:F,isMuted:R,isVideoOff:L,activeCall:I,isScreenSharing:!!Ve.current,toggleScreenShare:K,availableDevices:oe,selectedMicId:Z,selectedCameraId:Se,setSelectedMicId:J,setSelectedCameraId:Le,playSound:$,customSounds:H,isDeafened:P,toggleDeafen:ye,addSound:w,removeSound:S};return c.jsx(wA.Provider,{value:je,children:t})},BV=240*1e3,FV=t=>{const e=T.useRef(null);T.useEffect(()=>{if(!t)return;const n=async()=>{try{await Xn(Ne(le,"users",t),{lastSeen:ht(),isOnline:!0},{merge:!0})}catch(a){console.error("Error updating presence:",a)}};n(),e.current=setInterval(n,BV);const r=()=>{navigator.sendBeacon&&n()};return window.addEventListener("beforeunload",r),()=>{e.current&&clearInterval(e.current),window.removeEventListener("beforeunload",r)}},[t])},EA=(t,e=10)=>{if(!t)return!1;const n=t.toMillis?t.toMillis():new Date(t).getTime(),r=Date.now(),a=e*60*1e3;return r-n<a},wb=({user:t,isOpen:e,onClose:n,onMessage:r})=>{if(!t)return null;const a=t.presence!=="invisible"&&EA(t.lastSeen),o=f=>({admin:"#f23f42",moderator:"#faa81a",member:"#80848e"})[f]||"#80848e",{startCall:u}=Qc(),{currentUser:h}=yn();return c.jsx(Ds,{isOpen:e,onClose:n,title:"",size:"sm",showCloseButton:!1,children:c.jsxs("div",{className:"relative overflow-hidden rounded-lg -m-6 min-h-[400px] flex flex-col",children:[c.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-colors",style:{backgroundColor:t.themeColor||"#6366f1",backgroundImage:t.bannerUrl?`url(${t.bannerUrl})`:`linear-gradient(to bottom right, ${t.themeColor||"#6366f1"}, #000)`}}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/95 via-black/50 to-transparent"}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 p-2 bg-black/40 hover:bg-black/60 rounded-full text-white/80 hover:text-white transition-colors z-20 backdrop-blur-sm",children:c.jsxs("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{fill:"none",d:"M0 0h24v24H0z"}),c.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 17.59 13.41 12z"})]})}),c.jsxs("div",{className:"relative z-10 p-6 mt-auto flex flex-col items-center text-center",children:[c.jsxs("div",{className:"relative group mb-4",children:[t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:t.displayName,className:"w-32 h-32 rounded-full border-4 object-cover shadow-2xl",style:{borderColor:t.themeColor||"#1e1f22"},onError:f=>{f.target.style.display="none",f.target.nextSibling.style.display="flex"}},t.photoUrl):null,c.jsx("div",{className:"w-32 h-32 rounded-full border-4 flex items-center justify-center text-white font-bold text-5xl shadow-2xl",style:{display:t.photoUrl?"none":"flex",borderColor:t.themeColor||"#1e1f22",backgroundColor:t.themeColor||"#6366f1"},children:t.displayName?.[0]?.toUpperCase()||"U"})]}),c.jsxs("div",{className:"space-y-1 w-full",children:[c.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center justify-center gap-2 drop-shadow-md",children:[t.displayName||"Unknown",(t.role==="admin"||t.role==="premium")&&c.jsx("div",{className:"text-brand-primary drop-shadow-none",title:"Premium Member",children:c.jsx(Zo,{size:24,color:t.themeColor||"#6366f1"})})]}),c.jsx("div",{className:"flex justify-center mt-2",children:c.jsx("span",{className:"px-4 py-1.5 rounded-full text-sm font-semibold border backdrop-blur-md shadow-lg",style:{backgroundColor:`${o(t.role)}30`,color:"#fff",borderColor:`${o(t.role)}80`},children:t.role?.charAt(0).toUpperCase()+t.role?.slice(1)})})]}),c.jsx("div",{className:"flex justify-center gap-2 mt-4 flex-wrap",children:(()=>{const f=new Set(t.badges||[]);t.role==="admin"&&f.add("admin");const p=Array.from(f).map(y=>pb[y]).filter(Boolean);return p.length===0?null:c.jsx("div",{className:"p-1.5 rounded-xl bg-black/40 backdrop-blur-md border border-white/10 flex gap-2",children:p.map(y=>{const b=y.icon;return c.jsxs("div",{className:"relative group cursor-help p-1 hover:bg-white/10 rounded transition-colors",children:[c.jsx(b,{size:20,color:y.color}),c.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 px-2 py-1 bg-black text-white text-xs rounded shadow-lg whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50",children:[c.jsx("div",{className:"font-bold",children:y.label}),y.description&&c.jsx("div",{className:"text-gray-300 font-normal text-[10px]",children:y.description}),c.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-black"})]})]},y.id)})})})()}),c.jsxs("div",{className:"flex items-center gap-3 mt-4 bg-black/30 px-4 py-2 rounded-full backdrop-blur-sm border border-white/5",children:[c.jsx("div",{className:Ht("w-3 h-3 rounded-full shadow-lg shadow-white/20",a&&(t.presence==="online"||!t.presence)?"bg-green-500":a&&t.presence==="idle"?"bg-yellow-500":a&&t.presence==="dnd"?"bg-red-500":"bg-gray-500")}),t.status?c.jsxs("span",{className:"text-sm text-gray-200 flex gap-2",children:[c.jsx("span",{children:t.status.emoji}),c.jsx("span",{children:t.status.text})]}):c.jsx("span",{className:"text-sm text-gray-300",children:a?t.presence==="idle"?"Idle":t.presence==="dnd"?"Do Not Disturb":"Online":"Offline"})]}),t.id!==h?.uid&&c.jsxs("div",{className:"flex gap-4 justify-center mt-6 w-full max-w-xs",children:[c.jsxs("button",{onClick:()=>r&&r(t),className:"flex-1 py-3 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition-colors shadow-lg flex items-center justify-center gap-2",children:[c.jsx(T7,{size:20})," Message"]}),c.jsx("button",{onClick:()=>u(t,"voice"),className:"p-3 bg-black/50 text-white rounded-xl hover:bg-black/70 border border-white/10 transition-colors backdrop-blur-sm",title:"Voice Call",children:c.jsx(C7,{size:22})}),c.jsx("button",{onClick:()=>u(t,"video"),className:"p-3 bg-black/50 text-white rounded-xl hover:bg-black/70 border border-white/10 transition-colors backdrop-blur-sm",title:"Video Call",children:c.jsx(Ud,{size:22})})]}),t.bio&&c.jsxs("div",{className:"mt-6 w-full text-left bg-black/20 p-4 rounded-xl backdrop-blur-sm border border-white/5",children:[c.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase mb-2 tracking-wider",children:"About Me"}),c.jsx("p",{className:"text-gray-200 text-sm leading-relaxed whitespace-pre-wrap",children:t.bio})]}),c.jsxs("div",{className:"mt-4 text-xs text-gray-500 font-medium uppercase tracking-widest",children:["Member since ",t.createdAt?new Date(t.createdAt.seconds*1e3).toLocaleDateString("en-US",{month:"short",year:"numeric"}):"Unknown"]})]})]})})},Ac=({isOpen:t,onClose:e,onConfirm:n,title:r="Confirm Action",message:a="Are you sure you want to proceed?",confirmText:o="Confirm",cancelText:u="Cancel",variant:h="danger"})=>{const f=()=>{n(),e()};return c.jsx(Ds,{isOpen:t,onClose:e,title:r,size:"sm",children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-dark-text",children:a}),c.jsxs("div",{className:"flex gap-3 justify-end",children:[c.jsx(st,{variant:"secondary",onClick:e,children:u}),c.jsx(st,{variant:h,onClick:f,children:o})]})]})})},HV=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let n=0;n<8;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},$V=({isOpen:t,onClose:e,serverId:n})=>{const[r,a]=T.useState(""),[o,u]=T.useState(!1),[h,f]=T.useState(!1),[p,y]=T.useState(!1),{success:b,error:x}=Fr(),k=async()=>{u(!0);try{const A=HV();await Xn(Ne(le,"inviteCodes",A),{serverId:n,createdAt:ht(),expiresAt:new Date(Date.now()+(p?365*24*60*60*1e3:1440*60*1e3)),maxUses:p?-1:1,uses:0,isActive:!0,isUnlimited:p}),a(A),b("Invite code generated!")}catch(A){console.error("Error generating invite:",A),x("Failed to generate invite code")}finally{u(!1)}},I=()=>{navigator.clipboard.writeText(r),f(!0),b("Copied to clipboard!"),setTimeout(()=>f(!1),2e3)};return c.jsx(Ds,{isOpen:t,onClose:e,title:"Invite Code",size:"sm",children:c.jsx("div",{className:"space-y-4",children:r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-dark-bg p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-3xl font-mono font-bold text-brand-primary mb-2",children:r}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:I,className:"flex-1 flex items-center justify-center gap-2",children:h?c.jsxs(c.Fragment,{children:[c.jsx(el,{size:20}),"Copied!"]}):c.jsxs(c.Fragment,{children:[c.jsx(uN,{size:20}),"Copy Code"]})}),c.jsx(st,{variant:"secondary",onClick:()=>{a(""),f(!1),y(!1)},className:"flex items-center justify-center gap-2 px-4",title:"Generate new code",children:c.jsx($7,{size:20})})]})]}),c.jsxs("div",{className:"text-xs text-dark-muted space-y-1",children:[c.jsxs("div",{children:[" ",p?"Expires in 1 year":"Expires in 24 hours"]}),c.jsxs("div",{children:[" ",p?"Unlimited uses":"One-time use only"]}),c.jsx("div",{children:" Share with trusted users"})]}),c.jsx(st,{variant:"secondary",onClick:e,className:"w-full",children:"Close"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-dark-text text-sm",children:"Generate an invite code for this server."}),c.jsxs("label",{className:"flex items-center gap-2 p-3 rounded bg-dark-bg cursor-pointer hover:bg-opacity-80 transition-colors",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:A=>y(A.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-brand-primary focus:ring-brand-primary"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-white text-sm font-medium",children:"Unlimited Uses"}),c.jsx("span",{className:"text-dark-muted text-xs",children:"Code will not expire after one use"})]})]})]}),c.jsx(st,{variant:"primary",onClick:k,disabled:o,className:"w-full",children:o?"Generating...":"Generate Invite Code"})]})})})},qV=[{emoji:"",text:"Gaming",type:"gaming"},{emoji:"",text:"Working",type:"working"},{emoji:"",text:"Listening to music",type:"music"},{emoji:"",text:"Watching",type:"watching"},{emoji:"",text:"Eating",type:"eating"},{emoji:"",text:"AFK",type:"afk"},{emoji:"",text:"Focusing",type:"focusing"},{emoji:"",text:"Studying",type:"studying"}],LS={online:{color:"bg-green-500",label:"Online",icon:""},idle:{color:"bg-yellow-500",label:"Idle",icon:""},dnd:{color:"bg-red-500",label:"Do Not Disturb",icon:""},invisible:{color:"bg-gray-500",label:"Invisible",icon:""},offline:{color:"bg-gray-500",label:"Offline",icon:""}},GV=t=>LS[t]||LS.offline,SA=({status:t,size:e="md",className:n})=>{const r=GV(t),a={sm:"w-2.5 h-2.5",md:"w-3 h-3",lg:"w-4 h-4"};return t==="invisible"?null:c.jsx("div",{className:Ht("rounded-full border-2 border-dark-bg",r.color,a[e]||a.md,n),title:r.label})},YV=({dm:t,currentUserId:e,isSelected:n,unreadCount:r,onClick:a,onContextMenu:o})=>{const u=t.participants.find(p=>p!==e),[h,f]=T.useState(null);return T.useEffect(()=>{(async()=>{if(u)try{const y=await Jo(Ne(le,"users",u));y.exists()&&f({id:y.id,...y.data()})}catch(y){console.error("Error fetching DM user:",y)}})()},[u]),h?c.jsxs("button",{onClick:a,onContextMenu:o,className:Ht("w-full flex items-center gap-3 px-2 py-2 rounded mb-1 group relative","text-dark-muted hover:bg-dark-hover hover:text-dark-text","transition-colors duration-150",n&&"bg-dark-hover text-dark-text"),children:[c.jsxs("div",{className:"relative",children:[h.photoUrl?c.jsx("img",{src:h.photoUrl,alt:h.displayName,className:"w-8 h-8 rounded-full object-cover"}):c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white text-sm font-bold",children:h.displayName?.[0]?.toUpperCase()}),r>0&&c.jsx("div",{className:"absolute -top-1 -right-1 min-w-4 h-4 bg-red-500 rounded-full flex items-center justify-center border-2 border-dark-sidebar pointer-events-none z-10",children:c.jsx("span",{className:"text-white text-[9px] font-bold px-0.5",children:r>9?"9+":r})})]}),c.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[c.jsxs("div",{className:"text-sm font-medium truncate flex justify-between items-center",children:[c.jsx("span",{children:h.displayName}),t.updatedAt&&c.jsx("span",{className:"text-[10px] text-gray-500 hidden group-hover:block",children:zp(t.updatedAt)})]}),c.jsx("div",{className:"text-xs truncate opacity-70",children:t.lastMessage?.text||"Start a conversation"})]})]}):null},KV=({dms:t,unreadDms:e={},selectedDmId:n,onSelectDm:r})=>{const{currentUser:a}=yn(),[o,u]=T.useState(null),[h,f]=T.useState([]),p=(x,k)=>{x.preventDefault(),u({x:x.pageX,y:x.pageY,dmId:k.id})},y=async x=>{if(f(k=>[...k,x]),u(null),!!a)try{const k=Ne(le,"dms",x);await it(k,{hiddenFor:uh(a.uid)}),n===x&&r(null)}catch(k){console.error("Error deleting DM:",k),f(I=>I.filter(A=>A!==x))}};T.useEffect(()=>{const x=()=>u(null);return window.addEventListener("click",x),()=>window.removeEventListener("click",x)},[]);const b=t?.filter(x=>!h.includes(x.id))||[];return b.length===0?c.jsxs("div",{className:"px-4 py-8 text-center text-dark-muted text-sm",children:[c.jsx("p",{children:"No conversations yet."}),c.jsx("p",{className:"mt-2",children:"Start a DM from the friends list!"})]}):c.jsxs("div",{className:"flex-1 overflow-y-auto py-3",children:[c.jsxs("div",{className:"px-2",children:[c.jsx("div",{className:"text-xs font-semibold text-dark-muted uppercase px-2 mb-2 flex justify-between items-center",children:c.jsx("span",{children:"Direct Messages"})}),c.jsx("div",{className:"space-y-0.5",children:b.map(x=>c.jsx(YV,{dm:x,currentUserId:a.uid,isSelected:n===x.id,unreadCount:e[x.id]?.count||0,onClick:()=>r(x),onContextMenu:k=>p(k,x)},x.id))})]}),o&&c.jsx("div",{className:"fixed bg-dark-sidebar border border-dark-hover shadow-xl rounded-md z-50 py-1 min-w-[160px]",style:{top:o.y,left:o.x},children:c.jsxs("button",{onClick:()=>y(o.dmId),className:"w-full text-left px-4 py-2 hover:bg-red-500/10 text-red-400 hover:text-red-500 text-sm flex items-center gap-2 transition-colors",children:[c.jsx(Ki,{size:16}),"Delete Conversation"]})})]})};let R0=null;const Hp=()=>(R0||(R0=new(window.AudioContext||window.webkitAudioContext)),R0),Rc=async(t,e,n="sine",r=.3)=>{try{const a=Hp();a.state==="suspended"&&await a.resume();const o=a.createOscillator(),u=a.createGain();o.connect(u),u.connect(a.destination),o.frequency.value=t,o.type=n,u.gain.setValueAtTime(r,a.currentTime),u.gain.exponentialRampToValueAtTime(.01,a.currentTime+e),o.start(a.currentTime),o.stop(a.currentTime+e)}catch(a){console.warn("[VoiceSound] Failed to play tone:",a)}},VS=()=>{Hp(),setTimeout(()=>Rc(440,.1,"sine",.2),0),setTimeout(()=>Rc(554,.15,"sine",.25),80)},US=()=>{Hp(),setTimeout(()=>Rc(554,.1,"sine",.2),0),setTimeout(()=>Rc(440,.15,"sine",.15),80)},I0=()=>{Hp(),setTimeout(()=>Rc(880,.08,"sine",.2),0),setTimeout(()=>Rc(1100,.12,"sine",.25),60)},Eb=(t,e={})=>{const[n,r]=T.useState(!1),a=T.useRef(null),o=T.useRef(null),u=T.useRef(null),h=e.threshold??30,f=e.interval??100;return T.useEffect(()=>{const p=()=>{if(u.current&&(clearInterval(u.current),u.current=null),a.current){const x=a.current;x.state!=="closed"&&x.close().catch(k=>console.warn("Error closing AudioContext:",k)),a.current=null}o.current=null,r(!1)};if(!t){p();return}const y=t.getAudioTracks();if(y.length===0){p();return}const b=y[0];if(!b.enabled||b.muted){p();return}try{const x=window.AudioContext||window.webkitAudioContext,k=new x,I=k.createAnalyser();I.fftSize=256,I.smoothingTimeConstant=.5,k.createMediaStreamSource(t).connect(I),a.current=k,o.current=I,k.state==="suspended"&&k.resume().then(()=>{console.log("[useSpeakingIndicator] AudioContext resumed")}).catch(V=>console.error("[useSpeakingIndicator] Failed to resume AudioContext:",V));const N=new Uint8Array(I.frequencyBinCount);u.current=setInterval(()=>{if(!o.current)return;o.current.getByteFrequencyData(N);let V=0;for(let O=0;O<N.length;O++)V+=N[O];const j=V/N.length>h;r(j)},f)}catch(x){console.error("[useSpeakingIndicator] Error initializing audio analysis:",x),p()}return p},[t,h,f]),n},TA=T.createContext(),Xc=()=>{const t=T.useContext(TA);if(!t)throw new Error("useVoiceChannel must be used within VoiceChannelProvider");return t},QV=({children:t})=>{const{currentUser:e,userProfile:n}=yn(),{currentServer:r,channels:a}=aa(),[o,u]=T.useState(null),[h,f]=T.useState(null),[p,y]=T.useState([]),[b,x]=T.useState(null),[k,I]=T.useState(null),[A,N]=T.useState(new Map),[V,F]=T.useState(new Map),[j,O]=T.useState([]),[B,H]=T.useState(null),[w,S]=T.useState([]),[R,D]=T.useState(null),[L,U]=T.useState(new Map),[P,ne]=T.useState(null),[oe,G]=T.useState(!1),[Z,J]=T.useState(!1),[Se,Le]=T.useState(!1),[$,X]=T.useState(!1),[re,he]=T.useState(!1),Te=T.useRef(null),Ue=T.useRef(null),te=T.useRef(null),Oe=T.useRef(null),Ie=T.useRef(new Map),We=T.useRef(new Map),ke=T.useRef([]),fe=T.useRef(null),Re=T.useRef(null),dt=T.useRef(null),ye=T.useRef(null),Ve=T.useRef(null),De=T.useRef([]);T.useEffect(()=>{ye.current=o},[o]),T.useEffect(()=>{Ve.current=h},[h]);const K=T.useCallback(Fe=>{if(Fe&&Fe.type==="SOUND_EFFECT"&&Fe.payload?.src){console.log("[VoiceChannel] Received sound effect:",Fe.payload.name);const Ce=new Audio(Fe.payload.src);Ce.volume=.5,ke.current.push(Ce),Ce.onended=()=>{ke.current=ke.current.filter(Ze=>Ze!==Ce)},Ce.play().catch(Ze=>console.error("[VoiceChannel] Error playing sound:",Ze))}},[]);T.useEffect(()=>{if(!e)return;const Fe=new yA;return Fe.on("open",Ce=>{console.log("[VoiceChannel] My Peer ID:",Ce),Ue.current=Ce,Te.current=Fe}),Fe.on("connection",Ce=>{console.log("[VoiceChannel] Incoming data connection from:",Ce.peer),Ce.on("open",()=>{We.current.set(Ce.peer,Ce)}),Ce.on("data",K),Ce.on("close",()=>{We.current.delete(Ce.peer)})}),Fe.on("call",Ce=>{console.log("[VoiceChannel] Incoming call from:",Ce.peer);const Ze=te.current;Ze?Ce.answer(Ze):Ce.answer(),Ce.on("stream",et=>{console.log("[VoiceChannel] Received remote stream from:",Ce.peer),F(bt=>new Map(bt).set(Ce.peer,et))}),Ce.on("close",()=>{F(et=>{const bt=new Map(et);return bt.delete(Ce.peer),bt})}),Ie.current.set(Ce.peer,Ce)}),Fe.on("error",Ce=>{if(console.error("[VoiceChannel] Peer error details:",{type:Ce.type,message:Ce.message,targetPeer:Ce.peer}),Ce.type==="peer-unavailable"||Ce.message?.includes("Could not connect to peer")){let Ze=Ce.peer;if(!Ze){const et=Ce.message.match(/peer\s+([a-zA-Z0-9-]+)/);et&&(Ze=et[1])}Ze&&ye.current&&Ve.current&&(console.log("[VoiceChannel] Proactively removing ghost peer:",Ze),y(et=>{const bt=et.find(mt=>mt.peerId===Ze);if(bt&&bt.odaId){console.log("[VoiceChannel] Cleaning up Firestore for ghost:",bt.displayName);const mt=Ne(le,"servers",Ve.current,"channels",ye.current,"voiceParticipants",bt.odaId);ts(mt).catch(()=>{})}return et.filter(mt=>mt.peerId!==Ze)}))}}),()=>{ke.current.forEach(Ce=>{try{Ce.pause(),Ce.currentTime=0}catch{}}),ke.current=[],Fe.destroy(),Te.current=null,Ue.current=null}},[e]);const ue=T.useCallback(async()=>{if(!navigator.mediaDevices){console.log("[VoiceChannel] mediaDevices API not available - skipping device enumeration");return}try{const Fe=await navigator.mediaDevices.enumerateDevices(),Ce=Fe.filter(et=>et.kind==="audioinput"),Ze=Fe.filter(et=>et.kind==="videoinput");O(Ce),S(Ze),!B&&Ce.length>0&&H(Ce[0].deviceId),!R&&Ze.length>0&&D(Ze[0].deviceId)}catch(Fe){console.error("[VoiceChannel] Failed to refresh devices:",Fe)}},[B,R]);T.useEffect(()=>{if(!navigator.mediaDevices){console.log("[VoiceChannel] mediaDevices API not available - skipping device enumeration");return}return ue(),navigator.mediaDevices.ondevicechange=ue,()=>{navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=null)}},[ue]);const me=Eb(!oe&&re&&b?b:null,{threshold:15,interval:50});T.useEffect(()=>{if(!te.current||!re||oe)return;const Fe=te.current.getAudioTracks()[0];Fe&&(me?Fe.enabled||(Fe.enabled=!0,console.log("[VAD] Audio enabled - speaking detected")):Fe.enabled&&(Fe.enabled=!1,console.log("[VAD] Audio disabled - silence detected")))},[me,re,oe]);const Ae=T.useCallback(async Fe=>{if(H(Fe),!(!o||!te.current))try{const Ce=await navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:Fe}},video:Se});te.current&&te.current.getTracks().forEach(et=>et.stop()),te.current=Ce,x(Ce);const Ze=Ce.getAudioTracks()[0];Ze&&(Ze.enabled=!oe),Ie.current.forEach((et,bt)=>{const mt=Te.current.call(bt,Ce);mt&&(mt.on("stream",At=>{F($t=>new Map($t).set(bt,At))}),Ie.current.set(bt,mt))}),console.log("[VoiceChannel] Switched to audio device:",Fe)}catch(Ce){console.error("[VoiceChannel] Failed to switch audio device:",Ce)}},[o,Se,oe]),xe=T.useCallback(async Fe=>{if(D(Fe),!(!o||!te.current||!Se))try{const Ze=(await navigator.mediaDevices.getUserMedia({audio:B?{deviceId:{exact:B}}:!0,video:{deviceId:{exact:Fe}}})).getVideoTracks()[0];if(Ze){const et=te.current.getVideoTracks()[0];et&&et.stop(),et&&te.current.removeTrack(et),te.current.addTrack(Ze),x(new MediaStream(te.current.getTracks())),Ie.current.forEach((bt,mt)=>{const At=Te.current.call(mt,te.current);At&&(At.on("stream",$t=>{F(St=>new Map(St).set(mt,$t))}),Ie.current.set(mt,At))})}console.log("[VoiceChannel] Switched to video device:",Fe)}catch(Ce){console.error("[VoiceChannel] Failed to switch video device:",Ce)}},[o,Se,B]),W=T.useRef([]),He=T.useRef(new Set);T.useEffect(()=>{if(!o||!h){y([]),W.current=[],He.current=new Set;return}const Fe=_t(le,"servers",h,"channels",o,"voiceParticipants"),Ce=zr(Fe,Hm("joinedAt","asc")),Ze=Sr(Ce,et=>{const bt=[];et.forEach(qe=>{bt.push({odaId:qe.id,...qe.data()})});const mt=new Set(W.current.map(qe=>qe.odaId)),At=new Set(bt.map(qe=>qe.odaId));bt.forEach(qe=>{!mt.has(qe.odaId)&&qe.odaId!==e?.uid&&VS()}),W.current.forEach(qe=>{!At.has(qe.odaId)&&qe.odaId!==e?.uid&&US()});const $t=new Set(bt.filter(qe=>qe.isScreenSharing).map(qe=>qe.odaId));$t.forEach(qe=>{!He.current.has(qe)&&qe!==e?.uid&&I0()}),W.current=bt,He.current=$t;const St=Date.now(),ln=bt.filter(qe=>{if(qe.odaId===e?.uid)return!0;const xt=qe.lastHeartbeat?.toMillis?qe.lastHeartbeat.toMillis():qe.lastHeartbeat||(qe.joinedAt?.toMillis?qe.joinedAt.toMillis():Date.now());if(St-xt>3e4){console.log("[VoiceChannel] Filtering ghost participant locally (no activity):",qe.displayName);const rr=Ne(le,"servers",h,"channels",o,"voiceParticipants",qe.odaId);return ts(rr).catch(()=>{}),!1}return!0});F(qe=>{const xt=new Map(qe);for(const[qt]of qe)ln.some(oa=>oa.peerId===qt||oa.odaId===qt)||xt.delete(qt);return xt}),ln.forEach(qe=>{if(qe.odaId!==e?.uid&&qe.peerId&&!Ie.current.has(qe.peerId)&&Te.current&&te.current){console.log("[VoiceChannel] Calling peer:",qe.peerId);const xt=Te.current.call(qe.peerId,te.current);if(xt&&(xt.on("stream",qt=>{F(rr=>new Map(rr).set(qe.peerId,qt))}),xt.on("close",()=>{F(qt=>{const rr=new Map(qt);return rr.delete(qe.peerId),rr})}),Ie.current.set(qe.peerId,xt)),!We.current.has(qe.peerId)){const qt=Te.current.connect(qe.peerId);qt&&(qt.on("open",()=>{We.current.set(qe.peerId,qt)}),qt.on("data",K),qt.on("close",()=>{We.current.delete(qe.peerId)}))}}});const qn=new Set(ln.map(qe=>qe.peerId));Ie.current.forEach((qe,xt)=>{if(!qn.has(xt)){qe.close(),Ie.current.delete(xt);const qt=We.current.get(xt);qt&&(qt.close(),We.current.delete(xt))}}),y(ln),W.current=ln,De.current=bt});return()=>Ze()},[o,h,e,K]);const ct=T.useCallback(async Fe=>{if(!e||!r||!Te.current||!Ue.current){console.error("[VoiceChannel] Cannot join: missing requirements");return}try{const Ce=await navigator.mediaDevices.getUserMedia({audio:B?{deviceId:{exact:B}}:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});x(Ce),te.current=Ce;const Ze=Ne(le,"servers",r,"channels",Fe,"voiceParticipants",e.uid);await Xn(Ze,{odaId:e.uid,peerId:Ue.current,displayName:n?.displayName||e.displayName||"User",photoUrl:n?.photoUrl||n?.photoURL||null,joinedAt:ht(),isMuted:!1,isVideoOn:!1,isScreenSharing:!1});const et=async()=>{if(o&&e&&h)try{const At=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);await Xn(At,{lastHeartbeat:ht()},{merge:!0})}catch(At){console.error("[VoiceChannel] Heartbeat failed:",At)}};await et(),fe.current=setInterval(et,5e3),console.log("[VoiceChannel] Heartbeat started");const bt=async()=>{if(!ye.current||!Ve.current)return;const At=Date.now(),$t=De.current;$t.length>0&&console.log(`[VoiceChannel] Ghost Monitor: checking ${$t.length} total entries...`),De.current.forEach(St=>{if(St.odaId===e?.uid)return;const ln=St.lastHeartbeat||St.joinedAt,qn=ln?.toMillis?ln.toMillis():ln||0;if(qn===0)return;const qe=At-qn;if(qe>2e4){console.log("[VoiceChannel] Interval cleanup removing ghost:",St.displayName,`(${Math.round(qe/1e3)}s idle)`);const xt=Ne(le,"servers",Ve.current,"channels",ye.current,"voiceParticipants",St.odaId);ts(xt).catch(qt=>console.error("[VoiceChannel] Failed to delete ghost:",qt)),y(qt=>qt.filter(rr=>rr.odaId!==St.odaId))}})};dt.current=setInterval(bt,1e4),console.log("[VoiceChannel] Global cleanup interval started");const mt=async()=>{if(!Ie.current.size){ne(null);return}let At=0,$t=0;const St=Array.from(Ie.current.values()).map(async ln=>{if(ln.peerConnection)try{const qn=await ln.peerConnection.getStats();let qe=!1;qn.forEach(xt=>{xt.type==="candidate-pair"&&xt.state==="succeeded"&&(qe=!0,xt.currentRoundTripTime!==void 0?(At+=Math.round(xt.currentRoundTripTime*1e3),$t++):xt.roundTripTime!==void 0&&(At+=Math.round(xt.roundTripTime*1e3),$t++))}),qe||qn.forEach(xt=>{if(xt.type==="candidate-pair"&&(xt.currentRoundTripTime||xt.roundTripTime)){const qt=xt.currentRoundTripTime||xt.roundTripTime;At+=Math.round(qt*1e3),$t++}})}catch(qn){console.warn("[VoiceChannel] Stats error:",qn)}});if(await Promise.all(St),$t>0){const ln=Math.round(At/$t);ne(ln)}};Re.current=setInterval(mt,2e3),u(Fe),f(r),G(!1),Le(!1),X(!1),VS(),console.log("[VoiceChannel] Joined channel:",Fe)}catch(Ce){console.error("[VoiceChannel] Failed to join:",Ce)}},[e,r,n,B]),on=T.useRef(!1),Ee=T.useCallback(async()=>{if(!(on.current||!o||!e||!h))try{on.current=!0,fe.current&&(clearInterval(fe.current),fe.current=null,console.log("[VoiceChannel] Heartbeat stopped")),dt.current&&(clearInterval(dt.current),dt.current=null),Re.current&&(clearInterval(Re.current),Re.current=null);const Fe=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);await ts(Fe),te.current&&(te.current.getTracks().forEach(Ce=>{Ce.stop(),console.log("[VoiceChannel] Stopped track:",Ce.kind)}),te.current=null,x(null)),Oe.current&&(Oe.current.getTracks().forEach(Ce=>{Ce.stop(),console.log("[VoiceChannel] Stopped screen track:",Ce.kind)}),Oe.current=null,I(null)),Ie.current.forEach(Ce=>Ce.close()),Ie.current.clear(),We.current.forEach(Ce=>Ce.close()),We.current.clear(),F(new Map),u(null),f(null),y([]),Le(!1),X(!1),G(!1),J(!1),ke.current.length>0&&(console.log("[VoiceChannel] Stopping",ke.current.length,"active sounds"),ke.current.forEach(Ce=>{try{Ce.pause(),Ce.currentTime=0}catch(Ze){console.error("[VoiceChannel] Error stopping sound:",Ze)}}),ke.current=[]),US(),console.log("[VoiceChannel] Left channel - all media stopped")}catch(Fe){console.error("[VoiceChannel] Failed to leave:",Fe)}finally{setTimeout(()=>{on.current=!1},500)}},[o,e,h]);T.useEffect(()=>{const Fe=()=>{o&&Ee()};return window.addEventListener("beforeunload",Fe),()=>window.removeEventListener("beforeunload",Fe)},[o,Ee]);const $e=T.useCallback(()=>{if(te.current){const Fe=te.current.getAudioTracks()[0];if(Fe){const Ce=!oe;if(G(Ce),Ce?Fe.enabled=!1:re||(Fe.enabled=!0),o&&e&&h){const Ze=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);Xn(Ze,{isMuted:Ce},{merge:!0})}}}},[o,e,h,oe,re]),lt=T.useCallback(()=>{J(Fe=>{const Ce=!Fe;return Ce?oe||$e():oe&&$e(),V.forEach(Ze=>{Ze.getAudioTracks().forEach(et=>{et.enabled=!Ce})}),Ce})},[V,oe,$e]),yt=T.useCallback(async()=>{if(!(!te.current||!o))try{if(Se){const Fe=te.current.getVideoTracks()[0];Fe&&(Fe.stop(),te.current.removeTrack(Fe)),Le(!1)}else{const Ce=(await navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0];te.current.addTrack(Ce),x(new MediaStream(te.current.getTracks())),Le(!0),Ie.current.forEach((Ze,et)=>{const bt=Te.current.call(et,te.current);bt&&(bt.on("stream",mt=>{F(At=>new Map(At).set(et,mt))}),Ie.current.set(et,bt))})}if(e&&h){const Fe=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);Xn(Fe,{isVideoOn:!Se},{merge:!0})}}catch(Fe){console.error("[VoiceChannel] Failed to toggle video:",Fe)}},[Se,o,e,h]),Vt=T.useCallback(async(Fe=null)=>{if(o)try{if($||Fe===null&&Oe.current){if(Oe.current&&(Oe.current.getTracks().forEach(St=>St.stop()),Oe.current=null),X(!1),I(null),e&&h){const St=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);Xn(St,{isScreenSharing:!1},{merge:!0})}return}let Ce;const Ze={width:Fe?.width||960,height:Fe?.height||540,frameRate:Fe?.frameRate||15};console.log("[VoiceChannel] Screen share starting with constraints:",Ze),Fe?.sourceId?Ce=await navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:Fe.sourceId,maxWidth:Ze.width,maxHeight:Ze.height,maxFrameRate:Ze.frameRate}}}):Ce=await navigator.mediaDevices.getDisplayMedia({video:{width:{ideal:Ze.width},height:{ideal:Ze.height},frameRate:{ideal:Ze.frameRate},cursor:"always"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}});const et=Ce.getVideoTracks()[0],bt=Ce.getAudioTracks()[0],mt=te.current?.getAudioTracks()[0];let At=null;if(mt&&bt){console.log("[VoiceChannel] Mixing microphone and system audio");try{const St=new(window.AudioContext||window.webkitAudioContext),ln=St.createMediaStreamDestination(),qn=St.createMediaStreamSource(new MediaStream([mt])),qe=St.createMediaStreamSource(new MediaStream([bt])),xt=St.createGain(),qt=St.createGain();xt.gain.value=1,qt.gain.value=.5,qn.connect(xt),qe.connect(qt),xt.connect(ln),qt.connect(ln),At=ln.stream.getAudioTracks()[0]}catch(St){console.error("[VoiceChannel] Audio mixing failed, using mic only:",St),At=mt}}else mt?(console.log("[VoiceChannel] Using microphone audio only"),At=mt):bt&&(console.log("[VoiceChannel] Using system audio only"),At=bt);const $t=new MediaStream([et]);if(At&&$t.addTrack(At),Oe.current=$t,et.onended=()=>{if(X(!1),I(null),Oe.current=null,e&&h&&o){const St=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);Xn(St,{isScreenSharing:!1},{merge:!0})}},Ie.current.forEach((St,ln)=>{const qn=Te.current.call(ln,$t);qn&&qn.on("stream",qe=>{F(xt=>new Map(xt).set(ln,qe))})}),X(!0),I($t),I0(),e&&h){const St=Ne(le,"servers",h,"channels",o,"voiceParticipants",e.uid);Xn(St,{isScreenSharing:!0},{merge:!0})}}catch(Ce){console.error("[VoiceChannel] Failed to toggle screen share:",Ce)}},[$,o,e,h,te,Oe,Ie,We,V,F,X,I,I0]),kt=a?.filter(Fe=>Fe.type==="voice")||[];T.useEffect(()=>()=>{o&&Ee()},[o,h]);const{customSounds:nt}=_b(),Rt=T.useCallback(Fe=>{const Ce=nt.find(et=>et.id===Fe);if(!Ce)return;const Ze=new Audio(Ce.src);Ze.volume=.5,ke.current.push(Ze),Ze.onended=()=>{ke.current=ke.current.filter(et=>et!==Ze)},Ze.play().catch(et=>console.error("[VoiceChannel] Error playing sound locally:",et)),We.current.forEach((et,bt)=>{et.open&&(console.log("[VoiceChannel] Broadcasting sound to:",bt),et.send({type:"SOUND_EFFECT",payload:{src:Ce.src,name:Ce.name}}))})},[nt]),Xt={currentVoiceChannel:o,connectedServerId:h,participants:p,localStream:b,screenStream:k,remoteStreams:V,voiceChannels:kt,currentPing:P,isMuted:oe,isDeafened:Z,isVideoOn:Se,isScreenSharing:$,audioDevices:j,selectedAudioDeviceId:B,vadEnabled:re,joinVoiceChannel:ct,leaveVoiceChannel:Ee,toggleMute:$e,toggleDeafen:lt,toggleVideo:yt,toggleScreenShare:Vt,changeAudioDevice:Ae,videoDevices:w,selectedVideoDeviceId:R,changeVideoDevice:xe,refreshDevices:ue,userVolumes:L,setUserVolume:(Fe,Ce)=>{U(Ze=>{const et=new Map(Ze);return et.set(Fe,Ce),et})},playSound:Rt,toggleVAD:()=>he(Fe=>!Fe)};return c.jsxs(TA.Provider,{value:Xt,children:[t,c.jsx(XV,{remoteStreams:V,isDeafened:Z,participants:p,userVolumes:L})]})},XV=({remoteStreams:t,isDeafened:e,participants:n,userVolumes:r})=>c.jsx("div",{style:{display:"none"},children:Array.from(t.entries()).map(([a,o])=>{const h=n.find(p=>p.peerId===a)?.odaId,f=h?r.get(h)??1:1;return c.jsx(WV,{stream:o,muted:e,volume:f},a)})}),WV=({stream:t,muted:e,volume:n})=>{const r=T.useRef(null);return T.useEffect(()=>{r.current&&t&&(r.current.srcObject=t,r.current.play().catch(a=>{console.log("[VoiceChannel] Audio autoplay blocked:",a)}))},[t]),T.useEffect(()=>{r.current&&(r.current.muted=e)},[e]),T.useEffect(()=>{r.current&&(r.current.volume=n)},[n]),c.jsx("audio",{ref:r,autoPlay:!0,playsInline:!0})},CA=({participant:t,position:e,onClose:n,channelId:r,serverId:a})=>{const{userVolumes:o,setUserVolume:u}=Xc(),{userProfile:h}=yn(),f=h?.role==="admin",p=Math.round((o.get(t.odaId)??1)*100),y=x=>{const k=parseInt(x.target.value)/100;u(t.odaId,k)},b=async()=>{if(console.log("[Admin] Kick attempt:",{isAdmin:f,channelId:r,serverId:a,participantId:t.odaId,participantName:t.displayName}),!f){console.error("[Admin] Not an admin, cannot kick");return}if(!r||!a){console.error("[Admin] Missing channel or server ID");return}try{const x=Ne(le,"servers",a,"channels",r,"voiceParticipants",t.odaId);console.log("[Admin] Deleting participant:",x.path),await ts(x),console.log("[Admin] Successfully kicked user from voice:",t.displayName),n()}catch(x){console.error("[Admin] Failed to kick user:",x)}};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-40",onClick:n,onContextMenu:x=>{x.preventDefault(),n()}}),c.jsxs("div",{className:"fixed bg-[#111214] border border-[#1e1f22] rounded-lg shadow-xl py-3 z-50 w-64 px-3",style:{top:e.y,left:e.x},onClick:x=>x.stopPropagation(),children:[c.jsxs("div",{className:"text-xs font-bold text-[#949ba4] uppercase mb-3 px-1",children:[t.displayName," SETTINGS"]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm text-[#dbdee1] font-medium mb-1 px-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(RN,{size:14,className:"text-[#949ba4]"}),c.jsx("span",{children:"User Volume"})]}),c.jsxs("span",{className:"text-xs font-bold text-brand-primary",children:[p,"%"]})]}),c.jsx("input",{type:"range",min:"0",max:"100",value:p,onChange:y,className:"volume-slider",style:{background:`linear-gradient(to right, #ef9f64 0%, #ef9f64 ${p}%, #1e1f22 ${p}%, #1e1f22 100%)`}})]}),c.jsx("div",{className:"mt-4 border-t border-[#1e1f22] pt-2",children:c.jsx("div",{className:"text-[11px] text-[#949ba4] px-1 italic",children:"This setting only affects the audio heard by you."})}),f&&c.jsx("div",{className:"mt-3 border-t border-[#1e1f22] pt-3",children:c.jsxs("button",{onClick:b,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-red-500/10 rounded transition-colors",children:[c.jsx(lV,{size:14}),c.jsx("span",{children:"Kick from Voice Channel"})]})})]})]})},JV=({channel:t})=>{const{currentVoiceChannel:e,joinVoiceChannel:n,participants:r,remoteStreams:a,localStream:o}=Xc(),{currentServer:u}=aa(),{currentUser:h}=yn(),[f,p]=T.useState([]),[y,b]=T.useState(null),x=e===t.id;T.useEffect(()=>{if(!u||!t.id)return;const I=_t(le,"servers",u,"channels",t.id,"voiceParticipants"),A=Sr(I,V=>{const F=Date.now(),j=[];V.forEach(B=>{j.push({odaId:B.id,...B.data()})});const O=j.filter(B=>{if(B.odaId===h?.uid)return!0;const H=B.lastHeartbeat||B.joinedAt,w=H?.toMillis?H.toMillis():H||0;if(w===0)return!0;if(F-w>3e4){console.log("[VoiceChannel] Passive sidebar cleanup purging ghost:",B.displayName);const R=Ne(le,"servers",u,"channels",t.id,"voiceParticipants",B.odaId);return ts(R).catch(()=>{}),!1}return!0});p(O)}),N=setInterval(()=>{const V=Date.now();p(F=>F.filter(j=>{if(j.odaId===h?.uid)return!0;const O=j.lastHeartbeat||j.joinedAt,B=O?.toMillis?O.toMillis():O||0;if(B===0)return!0;if(V-B>3e4){console.log("[VoiceChannel] Periodic sidebar cleanup purging ghost:",j.displayName);const H=Ne(le,"servers",u,"channels",t.id,"voiceParticipants",j.odaId);return ts(H).catch(()=>{}),!1}return!0}))},15e3);return()=>{A(),clearInterval(N)}},[u,t.id,h]);const k=()=>{x||n(t.id)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded cursor-pointer transition-colors duration-150 ${x?"bg-dark-hover text-dark-text":"text-dark-muted hover:bg-dark-hover hover:text-dark-text"}`,onClick:k,children:[c.jsx(RN,{className:"flex-shrink-0"}),c.jsx("span",{className:"truncate text-sm flex-1 text-left",children:t.name})]}),f.length>0&&c.jsx("div",{className:"voice-participants",children:f.map(I=>c.jsx(ZV,{participant:I,isLocal:I.odaId===h?.uid,remoteStreams:a,localStream:o,onContextMenu:A=>{I.odaId!==h?.uid&&(A.preventDefault(),b({participant:I,x:A.clientX,y:A.clientY}))}},I.odaId))}),y&&c.jsx(CA,{participant:y.participant,position:{x:y.x,y:y.y},onClose:()=>b(null),channelId:t.id,serverId:u})]})},ZV=({participant:t,isLocal:e,remoteStreams:n,localStream:r,onContextMenu:a})=>{const o=e?r:n.get(t.peerId),u=Eb(t.isMuted||!o?null:o,{threshold:15});return c.jsxs("div",{className:`voice-participant ${u?"speaking":""}`,onContextMenu:a,children:[c.jsx("div",{className:"participant-avatar",children:t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:""}):c.jsx("div",{className:"avatar-placeholder",children:t.displayName?.charAt(0)?.toUpperCase()||"?"})}),c.jsx("span",{className:"participant-name",children:t.displayName}),c.jsxs("div",{className:"participant-status",children:[t.isMuted&&c.jsx(mb,{className:"status-icon muted"}),t.isVideoOn&&c.jsx(AN,{className:"status-icon video"}),t.isScreenSharing&&c.jsx(fb,{className:"status-icon screen"})]})]})},eU=()=>{const{voiceChannels:t}=Xc();return!t||t.length===0?null:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-xs font-semibold text-dark-muted uppercase px-2 mb-1 mt-4",children:"VOICE CHANNELS"}),c.jsx("div",{className:"voice-channel-list",children:t.map(e=>c.jsx(JV,{channel:e},e.id))})]})},tU=({onClose:t})=>{const{participants:e,localStream:n,screenStream:r,remoteStreams:a,isMuted:o,isScreenSharing:u}=Xc(),{currentUser:h}=yn(),[f,p]=T.useState(null),[y,b]=T.useState(null),x=e.length,k=x<=1?"grid-1":x<=2?"grid-2":x<=4?"grid-4":x<=6?"grid-6":x<=9?"grid-9":"grid-many",I=()=>u&&r?r:n,A=N=>N.odaId===h?.uid?I():a.get(N.peerId);return c.jsxs("div",{className:"voice-grid-overlay",children:[c.jsxs("div",{className:"voice-grid-modal",children:[c.jsxs("div",{className:"voice-grid-header",children:[c.jsx("h3",{children:"Voice Channel"}),c.jsx("button",{className:"close-btn",onClick:t,children:c.jsx(oV,{})})]}),c.jsx("div",{className:`voice-grid ${k}`,children:e.map(N=>c.jsx(rU,{participant:N,stream:A(N),isLocal:N.odaId===h?.uid,isMuted:N.odaId===h?.uid?o:N.isMuted,onExpand:()=>p(N),isFocused:!1,onContextMenu:V=>{N.odaId!==h?.uid&&(V.preventDefault(),b({participant:N,x:V.clientX,y:V.clientY}))}},N.odaId))})]}),y&&c.jsx(CA,{participant:y.participant,position:{x:y.x,y:y.y},onClose:()=>b(null)}),f&&c.jsx("div",{className:"voice-fullscreen-overlay",onClick:()=>p(null),children:c.jsx("div",{className:"voice-fullscreen-container",onClick:N=>N.stopPropagation(),children:c.jsx(nU,{stream:A(f),participant:f,isLocal:f.odaId===h?.uid,onClose:()=>p(null)})})})]})},nU=({stream:t,participant:e,isLocal:n,onClose:r})=>{const a=T.useRef(null);return T.useEffect(()=>{a.current&&t&&(a.current.srcObject=t)},[t]),c.jsxs("div",{className:"fullscreen-video-wrapper",children:[c.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:n,className:"fullscreen-video"}),c.jsxs("div",{className:"fullscreen-overlay",children:[c.jsxs("span",{className:"fullscreen-label",children:[e.displayName,n&&" (You)"]}),c.jsx("button",{className:"fullscreen-close-btn",onClick:r,children:c.jsx(rV,{})})]})]})},rU=({participant:t,stream:e,isLocal:n,isMuted:r,onExpand:a,isFocused:o,onContextMenu:u})=>{const h=T.useRef(null),f=Eb(r?null:e,{threshold:5});T.useEffect(()=>{h.current&&e&&(h.current.srcObject=e)},[e]);const p=e?.getVideoTracks()?.length>0&&e.getVideoTracks()[0].enabled;return c.jsxs("div",{className:`video-tile ${n?"local":""} ${o?"focused":""} ${f?"speaking":""}`,onClick:()=>p&&a&&a(),onContextMenu:u,children:[p?c.jsx("video",{ref:h,autoPlay:!0,playsInline:!0,muted:n,className:"video-feed"}):c.jsx("div",{className:"video-placeholder",children:t.photoUrl?c.jsx("img",{src:t.photoUrl,alt:"",className:"avatar-large"}):c.jsx("div",{className:"avatar-placeholder-large",children:t.displayName?.charAt(0)?.toUpperCase()||"?"})}),c.jsxs("div",{className:"tile-overlay",children:[c.jsxs("span",{className:"participant-label",children:[t.displayName,n&&" (You)"]}),c.jsxs("div",{className:"tile-status",children:[r&&c.jsx(mb,{className:"status-muted"}),t.isScreenSharing&&c.jsx(fb,{className:"status-screen"}),p&&c.jsx(NN,{className:"status-expand",onClick:y=>{y.stopPropagation(),a&&a()},title:"Full Screen"})]})]})]})},zS=()=>{if(window.electron&&window.electron.desktopCapturer)return window.electron.desktopCapturer;if(window.require)try{return window.require("electron").desktopCapturer}catch{return null}return null},kA=({isOpen:t,onClose:e,onConfirm:n})=>{const[r,a]=T.useState(720),[o,u]=T.useState(30),[h,f]=T.useState("screens"),[p,y]=T.useState({screens:[],windows:[]}),[b,x]=T.useState(null),[k,I]=T.useState(!1),A=!!zS();T.useEffect(()=>{if(t&&A){N();const F=setInterval(N,3e3);return()=>clearInterval(F)}},[t,A]);const N=async()=>{const F=zS();if(F)try{const j=await F.getSources({types:["window","screen"],thumbnailSize:{width:300,height:200}}),O=j.filter(H=>H.id.startsWith("screen:")),B=j.filter(H=>!H.id.startsWith("screen:"));y({screens:O,windows:B}),!b&&O.length>0&&x(O[0].id)}catch(j){console.error("Error loading sources:",j)}};if(!t)return null;const V=()=>{let F,j;r===1080?(F=1920,j=1080):(F=1280,j=720),n({width:F,height:j,frameRate:o,sourceId:b,displaySurface:h==="screens"?"monitor":"window"}),e()};return c.jsx("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center animate-fade-in",children:c.jsxs("div",{className:"bg-dark-elem w-full max-w-2xl rounded-2xl shadow-2xl border border-dark-hover overflow-hidden transform transition-all scale-100 p-6 relative flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 shrink-0",children:[c.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[c.jsx(Qm,{className:"text-brand-primary"}),"Screen Share"]}),c.jsx("button",{onClick:e,className:"p-1 hover:bg-dark-hover rounded-full transition-colors text-dark-muted hover:text-white",children:c.jsx($n,{size:24})})]}),c.jsxs("div",{className:"flex gap-6 overflow-hidden flex-1",children:[c.jsxs("div",{className:"w-64 flex flex-col gap-6 shrink-0 border-r border-dark-hover pr-6",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs font-bold text-dark-muted uppercase tracking-wider mb-3",children:"Resolution"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>a(720),className:`p-2 rounded-lg border text-xs font-bold ${r===720?"border-brand-primary bg-brand-primary/10 text-white":"border-dark-hover bg-dark-input text-gray-400"}`,children:"720p"}),c.jsx("button",{onClick:()=>a(1080),className:`p-2 rounded-lg border text-xs font-bold ${r===1080?"border-brand-primary bg-brand-primary/10 text-white":"border-dark-hover bg-dark-input text-gray-400"}`,children:"1080p"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs font-bold text-dark-muted uppercase tracking-wider mb-3",children:"Frame Rate"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:[15,30,60].map(F=>c.jsx("button",{onClick:()=>u(F),className:`p-2 rounded-lg border text-xs font-bold ${o===F?"border-brand-primary bg-brand-primary/10 text-white":"border-dark-hover bg-dark-input text-gray-400"}`,children:F},F))})]})]}),c.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:A?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-4 border-b border-dark-hover mb-4 shrink-0",children:[c.jsxs("button",{onClick:()=>f("screens"),className:`pb-2 text-sm font-bold flex items-center gap-2 transition-colors ${h==="screens"?"text-brand-primary border-b-2 border-brand-primary":"text-gray-400 hover:text-white"}`,children:[c.jsx(R7,{size:18})," Screens"]}),c.jsxs("button",{onClick:()=>f("windows"),className:`pb-2 text-sm font-bold flex items-center gap-2 transition-colors ${h==="windows"?"text-brand-primary border-b-2 border-brand-primary":"text-gray-400 hover:text-white"}`,children:[c.jsx(Y7,{size:18})," Windows"]})]}),c.jsx("div",{className:"grid grid-cols-2 gap-3 overflow-y-auto pr-2 custom-scrollbar content-start",children:(h==="screens"?p.screens:p.windows).map(F=>c.jsxs("button",{onClick:()=>x(F.id),className:`group relative rounded-lg overflow-hidden border-2 transition-all text-left ${b===F.id?"border-brand-primary ring-2 ring-brand-primary/20":"border-transparent hover:border-gray-600 bg-black/40"}`,children:[c.jsxs("div",{className:"aspect-video bg-black relative",children:[c.jsx("img",{src:F.thumbnail.toDataURL(),alt:F.name,className:"w-full h-full object-contain"}),b===F.id&&c.jsx("div",{className:"absolute inset-0 bg-brand-primary/10 flex items-center justify-center",children:c.jsx(el,{className:"text-brand-primary drop-shadow-lg",size:48})})]}),c.jsx("div",{className:"p-2 bg-dark-input truncate text-xs font-medium text-gray-300 group-hover:text-white",children:F.name})]},F.id))})]}):c.jsx("div",{className:"flex items-center justify-center h-full text-center text-gray-500",children:c.jsxs("div",{className:"max-w-xs",children:[c.jsx(Qm,{size:48,className:"mx-auto mb-4 opacity-50"}),c.jsxs("p",{className:"text-sm",children:["Browser limits source selection here.",c.jsx("br",{}),'Click "Go Live" to pick a screen or window.']})]})})})]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-hover mt-4 shrink-0",children:[c.jsx(st,{variant:"ghost",onClick:e,className:"text-dark-text hover:text-white",children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:V,className:"px-8 shadow-lg shadow-brand-primary/20",disabled:A&&!b,children:"Go Live"})]})]})})},sU=()=>{const{currentVoiceChannel:t,participants:e,isMuted:n,isDeafened:r,isVideoOn:a,isScreenSharing:o,toggleMute:u,toggleDeafen:h,toggleVideo:f,toggleScreenShare:p,leaveVoiceChannel:y,audioDevices:b,selectedAudioDeviceId:x,changeAudioDevice:k,videoDevices:I,selectedVideoDeviceId:A,changeVideoDevice:N,refreshDevices:V,playSound:F,currentPing:j}=Xc(),{customSounds:O,addSound:B,removeSound:H}=_b(),{userProfile:w}=yn(),{info:S}=Fr(),R=vc(w),{channels:D}=aa(),[L,U]=T.useState(!1),[P,ne]=T.useState(!1),[oe,G]=T.useState(!1),[Z,J]=T.useState(!1),[Se,Le]=T.useState(!1),$=T.useRef(null),X=T.useRef(null),re=T.useRef(null),he=T.useRef(null);T.useEffect(()=>{const fe=Re=>{$.current&&!$.current.contains(Re.target)&&G(!1),X.current&&!X.current.contains(Re.target)&&J(!1)};return(oe||Z)&&document.addEventListener("mousedown",fe),()=>{document.removeEventListener("mousedown",fe)}},[oe,Z]),T.useEffect(()=>{const fe=Re=>{re.current&&!re.current.contains(Re.target)&&Le(!1)};return Se&&document.addEventListener("mousedown",fe),()=>{document.removeEventListener("mousedown",fe)}},[Se]);const[Te,Ue]=T.useState(!1),te=fe=>!fe&&fe!==0?"unknown":fe<100?"good":fe<250?"fair":"poor",Oe=()=>{if(o)p(null);else{if(!R){S("Screen sharing is a Premium feature!");return}ne(!0)}},Ie=fe=>{ne(!1),p(fe)};if(!t)return null;const We=D?.find(fe=>fe.id===t),ke=async fe=>{const Re=fe.target.files[0];if(!Re)return;const dt=Re.name.split(".")[0].slice(0,15);await B(dt,Re),he.current&&(he.current.value="")};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"voice-channel-bar",children:[c.jsx("div",{className:"voice-bar-header",children:c.jsx("div",{className:"voice-bar-info",children:c.jsxs("div",{className:"voice-bar-status relative",children:[c.jsxs("div",{className:`voice-connection-status ${te(j)}`,onMouseEnter:()=>Ue(!0),onMouseLeave:()=>Ue(!1),children:[c.jsx("div",{className:"signal-bar bar-1"}),c.jsx("div",{className:"signal-bar bar-2"}),c.jsx("div",{className:"signal-bar bar-3"})]}),Te&&c.jsxs("div",{className:"ping-stats-panel",children:[c.jsxs("div",{className:"ping-value",children:[j||"--"," ms"]}),c.jsx("div",{className:"ping-label",children:"Latency"})]}),c.jsx("span",{className:"voice-bar-channel",children:We?.name||"Voice Channel"})]})})}),c.jsxs("div",{className:"voice-bar-controls",children:[c.jsxs("div",{className:"control-group",children:[c.jsx("button",{className:`voice-control-btn ${n?"active":""}`,onClick:u,title:n?"Unmute":"Mute",children:n?c.jsx(mb,{}):c.jsx(iV,{})}),c.jsxs("div",{className:"voice-settings-wrapper",ref:$,children:[c.jsx("button",{className:`voice-control-btn arrow-btn ${oe?"active":""}`,onClick:fe=>{fe.stopPropagation(),oe||V(),G(!oe)},title:"Input Devices",children:c.jsx(SS,{size:10})}),oe&&c.jsxs("div",{className:"voice-device-menu",children:[c.jsx("div",{className:"menu-header",children:"Input Device"}),c.jsx("div",{className:"menu-list",children:b.length>0?b.map(fe=>c.jsxs("div",{className:`menu-item ${x===fe.deviceId?"active":""}`,onClick:()=>{k(fe.deviceId),G(!1)},children:[c.jsx("span",{className:"truncate",children:fe.label||`Microphone ${fe.deviceId.slice(0,5)}`}),x===fe.deviceId&&c.jsx("div",{className:"active-dot"})]},fe.deviceId)):c.jsx("div",{className:"menu-item disabled",children:"No microphone found"})})]})]}),c.jsx("button",{className:`voice-control-btn ${r?"active":""}`,onClick:h,title:r?"Undeafen":"Deafen",children:r?c.jsx(I7,{}):c.jsx(sV,{})})]}),c.jsxs("div",{className:"control-group",children:[c.jsx("button",{className:`voice-control-btn ${a?"active":""}`,onClick:f,title:a?"Turn Off Camera":"Turn On Camera",children:a?c.jsx(AN,{}):c.jsx(cV,{})}),c.jsxs("div",{className:"voice-settings-wrapper",ref:X,children:[c.jsx("button",{className:`voice-control-btn arrow-btn ${Z?"active":""}`,onClick:fe=>{fe.stopPropagation(),Z||V(),J(!Z)},title:"Video Settings",children:c.jsx(SS,{size:10})}),Z&&c.jsxs("div",{className:"voice-device-menu",children:[c.jsx("div",{className:"menu-header",children:"Camera Device"}),c.jsx("div",{className:"menu-list",children:I.length>0?I.map(fe=>c.jsxs("div",{className:`menu-item ${A===fe.deviceId?"active":""}`,onClick:()=>{N(fe.deviceId),J(!1)},children:[c.jsx("span",{className:"truncate",children:fe.label||`Camera ${fe.deviceId.slice(0,5)}`}),A===fe.deviceId&&c.jsx("div",{className:"active-dot"})]},fe.deviceId)):c.jsx("div",{className:"menu-item disabled",children:"No camera found"})})]})]}),c.jsx("button",{className:`voice-control-btn ${o?"active":""}`,onClick:Oe,title:o?"Stop Sharing":"Share Screen",children:c.jsx(fb,{})})]}),c.jsxs("div",{className:"control-group",children:[c.jsxs("div",{className:"voice-settings-wrapper",ref:re,children:[c.jsx("button",{className:`voice-control-btn ${Se?"active":""}`,onClick:fe=>{fe.stopPropagation(),Le(!Se)},title:"Soundboard",children:c.jsx(Xm,{})}),Se&&c.jsxs("div",{className:"voice-device-menu soundboard-menu",children:[c.jsxs("div",{className:"menu-header",children:[c.jsx("span",{children:"Soundboard"}),c.jsxs("span",{className:"text-[10px] opacity-50",children:[O.length,"/10"]})]}),c.jsx("div",{className:"menu-list soundboard-list",children:O.length===0?c.jsx("div",{className:"menu-item disabled",children:"No sounds added yet"}):O.map(fe=>c.jsxs("div",{className:"soundboard-item-wrapper group",children:[c.jsxs("div",{className:"menu-item soundboard-item",onClick:()=>{R&&F(fe.id)},children:[c.jsx("span",{className:"truncate flex-1",children:fe.name}),c.jsx("span",{className:"text-xs opacity-50",children:""})]}),c.jsx("button",{className:"sound-delete-btn",onClick:Re=>{Re.stopPropagation(),H(fe.id)},children:c.jsx(Ki,{size:14})})]},fe.id))}),O.length<10&&c.jsxs("div",{className:"menu-footer",children:[c.jsxs("button",{className:"add-sound-btn",onClick:()=>he.current?.click(),children:[c.jsx(Yo,{size:14}),c.jsx("span",{children:"Add Sound"})]}),c.jsx("input",{type:"file",ref:he,className:"hidden",accept:"audio/mp3,audio/wav",onChange:ke})]}),!R&&c.jsx("div",{className:"absolute inset-0 bg-black/80 flex items-center justify-center rounded-lg p-4 text-center z-[60]",children:c.jsx("div",{children:c.jsx("p",{className:"text-orange-400 font-bold mb-1",children:"Premium Only"})})})]})]}),e.length>0&&c.jsx("button",{className:"voice-control-btn",onClick:()=>U(!0),title:"Expand Grid",children:c.jsx(NN,{})})]}),c.jsx("div",{className:"control-group no-bg",children:c.jsx("button",{className:"voice-control-btn disconnect",onClick:y,title:"Disconnect",children:c.jsx(aV,{})})})]})]}),L&&c.jsx(tU,{onClose:()=>U(!1)}),c.jsx(kA,{isOpen:P,onClose:()=>ne(!1),onConfirm:Ie})]})},BS=({server:t,channels:e,selectedChannel:n,onSelectChannel:r,onOpenSettings:a,onOpenAdmin:o,onLogout:u,userProfile:h,serverId:f,userRole:p,userId:y,dms:b,unreadDms:x,selectedDm:k,onSelectDm:I})=>{const[A,N]=T.useState(!1),[V,F]=T.useState(!1),[j,O]=T.useState(!1),B=()=>{F(!1),u()};return c.jsxs("div",{className:"w-60 bg-dark-sidebar flex flex-col h-full",children:[c.jsxs("div",{className:"h-12 md:h-12 pt-safe-top md:pt-0 px-4 flex items-center justify-between border-b border-dark-hover shadow-md box-content",children:[c.jsx("h2",{className:"font-semibold text-dark-text truncate",children:t?.name||"Lumo"}),c.jsxs("div",{className:"flex items-center gap-1",children:[f&&p==="admin"&&c.jsx("button",{onClick:()=>O(!0),className:"p-1.5 hover:bg-dark-hover rounded transition-colors",title:"Generate Invite",children:c.jsx(Q7,{className:"text-green-500",size:20})}),h?.role==="admin"&&c.jsx("button",{onClick:o,className:"p-1.5 hover:bg-dark-hover rounded transition-colors",title:"Admin Panel",children:c.jsx(oN,{className:"text-admin",size:20})})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto py-3",children:f==="home"?c.jsx(KV,{dms:b,unreadDms:x,selectedDmId:k?.id,onSelectDm:I}):c.jsxs("div",{className:"px-2",children:[c.jsx("div",{className:"text-xs font-semibold text-dark-muted uppercase px-2 mb-1",children:"Text Channels"}),e.filter(H=>H.type!=="voice").map(H=>c.jsxs("button",{onClick:()=>r(H),className:Ht("w-full flex items-center gap-2 px-2 py-1.5 rounded","text-dark-muted hover:bg-dark-hover hover:text-dark-text","transition-colors duration-150",n?.id===H.id&&"bg-dark-hover text-dark-text"),children:[c.jsx(Bp,{className:"flex-shrink-0"}),c.jsx("span",{className:"truncate text-sm flex-1 text-left",children:H.name}),H.locked&&c.jsx(v7,{className:"flex-shrink-0 text-yellow-500",size:14,title:"Locked channel"})]},H.id)),c.jsx(eU,{})]})}),c.jsx(sU,{}),c.jsx("div",{className:"px-2 pb-2 -ml-[72px] w-[calc(100%+72px)] relative z-10",children:c.jsxs("div",{className:"h-[60px] bg-[#1e1f22] px-3 flex items-center gap-2 rounded-lg shadow-lg border border-[#3f4147]",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1 cursor-pointer hover:bg-dark-hover rounded p-1 transition-colors",onClick:()=>N(!0),children:[c.jsxs("div",{className:"relative flex-shrink-0",children:[h?.photoUrl?c.jsx("img",{src:h.photoUrl,alt:h.displayName,className:"w-8 h-8 rounded-full object-cover",onError:H=>{H.target.style.display="none",H.target.nextSibling.style.display="flex"}},h.photoUrl):null,c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold text-sm",style:{display:h?.photoUrl?"none":"flex"},children:h?.displayName?.[0]?.toUpperCase()||"U"},`fallback-${h?.photoUrl}`),c.jsx("div",{className:"absolute -bottom-0.5 -right-0.5",children:c.jsx(SA,{status:h?.presence||"online",size:"sm"})})]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"text-sm font-medium text-dark-text truncate leading-tight",children:h?.displayName||"User"}),c.jsx("div",{className:"text-[11px] text-dark-muted truncate leading-tight",children:h?.presence==="online"?"Online":h?.presence==="idle"?"Idle":h?.presence==="dnd"?"Do Not Disturb":h?.presence==="offline"?"Invisible":"Online"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-hover rounded transition-colors",title:"User Settings",children:c.jsx(Up,{className:"text-dark-muted hover:text-dark-text",size:20})}),c.jsx("button",{onClick:()=>F(!0),className:"p-2 hover:bg-dark-hover rounded transition-colors",title:"Logout",children:c.jsx(y7,{className:"text-dark-muted hover:text-red-400",size:20})})]})]})}),c.jsx(wb,{user:h,isOpen:A,onClose:()=>N(!1)}),c.jsx(Ac,{isOpen:V,onClose:()=>F(!1),onConfirm:B,title:"Logout",message:"Are you sure you want to logout?",confirmText:"Logout",variant:"danger"}),c.jsx($V,{isOpen:j,onClose:()=>O(!1),serverId:f})]})},iU=(t,e)=>{if(e===0)return"0 KB/s";const n=t/e;return n>1024*1024?`${(n/(1024*1024)).toFixed(1)} MB/s`:`${(n/1024).toFixed(0)} KB/s`},Hd=(t,e)=>new Promise((n,r)=>{const a="5c1c5b7cae2edd508a2f35f98c4eec96",o=new FormData;o.append("image",t);const u=new XMLHttpRequest;u.open("POST",`https://api.imgbb.com/1/upload?key=${a}`);const h=Date.now();u.upload.onprogress=f=>{if(f.lengthComputable){const p=f.loaded/f.total*100,y=(Date.now()-h)/1e3,b=iU(f.loaded,y);e&&e(p,b)}},u.onload=()=>{if(u.status===200)try{const f=JSON.parse(u.responseText);f.success?n(f.data.url):r(new Error(f.error?.message||"Failed to upload image"))}catch{r(new Error("Invalid response from ImgBB"))}else r(new Error(`Upload failed with status ${u.status}`))},u.onerror=()=>r(new Error("Network error during upload")),u.send(o)}),aU=({server:t,onClose:e,onDelete:n,position:r,userRole:a,userId:o})=>{const[u,h]=T.useState(!1),[f,p]=T.useState(t.name),[y,b]=T.useState(!1),[x,k]=T.useState(!1),[I,A]=T.useState(t.icon||null),[N,V]=T.useState(null),[F,j]=T.useState({progress:0,speed:""}),[O,B]=T.useState(!1),[H,w]=T.useState(!1),S=T.useRef(null),{success:R,error:D}=Fr(),L=async()=>{if(!f.trim()){D("Server name is required");return}b(!0);try{await it(Ne(le,"servers",t.id),{name:f.trim()}),R("Server updated!"),h(!1),e()}catch(G){console.error("Error updating server:",G),D("Failed to update server")}finally{b(!1)}},U=async()=>{try{const G=_t(le,"servers",t.id,"members"),Z=await di(G),J=[];Z.forEach(Se=>{const Le=Se.data().userId;J.push(it(Ne(le,"users",Le),{servers:Vd(t.id),...Se.data().currentServer===t.id?{currentServer:null}:{}}))}),await Promise.all(J),await ts(Ne(le,"servers",t.id)),R("Server deleted"),B(!1),n(),e()}catch(G){console.error("Error deleting server:",G),D("Failed to delete server"),B(!1)}},P=async()=>{try{await it(Ne(le,"users",o),{servers:Vd(t.id),currentServer:null}),await ts(Ne(le,"servers",t.id,"members",o)),await it(Ne(le,"servers",t.id),{memberCount:Ui(-1)}),R("Left server"),w(!1),e()}catch(G){console.error("Error leaving server:",G),w(!1),e()}},ne=G=>{const Z=G.target.files?.[0];if(Z){if(!Z.type.startsWith("image/")){D("Please select an image file");return}if(Z.size>10*1024*1024){D("Image size must be less than 10MB");return}V(Z),A(URL.createObjectURL(Z))}},oe=async()=>{if(!N){D("Please select an image first");return}b(!0);try{const G=await Hd(N,(Z,J)=>{j({progress:Z,speed:J})});await it(Ne(le,"servers",t.id),{icon:G}),R("Server icon updated!"),k(!1),e()}catch(G){console.error("Error updating icon:",G),D("Failed to update icon")}finally{b(!1),j({progress:0,speed:""})}};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-40",onClick:e}),c.jsx("div",{className:"fixed bg-dark-sidebar border border-dark-hover rounded-lg shadow-xl py-2 z-50 w-64",style:{top:r.y,left:r.x},children:u?c.jsxs("div",{className:"px-3 py-2 space-y-2",children:[c.jsx(bn,{value:f,onChange:G=>p(G.target.value),placeholder:"Server name",autoFocus:!0}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:()=>h(!1),className:"flex-1 text-xs py-1",children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:L,disabled:y,className:"flex-1 text-xs py-1",children:y?"Saving...":"Save"})]})]}):x?c.jsxs("div",{className:"px-3 py-2 space-y-3",children:[c.jsx("input",{type:"file",ref:S,onChange:ne,accept:"image/*",className:"hidden"}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{onClick:()=>S.current?.click(),className:"w-16 h-16 rounded-full bg-dark-hover border-2 border-dashed border-dark-muted hover:border-brand-primary flex items-center justify-center transition-colors overflow-hidden",children:I?c.jsx("img",{src:I,alt:"Preview",className:"w-full h-full object-cover"}):c.jsx(_y,{size:24,className:"text-dark-muted"})}),c.jsx("span",{className:"text-xs text-dark-muted mt-2",children:"Click to select image"})]}),y&&F.progress>0&&c.jsxs("div",{className:"text-xs text-center text-dark-muted",children:[Math.round(F.progress),"% (",F.speed,")"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:()=>{k(!1),V(null),A(t.icon||null)},className:"flex-1 text-xs py-1",children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:oe,disabled:y||!N,className:"flex-1 text-xs py-1",children:y?"Uploading...":"Save"})]})]}):c.jsx(c.Fragment,{children:a==="admin"?c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>h(!0),className:"w-full px-4 py-2 text-left text-sm text-dark-text hover:bg-dark-hover transition-colors flex items-center gap-2",children:[c.jsx(pc,{size:16}),"Edit Server Name"]}),c.jsxs("button",{onClick:()=>k(!0),className:"w-full px-4 py-2 text-left text-sm text-dark-text hover:bg-dark-hover transition-colors flex items-center gap-2",children:[c.jsx(_y,{size:16}),"Change Icon"]}),c.jsxs("button",{onClick:()=>B(!0),className:"w-full px-4 py-2 text-left text-sm text-admin hover:bg-dark-hover transition-colors flex items-center gap-2",children:[c.jsx(Ki,{size:16}),"Delete Server"]})]}):c.jsxs("button",{onClick:()=>w(!0),className:"w-full px-4 py-2 text-left text-sm text-orange-500 hover:bg-dark-hover transition-colors flex items-center gap-2",children:[c.jsx(p7,{size:16}),"Leave Server"]})})}),c.jsx(Ac,{isOpen:O,onClose:()=>B(!1),onConfirm:U,title:"Delete Server",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone!`,confirmText:"Delete",confirmVariant:"danger"}),c.jsx(Ac,{isOpen:H,onClose:()=>w(!1),onConfirm:P,title:"Leave Server",message:`Are you sure you want to leave "${t.name}"?`,confirmText:"Leave",confirmVariant:"warning"})]})},oU=""+new URL("lumo-logo-DYOsjf-q.png",import.meta.url).href,FS=({servers:t,currentServerId:e,onServerChange:n,onCreateServer:r,onJoinServer:a,userRole:o,userId:u,unreadMentions:h={},unreadDms:f={}})=>{const[p,y]=T.useState(!1),[b,x]=T.useState(null),k=Object.values(f).reduce((A,N)=>A+(N.count||0),0),I=(A,N)=>{A.preventDefault(),x({server:N,position:{x:A.clientX,y:A.clientY}})};return c.jsxs("div",{className:"w-20 bg-dark-bg h-full flex flex-col items-center pt-safe-top md:pt-0 box-content",children:[c.jsx("div",{className:"flex flex-col items-center",children:c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>n("home"),className:Ht("w-16 h-16 flex items-center justify-center transition-all duration-200 overflow-hidden",e==="home"||!e?"rounded-xl":"rounded-2xl hover:rounded-xl"),children:c.jsx("img",{src:oU,alt:"Home",className:"w-full h-full object-cover"})}),k>0&&c.jsx("div",{className:"absolute top-0 right-0 min-w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-2 border-dark-bg pointer-events-none",children:c.jsx("span",{className:"text-white text-xs font-bold px-1",children:k>99?"99+":k})})]})}),c.jsx("div",{className:"w-8 h-0.5 bg-dark-hover my-2"}),c.jsxs("div",{className:"flex flex-col items-center gap-2 flex-1 overflow-y-auto",children:[t.map(A=>c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>n(A.id),onContextMenu:N=>I(N,A),className:Ht("w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-200","hover:rounded-xl",e===A.id?"bg-brand-primary text-white rounded-xl":"bg-dark-sidebar text-dark-text hover:bg-brand-primary hover:text-white"),title:A.name,children:A.icon?c.jsx("img",{src:A.icon,alt:A.name,className:"w-full h-full rounded-2xl object-cover"}):c.jsx("span",{className:"text-xl font-bold",children:A.name.charAt(0).toUpperCase()})}),h[A.id]?.count>0&&c.jsx("div",{className:"absolute -top-1 -right-1 min-w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-2 border-dark-bg pointer-events-none",children:c.jsx("span",{className:"text-white text-xs font-bold px-1",children:h[A.id].count>99?"99+":h[A.id].count})})]},A.id)),c.jsx("div",{className:"w-8 h-0.5 bg-dark-hover my-1"}),c.jsxs("div",{className:"relative pb-2",children:[c.jsx("button",{id:"add-server-btn",onClick:A=>{const N=A.currentTarget.getBoundingClientRect();document.documentElement.style.setProperty("--btn-top",`${N.top}px`),y(!p)},className:"w-12 h-12 rounded-2xl bg-dark-sidebar text-green-500 flex items-center justify-center hover:bg-green-500 hover:text-white hover:rounded-xl transition-all duration-200",title:"Add Server",children:c.jsx(Yo,{size:28})}),p&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>y(!1)}),c.jsxs("div",{className:"fixed left-[80px] bg-dark-sidebar border border-dark-hover rounded-lg shadow-lg py-2 z-50 w-48",style:{top:"var(--btn-top)"},children:[o==="admin"&&c.jsx("button",{onClick:()=>{r(),y(!1)},className:"w-full px-4 py-2 text-left text-sm text-dark-text hover:bg-dark-hover transition-colors",children:"Create Server"}),c.jsx("button",{onClick:()=>{a(),y(!1)},className:"w-full px-4 py-2 text-left text-sm text-dark-text hover:bg-dark-hover transition-colors",children:"Join Server"})]})]})]})]}),b&&c.jsx(aU,{server:b.server,position:b.position,userRole:o,userId:u,onClose:()=>x(null),onDelete:()=>{x(null)}})]})},HS=({users:t,currentUserId:e,onStartDm:n})=>{const{currentServer:r}=aa(),[a,o]=T.useState(null),[u,h]=T.useState([]);T.useEffect(()=>{if(!r||r==="home"){h([]);return}const N=zr(_t(le,"servers",r,"roles"));return Sr(N,F=>{const j=[];F.forEach(O=>{j.push({id:O.id,...O.data()})}),h(j)})},[r]);const f=N=>N.presence==="invisible"?!1:EA(N.lastSeen),p=t.filter(N=>f(N)),y=t.filter(N=>!f(N)),b=p.reduce((N,V)=>{const F=V.serverRole||V.role||"member";return N[F]||(N[F]=[]),N[F].push(V),N},{}),I=[...[{name:"admin",position:-3},{name:"moderator",position:-2},{name:"member",position:-1}],...u.map(N=>({name:N.name,position:N.position??999}))].sort((N,V)=>N.position-V.position).map(N=>N.name).filter(N=>b[N]?.length>0),A=N=>{const V=f(N);return c.jsxs("div",{onClick:()=>o(N),className:Ht("flex items-center gap-2 px-2 py-1.5 rounded cursor-pointer","hover:bg-dark-hover transition-colors",N.id===e&&"bg-dark-hover/50",!V&&"opacity-50"),children:[c.jsxs("div",{className:"relative flex-shrink-0",children:[N.photoUrl?c.jsx("img",{src:N.photoUrl,alt:N.displayName,className:"w-8 h-8 rounded-full object-cover",onError:F=>{F.target.style.display="none",F.target.nextSibling.style.display="flex"}}):null,c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold text-sm",style:{display:N.photoUrl?"none":"flex"},children:N.displayName?.[0]?.toUpperCase()||"U"}),c.jsx("div",{className:"absolute bottom-0 right-0",children:c.jsx(SA,{status:V?N.presence||"online":"offline",size:"sm"})})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-dark-text truncate",children:N.displayName||"Unknown"}),N.badges&&N.badges.length>0&&c.jsx("div",{className:"flex items-center gap-0.5",children:N.badges.slice(0,3).map(F=>{const j=uV(F);if(!j)return null;const O=j.icon;return c.jsx(O,{size:14,style:{color:j.color},title:j.label,className:"flex-shrink-0"},F)})})]}),N.status&&c.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[c.jsx("span",{className:"text-xs",children:N.status.emoji}),c.jsx("span",{className:"text-xs text-dark-muted truncate",children:N.status.text})]})]})]},N.id)};return c.jsxs("div",{className:"w-60 bg-dark-sidebar h-full overflow-y-auto py-3",children:[c.jsxs("div",{className:"px-2",children:[I.map(N=>{const V=b[N]||[];return V.length===0?null:c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"text-xs font-semibold text-dark-muted uppercase px-2 mb-2",children:[N.charAt(0).toUpperCase()+N.slice(1),"s  ",V.length]}),V.map(A)]},N)}),y.length>0&&c.jsxs("div",{className:"mt-4",children:[c.jsxs("div",{className:"text-xs font-semibold text-gray-500 uppercase px-2 mb-2",children:["Offline  ",y.length]}),y.map(A)]})]}),c.jsx(wb,{user:a,isOpen:!!a,onClose:()=>o(null),onMessage:N=>{n&&n(N),o(null)}})]})},lU=({isOpen:t,onClose:e,onConfirm:n,url:r})=>{const[a,o]=T.useState(!1),u=()=>{a&&localStorage.setItem("dontAskExternalLinks","true"),n(),e()};return c.jsx(Ds,{isOpen:t,onClose:e,title:"External Link Warning",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:c.jsxs("p",{className:"text-dark-text text-sm",children:[c.jsx("span",{className:"font-semibold text-yellow-500",children:" Security Warning"}),c.jsx("br",{}),c.jsx("br",{}),"You are about to open an external link. External links may lead to harmful or malicious websites. Please ensure you trust the source before proceeding."]})}),c.jsxs("div",{className:"bg-dark-bg p-3 rounded-lg",children:[c.jsx("p",{className:"text-xs text-dark-muted mb-1",children:"Link:"}),c.jsx("p",{className:"text-dark-text text-sm break-all font-mono",children:r})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:a,onChange:h=>o(h.target.checked),className:`w-4 h-4 rounded border-dark-hover bg-dark-input text-brand-primary 
                       focus:ring-2 focus:ring-brand-primary cursor-pointer`}),c.jsx("span",{className:"text-sm text-dark-text",children:"Don't ask me again"})]}),c.jsxs("div",{className:"flex gap-3 justify-end pt-2",children:[c.jsx(st,{variant:"secondary",onClick:e,children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:u,children:"Open Link"})]})]})})},cU=t=>{if(!t)return t;let e=t;return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/```([^`]+)```/g,'<pre class="bg-dark-input text-dark-text p-2 rounded my-1 overflow-x-auto"><code>$1</code></pre>'),e=e.replace(/`([^`]+)`/g,'<code class="bg-dark-input text-dark-text px-1 py-0.5 rounded text-sm">$1</code>'),e=e.replace(/\*\*([^*]+)\*\*/g,'<strong class="font-bold">$1</strong>'),e=e.replace(/\*([^*]+)\*/g,'<em class="italic">$1</em>'),e=e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-brand-primary hover:underline">$1</a>'),e=e.replace(/@(everyone|[a-zA-Z0-9_]+)\b/g,'<span class="text-brand-primary font-medium cursor-pointer hover:underline" data-mention="$1">$1</span>'),e=e.replace(/\n/g,"<br>"),e},NA=({children:t,onMentionClick:e})=>{const n=cU(t),r=a=>{const o=a.target.getAttribute("data-mention");o&&e&&e(o)};return c.jsx("div",{dangerouslySetInnerHTML:{__html:n},className:"markdown-content",onClick:r})},uU=["","","","","","","","","",""],$S=({onSelect:t,onClose:e})=>c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-40",onClick:e}),c.jsx("div",{className:"absolute left-0 bottom-full mb-2 bg-dark-sidebar border border-dark-hover rounded-lg shadow-lg p-2 z-50",children:c.jsx("div",{className:"flex gap-1",children:uU.map(n=>c.jsx("button",{onClick:()=>t(n),className:"w-8 h-8 flex items-center justify-center text-lg hover:bg-dark-hover rounded transition-colors",title:n,children:n},n))})})]}),dU=({message:t,currentUserId:e,serverId:n,channelId:r,users:a})=>{const[o,u]=T.useState(!1),h=t.poll;if(!h)return null;const f=t.userId===e,p=h.ended===!0,y=h.options.reduce((A,N,V)=>A+(h.votes?.[`option_${V}`]?.length||0),0),b=h.options.map((A,N)=>h.votes?.[`option_${N}`]?.includes(e)?N:-1).filter(A=>A!==-1);b.length>0;const x=async A=>{if(!(o||p)){u(!0);try{const N=`poll.votes.option_${A}`,V=Ne(le,"servers",n,"channels",r,"messages",t.id);if(h.votes?.[`option_${A}`]?.includes(e))await it(V,{[N]:Vd(e)});else{if(!h.multipleChoice&&b.length>0)for(const j of b)await it(V,{[`poll.votes.option_${j}`]:Vd(e)});await it(V,{[N]:uh(e)})}}catch(N){console.error("Error voting:",N)}finally{u(!1)}}},k=async()=>{if(!(!f||p))try{const A=Ne(le,"servers",n,"channels",r,"messages",t.id);await it(A,{"poll.ended":!0})}catch(A){console.error("Error ending poll:",A)}},I=A=>h.anonymous?null:(h.votes?.[`option_${A}`]||[]).map(V=>a?.find(F=>F.id===V)?.displayName||"Unknown").join(", ");return c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 mt-2 border border-dark-hover max-w-md",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(db,{className:"text-brand-primary",size:20}),c.jsx("span",{className:"text-xs text-dark-muted uppercase tracking-wide font-semibold",children:"Poll"}),h.multipleChoice&&c.jsx("span",{className:"text-xs text-dark-muted bg-dark-hover px-2 py-0.5 rounded",children:"Multiple Choice"}),p&&c.jsx("span",{className:"text-xs text-red-400 bg-red-400/10 px-2 py-0.5 rounded",children:"Ended"})]}),c.jsx("h3",{className:"text-dark-text font-semibold mb-4",children:h.question}),c.jsx("div",{className:"space-y-2",children:h.options.map((A,N)=>{const V=h.votes?.[`option_${N}`]?.length||0,F=y>0?Math.round(V/y*100):0,j=b.includes(N),O=I(N);return c.jsxs("button",{onClick:()=>x(N),disabled:o||p,className:`w-full text-left p-3 rounded-lg relative overflow-hidden transition-all group ${j?"bg-brand-primary/20 border-2 border-brand-primary":"bg-dark-sidebar border border-dark-hover hover:border-dark-muted"} ${p?"cursor-not-allowed opacity-80":""}`,children:[y>0&&c.jsx("div",{className:`absolute inset-0 transition-all duration-500 ${j?"bg-brand-primary/30":"bg-dark-hover/50"}`,style:{width:`${F}%`}}),c.jsxs("div",{className:"relative flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[j&&c.jsx("div",{className:"w-5 h-5 bg-brand-primary rounded-full flex items-center justify-center",children:c.jsx(el,{className:"text-white",size:14})}),c.jsx("span",{className:`text-sm ${j?"text-dark-text font-medium":"text-dark-muted"}`,children:A})]}),y>0&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"text-xs text-dark-muted",children:[V," vote",V!==1?"s":""]}),c.jsxs("span",{className:"text-sm font-semibold text-dark-text",children:[F,"%"]})]})]}),O&&V>0&&c.jsx("div",{className:"text-xs text-dark-muted mt-1 truncate opacity-0 group-hover:opacity-100 transition-opacity",children:O})]},N)})}),c.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-dark-hover",children:[c.jsxs("div",{className:"flex items-center gap-1 text-xs text-dark-muted",children:[c.jsx(ub,{size:14}),c.jsxs("span",{children:[y," total vote",y!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[h.anonymous&&c.jsx("span",{className:"text-xs text-dark-muted",children:"Anonymous"}),f&&!p&&c.jsxs("button",{onClick:k,className:"flex items-center gap-1.5 text-xs font-medium text-red-400 bg-red-400/10 hover:bg-red-400/20 px-3 py-1.5 rounded transition-all border border-red-400/20 hover:border-red-400/30",children:[c.jsx(w7,{size:14}),"End Poll"]})]})]})]})},Sb=({isOpen:t,onClose:e,mediaUrl:n,mediaType:r="image"})=>{if(!n)return null;const a=()=>{const u=document.createElement("a");u.href=n,u.download=n.split("/").pop()||"download",document.body.appendChild(u),u.click(),document.body.removeChild(u)},o=()=>{window.electron&&window.electron.shell?window.electron.shell.openExternal(n):window.open(n,"_blank","noopener,noreferrer")};return c.jsx(Ds,{isOpen:t,onClose:e,title:"",size:"full",showCloseButton:!1,children:c.jsxs("div",{className:"fixed inset-0 bg-black/95 flex flex-col z-50",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/50 backdrop-blur-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:a,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-white",title:"Download",children:c.jsx(hN,{size:24})}),c.jsx("button",{onClick:o,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-white",title:"Open in new window",children:c.jsx(Vp,{size:24})})]}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-white",title:"Close (Esc)",children:c.jsx($n,{size:24})})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-4 overflow-auto",onClick:e,children:r==="image"?c.jsx("img",{src:n,alt:"Full size",className:"max-w-full max-h-full object-contain cursor-zoom-out",onClick:u=>u.stopPropagation()}):r==="video"?c.jsx("video",{src:n,controls:!0,autoPlay:!0,className:"max-w-full max-h-full",onClick:u=>u.stopPropagation()}):null})]})})},AA=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,RA=/(?:https?:\/\/)?(?:open\.)?spotify\.com\/(track|album|playlist|artist|episode|show)\/([a-zA-Z0-9]+)/,IA=/(?:https?:\/\/)?(?:www\.)?(?:twitter\.com|x\.com)\/(\w+)\/status\/(\d+)/,hU=/\.(jpg|jpeg|png|gif|webp|bmp|svg)(\?.*)?$/i,fU=/\.(mp4|webm|ogg|mov)(\?.*)?$/i,mU=/\.(mp3|wav|ogg|m4a)(\?.*)?$/i,pU=t=>{const e=t.match(AA);return e?e[1]:null},gU=t=>{const e=t.match(RA);return e?{type:e[1],id:e[2]}:null},vU=t=>{const e=t.match(IA);return e?{user:e[1],id:e[2]}:null},jA=t=>AA.test(t)?"youtube":RA.test(t)?"spotify":IA.test(t)?"twitter":hU.test(t)?"image":fU.test(t)?"video":mU.test(t)?"audio":t.includes("/raw/upload/")||/\.(zip|rar|7z|exe|pdf|docx|xlsx|txt|iso|yml|json|xml|csv)$/i.test(t)?"file":"generic",DA=t=>{const e=/(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/g;return t.match(e)||[]},yU=({url:t})=>{const e=pU(t),[n,r]=T.useState(!1);if(!e)return null;const a=`https://img.youtube.com/vi/${e}/mqdefault.jpg`;return c.jsxs("div",{className:"mt-2 max-w-md rounded-lg overflow-hidden border border-dark-hover bg-dark-sidebar",children:[c.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-dark-hover",children:[c.jsx(nV,{className:"text-red-500",size:18}),c.jsx("span",{className:"text-xs text-dark-muted font-medium",children:"YouTube"})]}),n?c.jsx("div",{className:"relative pt-[56.25%]",children:c.jsx("iframe",{className:"absolute inset-0 w-full h-full",src:`https://www.youtube.com/embed/${e}?autoplay=1&origin=${window.location.origin}`,title:"YouTube video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):c.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>r(!0),children:[c.jsx("img",{src:a,alt:"YouTube thumbnail",className:"w-full h-auto",onError:o=>{o.target.src=`https://img.youtube.com/vi/${e}/default.jpg`}}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/50 transition-colors",children:c.jsx(cN,{className:"text-white/90 group-hover:text-white group-hover:scale-110 transition-all",size:64})})]}),c.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[c.jsx("span",{className:"text-xs text-dark-muted truncate",children:t}),c.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-dark-muted hover:text-brand-primary transition-colors",onClick:o=>o.stopPropagation(),children:c.jsx(Vp,{size:16})})]})]})},bU=({url:t})=>{const e=gU(t);if(!e)return null;const r={track:152,album:352,playlist:352,artist:352,episode:232,show:232}[e.type]||152;return c.jsxs("div",{className:"mt-2 max-w-md rounded-lg overflow-hidden border border-dark-hover bg-dark-sidebar",children:[c.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-dark-hover",children:[c.jsx(tV,{className:"text-green-500",size:18}),c.jsxs("span",{className:"text-xs text-dark-muted font-medium",children:["Spotify ",e.type]})]}),c.jsx("iframe",{src:`https://open.spotify.com/embed/${e.type}/${e.id}?utm_source=generator&theme=0`,width:"100%",height:r,frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",className:"bg-transparent"}),c.jsxs("div",{className:"px-3 py-2 flex items-center justify-between border-t border-dark-hover",children:[c.jsx("span",{className:"text-xs text-dark-muted truncate",children:t}),c.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-dark-muted hover:text-green-500 transition-colors",children:c.jsx(Vp,{size:16})})]})]})},xU=({url:t})=>{const[e,n]=T.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mt-2 max-w-md rounded-lg overflow-hidden border border-dark-hover bg-dark-sidebar",children:c.jsx("div",{className:"block cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>n(!0),children:c.jsx("img",{src:t,alt:"Attachment",className:"w-full h-auto max-h-[400px] object-contain bg-black/50",loading:"lazy",onError:r=>{r.target.style.display="none"}})})}),c.jsx(Sb,{isOpen:e,onClose:()=>n(!1),mediaUrl:t,mediaType:"image"})]})},_U=({url:t})=>{const e=T.useRef(null),[n,r]=T.useState(!1),[a,o]=T.useState(!1);T.useEffect(()=>{if(window.twttr)u();else{const h=document.createElement("script");h.src="https://platform.twitter.com/widgets.js",h.async=!0,h.onload=()=>{window.twttr&&e.current&&u()},h.onerror=()=>o(!0),document.body.appendChild(h)}},[t]);const u=()=>{window.twttr&&e.current&&(e.current.innerHTML="",window.twttr.widgets.createTweet(vU(t)?.id,e.current,{theme:"dark",conversation:"none"}).then(h=>{r(!!h),h||o(!0)}).catch(()=>o(!0)))};return a?c.jsx("div",{className:"mt-2 max-w-md rounded-lg overflow-hidden border border-dark-hover bg-dark-sidebar p-3",children:c.jsxs("div",{className:"flex items-center gap-2 text-dark-muted",children:[c.jsx(ES,{className:"text-sky-400",size:18}),c.jsx("span",{className:"text-sm",children:"Tweet could not be loaded"}),c.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"ml-auto text-brand-primary hover:underline text-sm",children:"View on X"})]})}):c.jsxs("div",{className:"mt-2 max-w-md",children:[!n&&c.jsx("div",{className:"rounded-lg border border-dark-hover bg-dark-sidebar p-4 animate-pulse",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ES,{className:"text-sky-400",size:18}),c.jsx("span",{className:"text-sm text-dark-muted",children:"Loading tweet..."})]})}),c.jsx("div",{ref:e,className:n?"":"hidden"})]})},wU=({url:t})=>{const[e,n]=T.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mt-2 max-w-md rounded-lg overflow-hidden border border-dark-hover bg-dark-sidebar",children:c.jsxs("div",{className:"cursor-pointer",onClick:()=>n(!0),children:[c.jsx("video",{src:t,className:"w-full max-h-[400px] bg-black pointer-events-none"}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/50 transition-colors",children:c.jsx(cN,{className:"text-white/90 hover:text-white",size:64})})]})}),c.jsx(Sb,{isOpen:e,onClose:()=>n(!1),mediaUrl:t,mediaType:"video"})]})},EU=({url:t})=>c.jsxs("div",{className:"mt-2 max-w-md rounded-lg border border-dark-hover bg-dark-sidebar p-3 flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary/20 flex items-center justify-center flex-shrink-0",children:c.jsx(L7,{className:"text-brand-primary",size:24})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-xs text-dark-muted mb-1 truncate",children:t.split("/").pop()}),c.jsx("audio",{src:t,controls:!0,className:"w-full h-8"})]})]}),SU=({url:t})=>{const e=t.split("/").pop().split("?")[0]||"file",n=e.split(".").pop();return c.jsxs("div",{className:"mt-2 max-w-md rounded-lg border border-dark-hover bg-dark-sidebar p-3 flex items-center gap-3 hover:bg-dark-hover transition-colors",children:[c.jsx("div",{className:"w-12 h-12 rounded bg-dark-input flex items-center justify-center flex-shrink-0",children:c.jsx("span",{className:"text-xs font-bold text-dark-text uppercase",children:n.length<5?n:"FILE"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-sm font-medium text-dark-text truncate",children:e}),c.jsx("div",{className:"text-xs text-dark-muted",children:"Attachment"})]}),c.jsx("a",{href:t,download:!0,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full hover:bg-white/10 text-dark-muted hover:text-white transition-colors",title:"Download",children:c.jsx(hN,{size:20})})]})},TU=({url:t})=>{let e="";try{e=new URL(t).hostname.replace("www.","")}catch{e=t}return c.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"mt-2 flex items-center gap-3 max-w-md rounded-lg border border-dark-hover bg-dark-sidebar p-3 hover:bg-dark-hover transition-colors group",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-primary/20 flex items-center justify-center",children:c.jsx(Vp,{className:"text-brand-primary",size:20})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-sm font-medium text-dark-text truncate group-hover:text-brand-primary transition-colors",children:e}),c.jsx("div",{className:"text-xs text-dark-muted truncate",children:t})]})]})},CU=({url:t})=>{switch(jA(t)){case"youtube":return c.jsx(yU,{url:t});case"spotify":return c.jsx(bU,{url:t});case"twitter":return c.jsx(_U,{url:t});case"image":return c.jsx(xU,{url:t});case"video":return c.jsx(wU,{url:t});case"audio":return c.jsx(EU,{url:t});case"file":return c.jsx(SU,{url:t});default:return c.jsx(TU,{url:t})}},kU=({text:t})=>{const n=DA(t).slice(0,3);return n.length===0?null:c.jsx("div",{className:"space-y-2",children:n.map((r,a)=>c.jsx(CU,{url:r},`${r}-${a}`))})},PA=({serverId:t,channelId:e,users:n,currentUserId:r,userRole:a,onReply:o,onMessagesChange:u})=>{const[h,f]=T.useState([]),[p,y]=T.useState(null),[b,x]=T.useState(null),[k,I]=T.useState(null),[A,N]=T.useState(null),[V,F]=T.useState(""),[j,O]=T.useState(null),[B,H]=T.useState("bottom"),[w,S]=T.useState(null),[R,D]=T.useState(!0),[L,U]=T.useState(!1),[P,ne]=T.useState(null),[oe,G]=T.useState(null),Z=T.useRef(null),J=T.useRef(null),Se=T.useRef(0),Le=T.useRef(!0),$=T.useRef(n);T.useEffect(()=>{$.current=n},[n]);const{success:X,error:re}=Fr(),he=()=>{Z.current?.scrollIntoView({behavior:"smooth"})};T.useEffect(()=>{if(!e||!e)return;const Ve=zr(t?_t(le,"servers",t,"channels",e,"messages"):_t(le,"dms",e,"messages"),Hm("timestamp","desc"),gy(20)),De=Sr(Ve,K=>{const ue=[];if(K.forEach(je=>{ue.push({id:je.id,...je.data()})}),ue.reverse(),!Le.current&&ue.length>Se.current&&r){const je=$.current?.find(me=>me.id===r);if(je?.displayName){const me=ue.slice(Se.current),Ae=me.some(W=>W.userId!==r&&s7(W.text,je.displayName)),xe=me.some(W=>{const He=W.userId!==r&&W.replyTo?.userId===r;return He&&console.log("Reply notification:",W),He});(Ae||xe)&&(console.log("Playing notification sound",{hasMention:Ae,hasReply:xe}),vy())}}Se.current=ue.length,f(ue),Le.current&&(Le.current=!1),ue.length>0&&ne(ue[0]),D(ue.length===20),u&&u(ue),setTimeout(he,100)});return()=>{De(),Le.current=!0}},[e,t,r,u]);const Te=async()=>{if(!e||!P||L||!R)return;U(!0);const ye=J.current,Ve=ye?.scrollHeight||0;try{const De=zr(t?_t(le,"servers",t,"channels",e,"messages"):_t(le,"dms",e,"messages"),Hm("timestamp","desc"),cO(P.timestamp),gy(20)),K=await di(De),ue=[];K.forEach(je=>{ue.push({id:je.id,...je.data()})}),ue.length>0?(ue.reverse(),f(je=>[...ue,...je]),ne(ue[0]),D(ue.length===20),setTimeout(()=>{ye&&(ye.scrollTop=ye.scrollHeight-Ve)},0)):D(!1)}catch(De){console.error("Error loading more messages:",De),re("Failed to load more messages")}finally{U(!1)}},Ue=ye=>n.find(Ve=>Ve.id===ye)||{displayName:"Unknown",role:"member"},te=ye=>r===ye||a==="admin",Oe=ye=>{if(ye.userId!==r)return!1;if(!ye.timestamp)return!0;const Ve=ye.timestamp.toDate();return(new Date-Ve)/1e3/60<15},Ie=async()=>{if(p)try{const ye=n.find(De=>De.id===p.userId),Ve=t?Ne(le,"servers",t,"channels",e,"messages",p.id):Ne(le,"dms",e,"messages",p.id);await ts(Ve),await Kn(_t(le,"adminLogs"),{type:"message_delete",channelId:e,messageId:p.id,userId:r,deletedText:p.text||"(empty)",originalUserId:p.userId,originalUserName:ye?.displayName||"Unknown User",timestamp:ht()}),X("Message deleted successfully")}catch(ye){console.error("Error deleting message:",ye),re("Failed to delete message")}finally{y(null)}},We=ye=>{N(ye.id),F(ye.text)},ke=()=>{N(null),F("")},fe=async()=>{if(!A)return;if(!V.trim()){re("Message cannot be empty");return}const ye=A,Ve=V.trim(),K=h.find(ue=>ue.id===ye)?.text||"";N(null),F("");try{const ue=t?Ne(le,"servers",t,"channels",e,"messages",ye):Ne(le,"dms",e,"messages",ye);await it(ue,{text:Ve,edited:!0,editedAt:ht()}),await Kn(_t(le,"adminLogs"),{type:"message_edit",channelId:e,messageId:ye,userId:r,originalText:K,newText:Ve,timestamp:ht()}),X("Message updated successfully")}catch(ue){console.error("Error editing message:",ue),ue.code==="resource-exhausted"?re("Quota exceeded. Please try again tomorrow."):re("Failed to edit message")}},Re=async(ye,Ve)=>{try{const De=h.find(me=>me.id===ye);if(!De)return;const K={...De.reactions},ue=K[Ve]||[];if(ue.includes(r)){const me=ue.filter(Ae=>Ae!==r);me.length===0?delete K[Ve]:K[Ve]=me}else K[Ve]=[...ue,r];const je=t?Ne(le,"servers",t,"channels",e,"messages",ye):Ne(le,"dms",e,"messages",ye);await it(je,{reactions:K})}catch(De){console.error("Error toggling reaction:",De),re("Failed to update reaction")}},dt=async ye=>{if(a!=="admin"&&a!=="moderator"){re("Only admins and moderators can pin messages");return}try{const Ve=!ye.pinned,De=t?Ne(le,"servers",t,"channels",e,"messages",ye.id):Ne(le,"dms",e,"messages",ye.id);await it(De,{pinned:Ve,pinnedBy:Ve?r:null,pinnedAt:Ve?ht():null}),await Kn(_t(le,"adminLogs"),{type:Ve?"message_pin":"message_unpin",channelId:e,messageId:ye.id,userId:r,messageText:ye.text,timestamp:ht()}),X(Ve?"Message pinned":"Message unpinned")}catch(Ve){console.error("Error toggling pin:",Ve),re("Failed to pin message")}};return c.jsxs("div",{ref:J,className:"flex-1 overflow-y-auto px-4 py-4 space-y-4",children:[R&&h.length>0&&c.jsx("div",{className:"flex justify-center mb-4",children:c.jsx("button",{onClick:Te,disabled:L,className:"px-4 py-2 bg-brand-primary hover:bg-brand-primary/80 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:L?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Loading..."]}):"Load More Messages"})}),h.length===0?c.jsx("div",{className:"text-center text-dark-muted py-8",children:"No messages yet. Start the conversation!"}):h.map(ye=>{const Ve=Ue(ye.userId);return c.jsxs("div",{id:`message-${ye.id}`,className:"flex gap-3 hover:bg-dark-hover/30 px-2 py-1 rounded group transition-colors",children:[c.jsxs("div",{className:"relative flex-shrink-0",children:[Ve.photoUrl?c.jsx("img",{src:Ve.photoUrl,alt:Ve.displayName,onClick:()=>I(Ve),className:"w-10 h-10 rounded-full object-cover cursor-pointer hover:opacity-80 transition-opacity",onError:De=>{De.target.style.display="none",De.target.nextSibling.style.display="flex"}}):null,c.jsx("div",{onClick:()=>I(Ve),className:"w-10 h-10 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold cursor-pointer hover:opacity-80 transition-opacity",style:{display:Ve.photoUrl?"none":"flex"},children:Ve.displayName?.[0]?.toUpperCase()||"U"})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"font-semibold text-dark-text hover:underline cursor-pointer",onClick:()=>I(Ve),children:Ve.displayName||"Unknown"}),c.jsx("span",{className:Ht("text-xs px-1.5 py-0.5 rounded border",GL(Ve.role)),children:Ve.role?.charAt(0).toUpperCase()+Ve.role?.slice(1)}),c.jsx("span",{className:"text-xs text-dark-muted",children:zp(ye.timestamp)}),ye.edited&&c.jsx("span",{className:"text-xs text-dark-muted italic",children:"(edited)"}),A!==ye.id&&c.jsxs("div",{className:"ml-auto relative z-50",children:[c.jsx("button",{onClick:De=>{const K=De.clientY,ue=window.innerHeight,je=K<ue/2;H(je?"bottom":"top"),O(j===ye.id?null:ye.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-dark-hover rounded transition-all",title:"More options",children:c.jsx(H7,{size:18,className:"text-dark-muted"})}),j===ye.id&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>O(null)}),c.jsxs("div",{className:`absolute right-0 ${B==="top"?"bottom-full mb-1":"top-full mt-1"} bg-dark-sidebar border border-dark-hover rounded-lg shadow-lg py-1 z-50 min-w-[120px]`,children:[c.jsxs("button",{onClick:()=>{o&&o(ye),O(null)},className:"w-full px-3 py-2 text-left text-sm text-dark-text hover:bg-dark-hover flex items-center gap-2",children:[c.jsx(N7,{size:16,className:"text-green-400"}),"Reply"]}),Oe(ye)&&c.jsxs("button",{onClick:()=>{We(ye),O(null)},className:"w-full px-3 py-2 text-left text-sm text-dark-text hover:bg-dark-hover flex items-center gap-2",children:[c.jsx(pc,{size:16,className:"text-blue-400"}),"Edit"]}),(a==="admin"||a==="moderator")&&c.jsxs("button",{onClick:()=>{dt(ye),O(null)},className:"w-full px-3 py-2 text-left text-sm text-dark-text hover:bg-dark-hover flex items-center gap-2",children:[c.jsx(mc,{size:16,className:"text-blue-400"}),ye.pinned?"Unpin":"Pin"]}),te(ye.userId)&&c.jsxs("button",{onClick:()=>{y({id:ye.id,text:ye.text,userId:ye.userId}),O(null)},className:"w-full px-3 py-2 text-left text-sm text-admin hover:bg-dark-hover flex items-center gap-2",children:[c.jsx(Ki,{size:16}),"Delete"]})]})]})]})]}),A===ye.id?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",value:V,onChange:De=>F(De.target.value),onKeyDown:De=>{De.key==="Enter"&&fe(),De.key==="Escape"&&ke()},className:`flex-1 bg-dark-input text-dark-text px-3 py-1.5 rounded
                                 border border-brand-primary outline-none`,autoFocus:!0}),c.jsx("button",{onClick:fe,className:"text-green-500 hover:text-green-400 transition-colors",title:"Save (Enter)",children:c.jsx(el,{size:20})}),c.jsx("button",{onClick:ke,className:"text-admin hover:text-admin/80 transition-colors",title:"Cancel (Esc)",children:c.jsx($n,{size:20})})]}):c.jsxs(c.Fragment,{children:[ye.replyTo&&c.jsxs("div",{className:"mb-2 ml-2 pl-3 border-l-2 border-green-400 text-sm bg-dark-sidebar/30 rounded py-1",children:[c.jsxs("div",{className:"text-xs text-green-400 font-semibold",children:["Replying to ",Ue(ye.replyTo.userId).displayName]}),c.jsx("div",{className:"text-dark-muted italic truncate",children:ye.replyTo.text})]}),ye.pinned&&c.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-400 mb-1",children:[c.jsx(mc,{size:14}),c.jsx("span",{children:"Pinned"})]}),ye.type!=="sticker"&&(()=>{const De=DA(ye.text);let K=ye.text;return De.filter(je=>{const me=jA(je);return["youtube","spotify","twitter","image","video","audio","file"].includes(me)}).forEach(je=>{K=K.replace(je,"")}),K=K.trim(),K.length>0&&c.jsx("div",{className:"text-dark-text whitespace-pre-wrap break-words select-text",children:c.jsx(NA,{onMentionClick:je=>{const me=n.find(Ae=>Ae.displayName?.toLowerCase()===je.toLowerCase());me&&I(me)},children:K})})})(),ye.type==="sticker"&&c.jsx("div",{className:"mt-1 mb-1",children:c.jsx("img",{src:ye.text,alt:"Sticker",className:"w-40 h-40 object-contain drop-shadow-md hover:scale-110 transition-transform origin-bottom-left select-none cursor-pointer",onClick:()=>G({url:ye.text,type:"image"})})}),ye.type!=="sticker"&&c.jsx(kU,{text:ye.text}),ye.type==="poll"&&c.jsx(dU,{message:ye,currentUserId:r,serverId:t,channelId:e,users:n}),ye.reactions&&Object.keys(ye.reactions).length>0&&c.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[Object.entries(ye.reactions).map(([De,K])=>c.jsxs("button",{onClick:()=>Re(ye.id,De),className:Ht("px-2 py-1 rounded-full text-sm flex items-center gap-1 transition-colors",K.includes(r)?"bg-brand-primary/20 border border-brand-primary text-brand-primary":"bg-dark-hover border border-dark-hover text-dark-text hover:border-dark-muted"),title:`${K.map(ue=>Ue(ue).displayName).join(", ")}`,children:[c.jsx("span",{children:De}),c.jsx("span",{className:"text-xs",children:K.length})]},De)),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>S(w===ye.id?null:ye.id),className:"px-2 py-1 rounded-full text-sm bg-dark-hover border border-dark-hover hover:border-dark-muted transition-colors",title:"Add reaction",children:c.jsx(vS,{size:16,className:"text-dark-muted"})}),w===ye.id&&c.jsx($S,{onSelect:De=>{Re(ye.id,De),S(null)},onClose:()=>S(null)})]})]}),(!ye.reactions||Object.keys(ye.reactions).length===0)&&c.jsxs("div",{className:"relative mt-2",children:[c.jsxs("button",{onClick:()=>S(w===ye.id?null:ye.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 rounded text-xs bg-dark-hover hover:bg-dark-input transition-all flex items-center gap-1",title:"Add reaction",children:[c.jsx(vS,{size:14}),c.jsx("span",{className:"text-dark-muted",children:"Add reaction"})]}),w===ye.id&&c.jsx($S,{onSelect:De=>{Re(ye.id,De),S(null)},onClose:()=>S(null)})]})]})]})]},ye.id)}),c.jsx("div",{ref:Z}),c.jsx(Ac,{isOpen:!!p,onClose:()=>y(null),onConfirm:Ie,title:"Delete Message",message:"Are you sure you want to delete this message? This action cannot be undone.",confirmText:"Delete",variant:"danger"}),c.jsx(lU,{isOpen:!!b,onClose:()=>x(null),onConfirm:()=>window.open(b?.url,"_blank","noopener,noreferrer"),url:b?.url}),c.jsx(wb,{user:k,isOpen:!!k,onClose:()=>I(null)}),c.jsx(Sb,{isOpen:!!oe,onClose:()=>G(null),mediaUrl:oe?.url,mediaType:oe?.type})]})},qS={smileys:{name:"Smileys & People",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},animals:{name:"Animals & Nature",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},food:{name:"Food & Drink",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},activities:{name:"Activities",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},travel:{name:"Travel & Places",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},objects:{name:"Objects",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},symbols:{name:"Symbols",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","0","1","2","3","4","5","6","7","8","9","","","#","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},flags:{name:"Flags",icon:"",emojis:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}},NU=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],AU=({onSelect:t,onClose:e})=>{const[n,r]=T.useState("smileys");return c.jsxs("div",{className:"absolute bottom-full right-0 mb-2 bg-dark-sidebar border border-dark-hover rounded-lg shadow-xl w-80 z-50",children:[c.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-dark-hover",children:[c.jsx("span",{className:"text-sm font-semibold text-dark-text",children:"Emoji Picker"}),c.jsx("button",{onClick:e,className:"text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:18})})]}),c.jsxs("div",{className:"p-3 border-b border-dark-hover",children:[c.jsx("div",{className:"text-xs text-dark-muted mb-2 font-semibold",children:"POPULAR"}),c.jsx("div",{className:"grid grid-cols-10 gap-1",children:NU.map((a,o)=>c.jsx("button",{onClick:()=>t(a),className:"text-2xl hover:bg-dark-hover rounded p-1 transition-colors",title:a,children:a},o))})]}),c.jsx("div",{className:"flex gap-1 p-2 border-b border-dark-hover overflow-x-auto",children:Object.entries(qS).map(([a,o])=>c.jsx("button",{onClick:()=>r(a),className:`text-xl p-2 rounded transition-colors ${n===a?"bg-brand-primary/20 text-brand-primary":"hover:bg-dark-hover text-dark-muted"}`,title:o.name,children:o.icon},a))}),c.jsx("div",{className:"p-3 h-64 overflow-y-auto",children:c.jsx("div",{className:"grid grid-cols-8 gap-1",children:qS[n].emojis.map((a,o)=>c.jsx("button",{onClick:()=>t(a),className:"text-2xl hover:bg-dark-hover rounded p-1 transition-colors",title:a,children:a},o))})})]})};let Yf;const RU=new Uint8Array(16);function IU(){if(!Yf&&(Yf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Yf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Yf(RU)}const cr=[];for(let t=0;t<256;++t)cr.push((t+256).toString(16).slice(1));function jU(t,e=0){return cr[t[e+0]]+cr[t[e+1]]+cr[t[e+2]]+cr[t[e+3]]+"-"+cr[t[e+4]]+cr[t[e+5]]+"-"+cr[t[e+6]]+cr[t[e+7]]+"-"+cr[t[e+8]]+cr[t[e+9]]+"-"+cr[t[e+10]]+cr[t[e+11]]+cr[t[e+12]]+cr[t[e+13]]+cr[t[e+14]]+cr[t[e+15]]}const DU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),GS={randomUUID:DU};function PU(t,e,n){if(GS.randomUUID&&!t)return GS.randomUUID();t=t||{};const r=t.random||(t.rng||IU)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,jU(r)}var MU=Object.defineProperty,OU=Object.defineProperties,LU=Object.getOwnPropertyDescriptors,YS=Object.getOwnPropertySymbols,VU=Object.prototype.hasOwnProperty,UU=Object.prototype.propertyIsEnumerable,KS=(t,e,n)=>e in t?MU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tb=(t,e)=>{for(var n in e||(e={}))VU.call(e,n)&&KS(t,n,e[n]);if(YS)for(var n of YS(e))UU.call(e,n)&&KS(t,n,e[n]);return t},zU=(t,e)=>OU(t,LU(e)),ur={ENABLED:typeof window<"u"&&typeof location<"u"&&location.search.indexOf("giphy-debug")!==-1,LEVEL:0,PREFIX:"GiphyJS",debug:(...t)=>{ur.ENABLED&&ur.LEVEL<=0&&console.debug(ur.PREFIX,...t)},info:(...t)=>{ur.ENABLED&&ur.LEVEL<=1&&console.info(ur.PREFIX,...t)},warn:(...t)=>{ur.ENABLED&&ur.LEVEL<=2&&console.warn(ur.PREFIX,...t)},error:(...t)=>{ur.ENABLED&&ur.LEVEL<=3&&console.error(ur.PREFIX,...t)}},BU=(t,e,n)=>{let r=1/0,a;return n.forEach(o=>{const u=o.width/t,h=o.height/e,f=u*h,p=Math.abs(1-f);p<r&&(r=p,a=o)}),a},FU=50;function HU(t,e,n,r=FU){let[a]=t;const o=t.filter(u=>(u.width*u.height>a.width*a.height&&(a=u),e-u.width<=r&&n-u.height<=r));return o.length===0?a:BU(e,n,o)}var MA=HU;function $U(t,e=0){return t.slice(0,e)}function qU(t,e){return t.filter(n=>e.indexOf(n)===-1)}function Ry(t,e){const n={};return e.forEach(r=>{t[r]!==void 0&&(n[r]=t[r])}),n}var GU=t=>{let e=0,n=0;const r=t.offsetWidth,a=t.offsetHeight;do e+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;while(t);const o={left:e,top:n,width:r,height:a,right:e+r,bottom:n+a,x:e,y:n};return zU(Tb({},o),{toJSON:()=>JSON.stringify(o)})},YU=GU,Uo="",OA=16,LA=()=>{let t="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.length;for(let r=0;r<OA;r++)t+=e.charAt(Math.floor(Math.random()*n));return t},KU=()=>{if(!Uo){try{Uo=sessionStorage.getItem("giphyPingbackId")}catch{}if(!Uo){const t=new Date().getTime().toString(16);try{Uo=`${t}${PU().replace(/-/g,"")}`.substring(0,OA)}catch{Uo=LA()}try{sessionStorage.setItem("giphyPingbackId",Uo)}catch{}}}return Uo},Cb=KU,Kf=null;new Promise(t=>{typeof Image>"u"&&t(!1);const e=new Image;e.onload=()=>{Kf=!0,t(Kf)},e.onerror=()=>{Kf=!1,t(Kf)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"});var QS=(t,e,n)=>{let r=t?.assets;if(r){r=Tb({},r),delete r.source;const a=Object.values(r).sort((o,u)=>o.width-u.width);return MA(a,e,n)}},QU=(t,e,n,r)=>{const a=Ry(t,["original","fixed_width","fixed_height","fixed_width_small","fixed_height_small"]),o=Object.entries(a).map(([u,h])=>Tb({renditionName:u},h));return MA(o,e,n,r)},$p=({images:t},e)=>{const{fixed_width:n}=t;if(n){const{width:r,height:a}=n,o=r/a;return Math.round(e/o)}return 0},XU=({images:t},e)=>{const{fixed_width:n}=t;if(n){const{width:r,height:a}=n,o=r/a;return Math.round(e*o)}return 0},WU=({alt_text:t,user:e,tags:n=[],is_sticker:r=!1,title:a=""})=>{if(t)return t;if(a)return a;const o=e&&e.username||"",u=$U(qU(n,["transparent"]),o?4:5);return`${o?`${o} `:""}${u.join(" ")} ${r?"Sticker":"GIF"}`},md=(typeof window<"u"?window:global)||{};md._GIPHY_SDK_HEADERS_=md._GIPHY_SDK_HEADERS_||(md.Headers?new md.Headers({"X-GIPHY-SDK-PLATFORM":"web"}):void 0);var kb=()=>md._GIPHY_SDK_HEADERS_,Iy=(t,e)=>{var n;return(n=kb())==null?void 0:n.set(t,e)},JU=Object.defineProperty,ZU=Object.defineProperties,ez=Object.getOwnPropertyDescriptors,tz=Object.getOwnPropertyNames,XS=Object.getOwnPropertySymbols,nz=Object.prototype.hasOwnProperty,rz=Object.prototype.propertyIsEnumerable,WS=(t,e,n)=>e in t?JU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ei=(t,e)=>{for(var n in e||(e={}))nz.call(e,n)&&WS(t,n,e[n]);if(XS)for(var n of XS(e))rz.call(e,n)&&WS(t,n,e[n]);return t},j0=(t,e)=>ZU(t,ez(e)),sz=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),iz=(t,e)=>function(){return e||(0,t[tz(t)[0]])((e={exports:{}}).exports,e),e.exports},VA=(t,e,n)=>new Promise((r,a)=>{var o=f=>{try{h(n.next(f))}catch(p){a(p)}},u=f=>{try{h(n.throw(f))}catch(p){a(p)}},h=f=>f.done?r(f.value):Promise.resolve(f.value).then(o,u);h((n=n.apply(t,e)).next())}),az=iz({"package.json"(t,e){e.exports={scripts:{lint:"run -T eslint . --ext .ts,.tsx",clean:"rm -rf ./dist",dev:"parcel public/test.html",docs:"typedoc src/index.ts",build:"run -T tsup src/index.ts --format cjs,esm --dts && run -T publint",prepublish:"npm run clean && npm run build",test:"run -T jest --config ./jestconfig.js","test:watch":"run -T jest --config ./jestconfig.js --watchAll"},name:"@giphy/js-fetch-api",version:"5.7.0",description:"Javascript API to fetch gifs and stickers from the GIPHY API.",homepage:"https://github.com/Giphy/giphy-js/tree/master/packages/fetch-api",main:"dist/index.cjs",types:"dist/index.d.ts",module:"dist/index.js",type:"module",sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/index.js",require:"./dist/index.cjs"},"./package.json":"./package.json"},files:["dist/","src/**/*"],license:"MIT",publishConfig:{access:"public"},dependencies:{"@giphy/js-types":"*","@giphy/js-util":"*"},devDependencies:{"jest-fetch-mock":"^3.0.3","parcel-bundler":"latest",typedoc:"^0.20.37","typedoc-thunder-theme":"^0.0.3",typescript:"^5.0.4"}}}}),oz=["is_anonymous","is_community","is_featured","is_hidden","is_indexable","is_preserve_size","is_realtime","is_removed","is_sticker","is_dynamic"],lz=["suppress_chrome","is_public","is_verified"],JS=t=>e=>t[e]=!!t[e],cz=t=>typeof t=="string"?t:t.text,UA=(t,e="")=>{const n=ei({},t);n.id=String(n.id),n.tags=(n.tags||[]).map(cz),n.bottle_data||(n.bottle_data={}),n.response_id=e,oz.forEach(JS(n)),Object.keys(n.images||{}).forEach(a=>{const o=n.images[a];o.width=parseInt(o.width),o.height=parseInt(o.height)});const{user:r}=n;if(r){const a=ei({},r);lz.forEach(JS(a)),n.user=a}return n},ZS=t=>{const{response_id:e}=t.meta;return t.data=UA(t.data,e),t},Oi=t=>{const{response_id:e}=t.meta;return t.data=t.data.map(n=>UA(n,e)),t},uz=(typeof window<"u"?window:global)||{},dz=uz.GIPHY_API_URL||"https://api.giphy.com/v1/",zA=class extends Error{constructor(e,n,r=0,a=""){super(e),this.url=n,this.status=r,this.statusText=a}},hz=class extends zA{},e4=zA,fz="@giphy/js-fetch-api: ",mz="Error fetching",pz=t=>t,Ns={},gz=6e4,vz=6e3,yz=()=>{const t=Date.now();Object.keys(Ns).forEach(e=>{const n=Ns[e].isError?vz:gz;t-Ns[e].ts>=n&&delete Ns[e]})};function bz(t,e={}){const{apiVersion:n=1,noCache:r=!1,normalizer:a=pz}=e,o=dz.replace(/\/v\d+\/$/,`/v${n}/`);if(yz(),!Ns[t]||r){const u=`${o}${t}`,h=()=>VA(this,null,function*(){var f,p;let y;try{const b=yield fetch(u,{method:"get"});if(b.ok){const x=yield b.json();if((f=x.meta)!=null&&f.response_id)return a(x);throw{message:"synthetic response"}}else{let x=mz;try{const I=yield b.json();I.message&&(x=I.message),(p=I.meta)!=null&&p.msg&&(x=I.meta.msg)}catch{}Ns[t]&&(Ns[t].isError=!0);let k=e4;x==="This content is not available in your location"&&(k=hz),y=new k(`${fz}${x}`,u,b.status,b.statusText)}}catch(b){y=new e4(b.message,u),Ns[t]&&(Ns[t].isError=!0)}throw y});Ns[t]={request:h(),ts:Date.now()}}return Ns[t].request}var Or=bz,D0=t=>t&&t.type?t.type:"gifs",xz=class{constructor(t,e={}){this.getQS=(n={})=>new URLSearchParams(ei(j0(ei({},n),{api_key:this.apiKey,pingback_id:Cb()}),this.qsParams)).toString(),this.apiKey=t,this.qsParams=e}categories(t){return Or(`gifs/categories?${this.getQS(t)}`)}gif(t,e){const n=e?.internal?"internal/":"";return Or(`${n}gifs/${t}?${this.getQS()}`,{normalizer:ZS})}gifs(t,e){return Array.isArray(t)?Or(`gifs?${this.getQS({ids:t.join(",")})}`,{normalizer:Oi}):Or(`gifs/categories/${t}/${e}?${this.getQS()}`,{normalizer:Oi})}emoji(t){return Or(`emoji?${this.getQS(t)}`,{normalizer:Oi})}emojiDefaultVariations(t){return Or(`emoji?${this.getQS(t)}`,{apiVersion:2,normalizer:Oi})}emojiVariations(t){return Or(`emoji/${t}/variations?${this.getQS()}`,{apiVersion:2,normalizer:Oi})}animate(t,e={}){const n=this.getQS(j0(ei({},e),{m:t}));return Or(`text/animate?${n}`,{normalizer:Oi})}search(t,e={}){const n=e.channel?`@${e.channel} ${t}`:t;let r;e.type==="text"&&(r=!0);const a=this.getQS(j0(ei({rating:"pg-13"},e),{q:n,excludeDynamicResults:r}));return Or(`${D0(e)}/search?${a}`,{normalizer:Oi})}subcategories(t,e){return Or(`gifs/categories/${t}?${this.getQS(e)}`)}trending(t={}){return Or(`${D0(t)}/trending?${this.getQS(ei({rating:"pg-13"},t))}`,{normalizer:Oi})}random(t){return Or(`${D0(t)}/random?${this.getQS(ei({rating:"pg-13"},t))}`,{noCache:!0,normalizer:ZS})}related(t,e={}){const{type:n="gifs"}=e;return Or(`${n}/related?${this.getQS(ei({gif_id:t,rating:"pg-13"},e))}`,{normalizer:Oi})}channels(t,e={}){return Or(`channels/search?${this.getQS(ei({q:t,rating:"pg-13"},e))}`)}},BA=xz,_z=Symbol("has inivisible gifs"),FA=(t,e=[])=>{let n=[...e],r=e.map(u=>u.id),a=e.length,o=!1;return u=>VA(void 0,null,function*(){if(u&&(n=u,r=u.map(b=>b.id)),o)return n;const h=yield t(a),{pagination:f,data:p}=h;a=f.count+f.offset,o=a===f.total_count,p.forEach(b=>{const{id:x}=b;r.includes(x)||(n.push(b),r.push(x))});const y=[...n];return f.hasMoreGifs&&(y.skipCountCheck=_z),y})},t4;if(typeof sz<"u"){const{version:t}=az();(t4=kb())!=null&&t4.get("X-GIPHY-SDK-NAME")||(Iy("X-GIPHY-SDK-NAME","FetchAPI"),Iy("X-GIPHY-SDK-VERSION",t))}var jy=function(t,e){return jy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},jy(t,e)};function HA(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");jy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var br=function(){return br=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},br.apply(this,arguments)};function $A(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function qA(t,e,n,r){var a=arguments.length,o=a<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,n,r);else for(var h=t.length-1;h>=0;h--)(u=t[h])&&(o=(a<3?u(o):a>3?u(e,n,o):u(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function GA(t,e){return function(n,r){e(n,r,t)}}function YA(t,e,n,r,a,o){function u(V){if(V!==void 0&&typeof V!="function")throw new TypeError("Function expected");return V}for(var h=r.kind,f=h==="getter"?"get":h==="setter"?"set":"value",p=!e&&t?r.static?t:t.prototype:null,y=e||(p?Object.getOwnPropertyDescriptor(p,r.name):{}),b,x=!1,k=n.length-1;k>=0;k--){var I={};for(var A in r)I[A]=A==="access"?{}:r[A];for(var A in r.access)I.access[A]=r.access[A];I.addInitializer=function(V){if(x)throw new TypeError("Cannot add initializers after decoration has completed");o.push(u(V||null))};var N=(0,n[k])(h==="accessor"?{get:y.get,set:y.set}:y[f],I);if(h==="accessor"){if(N===void 0)continue;if(N===null||typeof N!="object")throw new TypeError("Object expected");(b=u(N.get))&&(y.get=b),(b=u(N.set))&&(y.set=b),(b=u(N.init))&&a.unshift(b)}else(b=u(N))&&(h==="field"?a.unshift(b):y[f]=b)}p&&Object.defineProperty(p,r.name,y),x=!0}function KA(t,e,n){for(var r=arguments.length>2,a=0;a<e.length;a++)n=r?e[a].call(t,n):e[a].call(t);return r?n:void 0}function QA(t){return typeof t=="symbol"?t:"".concat(t)}function XA(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function WA(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function JA(t,e,n,r){function a(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function h(y){try{p(r.next(y))}catch(b){u(b)}}function f(y){try{p(r.throw(y))}catch(b){u(b)}}function p(y){y.done?o(y.value):a(y.value).then(h,f)}p((r=r.apply(t,e||[])).next())})}function ZA(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=h(0),u.throw=h(1),u.return=h(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(p){return function(y){return f([p,y])}}function f(p){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,p[0]&&(n=0)),n;)try{if(r=1,a&&(o=p[0]&2?a.return:p[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,p[1])).done)return o;switch(a=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,a=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){n.label=p[1];break}if(p[0]===6&&n.label<o[1]){n.label=o[1],o=p;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(p);break}o[2]&&n.ops.pop(),n.trys.pop();continue}p=e.call(t,n)}catch(y){p=[6,y],a=0}finally{r=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var qp=Object.create?(function(t,e,n,r){r===void 0&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]});function e3(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&qp(e,t,n)}function np(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nb(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),a,o=[],u;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(h){u={error:h}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(u)throw u.error}}return o}function t3(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Nb(arguments[e]));return t}function n3(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),a=0,e=0;e<n;e++)for(var o=arguments[e],u=0,h=o.length;u<h;u++,a++)r[a]=o[u];return r}function tl(t,e,n){if(n||arguments.length===2)for(var r=0,a=e.length,o;r<a;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function Ic(t){return this instanceof Ic?(this.v=t,this):new Ic(t)}function r3(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",u),a[Symbol.asyncIterator]=function(){return this},a;function u(k){return function(I){return Promise.resolve(I).then(k,b)}}function h(k,I){r[k]&&(a[k]=function(A){return new Promise(function(N,V){o.push([k,A,N,V])>1||f(k,A)})},I&&(a[k]=I(a[k])))}function f(k,I){try{p(r[k](I))}catch(A){x(o[0][3],A)}}function p(k){k.value instanceof Ic?Promise.resolve(k.value.v).then(y,b):x(o[0][2],k)}function y(k){f("next",k)}function b(k){f("throw",k)}function x(k,I){k(I),o.shift(),o.length&&f(o[0][0],o[0][1])}}function s3(t){var e,n;return e={},r("next"),r("throw",function(a){throw a}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(a,o){e[a]=t[a]?function(u){return(n=!n)?{value:Ic(t[a](u)),done:!1}:o?o(u):u}:o}}function i3(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof np=="function"?np(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(u){return new Promise(function(h,f){u=t[o](u),a(h,f,u.done,u.value)})}}function a(o,u,h,f){Promise.resolve(f).then(function(p){o({value:p,done:h})},u)}}function a3(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var wz=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Dy=function(t){return Dy=Object.getOwnPropertyNames||function(e){var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[n.length]=r);return n},Dy(t)};function o3(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=Dy(t),r=0;r<n.length;r++)n[r]!=="default"&&qp(e,t,n[r]);return wz(e,t),e}function l3(t){return t&&t.__esModule?t:{default:t}}function c3(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function u3(t,e,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(t,n):a?a.value=n:e.set(t,n),n}function d3(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function h3(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(o){return Promise.reject(o)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var Ez=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function f3(t){function e(o){t.error=t.hasError?new Ez(o,t.error,"An error was suppressed during disposal."):o,t.hasError=!0}var n,r=0;function a(){for(;n=t.stack.pop();)try{if(!n.async&&r===1)return r=0,t.stack.push(n),Promise.resolve().then(a);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(o).then(a,function(u){return e(u),a()})}else r|=1}catch(u){e(u)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return a()}function m3(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,r,a,o,u){return r?e?".jsx":".js":a&&(!o||!u)?n:a+o+"."+u.toLowerCase()+"js"}):t}const Sz={__extends:HA,__assign:br,__rest:$A,__decorate:qA,__param:GA,__esDecorate:YA,__runInitializers:KA,__propKey:QA,__setFunctionName:XA,__metadata:WA,__awaiter:JA,__generator:ZA,__createBinding:qp,__exportStar:e3,__values:np,__read:Nb,__spread:t3,__spreadArrays:n3,__spreadArray:tl,__await:Ic,__asyncGenerator:r3,__asyncDelegator:s3,__asyncValues:i3,__makeTemplateObject:a3,__importStar:o3,__importDefault:l3,__classPrivateFieldGet:c3,__classPrivateFieldSet:u3,__classPrivateFieldIn:d3,__addDisposableResource:h3,__disposeResources:f3,__rewriteRelativeImportExtension:m3},Tz=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:h3,get __assign(){return br},__asyncDelegator:s3,__asyncGenerator:r3,__asyncValues:i3,__await:Ic,__awaiter:JA,__classPrivateFieldGet:c3,__classPrivateFieldIn:d3,__classPrivateFieldSet:u3,__createBinding:qp,__decorate:qA,__disposeResources:f3,__esDecorate:YA,__exportStar:e3,__extends:HA,__generator:ZA,__importDefault:l3,__importStar:o3,__makeTemplateObject:a3,__metadata:WA,__param:GA,__propKey:QA,__read:Nb,__rest:$A,__rewriteRelativeImportExtension:m3,__runInitializers:KA,__setFunctionName:XA,__spread:t3,__spreadArray:tl,__spreadArrays:n3,__values:np,default:Sz},Symbol.toStringTag,{value:"Module"}));var dn="-ms-",Td="-moz-",Kt="-webkit-",p3="comm",Gp="rule",Ab="decl",Cz="@import",kz="@namespace",g3="@keyframes",Nz="@layer",v3=Math.abs,Rb=String.fromCharCode,Py=Object.assign;function Az(t,e){return Qn(t,0)^45?(((e<<2^Qn(t,0))<<2^Qn(t,1))<<2^Qn(t,2))<<2^Qn(t,3):0}function y3(t){return t.trim()}function Li(t,e){return(t=e.exec(t))?t[0]:t}function Ct(t,e,n){return t.replace(e,n)}function vm(t,e,n){return t.indexOf(e,n)}function Qn(t,e){return t.charCodeAt(e)|0}function nl(t,e,n){return t.slice(e,n)}function As(t){return t.length}function b3(t){return t.length}function pd(t,e){return e.push(t),t}function Rz(t,e){return t.map(e).join("")}function n4(t,e){return t.filter(function(n){return!Li(n,e)})}var Yp=1,jc=1,x3=0,gs=0,Bn=0,Wc="";function Kp(t,e,n,r,a,o,u,h){return{value:t,root:e,parent:n,type:r,props:a,children:o,line:Yp,column:jc,length:u,return:"",siblings:h}}function Ha(t,e){return Py(Kp("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function tc(t){for(;t.root;)t=Ha(t.root,{children:[t]});pd(t,t.siblings)}function Iz(){return Bn}function jz(){return Bn=gs>0?Qn(Wc,--gs):0,jc--,Bn===10&&(jc=1,Yp--),Bn}function Ps(){return Bn=gs<x3?Qn(Wc,gs++):0,jc++,Bn===10&&(jc=1,Yp++),Bn}function Ga(){return Qn(Wc,gs)}function ym(){return gs}function Qp(t,e){return nl(Wc,t,e)}function $d(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Dz(t){return Yp=jc=1,x3=As(Wc=t),gs=0,[]}function Pz(t){return Wc="",t}function P0(t){return y3(Qp(gs-1,My(t===91?t+2:t===40?t+1:t)))}function Mz(t){for(;(Bn=Ga())&&Bn<33;)Ps();return $d(t)>2||$d(Bn)>3?"":" "}function Oz(t,e){for(;--e&&Ps()&&!(Bn<48||Bn>102||Bn>57&&Bn<65||Bn>70&&Bn<97););return Qp(t,ym()+(e<6&&Ga()==32&&Ps()==32))}function My(t){for(;Ps();)switch(Bn){case t:return gs;case 34:case 39:t!==34&&t!==39&&My(Bn);break;case 40:t===41&&My(t);break;case 92:Ps();break}return gs}function Lz(t,e){for(;Ps()&&t+Bn!==57;)if(t+Bn===84&&Ga()===47)break;return"/*"+Qp(e,gs-1)+"*"+Rb(t===47?t:Ps())}function Vz(t){for(;!$d(Ga());)Ps();return Qp(t,gs)}function Uz(t){return Pz(bm("",null,null,null,[""],t=Dz(t),0,[0],t))}function bm(t,e,n,r,a,o,u,h,f){for(var p=0,y=0,b=u,x=0,k=0,I=0,A=1,N=1,V=1,F=0,j="",O=a,B=o,H=r,w=j;N;)switch(I=F,F=Ps()){case 40:if(I!=108&&Qn(w,b-1)==58){vm(w+=Ct(P0(F),"&","&\f"),"&\f",v3(p?h[p-1]:0))!=-1&&(V=-1);break}case 34:case 39:case 91:w+=P0(F);break;case 9:case 10:case 13:case 32:w+=Mz(I);break;case 92:w+=Oz(ym()-1,7);continue;case 47:switch(Ga()){case 42:case 47:pd(zz(Lz(Ps(),ym()),e,n,f),f),($d(I||1)==5||$d(Ga()||1)==5)&&As(w)&&nl(w,-1,void 0)!==" "&&(w+=" ");break;default:w+="/"}break;case 123*A:h[p++]=As(w)*V;case 125*A:case 59:case 0:switch(F){case 0:case 125:N=0;case 59+y:V==-1&&(w=Ct(w,/\f/g,"")),k>0&&(As(w)-b||A===0&&I===47)&&pd(k>32?s4(w+";",r,n,b-1,f):s4(Ct(w," ","")+";",r,n,b-2,f),f);break;case 59:w+=";";default:if(pd(H=r4(w,e,n,p,y,a,h,j,O=[],B=[],b,o),o),F===123)if(y===0)bm(w,e,H,H,O,o,b,h,B);else{switch(x){case 99:if(Qn(w,3)===110)break;case 108:if(Qn(w,2)===97)break;default:y=0;case 100:case 109:case 115:}y?bm(t,H,H,r&&pd(r4(t,H,H,0,0,a,h,j,a,O=[],b,B),B),a,B,b,h,r?O:B):bm(w,H,H,H,[""],B,0,h,B)}}p=y=k=0,A=V=1,j=w="",b=u;break;case 58:b=1+As(w),k=I;default:if(A<1){if(F==123)--A;else if(F==125&&A++==0&&jz()==125)continue}switch(w+=Rb(F),F*A){case 38:V=y>0?1:(w+="\f",-1);break;case 44:h[p++]=(As(w)-1)*V,V=1;break;case 64:Ga()===45&&(w+=P0(Ps())),x=Ga(),y=b=As(j=w+=Vz(ym())),F++;break;case 45:I===45&&As(w)==2&&(A=0)}}return o}function r4(t,e,n,r,a,o,u,h,f,p,y,b){for(var x=a-1,k=a===0?o:[""],I=b3(k),A=0,N=0,V=0;A<r;++A)for(var F=0,j=nl(t,x+1,x=v3(N=u[A])),O=t;F<I;++F)(O=y3(N>0?k[F]+" "+j:Ct(j,/&\f/g,k[F])))&&(f[V++]=O);return Kp(t,e,n,a===0?Gp:h,f,p,y,b)}function zz(t,e,n,r){return Kp(t,e,n,p3,Rb(Iz()),nl(t,2,-2),0,r)}function s4(t,e,n,r,a){return Kp(t,e,n,Ab,nl(t,0,r),nl(t,r+1,-1),r,a)}function _3(t,e,n){switch(Az(t,e)){case 5103:return Kt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:case 6391:case 5879:case 5623:case 6135:case 4599:return Kt+t+t;case 4855:return Kt+t.replace("add","source-over").replace("substract","source-out").replace("intersect","source-in").replace("exclude","xor")+t;case 4789:return Td+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Kt+t+Td+t+dn+t+t;case 5936:switch(Qn(t,e+11)){case 114:return Kt+t+dn+Ct(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Kt+t+dn+Ct(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Kt+t+dn+Ct(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return Kt+t+dn+t+t;case 6165:return Kt+t+dn+"flex-"+t+t;case 5187:return Kt+t+Ct(t,/(\w+).+(:[^]+)/,Kt+"box-$1$2"+dn+"flex-$1$2")+t;case 5443:return Kt+t+dn+"flex-item-"+Ct(t,/flex-|-self/g,"")+(Li(t,/flex-|baseline/)?"":dn+"grid-row-"+Ct(t,/flex-|-self/g,""))+t;case 4675:return Kt+t+dn+"flex-line-pack"+Ct(t,/align-content|flex-|-self/g,"")+t;case 5548:return Kt+t+dn+Ct(t,"shrink","negative")+t;case 5292:return Kt+t+dn+Ct(t,"basis","preferred-size")+t;case 6060:return Kt+"box-"+Ct(t,"-grow","")+Kt+t+dn+Ct(t,"grow","positive")+t;case 4554:return Kt+Ct(t,/([^-])(transform)/g,"$1"+Kt+"$2")+t;case 6187:return Ct(Ct(Ct(t,/(zoom-|grab)/,Kt+"$1"),/(image-set)/,Kt+"$1"),t,"")+t;case 5495:case 3959:return Ct(t,/(image-set\([^]*)/,Kt+"$1$`$1");case 4968:return Ct(Ct(t,/(.+:)(flex-)?(.*)/,Kt+"box-pack:$3"+dn+"flex-pack:$3"),/space-between/,"justify")+Kt+t+t;case 4200:if(!Li(t,/flex-|baseline/))return dn+"grid-column-align"+nl(t,e)+t;break;case 2592:case 3360:return dn+Ct(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(r,a){return e=a,Li(r.props,/grid-\w+-end/)})?~vm(t+(n=n[e].value),"span",0)?t:dn+Ct(t,"-start","")+t+dn+"grid-row-span:"+(~vm(n,"span",0)?Li(n,/\d+/):+Li(n,/\d+/)-+Li(t,/\d+/))+";":dn+Ct(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(r){return Li(r.props,/grid-\w+-start/)})?t:dn+Ct(Ct(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return Ct(t,/(.+)-inline(.+)/,Kt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(As(t)-1-e>6)switch(Qn(t,e+1)){case 109:if(Qn(t,e+4)!==45)break;case 102:return Ct(t,/(.+:)(.+)-([^]+)/,"$1"+Kt+"$2-$3$1"+Td+(Qn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~vm(t,"stretch",0)?_3(Ct(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return Ct(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,a,o,u,h,f,p){return dn+a+":"+o+p+(u?dn+a+"-span:"+(h?f:+f-+o)+p:"")+t});case 4949:if(Qn(t,e+6)===121)return Ct(t,":",":"+Kt)+t;break;case 6444:switch(Qn(t,Qn(t,14)===45?18:11)){case 120:return Ct(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Kt+(Qn(t,14)===45?"inline-":"")+"box$3$1"+Kt+"$2$3$1"+dn+"$2box$3")+t;case 100:return Ct(t,":",":"+dn)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ct(t,"scroll-","scroll-snap-")+t}return t}function rp(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function Bz(t,e,n,r){switch(t.type){case Nz:if(t.children.length)break;case Cz:case kz:case Ab:return t.return=t.return||t.value;case p3:return"";case g3:return t.return=t.value+"{"+rp(t.children,r)+"}";case Gp:if(!As(t.value=t.props.join(",")))return""}return As(n=rp(t.children,r))?t.return=t.value+"{"+n+"}":""}function Fz(t){var e=b3(t);return function(n,r,a,o){for(var u="",h=0;h<e;h++)u+=t[h](n,r,a,o)||"";return u}}function Hz(t){return function(e){e.root||(e=e.return)&&t(e)}}function $z(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case Ab:t.return=_3(t.value,t.length,n);return;case g3:return rp([Ha(t,{value:Ct(t.value,"@","@"+Kt)})],r);case Gp:if(t.length)return Rz(n=t.props,function(a){switch(Li(a,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":tc(Ha(t,{props:[Ct(a,/:(read-\w+)/,":"+Td+"$1")]})),tc(Ha(t,{props:[a]})),Py(t,{props:n4(n,r)});break;case"::placeholder":tc(Ha(t,{props:[Ct(a,/:(plac\w+)/,":"+Kt+"input-$1")]})),tc(Ha(t,{props:[Ct(a,/:(plac\w+)/,":"+Td+"$1")]})),tc(Ha(t,{props:[Ct(a,/:(plac\w+)/,dn+"input-$1")]})),tc(Ha(t,{props:[a]})),Py(t,{props:n4(n,r)});break}return""})}}var qz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Zr={},Dc=typeof process<"u"&&Zr!==void 0&&(Zr.REACT_APP_SC_ATTR||Zr.SC_ATTR)||"data-styled",w3="active",E3="data-styled-version",Xp="6.3.8",Ib=`/*!sc*/
`,sp=typeof window<"u"&&typeof document<"u",Pc=ve.createContext===void 0,Gz=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Zr!==void 0&&Zr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Zr.REACT_APP_SC_DISABLE_SPEEDY!==""?Zr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Zr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Zr!==void 0&&Zr.SC_DISABLE_SPEEDY!==void 0&&Zr.SC_DISABLE_SPEEDY!==""&&Zr.SC_DISABLE_SPEEDY!=="false"&&Zr.SC_DISABLE_SPEEDY),Wp=Object.freeze([]),Mc=Object.freeze({});function Yz(t,e,n){return n===void 0&&(n=Mc),t.theme!==n.theme&&t.theme||e||n.theme}var S3=new Set(["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","body","button","br","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","map","mark","menu","meter","nav","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","slot","small","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tspan","use"]),Kz=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Qz=/(^-|-$)/g;function i4(t){return t.replace(Kz,"-").replace(Qz,"")}var Xz=/(a)(d)/gi,a4=function(t){return String.fromCharCode(t+(t>25?39:97))};function Oy(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=a4(e%52)+n;return(a4(e%52)+n).replace(Xz,"$1-$2")}var M0,oc=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},T3=function(t){return oc(5381,t)};function C3(t){return Oy(T3(t)>>>0)}function Wz(t){return t.displayName||t.name||"Component"}function O0(t){return typeof t=="string"&&!0}var k3=typeof Symbol=="function"&&Symbol.for,N3=k3?Symbol.for("react.memo"):60115,Jz=k3?Symbol.for("react.forward_ref"):60112,Zz={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},eB={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},A3={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},tB=((M0={})[Jz]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},M0[N3]=A3,M0);function o4(t){return("type"in(e=t)&&e.type.$$typeof)===N3?A3:"$$typeof"in t?tB[t.$$typeof]:Zz;var e}var nB=Object.defineProperty,rB=Object.getOwnPropertyNames,l4=Object.getOwnPropertySymbols,sB=Object.getOwnPropertyDescriptor,iB=Object.getPrototypeOf,c4=Object.prototype;function R3(t,e,n){if(typeof e!="string"){if(c4){var r=iB(e);r&&r!==c4&&R3(t,r,n)}var a=rB(e);l4&&(a=a.concat(l4(e)));for(var o=o4(t),u=o4(e),h=0;h<a.length;++h){var f=a[h];if(!(f in eB||n&&n[f]||u&&f in u||o&&f in o)){var p=sB(e,f);try{nB(t,f,p)}catch{}}}}return t}function Oc(t){return typeof t=="function"}function jb(t){return typeof t=="object"&&"styledComponentId"in t}function Ho(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function Ly(t,e){if(t.length===0)return"";for(var n=t[0],r=1;r<t.length;r++)n+=t[r];return n}function qd(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function Vy(t,e,n){if(n===void 0&&(n=!1),!n&&!qd(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=Vy(t[r],e[r]);else if(qd(e))for(var r in e)t[r]=Vy(t[r],e[r]);return t}function Db(t,e){Object.defineProperty(t,"toString",{value:e})}function hh(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var aB=(function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,r=0;r<e;r++)n+=this.groupSizes[r];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var r=this.groupSizes,a=r.length,o=a;e>=o;)if((o<<=1)<0)throw hh(16,"".concat(e));this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var u=a;u<o;u++)this.groupSizes[u]=0}for(var h=this.indexOfGroup(e+1),f=(u=0,n.length);u<f;u++)this.tag.insertRule(h,n[u])&&(this.groupSizes[e]++,h++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],r=this.indexOfGroup(e),a=r+n;this.groupSizes[e]=0;for(var o=r;o<a;o++)this.tag.deleteRule(r)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var r=this.groupSizes[e],a=this.indexOfGroup(e),o=a+r,u=a;u<o;u++)n+="".concat(this.tag.getRule(u)).concat(Ib);return n},t})(),xm=new Map,ip=new Map,_m=1,gd=function(t){if(xm.has(t))return xm.get(t);for(;ip.has(_m);)_m++;var e=_m++;return xm.set(t,e),ip.set(e,t),e},oB=function(t,e){_m=e+1,xm.set(t,e),ip.set(e,t)},lB="style[".concat(Dc,"][").concat(E3,'="').concat(Xp,'"]'),cB=new RegExp("^".concat(Dc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),uB=function(t,e,n){for(var r,a=n.split(","),o=0,u=a.length;o<u;o++)(r=a[o])&&t.registerName(e,r)},dB=function(t,e){for(var n,r=((n=e.textContent)!==null&&n!==void 0?n:"").split(Ib),a=[],o=0,u=r.length;o<u;o++){var h=r[o].trim();if(h){var f=h.match(cB);if(f){var p=0|parseInt(f[1],10),y=f[2];p!==0&&(oB(y,p),uB(t,y,f[3]),t.getTag().insertRules(p,a)),a.length=0}else a.push(h)}}},u4=function(t){for(var e=document.querySelectorAll(lB),n=0,r=e.length;n<r;n++){var a=e[n];a&&a.getAttribute(Dc)!==w3&&(dB(t,a),a.parentNode&&a.parentNode.removeChild(a))}};function hB(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var I3=function(t){var e=document.head,n=t||e,r=document.createElement("style"),a=(function(h){var f=Array.from(h.querySelectorAll("style[".concat(Dc,"]")));return f[f.length-1]})(n),o=a!==void 0?a.nextSibling:null;r.setAttribute(Dc,w3),r.setAttribute(E3,Xp);var u=hB();return u&&r.setAttribute("nonce",u),n.insertBefore(r,o),r},fB=(function(){function t(e){this.element=I3(e),this.element.appendChild(document.createTextNode("")),this.sheet=(function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,a=0,o=r.length;a<o;a++){var u=r[a];if(u.ownerNode===n)return u}throw hh(17)})(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t})(),mB=(function(){function t(e){this.element=I3(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t})(),pB=(function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t})(),d4=sp,gB={isServer:!sp,useCSSOMInjection:!Gz},j3=(function(){function t(e,n,r){e===void 0&&(e=Mc),n===void 0&&(n={});var a=this;this.options=br(br({},gB),e),this.gs=n,this.names=new Map(r),this.server=!!e.isServer,!this.server&&sp&&d4&&(d4=!1,u4(this)),Db(this,function(){return(function(o){for(var u=o.getTag(),h=u.length,f="",p=function(b){var x=(function(V){return ip.get(V)})(b);if(x===void 0)return"continue";var k=o.names.get(x),I=u.getGroup(b);if(k===void 0||!k.size||I.length===0)return"continue";var A="".concat(Dc,".g").concat(b,'[id="').concat(x,'"]'),N="";k!==void 0&&k.forEach(function(V){V.length>0&&(N+="".concat(V,","))}),f+="".concat(I).concat(A,'{content:"').concat(N,'"}').concat(Ib)},y=0;y<h;y++)p(y);return f})(a)})}return t.registerId=function(e){return gd(e)},t.prototype.rehydrate=function(){!this.server&&sp&&u4(this)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(br(br({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=(function(n){var r=n.useCSSOMInjection,a=n.target;return n.isServer?new pB(a):r?new fB(a):new mB(a)})(this.options),new aB(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(gd(e),this.names.has(e))this.names.get(e).add(n);else{var r=new Set;r.add(n),this.names.set(e,r)}},t.prototype.insertRules=function(e,n,r){this.registerName(e,n),this.getTag().insertRules(gd(e),r)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(gd(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t})(),vB=/&/g,lc=47;function h4(t){if(t.indexOf("}")===-1)return!1;for(var e=t.length,n=0,r=0,a=!1,o=0;o<e;o++){var u=t.charCodeAt(o);if(r!==0||a||u!==lc||t.charCodeAt(o+1)!==42)if(a)u===42&&t.charCodeAt(o+1)===lc&&(a=!1,o++);else if(u!==34&&u!==39||o!==0&&t.charCodeAt(o-1)===92){if(r===0){if(u===123)n++;else if(u===125&&--n<0)return!0}}else r===0?r=u:r===u&&(r=0);else a=!0,o++}return n!==0||r!==0}function D3(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=D3(n.children,e)),n})}function yB(t){var e,n,r,a=Mc,o=a.options,u=o===void 0?Mc:o,h=a.plugins,f=h===void 0?Wp:h,p=function(x,k,I){return I.startsWith(n)&&I.endsWith(n)&&I.replaceAll(n,"").length>0?".".concat(e):x},y=f.slice();y.push(function(x){x.type===Gp&&x.value.includes("&")&&(x.props[0]=x.props[0].replace(vB,n).replace(r,p))}),u.prefix&&y.push($z),y.push(Bz);var b=function(x,k,I,A){k===void 0&&(k=""),I===void 0&&(I=""),A===void 0&&(A="&"),e=A,n=k,r=new RegExp("\\".concat(n,"\\b"),"g");var N=(function(j){if(!h4(j))return j;for(var O=j.length,B="",H=0,w=0,S=0,R=!1,D=0;D<O;D++){var L=j.charCodeAt(D);if(S!==0||R||L!==lc||j.charCodeAt(D+1)!==42)if(R)L===42&&j.charCodeAt(D+1)===lc&&(R=!1,D++);else if(L!==34&&L!==39||D!==0&&j.charCodeAt(D-1)===92){if(S===0)if(L===123)w++;else if(L===125){if(--w<0){for(var U=D+1;U<O;){var P=j.charCodeAt(U);if(P===59||P===10)break;U++}U<O&&j.charCodeAt(U)===59&&U++,w=0,D=U-1,H=U;continue}w===0&&(B+=j.substring(H,D+1),H=D+1)}else L===59&&w===0&&(B+=j.substring(H,D+1),H=D+1)}else S===0?S=L:S===L&&(S=0);else R=!0,D++}if(H<O){var ne=j.substring(H);h4(ne)||(B+=ne)}return B})((function(j){if(j.indexOf("//")===-1)return j;for(var O=j.length,B=[],H=0,w=0,S=0,R=0;w<O;){var D=j.charCodeAt(w);if(D!==34&&D!==39||w!==0&&j.charCodeAt(w-1)===92)if(S===0)if(D===40&&w>=3&&(32|j.charCodeAt(w-1))==108&&(32|j.charCodeAt(w-2))==114&&(32|j.charCodeAt(w-3))==117)R=1,w++;else if(R>0)D===41?R--:D===40&&R++,w++;else if(D===lc&&w+1<O&&j.charCodeAt(w+1)===lc){for(w>H&&B.push(j.substring(H,w));w<O&&j.charCodeAt(w)!==10;)w++;H=w}else w++;else w++;else S===0?S=D:S===D&&(S=0),w++}return H===0?j:(H<O&&B.push(j.substring(H)),B.join(""))})(x)),V=Uz(I||k?"".concat(I," ").concat(k," { ").concat(N," }"):N);u.namespace&&(V=D3(V,u.namespace));var F=[];return rp(V,Fz(y.concat(Hz(function(j){return F.push(j)})))),F};return b.hash=f.length?f.reduce(function(x,k){return k.name||hh(15),oc(x,k.name)},5381).toString():"",b}var bB=new j3,Uy=yB(),zy={shouldForwardProp:void 0,styleSheet:bB,stylis:Uy},P3=Pc?{Provider:function(t){return t.children},Consumer:function(t){return(0,t.children)(zy)}}:ve.createContext(zy);P3.Consumer;Pc||ve.createContext(void 0);function f4(){return Pc?zy:ve.useContext(P3)}var M3=(function(){function t(e,n){var r=this;this.inject=function(a,o){o===void 0&&(o=Uy);var u=r.name+o.hash;a.hasNameForId(r.id,u)||a.insertRules(r.id,u,o(r.rules,u,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,Db(this,function(){throw hh(12,String(r.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Uy),this.name+e.hash},t})();function xB(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in qz||t.startsWith("--")?String(e).trim():"".concat(e,"px")}var _B=function(t){return t>="A"&&t<="Z"};function m4(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(n===1&&r==="-"&&t[0]==="-")return t;_B(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var O3=function(t){return t==null||t===!1||t===""},L3=function(t){var e=[];for(var n in t){var r=t[n];t.hasOwnProperty(n)&&!O3(r)&&(Array.isArray(r)&&r.isCss||Oc(r)?e.push("".concat(m4(n),":"),r,";"):qd(r)?e.push.apply(e,tl(tl(["".concat(n," {")],L3(r),!1),["}"],!1)):e.push("".concat(m4(n),": ").concat(xB(n,r),";")))}return e};function Ko(t,e,n,r){if(O3(t))return[];if(jb(t))return[".".concat(t.styledComponentId)];if(Oc(t)){if(!Oc(o=t)||o.prototype&&o.prototype.isReactComponent||!e)return[t];var a=t(e);return Ko(a,e,n,r)}var o;return t instanceof M3?n?(t.inject(n,r),[t.getName(r)]):[t]:qd(t)?L3(t):Array.isArray(t)?Array.prototype.concat.apply(Wp,t.map(function(u){return Ko(u,e,n,r)})):[t.toString()]}function wB(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Oc(n)&&!jb(n))return!1}return!0}var EB=T3(Xp),SB=(function(){function t(e,n,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&wB(e),this.componentId=n,this.baseHash=oc(EB,n),this.baseStyle=r,j3.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,r){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,r).className:"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))a=Ho(a,this.staticRulesId);else{var o=Ly(Ko(this.rules,e,n,r)),u=Oy(oc(this.baseHash,o)>>>0);if(!n.hasNameForId(this.componentId,u)){var h=r(o,".".concat(u),void 0,this.componentId);n.insertRules(this.componentId,u,h)}a=Ho(a,u),this.staticRulesId=u}else{for(var f=oc(this.baseHash,r.hash),p="",y=0;y<this.rules.length;y++){var b=this.rules[y];if(typeof b=="string")p+=b;else if(b){var x=Ly(Ko(b,e,n,r));f=oc(f,x+y),p+=x}}if(p){var k=Oy(f>>>0);if(!n.hasNameForId(this.componentId,k)){var I=r(p,".".concat(k),void 0,this.componentId);n.insertRules(this.componentId,k,I)}a=Ho(a,k)}}return{className:a,css:typeof window>"u"?n.getTag().getGroup(gd(this.componentId)):""}},t})(),V3=Pc?{Provider:function(t){return t.children},Consumer:function(t){return(0,t.children)(void 0)}}:ve.createContext(void 0);V3.Consumer;var L0={};function TB(t,e,n){var r=jb(t),a=t,o=!O0(t),u=e.attrs,h=u===void 0?Wp:u,f=e.componentId,p=f===void 0?(function(O,B){var H=typeof O!="string"?"sc":i4(O);L0[H]=(L0[H]||0)+1;var w="".concat(H,"-").concat(C3(Xp+H+L0[H]));return B?"".concat(B,"-").concat(w):w})(e.displayName,e.parentComponentId):f,y=e.displayName,b=y===void 0?(function(O){return O0(O)?"styled.".concat(O):"Styled(".concat(Wz(O),")")})(t):y,x=e.displayName&&e.componentId?"".concat(i4(e.displayName),"-").concat(e.componentId):e.componentId||p,k=r&&a.attrs?a.attrs.concat(h).filter(Boolean):h,I=e.shouldForwardProp;if(r&&a.shouldForwardProp){var A=a.shouldForwardProp;if(e.shouldForwardProp){var N=e.shouldForwardProp;I=function(O,B){return A(O,B)&&N(O,B)}}else I=A}var V=new SB(n,x,r?a.componentStyle:void 0);function F(O,B){return(function(H,w,S){var R=H.attrs,D=H.componentStyle,L=H.defaultProps,U=H.foldedComponentIds,P=H.styledComponentId,ne=H.target,oe=Pc?void 0:ve.useContext(V3),G=f4(),Z=H.shouldForwardProp||G.shouldForwardProp,J=Yz(w,oe,L)||Mc,Se=(function(Oe,Ie,We){for(var ke,fe=br(br({},Ie),{className:void 0,theme:We}),Re=0;Re<Oe.length;Re+=1){var dt=Oc(ke=Oe[Re])?ke(fe):ke;for(var ye in dt)ye==="className"?fe.className=Ho(fe.className,dt[ye]):ye==="style"?fe.style=br(br({},fe.style),dt[ye]):fe[ye]=dt[ye]}return"className"in Ie&&typeof Ie.className=="string"&&(fe.className=Ho(fe.className,Ie.className)),fe})(R,w,J),Le=Se.as||ne,$={};for(var X in Se)Se[X]===void 0||X[0]==="$"||X==="as"||X==="theme"&&Se.theme===J||(X==="forwardedAs"?$.as=Se.forwardedAs:Z&&!Z(X,Le)||($[X]=Se[X]));var re=(function(Oe,Ie){var We=f4(),ke=Oe.generateAndInjectStyles(Ie,We.styleSheet,We.stylis);return ke})(D,Se),he=re.className,Te=re.css,Ue=Ho(U,P);he&&(Ue+=" "+he),Se.className&&(Ue+=" "+Se.className),$[O0(Le)&&!S3.has(Le)?"class":"className"]=Ue,S&&($.ref=S);var te=T.createElement(Le,$);return Pc&&Te?ve.createElement(ve.Fragment,null,ve.createElement("style",{precedence:"styled-components",href:"sc-".concat(P,"-").concat(he),children:Te}),te):te})(j,O,B)}F.displayName=b;var j=ve.forwardRef(F);return j.attrs=k,j.componentStyle=V,j.displayName=b,j.shouldForwardProp=I,j.foldedComponentIds=r?Ho(a.foldedComponentIds,a.styledComponentId):"",j.styledComponentId=x,j.target=r?a.target:t,Object.defineProperty(j,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(O){this._foldedDefaultProps=r?(function(B){for(var H=[],w=1;w<arguments.length;w++)H[w-1]=arguments[w];for(var S=0,R=H;S<R.length;S++)Vy(B,R[S],!0);return B})({},a.defaultProps,O):O}}),Db(j,function(){return".".concat(j.styledComponentId)}),o&&R3(j,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),j}function p4(t,e){for(var n=[t[0]],r=0,a=e.length;r<a;r+=1)n.push(e[r],t[r+1]);return n}var g4=function(t){return Object.assign(t,{isCss:!0})};function Jp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Oc(t)||qd(t))return g4(Ko(p4(Wp,tl([t],e,!0))));var r=t;return e.length===0&&r.length===1&&typeof r[0]=="string"?Ko(r):g4(Ko(p4(r,e)))}function By(t,e,n){if(n===void 0&&(n=Mc),!e)throw hh(1,e);var r=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];return t(e,n,Jp.apply(void 0,tl([a],o,!1)))};return r.attrs=function(a){return By(t,e,br(br({},n),{attrs:Array.prototype.concat(n.attrs,a).filter(Boolean)}))},r.withConfig=function(a){return By(t,e,br(br({},n),a))},r}var U3=function(t){return By(TB,t)},ot=U3;S3.forEach(function(t){ot[t]=U3(t)});function fh(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Ly(Jp.apply(void 0,tl([t],e,!1))),a=C3(r);return new M3(a,r)}var Fy="#121212",z3="#212121",CB="#3e3e3e",kB="#4a4a4a",B3="#a6a6a6",NB="#ececec",wm="#ffffff",Pb="#00ccff",F3="#00ff99",H3="#9933ff",$3="#ff6666",q3="#fff35c",AB="#6157ff";function v4(t,e,n,r){var a,o=!1,u=0;function h(){a&&clearTimeout(a)}function f(){h(),o=!0}typeof e!="boolean"&&(r=n,n=e,e=void 0);function p(){for(var y=arguments.length,b=new Array(y),x=0;x<y;x++)b[x]=arguments[x];var k=this,I=Date.now()-u;if(o)return;function A(){u=Date.now(),n.apply(k,b)}function N(){a=void 0}r&&!a&&A(),h(),r===void 0&&I>t?A():e!==!0&&(a=setTimeout(r?N:A,r===void 0?t-I:t))}return p.cancel=f,p}function Mb(t,e,n){return n===void 0?v4(t,e,!1):v4(t,n,e!==!1)}var y4={},b4;function RB(){return b4||(b4=1,(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function t(j){try{return j.defaultView&&j.defaultView.frameElement||null}catch{return null}}var e=(function(j){for(var O=j,B=t(O);B;)O=B.ownerDocument,B=t(O);return O})(window.document),n=[],r=null,a=null;function o(j){this.time=j.time,this.target=j.target,this.rootBounds=I(j.rootBounds),this.boundingClientRect=I(j.boundingClientRect),this.intersectionRect=I(j.intersectionRect||k()),this.isIntersecting=!!j.intersectionRect;var O=this.boundingClientRect,B=O.width*O.height,H=this.intersectionRect,w=H.width*H.height;B?this.intersectionRatio=Number((w/B).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function u(j,O){var B=O||{};if(typeof j!="function")throw new Error("callback must be a function");if(B.root&&B.root.nodeType!=1&&B.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=f(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=j,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(B.rootMargin),this.thresholds=this._initThresholds(B.threshold),this.root=B.root||null,this.rootMargin=this._rootMarginValues.map(function(H){return H.value+H.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}u.prototype.THROTTLE_TIMEOUT=100,u.prototype.POLL_INTERVAL=null,u.prototype.USE_MUTATION_OBSERVER=!0,u._setupCrossOriginUpdater=function(){return r||(r=function(j,O){!j||!O?a=k():a=A(j,O),n.forEach(function(B){B._checkForIntersections()})}),r},u._resetCrossOriginUpdater=function(){r=null,a=null},u.prototype.observe=function(j){var O=this._observationTargets.some(function(B){return B.element==j});if(!O){if(!(j&&j.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:j,entry:null}),this._monitorIntersections(j.ownerDocument),this._checkForIntersections()}},u.prototype.unobserve=function(j){this._observationTargets=this._observationTargets.filter(function(O){return O.element!=j}),this._unmonitorIntersections(j.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},u.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},u.prototype.takeRecords=function(){var j=this._queuedEntries.slice();return this._queuedEntries=[],j},u.prototype._initThresholds=function(j){var O=j||[0];return Array.isArray(O)||(O=[O]),O.sort().filter(function(B,H,w){if(typeof B!="number"||isNaN(B)||B<0||B>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return B!==w[H-1]})},u.prototype._parseRootMargin=function(j){var O=j||"0px",B=O.split(/\s+/).map(function(H){var w=/^(-?\d*\.?\d+)(px|%)$/.exec(H);if(!w)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(w[1]),unit:w[2]}});return B[1]=B[1]||B[0],B[2]=B[2]||B[0],B[3]=B[3]||B[1],B},u.prototype._monitorIntersections=function(j){var O=j.defaultView;if(O&&this._monitoringDocuments.indexOf(j)==-1){var B=this._checkForIntersections,H=null,w=null;this.POLL_INTERVAL?H=O.setInterval(B,this.POLL_INTERVAL):(p(O,"resize",B,!0),p(j,"scroll",B,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in O&&(w=new O.MutationObserver(B),w.observe(j,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(j),this._monitoringUnsubscribes.push(function(){var D=j.defaultView;D&&(H&&D.clearInterval(H),y(D,"resize",B,!0)),y(j,"scroll",B,!0),w&&w.disconnect()});var S=this.root&&(this.root.ownerDocument||this.root)||e;if(j!=S){var R=t(j);R&&this._monitorIntersections(R.ownerDocument)}}},u.prototype._unmonitorIntersections=function(j){var O=this._monitoringDocuments.indexOf(j);if(O!=-1){var B=this.root&&(this.root.ownerDocument||this.root)||e,H=this._observationTargets.some(function(R){var D=R.element.ownerDocument;if(D==j)return!0;for(;D&&D!=B;){var L=t(D);if(D=L&&L.ownerDocument,D==j)return!0}return!1});if(!H){var w=this._monitoringUnsubscribes[O];if(this._monitoringDocuments.splice(O,1),this._monitoringUnsubscribes.splice(O,1),w(),j!=B){var S=t(j);S&&this._unmonitorIntersections(S.ownerDocument)}}}},u.prototype._unmonitorAllIntersections=function(){var j=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var O=0;O<j.length;O++)j[O]()},u.prototype._checkForIntersections=function(){if(!(!this.root&&r&&!a)){var j=this._rootIsInDom(),O=j?this._getRootRect():k();this._observationTargets.forEach(function(B){var H=B.element,w=x(H),S=this._rootContainsTarget(H),R=B.entry,D=j&&S&&this._computeTargetAndRootIntersection(H,w,O),L=null;this._rootContainsTarget(H)?(!r||this.root)&&(L=O):L=k();var U=B.entry=new o({time:h(),target:H,boundingClientRect:w,rootBounds:L,intersectionRect:D});R?j&&S?this._hasCrossedThreshold(R,U)&&this._queuedEntries.push(U):R&&R.isIntersecting&&this._queuedEntries.push(U):this._queuedEntries.push(U)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},u.prototype._computeTargetAndRootIntersection=function(j,O,B){if(window.getComputedStyle(j).display!="none"){for(var H=O,w=V(j),S=!1;!S&&w;){var R=null,D=w.nodeType==1?window.getComputedStyle(w):{};if(D.display=="none")return null;if(w==this.root||w.nodeType==9)if(S=!0,w==this.root||w==e)r&&!this.root?!a||a.width==0&&a.height==0?(w=null,R=null,H=null):R=a:R=B;else{var L=V(w),U=L&&x(L),P=L&&this._computeTargetAndRootIntersection(L,U,B);U&&P?(w=L,R=A(U,P)):(w=null,H=null)}else{var ne=w.ownerDocument;w!=ne.body&&w!=ne.documentElement&&D.overflow!="visible"&&(R=x(w))}if(R&&(H=b(R,H)),!H)break;w=w&&V(w)}return H}},u.prototype._getRootRect=function(){var j;if(this.root&&!F(this.root))j=x(this.root);else{var O=F(this.root)?this.root:e,B=O.documentElement,H=O.body;j={top:0,left:0,right:B.clientWidth||H.clientWidth,width:B.clientWidth||H.clientWidth,bottom:B.clientHeight||H.clientHeight,height:B.clientHeight||H.clientHeight}}return this._expandRectByRootMargin(j)},u.prototype._expandRectByRootMargin=function(j){var O=this._rootMarginValues.map(function(H,w){return H.unit=="px"?H.value:H.value*(w%2?j.width:j.height)/100}),B={top:j.top-O[0],right:j.right+O[1],bottom:j.bottom+O[2],left:j.left-O[3]};return B.width=B.right-B.left,B.height=B.bottom-B.top,B},u.prototype._hasCrossedThreshold=function(j,O){var B=j&&j.isIntersecting?j.intersectionRatio||0:-1,H=O.isIntersecting?O.intersectionRatio||0:-1;if(B!==H)for(var w=0;w<this.thresholds.length;w++){var S=this.thresholds[w];if(S==B||S==H||S<B!=S<H)return!0}},u.prototype._rootIsInDom=function(){return!this.root||N(e,this.root)},u.prototype._rootContainsTarget=function(j){var O=this.root&&(this.root.ownerDocument||this.root)||e;return N(O,j)&&(!this.root||O==j.ownerDocument)},u.prototype._registerInstance=function(){n.indexOf(this)<0&&n.push(this)},u.prototype._unregisterInstance=function(){var j=n.indexOf(this);j!=-1&&n.splice(j,1)};function h(){return window.performance&&performance.now&&performance.now()}function f(j,O){var B=null;return function(){B||(B=setTimeout(function(){j(),B=null},O))}}function p(j,O,B,H){typeof j.addEventListener=="function"?j.addEventListener(O,B,H):typeof j.attachEvent=="function"&&j.attachEvent("on"+O,B)}function y(j,O,B,H){typeof j.removeEventListener=="function"?j.removeEventListener(O,B,H):typeof j.detachEvent=="function"&&j.detachEvent("on"+O,B)}function b(j,O){var B=Math.max(j.top,O.top),H=Math.min(j.bottom,O.bottom),w=Math.max(j.left,O.left),S=Math.min(j.right,O.right),R=S-w,D=H-B;return R>=0&&D>=0&&{top:B,bottom:H,left:w,right:S,width:R,height:D}||null}function x(j){var O;try{O=j.getBoundingClientRect()}catch{}return O?(O.width&&O.height||(O={top:O.top,right:O.right,bottom:O.bottom,left:O.left,width:O.right-O.left,height:O.bottom-O.top}),O):k()}function k(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function I(j){return!j||"x"in j?j:{top:j.top,y:j.top,bottom:j.bottom,left:j.left,x:j.left,right:j.right,width:j.width,height:j.height}}function A(j,O){var B=O.top-j.top,H=O.left-j.left;return{top:B,left:H,height:O.height,width:O.width,bottom:B+O.height,right:H+O.width}}function N(j,O){for(var B=O;B;){if(B==j)return!0;B=V(B)}return!1}function V(j){var O=j.parentNode;return j.nodeType==9&&j!=e?t(j):(O&&O.assignedSlot&&(O=O.assignedSlot.parentNode),O&&O.nodeType==11&&O.host?O.host:O)}function F(j){return j&&j.nodeType===9}window.IntersectionObserver=u,window.IntersectionObserverEntry=o})()),y4}RB();var IB=Object.defineProperty,x4=Object.getOwnPropertySymbols,jB=Object.prototype.hasOwnProperty,DB=Object.prototype.propertyIsEnumerable,_4=(t,e,n)=>e in t?IB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nd=(t,e)=>{for(var n in e||(e={}))jB.call(e,n)&&_4(t,n,e[n]);if(x4)for(var n of x4(e))DB.call(e,n)&&_4(t,n,e[n]);return t},PB=(t,e,n)=>{const r=Ry(t,[n]),a=Ry(e,[n]);return r[n]&&a[n]?nd(nd(nd({},t),e),{[n]:r[n]+", "+a[n]}):nd(nd({},t),e)},MB=PB,Ob=(typeof window<"u"?window:global)||{},w4,OB=((w4=Ob)==null?void 0:w4.GIPHY_PINGBACK_URL)||"https://pingback.giphy.com",LB=`${OB}/v2/pingback?apikey=l0HlIwPWyBBUDAUgM`,VB=t=>{const e=kb();return e?.set("Content-Type","application/json"),ur.debug("Pingback session",t),t.length?fetch(LB,{method:"POST",body:JSON.stringify({events:t}),headers:e}).catch(n=>{ur.warn(`pingbacks failing to post ${n}`)}):new Promise(n=>n())},Hy=[];Ob.giphyRandomId=Cb();var Qf="";function Lb(){const t=[...Hy];Hy=[],VB(t)}var UB=Mb(1e3,Lb),E4,S4;(S4=(E4=Ob).addEventListener)==null||S4.call(E4,"beforeunload",Lb);var zB=({userId:t,eventType:e,actionType:n,attributes:r,queueEvents:a=!0,analyticsResponsePayload:o})=>{Qf=t?String(t):Qf;const u={ts:Date.now(),attributes:r,action_type:n,user_id:Cb(),analytics_response_payload:o};Qf&&(u.logged_in_user_id=Qf),u.analytics_response_payload&&(u.analytics_response_payload=`${u.analytics_response_payload}${ur.ENABLED?"&mode=verification":""}`),e&&(u.event_type=e),Hy.push(u),a?UB():Lb()},Vb=zB;const BB=G6(Tz);var Xf={},T4;function FB(){if(T4)return Xf;T4=1,Object.defineProperty(Xf,"__esModule",{value:!0});var t=lo();function e(n,r){r===void 0&&(r=0);var a=t.useRef(!1),o=t.useRef(),u=t.useRef(n),h=t.useCallback(function(){return a.current},[]),f=t.useCallback(function(){a.current=!1,o.current&&clearTimeout(o.current),o.current=setTimeout(function(){a.current=!0,u.current()},r)},[r]),p=t.useCallback(function(){a.current=null,o.current&&clearTimeout(o.current)},[]);return t.useEffect(function(){u.current=n},[n]),t.useEffect(function(){return f(),p},[r]),[h,p,f]}return Xf.default=e,Xf}var HB=FB();const $B=Kd(HB);var Wf={},Jf={},Jr={},C4;function qB(){if(C4)return Jr;C4=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.isNavigator=Jr.isBrowser=Jr.off=Jr.on=Jr.noop=void 0;var t=function(){};Jr.noop=t;function e(r){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];r&&r.addEventListener&&r.addEventListener.apply(r,a)}Jr.on=e;function n(r){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];r&&r.removeEventListener&&r.removeEventListener.apply(r,a)}return Jr.off=n,Jr.isBrowser=typeof window<"u",Jr.isNavigator=typeof navigator<"u",Jr}var k4;function GB(){if(k4)return Jf;k4=1,Object.defineProperty(Jf,"__esModule",{value:!0});var t=lo(),e=qB(),n=e.isBrowser?t.useLayoutEffect:t.useEffect;return Jf.default=n,Jf}var N4;function YB(){if(N4)return Wf;N4=1,Object.defineProperty(Wf,"__esModule",{value:!0});var t=BB,e=lo(),n=t.__importDefault(GB()),r=function(a,o){a===void 0&&(a=1e12),o===void 0&&(o=0);var u=e.useState(0),h=u[0],f=u[1];return n.default(function(){var p,y,b,x=function(){var N=Math.min(1,(Date.now()-b)/a);f(N),k()},k=function(){p=requestAnimationFrame(x)},I=function(){y=setTimeout(function(){cancelAnimationFrame(p),f(1)},a),b=Date.now(),k()},A=setTimeout(I,o);return function(){clearTimeout(y),clearTimeout(A),cancelAnimationFrame(p)}},[a,o]),h};return Wf.default=r,Wf}var KB=YB();const QB=Kd(KB);var XB=Object.defineProperty,WB=Object.defineProperties,JB=Object.getOwnPropertyDescriptors,A4=Object.getOwnPropertySymbols,ZB=Object.prototype.hasOwnProperty,eF=Object.prototype.propertyIsEnumerable,R4=(t,e,n)=>e in t?XB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,na=(t,e)=>{for(var n in e||(e={}))ZB.call(e,n)&&R4(t,n,e[n]);if(A4)for(var n of A4(e))eF.call(e,n)&&R4(t,n,e[n]);return t},Ub=(t,e)=>WB(t,JB(e)),zb=(t,e,n)=>new Promise((r,a)=>{var o=f=>{try{h(n.next(f))}catch(p){a(p)}},u=f=>{try{h(n.throw(f))}catch(p){a(p)}},h=f=>f.done?r(f.value):Promise.resolve(f.value).then(o,u);h((n=n.apply(t,e)).next())}),tF=t=>{var e,n;if(!t)return"";const r=(n=(e=t?.split("."))==null?void 0:e.pop())==null?void 0:n.toLowerCase();return t.replace(`.${r}`,`/80h.${r}`)},nF=ot.img`
    object-fit: cover;
    width: 32px;
    height: 32px;
    margin-right: 8px;
`,rF=({user:t,className:e=""})=>{const n=T.useRef(Math.floor(Math.random()*5)+1),r=t.avatar_url?tF(t.avatar_url):`https://media.giphy.com/avatars/default${n.current}.gif`;return ve.createElement(nF,{src:r,className:e})},Zp=rF,Gd=({className:t="",size:e=17,fill:n="#15CDFF"})=>ve.createElement("svg",{className:[Gd.className,t].join(" "),height:e,width:"19px",viewBox:"0 0 19 17"},ve.createElement("path",{className:Gd.checkMarkClassName,d:"M9.32727273,9.44126709 L9.32727273,3.03016561 L6.55027155,3.03016561 L6.55027155,10.8150746 L6.55027155,12.188882 L12.1042739,12.188882 L12.1042739,9.44126709 L9.32727273,9.44126709 Z",fill:Fy,transform:"translate(9.327273, 7.609524) scale(-1, 1) rotate(-45.000000) translate(-9.327273, -7.609524) "}),ve.createElement("g",{transform:"translate(-532.000000, -466.000000)",fill:n},ve.createElement("g",{transform:"translate(141.000000, 235.000000)"},ve.createElement("g",{transform:"translate(264.000000, 0.000000)"},ve.createElement("g",{transform:"translate(10.000000, 224.000000)"},ve.createElement("g",{transform:"translate(114.000000, 2.500000)"},ve.createElement("path",{d:"M15.112432,4.80769231 L16.8814194,6.87556817 L19.4157673,7.90116318 L19.6184416,10.6028916 L21.0594951,12.9065042 L19.6184416,15.2101168 L19.4157673,17.9118452 L16.8814194,18.9374402 L15.112432,21.0053161 L12.4528245,20.3611511 L9.79321699,21.0053161 L8.02422954,18.9374402 L5.48988167,17.9118452 L5.28720734,15.2101168 L3.84615385,12.9065042 L5.28720734,10.6028916 L5.48988167,7.90116318 L8.02422954,6.87556817 L9.79321699,4.80769231 L12.4528245,5.4518573 L15.112432,4.80769231 Z M17.8163503,10.8991009 L15.9282384,9.01098901 L11.5681538,13.3696923 L9.68115218,11.4818515 L7.81302031,13.3499833 L9.7011322,15.2380952 L11.5892441,17.1262071 L17.8163503,10.8991009 Z"})))))));Gd.className="giphy-verified-badge";Gd.checkMarkClassName="giphy-verified-checkmark";var $y=Gd,sF=ot.div`
    color: white;
    font-size: 16px;
    font-weight: 700;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    -webkit-font-smoothing: antialiased;
`,iF=ot($y)`
    margin-left: 4px;
    flex-shrink: 0;
`,aF=ot.div`
    display: flex;
    align-items: center;
    min-width: 0;
`,oF=({user:t})=>{const{display_name:e,username:n}=t;return ve.createElement(aF,null,ve.createElement(sF,null,e||`@${n}`),t.is_verified?ve.createElement(iF,{size:14}):null)},G3=oF,lF=ot.div`
    display: flex;
    align-items: center;
    font-family: interface, helvetica, arial;
`,cF=ot(Zp)`
    flex-shrink: 0;
`,Bb=({gif:t,className:e,onClick:n})=>{const{user:r}=t;return!r?.username&&!r?.display_name?null:ve.createElement(lF,{className:[Bb.className,e].join(" "),onClick:a=>{if(a.preventDefault(),a.stopPropagation(),n)n(t);else{const o=r.profile_url;o&&window.open(o,"_blank")}}},ve.createElement(cF,{user:r}),ve.createElement(G3,{user:t.user}))};Bb.className="giphy-attribution";var uF=Bb,dF=ot.div`
    background: linear-gradient(rgba(0, 0, 0, 0), rgba(18, 18, 18, 0.6));
    cursor: default;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 75px;
    pointer-events: none;
`,hF=ot(uF)`
    position: absolute;
    bottom: 10px;
    left: 10px;
    right: 10px;
`,fF=ot.div`
    transition: opacity 150ms ease-in;
`,mF=({gif:t,isHovered:e,onClick:n})=>{const r=T.useRef(e);return e&&(r.current=!0),t.user&&r.current?ve.createElement(fF,{style:{opacity:e?1:0}},ve.createElement(dF,null),ve.createElement(hF,{gif:t,onClick:n})):null},pF=mF,gF=({children:t,className:e,onVisibleChange:n,config:r})=>{const a=T.useRef(null);return T.useEffect(()=>{let o;return a.current&&(o=new IntersectionObserver(([u])=>{n&&n(u.isIntersecting)},r),o.observe(a.current)),()=>o?.disconnect()},[n,a,r]),ve.createElement("div",{ref:a,className:e},t)},Y3=gF,K3=t=>(e,n,r,a={})=>{e.analytics_response_payload&&Vb({analyticsResponsePayload:e.analytics_response_payload,userId:n,actionType:t,attributes:na({position:JSON.stringify(YU(r))},a)})},vF=(t,e,n,r={})=>{t.analytics_response_payload&&Vb({analyticsResponsePayload:t.analytics_response_payload,userId:e,actionType:"SEEN",attributes:na({position:JSON.stringify(n)},r)})},yF=K3("CLICK"),bF=K3("HOVER");function xF(t){return t=t.replace("%%CACHEBUSTER%%",LA()),t=t.replace("%%TIMESTAMP%%",`${Date.now()}`),t=t.replace("%%APPBUNDLE%%","web"),typeof window<"u"&&(t=t.replace("%%APP_WINDOW_SIZE%%",`${window.innerWidth},${window.innerHeight}`),t=t.replace("%%DEVICE_LANGUAGE%%",`${navigator.language}`)),t}function _F({src:t}){const e=T.useRef(xF(t)),[n,r]=T.useState(!1);return T.useEffect(()=>{r(!0)},[]),n?ve.createElement("img",{src:e.current,width:0,height:0}):null}var wF=_F,qy=T.createContext({}),EF=({attributes:t,children:e})=>{const{attributes:n={}}=T.useContext(qy);return ve.createElement(qy.Provider,{value:{attributes:MB(n,t,"layout_type")}},e)},Q3=EF,SF=ot.div`
    position: relative;
    display: block;
    picture {
        display: block;
        width: 100%;
        height: 100%;
    }
    img {
        display: block;
    }
    .${$y.className} {
        g {
            fill: white;
        }
    }
    .${$y.checkMarkClassName} {
        opacity: 0;
    }
`,I4=[Pb,F3,H3,$3,q3],TF=()=>I4[Math.round(Math.random()*(I4.length-1))],CF=200,j4="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",kF=!!(typeof window<"u"&&window.document&&window.document.createElement),nc=()=>{},NF=({children:t})=>{const[e,n]=T.useState(!1);return T.useEffect(()=>{n(!0)},[]),e?ve.createElement(ve.Fragment,null,t):null},Ya=({gif:t,gif:{bottle_data:e={}},width:n,percentWidth:r,percentHeight:a,height:o,onGifRightClick:u=nc,className:h="",onGifClick:f=nc,onGifKeyPress:p=nc,onGifSeen:y=nc,onGifVisible:b=nc,user:x={},backgroundColor:k,overlay:I,hideAttribution:A=!1,noLink:N=!1,borderRadius:V=4,style:F,tabIndex:j,lazyLoad:O=!0})=>{var B;const[H,w]=T.useState(!1),[S,R]=T.useState(!1),[D,L]=T.useState(!kF||!O),[U,P]=T.useState(""),ne=T.useRef(TF()),oe=T.useRef(null),G=T.useRef(null),Z=T.useRef(),J=T.useRef(),Se=T.useRef(),Le=T.useRef(nc),$=Object.keys(e).length>0,{attributes:X}=T.useContext(qy);let re=I;!re&&!A&&(re=pF);const he=De=>{clearTimeout(Se.current),De.persist(),R(!0),Se.current=window.setTimeout(()=>{bF(t,x?.id,De.target,X)},CF)},Te=()=>{clearTimeout(Se.current),R(!1)},Ue=De=>{yF(t,x?.id,De.target,X),f(t,De)},te=De=>{p(t,De)};Le.current=De=>{w(!0),ur.debug(`GIF ${t.id} seen. ${t.title}`),vF(t,x?.id,De.boundingClientRect,X),y?.(t,De.boundingClientRect),J.current&&J.current.disconnect()};const Oe=()=>{J.current||(J.current=new IntersectionObserver(([De])=>{De.isIntersecting&&Le.current(De)},{threshold:[.99]})),!H&&oe.current&&J.current&&J.current.observe(oe.current)},Ie=De=>{Oe(),b(t,De),P(Ya.imgLoadedClassName)};T.useEffect(()=>{var De,K;(De=G.current)!=null&&De.complete&&(Oe(),b(t)),(K=J.current)==null||K.disconnect(),w(!1)},[t.id]),T.useEffect(()=>(Z.current=new IntersectionObserver(([De])=>{const{isIntersecting:K}=De;L(K),!K&&J.current&&J.current.disconnect()}),Z.current.observe(oe.current),()=>{Z.current&&Z.current.disconnect(),J.current&&J.current.disconnect(),Se.current&&clearTimeout(Se.current)}),[]);const We=$p(t,n);let ke=o;!F?.aspectRatio&&!o&&(ke=We);const fe=QU(t.images,n,o||We);if(!fe)return t.images?console.error(`no rendition for ${t.id}, rendition names: ${Object.keys(t.images).join(", ")}`):console.error(`no rendition for ${t.id} - no images`),null;const Re=t.images[fe.renditionName],ye=U===Ya.imgLoadedClassName&&!t.is_sticker?"unset":k||(t.is_sticker?"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4AQMAAACSSKldAAAABlBMVEUhIiIWFhYoSqvJAAAAGElEQVQY02MAAv7///8PWxqIPwDZw5UGABtgwz2xhFKxAAAAAElFTkSuQmCC') 0 0":ne.current),Ve=V?"hidden":"unset";return ve.createElement(SF,{as:N?"div":"a",href:N?void 0:t.url,"data-giphy-id":t.id,"data-giphy-is-sticker":t.is_sticker,style:na({width:r||n,height:a||ke,overflow:Ve,borderRadius:V},F),className:[Ya.className,h].join(" "),onMouseOver:he,onMouseLeave:Te,onClick:Ue,onContextMenu:De=>u(t,De),onKeyPress:te,tabIndex:j,ref:oe},ve.createElement("picture",null,ve.createElement("source",{type:"image/webp",srcSet:D?Re.webp:j4,suppressHydrationWarning:!0}),ve.createElement("img",{ref:G,suppressHydrationWarning:!0,className:[Ya.imgClassName,U].join(" "),src:D?Re.url:j4,style:{background:ye},width:"100%",height:"100%",alt:WU(t),onLoad:D?Ie:()=>{}})),$&&((B=e?.tags)==null?void 0:B.map((De,K)=>ve.createElement(wF,{src:De,key:K}))),re&&ve.createElement(NF,null,D&&ve.createElement(re,{gif:t,isHovered:S,width:n,height:ke})))};Ya.className="giphy-gif";Ya.imgClassName="giphy-gif-img";Ya.imgLoadedClassName="giphy-img-loaded";var Yd=Ya,AF=ot.div`
    -webkit-overflow-scrolling: touch;
    overflow-x: auto;
    overflow-y: hidden;
    white-space: nowrap;
    position: relative;
`,RF=ot(Yd)`
    position: relative;
    display: inline-block;
    list-style: none;
    margin-left: ${t=>t.$ml}px;
    /* make sure gifs are fully visible with a scrollbar */
    margin-bottom: 1px;

    &:first-of-type {
        margin-left: 0;
    }
    .${Yd.imgClassName} {
        position: absolute;
        top: 0;
        left: 0;
    }
`,IF=ot(Y3)`
    display: inline-block;
`,jF=ot.div`
    width: 30px;
    display: inline-block;
    opacity: ${t=>t.$isFirstLoad?0:1};
    height: ${t=>t.$height}px;
`,DF=Object.freeze({gutter:6,user:{},initialGifs:[]}),PF=Object.freeze({isFetching:!1,gifs:[],isLoaderVisible:!1,isDoneFetching:!1}),X3=class W3 extends T.PureComponent{constructor(){super(...arguments),this.state=Ub(na({},PF),{gifs:this.props.initialGifs||[]}),this.unmounted=!1,this.paginator=FA(this.props.fetchGifs,this.state.gifs),this.onLoaderVisible=e=>{this.unmounted||this.setState({isLoaderVisible:e},this.onFetch)},this.onFetch=Mb(100,()=>zb(this,null,function*(){if(this.unmounted)return;const{isFetching:e,isLoaderVisible:n,gifs:r}=this.state;if(!e&&n){this.setState({isFetching:!0});let a;try{a=yield this.paginator()}catch{this.setState({isFetching:!1})}if(a)if(!!!a?.skipCountCheck&&r.length===a.length)this.setState({isDoneFetching:!0});else{this.setState({gifs:a,isFetching:!1});const{onGifsFetched:u}=this.props;u&&u(a),this.onFetch()}}}))}componentDidMount(){this.unmounted=!1,this.onFetch()}componentWillUnmount(){this.unmounted=!0}render(){const{onGifVisible:e,onGifRightClick:n,gifHeight:r,gifWidth:a,gutter:o,className:u=W3.className,onGifSeen:h,onGifClick:f,onGifKeyPress:p,user:y,overlay:b,hideAttribution:x,noLink:k,noResultsMessage:I,backgroundColor:A,borderRadius:N,tabIndex:V=0,loaderConfig:F}=this.props,{gifs:j,isDoneFetching:O}=this.state,B=!O,H=j.length===0;return ve.createElement(Q3,{attributes:{layout_type:"CAROUSEL"}},ve.createElement(AF,{className:u},j.map(w=>ve.createElement(RF,{gif:w,key:w.id,tabIndex:V,width:a||XU(w,r),height:r,onGifClick:f,onGifKeyPress:p,onGifSeen:h,onGifVisible:e,onGifRightClick:n,user:y,$ml:o,overlay:b,hideAttribution:x,noLink:k,borderRadius:N,backgroundColor:A})),!B&&j.length===0&&I,B&&ve.createElement(IF,{onVisibleChange:this.onLoaderVisible,config:F},ve.createElement(jF,{$isFirstLoad:H,$height:r}))))}};X3.className="giphy-carousel";X3.defaultProps=DF;var MF=ot.div`
    color: ${B3};
    display: flex;
    justify-content: center;
    margin: 30px 0;
    font-family: interface, Helvetica Neue, helvetica, sans-serif;
    font-size: 16px;
    font-weight: 600;
    a {
        color: ${Pb};
        cursor: pointer;
        &:hover {
            color: white;
        }
    }
`,OF=({onClick:t})=>ve.createElement(MF,null,"Error loading GIFs.",ve.createElement("a",{onClick:t},"Try again?")),LF=OF,VF=.75;ot.div`
    align-items: center;
    background-color: ${({$backgroundColor:t})=>t};
    border-radius: 16px;
    display: flex;
    max-width: fit-content;
    overflow: hidden;
    padding: 4px 5px 5px 6px;
`;ot.div`
    overflow-x: auto;
    overflow-y: hidden;
    position: relative;
    -webkit-overflow-scrolling: touch;
`;ot.div`
    display: inline-flex;
    justify-content: space-between;
    overflow: hidden;
    white-space: nowrap;
    width: ${({$width:t})=>`${t}px`};
`;ot.div`
    background-color: ${({$color:t})=>t};
    box-sizing: border-box;
    height: ${({$gifHeight:t})=>`${Math.round(t*VF)}px`};
    margin: ${({$gutter:t})=>`0 ${t}px`};
    width: 2px;
`;ot(Yd)`
    display: inline-block;
    flex-shrink: 0;
    list-style: none;
    /* make sure gifs are fully visible with a scrollbar */
    margin-bottom: 1px;
    position: relative;

    .${Yd.imgClassName} {
        position: absolute;
        top: 0;
        left: 0;
    }
`;var UF=fh`
     to {
    transform: scale(1.75) translateY(-20px);
  }
`,J3=52,zF=ot.div`
    display: flex;
    align-items: center;
    height: ${J3}px;
    margin: 0 auto;
    text-align: center;
    justify-content: center;
    animation: pulse 0.8s ease-in-out 0s infinite alternate backwards;
`,rd=ot.div`
    display: inline-block;
    height: 10px;
    width: 10px;
    margin: ${J3}px 10px 10px 10px;
    position: relative;
    box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.3);
    animation: ${UF} cubic-bezier(0.455, 0.03, 0.515, 0.955) 0.75s infinite alternate;
    background: ${t=>t.$color};
    animation-delay: ${t=>t.$delay};
`,BF=({className:t=""})=>ve.createElement(zF,{className:t},ve.createElement(rd,{$color:F3,$delay:"0"}),ve.createElement(rd,{$color:Pb,$delay:".1s"}),ve.createElement(rd,{$color:H3,$delay:".2s"}),ve.createElement(rd,{$color:$3,$delay:".3s"}),ve.createElement(rd,{$color:q3,$delay:".4s"})),FF=BF,HF=ot.div`
    opacity: ${t=>t.$isFirstLoad?0:1};
`;function D4(t,e,n=[]){return Array.apply(null,Array(t)).map((r,a)=>n[a]||e)}function $F(t,e,n,r){const a=D4(t,[]),o=D4(t,0,e);return n.forEach(u=>{const h=o.indexOf(Math.min(...o));a[h]=[...a[h],u],o[h]+=$p(u,r)}),a}var qF=Object.freeze({gutter:6,user:{},initialGifs:[]}),GF=Object.freeze({isFetching:!1,isError:!1,gifs:[],isLoaderVisible:!1,isDoneFetching:!1}),Jc=class Em extends T.PureComponent{constructor(){super(...arguments),this.state=Ub(na({},GF),{gifs:this.props.initialGifs||[]}),this.unmounted=!1,this.paginator=FA(this.props.fetchGifs,this.state.gifs),this.onLoaderVisible=e=>{this.unmounted||this.setState({isLoaderVisible:e},this.onFetch)},this.onFetch=Mb(Em.fetchDebounce,()=>zb(this,null,function*(){if(this.unmounted)return;const{isFetching:e,isLoaderVisible:n}=this.state,{externalGifs:r}=this.props,a=(r||this.state.gifs).length;if(!e&&n){this.setState({isFetching:!0,isError:!1});let o;try{if(o=yield this.paginator(r),this.unmounted)return}catch(u){if(this.unmounted)return;this.setState({isFetching:!1,isError:!0});const{onGifsFetchError:h}=this.props;h&&h(u)}if(o)if(!!!o?.skipCountCheck&&a===o.length)this.setState({isDoneFetching:!0});else{this.setState({gifs:o,isFetching:!1});const{onGifsFetched:h}=this.props;h&&h(o),this.onFetch()}}}))}componentDidMount(){this.unmounted=!1,this.onFetch()}componentWillUnmount(){this.unmounted=!0}render(){const{onGifVisible:e,onGifRightClick:n,className:r=Em.className,onGifSeen:a,onGifClick:o,onGifKeyPress:u,user:h,overlay:f,hideAttribution:p,noLink:y,borderRadius:b,noResultsMessage:x,columns:k,width:I,gutter:A,percentWidth:N,columnOffsets:V,backgroundColor:F,loaderConfig:j,tabIndex:O=0,layoutType:B="GRID",loader:H=FF,eagerIds:w}=this.props,{gifs:S,isError:R,isDoneFetching:D}=this.state,L=!D,U=S.length===0,P=A*(k-1),ne=(I-P)/k,oe=$F(k,V,S,ne);return ve.createElement(Q3,{attributes:{layout_type:B}},ve.createElement("div",{className:r},ve.createElement("div",{style:{width:N||I,display:"flex",gap:A}},oe.map((G=[],Z)=>ve.createElement("div",{key:Z,style:{display:"flex",flexDirection:"column",gap:A,width:N?"100%":ne,marginTop:V?.[Z]}},G.map(J=>ve.createElement(Yd,{style:{aspectRatio:J.images.original.width/J.images.original.height},gif:J,tabIndex:O,key:J.id,width:ne,percentWidth:N?"100%":void 0,onGifClick:o,onGifKeyPress:u,onGifSeen:a,onGifVisible:e,onGifRightClick:n,user:h,overlay:f,backgroundColor:F,hideAttribution:p,noLink:y,borderRadius:b,lazyLoad:!w?.includes(J.id)}))))),!L&&S.length===0&&x,R?ve.createElement(LF,{onClick:this.onFetch}):L&&ve.createElement(Y3,{onVisibleChange:this.onLoaderVisible,config:j},ve.createElement(HF,{$isFirstLoad:U},ve.createElement(H,{className:Em.loaderClassName})))))}};Jc.className="giphy-grid";Jc.loaderClassName="loader";Jc.fetchDebounce=250;Jc.defaultProps=qF;Jc.getDerivedStateFromProps=({externalGifs:t},e)=>t&&t!==e.gifs?{gifs:t}:null;var YF=Jc,Z3=YF,zn={searchbarHeight:"--searchbar-height",bgColor:"--searchbar-bg-color",bgColor2:"--searchbar-bg-color-2",fgColor:"--searchbar-fg-color",cancelButtonDisplay:"--searchbar-cancel-button-display"};ot.div`
    ${zn.searchbarHeight}: ${t=>t.$searchbarHeight||42}px;
    @media (${t=>t.$mobileMediaQuery}) {
        ${zn.searchbarHeight}: ${t=>t.$mobileSearchbarHeight||35}px;
    }
    ${zn.bgColor}: ${wm};
    ${zn.bgColor2}: ${wm};
    ${zn.fgColor}: ${Fy};
    ${t=>t.$darkMode&&Jp`
            ${zn.fgColor}: ${wm};
            ${zn.bgColor}: ${Fy};
            ${zn.bgColor2}: ${kB};
        `}
    ${zn.cancelButtonDisplay}: ${t=>t.$hideCancelButton?"none":"block"};
`;T.createContext({});T.createContext({});ot.svg`
    position: relative;
    right: 10px;
    margin-left: 5px;
    cursor: pointer;
    display: var(${zn.cancelButtonDisplay});
`;var eR=6,Fb=`calc(var(${zn.searchbarHeight}) - ${eR*2}px)`,KF=fh`
to {
    width: ${Fb};
}
`;ot(Zp)`
    height: ${Fb};
    margin: 0;
    width: 0;
    animation: ${KF} 100ms ease-in-out forwards;
`;ot.div`
    background: var(${zn.bgColor2});
    display: flex;
    align-items: center;
    padding-left: ${eR}px;
`;ot.div`
    background: ${NB};
    display: flex;
    padding: 0 4px;
    color: ${CB};
    font-family: interface, Helvetica Neue, helvetica, sans-serif;
    font-weight: 600;
    font-size: 12px;
    align-items: center;
    height: ${Fb};
    @media (max-width: 480px) {
        display: none;
    }
`;var QF=({className:t=""})=>ve.createElement("svg",{viewBox:"0 0 30 30",version:"1.1",className:t},ve.createElement("defs",null,ve.createElement("path",{d:"M11.5482521,20.4090671 L4.24727698,28.2009189 C3.68084207,28.8054377 2.73159653,28.8363108 2.12707771,28.2698759 C1.5225589,27.703441 1.4916858,26.7541954 2.0581207,26.1496766 L9.40599838,18.3077689 C7.95982241,16.4371424 7.0978836,14.0789715 7.0978836,11.5181818 C7.0978836,5.44914339 11.9392549,0.518181818 17.9252787,0.518181818 C23.9113026,0.518181818 28.7526738,5.44914339 28.7526738,11.5181818 C28.7526738,17.5872202 23.9113026,22.5181818 17.9252787,22.5181818 C15.539851,22.5181818 13.3361963,21.7351359 11.5482521,20.4090671 Z M17.9252787,19.5181818 C22.242011,19.5181818 25.7526738,15.9425536 25.7526738,11.5181818 C25.7526738,7.09381 22.242011,3.51818182 17.9252787,3.51818182 C13.6085464,3.51818182 10.0978836,7.09381 10.0978836,11.5181818 C10.0978836,15.9425536 13.6085464,19.5181818 17.9252787,19.5181818 Z",id:"giphy-search-icon-path-1"})),ve.createElement("g",{id:"search",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},ve.createElement("g",{id:"icons/search"},ve.createElement("mask",{id:"giphy-search-icon-mask-2",fill:"white"},ve.createElement("use",{xlinkHref:"#giphy-search-icon-path-1"})),ve.createElement("use",{id:"Mask",fill:"#FFFFFF",fillRule:"nonzero",xlinkHref:"#giphy-search-icon-path-1"}),ve.createElement("g",{mask:"url(#giphy-search-icon-mask-2)"},ve.createElement("g",{transform:"translate(0.250000, 0.250000)"},ve.createElement("g",null)))))),XF=QF,WF="2s",V0="#E646B6",P4="#FF6666",tR="cubic-bezier(0.920, 0.240, 0.185, 0.730)",JF=fh`
    0% {
      transform: rotate(34deg) translate(-10px, 80px);
    };
    
    100% {
      transform: rotate(34deg) translate(-10px, -20px);
    }
`,ZF=fh`
    0% { 
      transform: translate(0px, 0px);
      opacity: 0;
    }
    50% {
      opacity: 1;
    }
    100% {
      transform: translate(10px, -17px);
      opacity: 0;
    }
`,eH=fh`
    0% {
      opacity: 0;
      transform: translateX(-400%);
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 0;
      transform: translateX(0);
    }
`;ot.div`
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    cursor: pointer;
    @media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: none) {
        display: none;
    }
    height: var(${zn.searchbarHeight});
    width: var(${zn.searchbarHeight});
`;ot.div`
    position: absolute;
    height: 100%;
    width: 100%;
    background: linear-gradient(45deg, ${V0} 0%, ${P4} 100%);
    border-radius: 0 4px 4px 0;
    overflow: hidden;
    &:before {
        animation: ${eH} ${WF} linear 0s infinite;
        background-image: linear-gradient(45deg, ${V0} 0%, ${P4} 50%, ${V0} 100%);
        background-size: 400%;
        background-position: 0% 100%;
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        width: 400%;
    }
`;ot.div`
    width: 100%;
    height: 100%;
    position: absolute;
    overflow: hidden;
    &::after {
        content: '+';
        color: white;
        font-family: 'SS Standard';
        font-size: 8px;
        position: absolute;
        top: 65%;
        left: 66%;
        animation: ${ZF} 1s ${tR} 0s 1 forwards;
    }
`;ot.div`
    position: absolute;
    width: 200%;
    height: 20px;
    background: rgba(255, 255, 255, 0.5);
    transform: rotate(34deg) translate(-10px, -20px);
    animation: ${JF} 1s ${tR} 0s 1;
    filter: blur(1px);
`;ot(XF)`
    z-index: 1;
    display: flex;
    width: 50%;
    height: 50%;
`;ot.div`
    display: flex;
    background: white;
    align-items: center;
    border-radius: 4px;
    height: var(${zn.searchbarHeight});
    background: var(${zn.bgColor2});
`;ot.input`
    background: inherit;
    box-sizing: border-box;
    border: 0;
    appearance: none;
    font-weight: normal;
    font-family: interface, Helvetica Neue, helvetica, sans-serif;
    outline: 0;
    font-size: 15px;
    padding: 0 10px;
    border-radius: 0;
    text-overflow: ellipsis;
    color: var(${zn.fgColor});
    &::placeholder {
        color: ${B3};
    }
    min-width: 150px;
    flex: 1;
    ${t=>t.$isUsernameSearch&&Jp`
            color: ${AB};
        `}
`;var tH=({size:t=18,className:e})=>ve.createElement("svg",{width:t,height:t,viewBox:"0 0 18 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:e},ve.createElement("g",{id:"trending",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},ve.createElement("g",null,ve.createElement("rect",{id:"Rectangle",stroke:"#979797",fill:"#D8D8D8",opacity:"0",x:"0.5",y:"0.5",width:"17",height:"17"}),ve.createElement("path",{d:"M12.6093329,3.12057664 L15.156896,3.12057664 L9.64199318,9.04253019 L6.88133868,6.8175119 C6.7544587,6.67603813 6.56616874,6.60087259 6.38404017,6.61897279 C6.2490402,6.63288422 6.11891631,6.69661171 6.02063992,6.79697337 C2.21226835,10.5943119 0.308082561,12.4929812 0.308082561,12.4929812 C0.308082561,12.4929812 0.527106106,12.8074292 0.710953088,13.0215425 C0.833517743,13.1642848 0.975497751,13.3098497 1.13689311,13.4582373 L6.47329888,8.13191205 L9.16381134,10.2953038 C9.40800276,10.5710787 9.68933701,10.7021044 10.019278,10.4570223 L16.0239805,4.04474473 C16.0239805,5.87956383 16.0239805,6.79697337 16.0239805,6.79697337 C16.0239805,6.79697337 16.4320205,6.79697337 17.2481004,6.79697337 L17.2481004,1.80604505 C14.1555887,1.80604505 12.6093329,1.80604505 12.6093329,1.80604505 C12.6093329,1.80604505 12.6093329,2.24422225 12.6093329,3.12057664 Z",id:"Shape",stroke:"#00CCFF",strokeWidth:"0.4",fill:"#00CCFF",fillRule:"nonzero",transform:"translate(8.778091, 7.632141) rotate(-2.000000) translate(-8.778091, -7.632141) "})))),nH=tH,nR=9;ot.div`
    background: ${z3};
    display: flex;
    padding-right: 4px;
    align-items: center;
    margin-right: ${nR}px;
    cursor: pointer;
`;ot.div`
    background: ${z3};
    display: flex;
    padding: 14px;
    align-items: center;
    margin-right: ${nR}px;
    white-space: nowrap;
    cursor: pointer;
    font-style: italic;
    border-radius: 20px;
`;ot(Zp)`
    height: var(${zn.searchbarHeight});
    width: var(${zn.searchbarHeight});
`;ot(nH)`
    margin-right: 2px;
`;ot.div`
    display: flex;
    color: white;
    flex-direction: row;
    font-family: 'interface';
    font-weight: 600;
    font-size: 14px;
    -webkit-overflow-scrolling: touch;
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: 10px;
    height: var(${zn.searchbarHeight});
`;var rH=({onClick:t})=>ve.createElement("svg",{width:"66px",height:"13px",viewBox:"0 0 66 13",onClick:t},ve.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},ve.createElement("g",{transform:"translate(-1060.000000, -462.000000)",fill:"#FFFFFF",fillRule:"nonzero"},ve.createElement("g",{transform:"translate(931.000000, 286.375671)"},ve.createElement("g",{transform:"translate(86.000000, 136.124329)"},ve.createElement("path",{d:"M47.968,49.1962322 C49.588,49.1962322 51.052,48.6202322 51.58,47.5522322 L51.58,43.8202322 L47.476,43.8202322 L47.476,45.6802322 L49.6,45.6802322 L49.6,46.7602322 C49.12,47.1082322 48.424,47.1922322 47.98,47.1922322 C46.288,47.1922322 45.724,45.8602322 45.724,44.7802322 C45.724,43.1362322 46.612,42.3202322 47.98,42.3202322 C48.544,42.3202322 49.288,42.4762322 49.9,43.0522322 L51.28,41.6842322 C50.176,40.5682322 49.144,40.3282322 47.98,40.3282322 C44.824,40.3282322 43.384,42.5842322 43.384,44.7802322 C43.384,46.9762322 44.644,49.1962322 47.968,49.1962322 Z M54.928,48.9682322 L54.928,40.5682322 L52.564,40.5682322 L52.564,48.9682322 L54.928,48.9682322 Z M58.648,48.9682322 L58.648,46.7002322 L60.352,46.7002322 C62.596,46.6762322 63.724,45.3442322 63.724,43.6282322 C63.724,41.9842322 62.608,40.5682322 60.352,40.5682322 L56.272,40.5682322 L56.272,48.9682322 L58.648,48.9682322 Z M60.352,44.6962322 L58.648,44.6962322 L58.648,42.6082322 L60.352,42.6082322 C61,42.6082322 61.348,43.1122322 61.348,43.6642322 C61.348,44.2162322 61.012,44.6962322 60.352,44.6962322 Z M66.796,48.9802322 L66.796,45.8002322 L69.82,45.8002322 L69.82,48.9802322 L72.172,48.9802322 L72.172,40.5802322 L69.82,40.5802322 L69.82,43.7722322 L66.796,43.7722322 L66.796,40.5802322 L64.42,40.5802322 L64.42,48.9802322 L66.796,48.9802322 Z M78.16,48.9682322 L78.16,45.6202322 L81.496,40.6762322 L81.496,40.5682322 L78.82,40.5682322 L77.008,43.4482322 L75.268,40.5682322 L72.592,40.5682322 L72.592,40.6642322 L75.784,45.6202322 L75.784,48.9682322 L78.16,48.9682322 Z M87.796,49.1362322 C88.972,49.1362322 90.088,48.7402322 90.952,47.8882322 L90.028,46.9642322 C89.44,47.5522322 88.576,47.8762322 87.796,47.8762322 C85.624,47.8762322 84.712,46.3522322 84.7,44.8162322 C84.688,43.2682322 85.66,41.6962322 87.796,41.6962322 C88.576,41.6962322 89.368,41.9722322 89.968,42.5602322 L90.868,41.6962322 C90.016,40.8442322 88.924,40.4242322 87.796,40.4242322 C84.796,40.4242322 83.356,42.6202322 83.3679256,44.8282322 C83.38,47.0362322 84.748,49.1362322 87.796,49.1362322 Z M93.028,48.9682322 L93.028,40.5802322 L91.792,40.5802322 L91.792,48.9682322 L93.028,48.9682322 Z M94.252,41.3122322 C94.252,42.3322322 95.788,42.3322322 95.788,41.3122322 C95.788,40.3042322 94.252,40.3042322 94.252,41.3122322 Z M95.632,48.9682322 L95.632,43.0282322 L94.396,43.0282322 L94.396,48.9682322 L95.632,48.9682322 Z M98.188,51.7162322 L98.188,48.1042322 C98.632,48.8362322 99.556,49.1002322 100.276,49.1002322 C102.112,49.1002322 103.264,47.8042322 103.264,46.0162322 C103.264,44.2282322 102.04,42.9442322 100.276,42.9322322 C99.484,42.9322322 98.644,43.2922322 98.188,44.0122322 L98.116,43.0522322 L96.952,43.0522322 L96.952,51.7162322 L98.188,51.7162322 Z M100.156,47.9002322 C99.076,47.9002322 98.296,47.0722322 98.296,46.0162322 C98.296,44.9602322 99.016,44.1322322 100.156,44.1322322 C101.284,44.1322322 102.028,44.9002322 102.028,46.0162322 C102.028,47.1202322 101.236,47.9002322 100.156,47.9002322 Z M106.456,49.1482322 C107.992,49.1482322 108.964,48.3802322 108.976,47.2762322 C108.988,45.7522322 107.56,45.5122322 106.468,45.4162322 C105.712,45.3442322 105.196,45.1522322 105.184,44.6602322 C105.184,44.1922322 105.688,43.9402322 106.444,43.9522322 C107.032,43.9522322 107.536,44.0722322 108.004,44.5042322 L108.7,43.6882322 C108.04,43.1002322 107.332,42.8962322 106.42,42.8962322 C105.316,42.8962322 103.96,43.3882322 103.96,44.6962322 C103.972,46.0042322 105.256,46.3642322 106.372,46.4722322 C107.248,46.5562322 107.752,46.7602322 107.74,47.2882322 C107.728,47.8402322 107.068,48.0562322 106.48,48.0562322 C105.784,48.0442322 104.956,47.7922322 104.404,47.1802322 L103.756,48.0562322 C104.536,48.9322322 105.496,49.1482322 106.456,49.1482322 Z",id:"GIPHYClips"})))))),sH=rH,iH=ot.div`
    display: flex;
    align-items: center;
    font-family: interface, helvetica, arial;
    cursor: pointer;
`,aH=ot(Zp)`
    flex-shrink: 0;
`,oH=ot.div`
    display: flex;
    flex-direction: column;
`,Hb=({gif:t,className:e,onClick:n})=>{const{user:r}=t;return!r?.username&&!r?.display_name?null:ve.createElement(iH,{className:[Hb.className,e].join(" "),onClick:a=>{if(a.preventDefault(),a.stopPropagation(),n)n(t);else{const o=r.profile_url;o&&window.open(o,"_blank")}}},ve.createElement(aH,{user:r}),ve.createElement(oH,null,ve.createElement(sH,{onClick:a=>{a.preventDefault(),a.stopPropagation(),n?n(t):t.url&&window.open(t.url,"_blank")}}),ve.createElement(G3,{user:r})))};Hb.className="giphy-attribution";var lH=Hb,rR=25,cH=({size:t=rR,onClick:e=()=>{}})=>ve.createElement("svg",{width:t,height:t,viewBox:"0 0 26 23",onClick:e},ve.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},ve.createElement("g",{transform:"translate(1.000000, 0.000000)",fill:"#FFF",fillRule:"nonzero"},ve.createElement("path",{d:"M11.9625091,0.572584405 L11.9625091,22.2272644 C11.9625091,22.4856644 11.8466091,22.6635044 11.6151891,22.7611644 C11.3480491,22.8413444 11.1390491,22.7968844 10.9878091,22.6277844 L4.8732291,15.9143244 L0.573909096,15.9143244 C0.413549096,15.9143244 0.277509096,15.8588444 0.166549096,15.7475044 C0.0573082348,15.6406091 -0.00292164572,15.4933347 -1.77635684e-15,15.3405244 L-1.77635684e-15,7.45058441 C-1.77635684e-15,7.29022441 0.0555890961,7.15456441 0.167309096,7.04322441 C0.278269096,6.93226441 0.414309096,6.87640441 0.573909096,6.87640441 L4.8732291,6.87640441 L10.9874291,0.172064405 C11.1390491,0.00296440549 11.3484291,-0.0414955945 11.6151891,0.0386844055 C11.8466091,0.136344405 11.9621291,0.314564405 11.9621291,0.572584405 L11.9625091,0.572584405 Z"}),ve.createElement("path",{d:"M15.7579491,16.0914044 L14.6798891,13.6594044 C15.5739159,13.2635547 16.1503537,12.3776671 16.1501091,11.3999244 C16.150386,10.4242626 15.5763999,9.53983269 14.6852091,9.14272441 L15.7697291,6.71376441 C17.6193585,7.53872062 18.810518,9.37466359 18.8101092,11.3999244 C18.8105521,13.4298903 17.6139475,15.2691931 15.7579491,16.0914044 L15.7579491,16.0914044 Z"}),ve.createElement("path",{d:"M18.3647491,20.2619044 L17.2863091,17.8299044 C19.8302925,16.7031661 21.4705725,14.1822599 21.4701091,11.3999244 C21.4701091,8.59818441 19.8167291,6.09892441 17.3022691,4.97678441 L18.3864091,2.54782441 C21.8804724,4.10607079 24.1307363,7.57414217 24.1301093,11.3999244 C24.1308375,15.2343934 21.8705556,18.7086904 18.3647491,20.2619044 Z"})))),uH=({size:t=rR,onClick:e=()=>{}})=>ve.createElement("svg",{onClick:e,height:t,width:t,viewBox:"0 0 26 23",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},ve.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},ve.createElement("g",{id:"Group",transform:"translate(1.000000, 0.000000)",fill:"#FFFFFF",fillRule:"nonzero"},ve.createElement("path",{d:"M11.9625091,0.572584405 L11.9625091,22.2272644 C11.9625091,22.4856644 11.8466091,22.6635044 11.6151891,22.7611644 C11.3480491,22.8413444 11.1390491,22.7968844 10.9878091,22.6277844 L4.8732291,15.9143244 L0.573909096,15.9143244 C0.413549096,15.9143244 0.277509096,15.8588444 0.166549096,15.7475044 C0.0573082348,15.6406091 -0.00292164572,15.4933347 0,15.3405244 L0,7.45058441 C0,7.29022441 0.0555890961,7.15456441 0.167309096,7.04322441 C0.278269096,6.93226441 0.414309096,6.87640441 0.573909096,6.87640441 L4.8732291,6.87640441 L10.9874291,0.172064405 C11.1390491,0.00296440549 11.3484291,-0.0414955945 11.6151891,0.0386844055 C11.8466091,0.136344405 11.9621291,0.314564405 11.9621291,0.572584405 L11.9625091,0.572584405 Z",id:"Path"})),ve.createElement("g",{id:"Group",transform:"translate(14.887009, 6.947630)",fill:"#FFFFFF",fillRule:"nonzero"},ve.createElement("path",{d:"M7.88199149,6.27905236 C7.94693088,6.35707599 7.94693088,6.47033309 7.88199149,6.54835671 L6.54835671,7.88199149 C6.47033309,7.94693088 6.35707599,7.94693088 6.27905236,7.88199149 L3.96534802,5.56828715 L1.65164367,7.88199149 C1.57362004,7.94693088 1.46036294,7.94693088 1.38233932,7.88199149 L0.0487045381,6.54835671 C-0.016234846,6.47033309 -0.016234846,6.35707599 0.0487045381,6.27905236 L2.36240889,3.96534802 L0.0487045381,1.65164367 C-0.016234846,1.57362004 -0.016234846,1.46036294 0.0487045381,1.38233932 L1.38233932,0.0487045381 C1.46036294,-0.016234846 1.57362004,-0.016234846 1.65164367,0.0487045381 L3.96534802,2.36240889 L6.27905236,0.0487045381 C6.35707599,-0.016234846 6.47033309,-0.016234846 6.54835671,0.0487045381 L7.88199149,1.38233932 C7.94693088,1.46036294 7.94693088,1.57362004 7.88199149,1.65164367 L5.56828715,3.96534802 L7.88199149,6.27905236 Z",id:"Shape"})))),dH=ot.div`
    background: ${wm};
    height: ${t=>t.$barHeight}px;
    position: absolute;
    width: 5px;
    bottom: 0;
    left: 0;
    opacity: 0.95;
`,hH=({videoEl:t})=>{QB(2147483647,100);const e=t?.currentTime||0,n=t?.duration||0,r=e/n;let a=Math.round(r*100),o=5;return t?.height<200?o=3:t?.height<300&&(o=4),a=n<10&&a>98?100:a,ve.createElement(dH,{style:{width:`${a}%`},$barHeight:o,className:"hide-in-percy"})},fH=hH,mH=(t,e="")=>{switch(t){case 1:return"Aborted. The fetching process for the media resource was aborted by the user agent at the user's request.";case 2:return"Network Error. A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";case 3:return"Decode Error. An error of some description occurred while decoding the media resource, after the resource was established to be usable.";case 4:return`Can not play a video of type "${e.split(".").pop()}" on this platform.`;default:return""}},pH=(t,e,n,r,a)=>{const o=a+t;return!r.has(o)&&n>0&&e>n*t?(r.add(o),!0):!1},gH=[.25,.5,.75],sR="giphy-video",vH={IDLE:1},iR=({muted:t,ccEnabled:e=!1,ccLanguage:n="en",loop:r=!0,onStateChange:a,onTimeUpdate:o,onCanPlay:u,onFirstPlay:h,onWaiting:f,onMuted:p,onError:y,onEnded:b,onLoop:x,onQuartile:k,onEndFullscreen:I,setVideoEl:A,gif:N,width:V,percentWidth:F,height:j,volume:O=.7,className:B=sR,isInPlayer:H})=>{var w,S,R;const D=j||$p(N,V);let L;F&&(L=`${Math.round(D/V*100)}%`);const[U,P]=T.useState(QS(N.video,V,D)),ne=T.useRef(0);U||console.warn(`GiphyJS No video content for id: ${N.id}`);const oe=T.useRef(Date.now()),G=T.useRef(!1),Z=T.useRef(0),J=T.useRef(0),Se=T.useRef(new Set);T.useEffect(()=>{oe.current=Date.now(),G.current=!1,Z.current=1,J.current=0,Se.current=new Set},[N.id]);const Le=T.useRef(null);T.useEffect(()=>{const ke=QS(N.video,V,D);Le.current&&U?.url&&ke.url!==U.url&&(U.url.indexOf(String(N.id))!==-1&&(ne.current=Le.current.currentTime),P(ke))},[V,j,N.video,D,U?.url,N.id]),T.useEffect(()=>{Le.current&&U?.url&&ne.current&&(Le.current.currentTime=ne.current,ne.current=0)},[U?.url,ne]);const $=T.useCallback(()=>{var ke;const fe=Le.current,Re=(ke=fe?.error)==null?void 0:ke.code;if(Re&&fe?.src){const dt=mH(Re,fe?.src);console.error(dt),y?.(Re)}},[y]),X=T.useCallback(()=>{a?.("playing"),G.current||(G.current=!0,N.analytics_response_payload&&Vb({actionType:"START",analyticsResponsePayload:N.analytics_response_payload}),h?.(Date.now()-oe.current))},[h,a,N]),re=T.useCallback(()=>a?.("paused"),[a]),he=T.useCallback(()=>{const ke=Le.current;if(ke){const fe=ke.currentTime;gH.some(Re=>pH(Re,fe,ke.duration,Se.current,Z.current)?(k?.(Re),!0):!1),o?.(fe||0)}},[k,o]),Te=T.useCallback(()=>u?.(),[u]),Ue=T.useCallback(()=>{const ke=Le.current;ke?.currentTime!==0&&ke?.networkState!==vH.IDLE&&f?.(++J.current)},[f]),te=T.useCallback(()=>{r&&Le.current&&Le.current.play(),x?.(Z.current),Z.current=Z.current+1,G.current&&b?.()},[b,r,x]),Oe=T.useCallback(()=>I?.(),[I]),Ie=T.useCallback(ke=>zb(void 0,null,function*(){if(ke){const fe=ke.play();if(fe!==void 0)try{yield fe,p?.(!1)}catch{ke.muted=!0,p?.(!0),ke.play()}}}),[p]);T.useEffect(()=>{const ke=Le.current;ke&&(Ie(ke),A?.(ke),isNaN(O)||(ke.volume=O))},[]),T.useEffect(()=>{const ke=Le.current;return ke&&(ke.addEventListener("play",X),ke.addEventListener("pause",re),ke.addEventListener("error",$),ke.addEventListener("timeupdate",he),ke.addEventListener("canplay",Te),ke.addEventListener("ended",te),ke.addEventListener("waiting",Ue),ke.addEventListener("webkitendfullscreen",Oe)),()=>{ke&&(ke.removeEventListener("play",X),ke.removeEventListener("pause",re),ke.removeEventListener("error",$),ke.removeEventListener("timeupdate",he),ke.removeEventListener("canplay",Te),ke.removeEventListener("ended",te),ke.removeEventListener("waiting",Ue),ke.removeEventListener("webkitendfullscreen",Oe))}},[X,re,$,he,Te,te,Ue,Oe]);const We=(R=(S=(w=N.video)==null?void 0:w.captions)==null?void 0:S[n])==null?void 0:R.vtt;return U?.url?ve.createElement("video",{crossOrigin:"anonymous",draggable:!0,className:B,width:H?"100%":F||V,height:H?"100%":L||D,muted:t,autoPlay:!0,playsInline:!0,ref:Le,src:U?.url,"data-giphy-id":N.id},e&&We&&ve.createElement("track",{label:"English",kind:"subtitles",srcLang:n,src:We,default:!0})):null};iR.className=sR;var aR=iR,yH=ot.div`
    position: relative;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: black;
    font-family: interface, helvetica, arial;
    -webkit-font-smoothing: antialiased;
`,bH=ot.div`
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    cursor: pointer;
`,xH=ot.div`
    position: absolute;
    top: 10px;
    right: 10px;
    left: 10px;
    bottom: 0;
    display: flex;
    justify-content: space-between;
    opacity: ${t=>t.$isHovered?1:0};
    transition: opacity ease-out 250ms;
    align-items: flex-start;
`,_H=ot.div`
    font-size: 22px;
    color: white;
    margin-bottom: 5px;
    font-weight: bold;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
    user-select: none;
    cursor: pointer;
`,wH=ot.div`
    position: relative;
    min-width: 0;
`,EH=ot.div`
    &:before {
        background: linear-gradient(rgba(18, 18, 18, 0.6), rgba(0, 0, 0, 0));
        content: '';
        height: ${t=>t.$isLargePlayer?125:75}px;
        left: 0;
        pointer-events: none;
        position: absolute;
        top: 0;
        width: 100%;
    }
    &:after {
        background: linear-gradient(rgba(0, 0, 0, 0), rgba(18, 18, 18, 0.6));
        content: '';
        height: ${t=>t.$isLargePlayer?125:75}px;
        left: 0;
        pointer-events: none;
        position: absolute;
        bottom: 0;
        width: 100%;
    }
`,SH=300,TH=4e3,CH=t=>{const{style:e,width:n,percentWidth:r,hideMute:a,hideAttribution:o,hideProgressBar:u,hideTitle:h,className:f,persistentControls:p,gif:y,overlay:b}=t,[x,k]=T.useState(!1),[I,A]=T.useState(null),[N,V]=T.useState(t.muted),[F,j]=T.useState(!1),{setVideoEl:O,onMuted:B,onUserMuted:H}=t,w=t.height||$p(y,n);let S;r&&(S=`${Math.round(w/n*100)}%`);const[,R,D]=$B(()=>{k(!1)},TH),L=T.useCallback(G=>{B?.(G),j(G)},[j,B]),U=T.useCallback(G=>{O?.(G),A(G)},[O,A]),P=()=>{F?(j(!1),V(!1)):V(!N)};T.useEffect(()=>{V(t.muted)},[t.muted]);const ne=p||x,oe=w>=SH;return T.useEffect(()=>(ne?D():R(),()=>R()),[ne,R,D]),ve.createElement(yH,{className:f,style:na({width:r||n,height:S||w},e),onMouseOver:()=>k(!0),onMouseLeave:()=>k(!1),onMouseMove:()=>{k(!0),D()},onClick:G=>{H?.(!(N||F)),I?.play(),G.preventDefault(),P()}},ve.createElement(aR,Ub(na({},t),{isInPlayer:!0,onMuted:L,setVideoEl:U,muted:N})),ne&&ve.createElement(EH,{$isLargePlayer:oe}),ve.createElement(xH,{$isHovered:ne},ve.createElement(wH,null,!h&&oe&&ve.createElement(_H,{onClick:G=>{G.preventDefault(),G.stopPropagation(),window.open(y.url,"_blank")}},y.title),I&&!o?ve.createElement(lH,{gif:y}):null),!a&&ve.createElement(bH,null,N||F?ve.createElement(uH,null):ve.createElement(cH,null))),ne&&!u&&I?ve.createElement(fH,{videoEl:I}):null,b&&ve.createElement(b,{gif:y,isHovered:x,width:n,height:w}))},kH=t=>(t.overlay&&!t.controls&&console.warn(`${ur.PREFIX}: Overlays only work when controls are enabled`),t.controls?ve.createElement(CH,na({},t)):ve.createElement(aR,na({},t))),NH=kH;ot.div`
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    height: 100%;
    width: 100%;
`;ot(NH)`
    height: 100%;
    display: inline-block;
    object-fit: fill;
    pointer-events: none;
    background: rgb(0, 0, 0, 0);
`;ot.div`
    position: absolute;
    top: 6px;
    right: 6px;
    cursor: pointer;
    opacity: ${t=>t.$isHovered?1:.8};
    transition: opacity ease-out 800ms;
`;Iy("X-GIPHY-SDK-NAME","ReactSDK");const AH="9S3bPWJJTZZdynuLXHFSBstNA5B6tes9",M4=new BA(AH),RH=({onSelect:t})=>{const[e,n]=T.useState(""),[r,a]=T.useState(400),o=T.useRef(null);T.useEffect(()=>{o.current&&a(o.current.offsetWidth)},[]);const u=h=>e?M4.search(e,{offset:h,limit:10}):M4.trending({offset:h,limit:10});return c.jsxs("div",{className:"w-full h-full flex flex-col bg-dark-sidebar rounded-lg overflow-hidden border border-dark-hover",children:[c.jsx("div",{className:"p-3 border-b border-dark-hover",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search GIFs...",value:e,onChange:h=>n(h.target.value),className:"w-full bg-dark-input text-dark-text px-4 py-2 pl-10 rounded outline-none border border-transparent focus:border-brand-primary transition-all",autoFocus:!0}),c.jsx(cb,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-dark-muted",size:20})]})}),c.jsx("div",{ref:o,className:"flex-1 overflow-y-auto overflow-x-hidden p-2 custom-scrollbar",children:r>0&&c.jsx(Z3,{width:r-20,columns:3,fetchGifs:u,onGifClick:(h,f)=>{f.preventDefault(),t(h.images.original.url)},noLink:!0,hideAttribution:!0,gutter:6},e)})]})},IH="9S3bPWJJTZZdynuLXHFSBstNA5B6tes9",O4=new BA(IH),jH=({onSelect:t})=>{const[e,n]=T.useState(""),[r,a]=T.useState(400),o=T.useRef(null);T.useEffect(()=>{o.current&&a(o.current.offsetWidth)},[]);const u=h=>e?O4.search(e,{offset:h,limit:10,type:"stickers"}):O4.trending({offset:h,limit:10,type:"stickers"});return c.jsxs("div",{className:"w-full h-full flex flex-col bg-dark-sidebar rounded-lg overflow-hidden border border-dark-hover",children:[c.jsx("div",{className:"p-3 border-b border-dark-hover bg-brand-primary/10",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search Premium Stickers...",value:e,onChange:h=>n(h.target.value),className:"w-full bg-dark-input text-dark-text px-4 py-2 pl-10 rounded outline-none border border-transparent focus:border-brand-primary transition-all placeholder:text-dark-muted",autoFocus:!0}),c.jsx(cb,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-dark-muted",size:20})]})}),c.jsx("div",{className:"px-3 py-1 bg-brand-primary/5 text-[10px] text-brand-primary text-center font-bold tracking-wider uppercase",children:"Premium Stickers"}),c.jsx("div",{ref:o,className:"flex-1 overflow-y-auto overflow-x-hidden p-2 custom-scrollbar",children:r>0&&c.jsx(Z3,{width:r-20,columns:3,fetchGifs:u,onGifClick:(h,f)=>{f.preventDefault(),t(h.images.original.url)},noLink:!0,hideAttribution:!0,gutter:6},e)})]})},DH=({onSubmit:t,onClose:e})=>{const[n,r]=T.useState(""),[a,o]=T.useState(["",""]),[u,h]=T.useState(!1),[f,p]=T.useState(!1),y=()=>{a.length<10&&o([...a,""])},b=A=>{a.length>2&&o(a.filter((N,V)=>V!==A))},x=(A,N)=>{const V=[...a];V[A]=N,o(V)},k=()=>{const A=a.filter(N=>N.trim()!=="");n.trim()&&A.length>=2&&(t({question:n.trim(),options:A,multipleChoice:u,anonymous:f}),e())},I=n.trim()&&a.filter(A=>A.trim()).length>=2;return c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-dark-sidebar rounded-lg w-full max-w-md mx-4 shadow-2xl animate-fadeIn",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-hover",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(db,{className:"text-brand-primary",size:24}),c.jsx("h2",{className:"text-lg font-semibold text-dark-text",children:"Create Poll"})]}),c.jsx("button",{onClick:e,className:"p-1 hover:bg-dark-hover rounded transition-colors",children:c.jsx($n,{className:"text-dark-muted",size:20})})]}),c.jsxs("div",{className:"p-4 space-y-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-dark-muted mb-2",children:"Question"}),c.jsx("input",{type:"text",value:n,onChange:A=>r(A.target.value),placeholder:"Ask a question...",maxLength:300,className:`w-full bg-dark-input text-dark-text px-4 py-3 rounded-lg
                         border border-transparent focus:border-brand-primary
                         outline-none transition-colors`,autoFocus:!0}),c.jsxs("div",{className:"text-xs text-dark-muted mt-1 text-right",children:[n.length,"/300"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-dark-muted mb-2",children:"Options"}),c.jsx("div",{className:"space-y-2",children:a.map((A,N)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"text-dark-muted text-sm w-6",children:[N+1,"."]}),c.jsx("input",{type:"text",value:A,onChange:V=>x(N,V.target.value),placeholder:`Option ${N+1}`,maxLength:100,className:`flex-1 bg-dark-input text-dark-text px-3 py-2 rounded
                               border border-transparent focus:border-brand-primary
                               outline-none transition-colors text-sm`}),a.length>2&&c.jsx("button",{onClick:()=>b(N),className:"p-1 hover:bg-red-500/20 text-red-400 rounded transition-colors",children:c.jsx($n,{size:18})})]},N))}),a.length<10&&c.jsxs("button",{onClick:y,className:"mt-2 flex items-center gap-1 text-sm text-brand-primary hover:text-brand-primary/80 transition-colors",children:[c.jsx(Yo,{size:18}),"Add Option"]})]}),c.jsxs("div",{className:"space-y-3 pt-2 border-t border-dark-hover",children:[c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[c.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${u?"bg-brand-primary border-brand-primary":"border-dark-muted group-hover:border-dark-text"}`,children:u&&c.jsx(el,{size:14,className:"text-white"})}),c.jsx("span",{className:"text-dark-text text-sm",children:"Allow multiple selections"}),c.jsx("input",{type:"checkbox",checked:u,onChange:A=>h(A.target.checked),className:"sr-only"})]}),c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[c.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${f?"bg-brand-primary border-brand-primary":"border-dark-muted group-hover:border-dark-text"}`,children:f&&c.jsx(el,{size:14,className:"text-white"})}),c.jsx("span",{className:"text-dark-text text-sm",children:"Anonymous voting"}),c.jsx("input",{type:"checkbox",checked:f,onChange:A=>p(A.target.checked),className:"sr-only"})]})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-dark-hover",children:[c.jsx(st,{variant:"secondary",onClick:e,children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:k,disabled:!I,children:"Create Poll"})]})]})})},PH=(t,e)=>{if(e===0)return"0 KB/s";const n=t/e;return n>1024*1024?`${(n/(1024*1024)).toFixed(1)} MB/s`:`${(n/1024).toFixed(0)} KB/s`},MH=t=>t.type.startsWith("image/")?"image":t.type.startsWith("video/")||t.type.startsWith("audio/")?"video":"auto",OH=(t,e)=>new Promise((n,r)=>{const a="dcqipv1hn",o="lumo_upload",u=MH(t),h=`https://api.cloudinary.com/v1_1/${a}/${u}/upload`,f=new FormData;f.append("file",t),f.append("upload_preset",o);const p=t.name.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_");f.append("public_id",p);const y=new XMLHttpRequest;y.open("POST",h);const b=Date.now();y.upload.onprogress=x=>{if(x.lengthComputable){const k=x.loaded/x.total*100,I=(Date.now()-b)/1e3,A=PH(x.loaded,I);e&&e(k,A)}},y.onload=()=>{if(y.status===200)try{const x=JSON.parse(y.responseText);n({url:x.secure_url,name:x.original_filename||t.name,type:x.resource_type,format:x.format,bytes:x.bytes})}catch{r(new Error("Invalid response from Cloudinary"))}else try{const x=JSON.parse(y.responseText);r(new Error(x.error?.message||`Upload failed with status ${y.status}`))}catch{r(new Error(`Upload failed with status ${y.status}`))}},y.onerror=()=>r(new Error("Network error during upload")),y.send(f)}),oR=({serverId:t,channelId:e,channel:n,userId:r,userProfile:a,userRole:o,users:u,replyingTo:h,onCancelReply:f})=>{const[p,y]=T.useState(""),[b,x]=T.useState(!1),[k,I]=T.useState(!1),[A,N]=T.useState(""),[V,F]=T.useState(0),[j,O]=T.useState(!1),[B,H]=T.useState(!1),[w,S]=T.useState(!1),[R,D]=T.useState(!1),[L,U]=T.useState(!1),[P,ne]=T.useState({uploading:!1,progress:0,speed:""}),[oe,G]=T.useState(null),[Z,J]=T.useState(null),[Se,Le]=T.useState(""),[$,X]=T.useState(!1),re=T.useRef(0),he=T.useRef(null),Te=T.useRef(null),{warning:Ue,error:te,info:Oe}=Fr(),Ie=["owner","admin","moderator"].includes(o),We=!n?.locked||Ie,ke="This channel is locked. Only staff can send messages.",fe=Ee=>{const $e=Te.current?.selectionStart||p.length,lt=p.slice(0,$e)+Ee+p.slice($e);y(lt),O(!1),Te.current?.focus()},Re=async Ee=>{if(H(!1),!(!p.trim()&&!We))try{x(!0);const $e={text:Ee,userId:r,timestamp:ht(),mentions:[],replyTo:null};if(t)await Kn(_t(le,"servers",t,"channels",e,"messages"),$e);else{await Kn(_t(le,"dms",e,"messages"),$e),await it(Ne(le,"dms",e),{lastMessage:{text:"GIF",userId:r,timestamp:ht()},updatedAt:ht(),hiddenFor:[]});const lt=u.find(yt=>yt.id!==r);lt&&await it(Ne(le,"users",lt.id),{[`unreadDms.${e}.count`]:Ui(1),[`unreadDms.${e}.lastMessageAt`]:ht(),[`unreadDms.${e}.text`]:"GIF"}).catch(yt=>console.error("Error updating unread DM count:",yt))}}catch($e){console.error("Error sending GIF:",$e),te("Failed to send GIF")}finally{x(!1)}},dt=async Ee=>{if(S(!1),!vc(a)){te("Stickers are for Premium members only!");return}try{x(!0);const $e={type:"sticker",text:Ee,userId:r,timestamp:ht(),mentions:[],replyTo:null};if(t)await Kn(_t(le,"servers",t,"channels",e,"messages"),$e);else{await Kn(_t(le,"dms",e,"messages"),$e),await it(Ne(le,"dms",e),{lastMessage:{text:" Sticker",userId:r,timestamp:ht()},updatedAt:ht(),hiddenFor:[]});const lt=u.find(yt=>yt.id!==r);lt&&await it(Ne(le,"users",lt.id),{[`unreadDms.${e}.count`]:Ui(1),[`unreadDms.${e}.lastMessageAt`]:ht(),[`unreadDms.${e}.text`]:" Sticker"}).catch(yt=>console.error("Error updating unread DM count:",yt))}}catch($e){console.error("Error sending Sticker:",$e),te("Failed to send Sticker")}finally{x(!1)}},ye=async Ee=>{if(We)try{x(!0);const $e={type:"poll",text:Ee.question,poll:{question:Ee.question,options:Ee.options,votes:{},multipleChoice:Ee.multipleChoice,anonymous:Ee.anonymous},userId:r,timestamp:ht(),mentions:[]};if(t)await Kn(_t(le,"servers",t,"channels",e,"messages"),$e);else{await Kn(_t(le,"dms",e,"messages"),$e),await it(Ne(le,"dms",e),{lastMessage:{text:` Poll: ${Ee.question}`,userId:r,timestamp:ht()},updatedAt:ht(),hiddenFor:[]});const lt=u.find(yt=>yt.id!==r);lt&&await it(Ne(le,"users",lt.id),{[`unreadDms.${e}.count`]:Ui(1),[`unreadDms.${e}.lastMessageAt`]:ht(),[`unreadDms.${e}.text`]:` Poll: ${Ee.question}`}).catch(yt=>console.error("Error updating unread DM count:",yt))}}catch($e){console.error("Error creating poll:",$e),te("Failed to create poll")}finally{x(!1)}},Ve=Ee=>{if(!Ee)return;const $e=vc(a),lt=$e?200*1024*1024:10*1024*1024;if(Ee.size>lt){te(`File too large! The limit is ${$e?"200MB":"10MB"}. ${$e?"":"Upgrade to Premium for larger uploads."}`);return}let yt=null;(Ee.type.startsWith("image/")||Ee.type.startsWith("video/"))&&(yt=URL.createObjectURL(Ee)),G(Ee),J(yt),Le(""),D(!1),he.current&&(he.current.value="")},De=Ee=>{Ve(Ee.target.files?.[0])},K=()=>document.querySelector('[role="dialog"]')!==null||document.querySelector(".modal-overlay")!==null||document.body.style.overflow==="hidden",ue=Ee=>{if(Ee.preventDefault(),Ee.stopPropagation(),K())return;re.current++,Ee.dataTransfer.types&&Array.from(Ee.dataTransfer.types).includes("Files")&&X(!0)},je=Ee=>{Ee.preventDefault(),Ee.stopPropagation(),re.current--,re.current===0&&X(!1)},me=Ee=>{Ee.preventDefault(),Ee.stopPropagation()},Ae=Ee=>{if(Ee.preventDefault(),Ee.stopPropagation(),X(!1),re.current=0,K())return;const $e=Ee.dataTransfer.files;$e&&$e.length>0&&Ve($e[0])};T.useEffect(()=>(window.addEventListener("dragenter",ue),window.addEventListener("dragleave",je),window.addEventListener("dragover",me),window.addEventListener("drop",Ae),()=>{window.removeEventListener("dragenter",ue),window.removeEventListener("dragleave",je),window.removeEventListener("dragover",me),window.removeEventListener("drop",Ae)}),[]);const xe=()=>{Z&&URL.revokeObjectURL(Z),G(null),J(null),Le("")},W=async()=>{if(oe)try{ne({uploading:!0,progress:0,speed:"0 KB/s"});let Ee,$e;if(oe.type.startsWith("image/"))Ee=await Hd(oe,(kt,nt)=>{ne({uploading:!0,progress:kt,speed:nt})});else{const Vt=await OH(oe,(kt,nt)=>{ne({uploading:!0,progress:kt,speed:nt})});Ee=Vt.url,$e=Vt}const yt={text:Se.trim()?`${Ee}
${Se}`:Ee,userId:r,timestamp:ht(),mentions:[],replyTo:null};if(t)await Kn(_t(le,"servers",t,"channels",e,"messages"),yt);else{await Kn(_t(le,"dms",e,"messages"),yt),await it(Ne(le,"dms",e),{lastMessage:{text:oe.type.startsWith("image/")?" Image":" Attachment",userId:r,timestamp:ht()},updatedAt:ht(),hiddenFor:[]});const Vt=u.find(kt=>kt.id!==r);Vt&&await it(Ne(le,"users",Vt.id),{[`unreadDms.${e}.count`]:Ui(1),[`unreadDms.${e}.lastMessageAt`]:ht(),[`unreadDms.${e}.text`]:oe.type.startsWith("image/")?" Image":" Attachment"}).catch(kt=>console.error("Error updating unread DM count:",kt))}xe()}catch(Ee){console.error("Error uploading file:",Ee),te("Failed to upload file")}finally{ne({uploading:!1,progress:0,speed:""})}};T.useEffect(()=>{const Ee=p.length,$e=p.slice(0,Ee),lt=$e.lastIndexOf("@");if(lt!==-1){const yt=$e.slice(lt+1);if(!yt.includes(" ")){N(yt.toLowerCase()),F(lt),I(!0);return}}I(!1)},[p]);const He=()=>{const Ee=[];return t&&("everyone".startsWith(A.toLowerCase())&&Ee.push({id:"everyone",displayName:"everyone",type:"special"}),["admin","moderator","member"].forEach(lt=>{lt.startsWith(A.toLowerCase())&&Ee.push({id:`role-${lt}`,displayName:lt,type:"role"})})),u&&u.filter(lt=>lt.id!==r&&lt.displayName.toLowerCase().startsWith(A.toLowerCase())).forEach(lt=>{Ee.push({...lt,type:"user"})}),Ee.slice(0,8)},ct=Ee=>{const $e=p.slice(0,V),lt=p.slice(V+A.length+1),yt=`${$e}@${Ee.displayName} ${lt}`;y(yt),I(!1)};T.useEffect(()=>{const Ee=$e=>{document.activeElement!==Te.current&&(document.activeElement?.tagName==="INPUT"||document.activeElement?.tagName==="TEXTAREA"||$e.ctrlKey||$e.metaKey||$e.altKey||["Escape","Tab","Enter","Backspace","Delete"].includes($e.key)||document.querySelector('[role="dialog"]')||$e.key.length===1&&Te.current?.focus())};return window.addEventListener("keydown",Ee),()=>window.removeEventListener("keydown",Ee)},[]);const on=async Ee=>{if(Ee.preventDefault(),!!p.trim()&&!(!e||!r)){a?.isMuted&&Ue("You are muted and cannot send messages"),x(!0);try{const $e=/@(\w+)/g,lt=[];let yt;for(;(yt=$e.exec(p))!==null;){const kt=yt[1].toLowerCase();if(kt==="everyone")u.forEach(nt=>{nt.id!==r&&lt.push(nt.id)});else if(["admin","moderator","member"].includes(kt))u.forEach(nt=>{nt.role===kt&&nt.id!==r&&lt.push(nt.id)});else{const nt=u.find(Rt=>Rt.displayName.toLowerCase()===kt);nt&&nt.id!==r&&lt.push(nt.id)}}const Vt={text:p.trim(),userId:r,timestamp:ht(),mentions:[...new Set(lt)],replyTo:h?{messageId:h.id,userId:h.userId,text:h.text.substring(0,100)}:null};if(t){if(await Kn(_t(le,"servers",t,"channels",e,"messages"),Vt),lt.length>0){const kt=lt.map(Rt=>it(Ne(le,"users",Rt),{[`unreadMentions.${t}.count`]:Ui(1),[`unreadMentions.${t}.lastMentionAt`]:ht(),[`unreadMentions.${t}.lastMentionText`]:p.trim().substring(0,50)}).catch(Xt=>{console.error("Error updating mention for user:",Rt,Xt)}));await Promise.all(kt),fetch("/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUserIds:lt,title:"New Mention",body:`${a?.displayName||"Someone"} mentioned you in ${n?.name||"a channel"}`,data:{serverId:t,channelId:e}})}).catch(Rt=>console.error("Failed to send push for mention:",Rt))}}else{await Kn(_t(le,"dms",e,"messages"),Vt),await it(Ne(le,"dms",e),{lastMessage:{text:p.trim().substring(0,100),userId:r,timestamp:ht()},updatedAt:ht(),hiddenFor:[]});const kt=u.find(nt=>nt.id!==r);kt&&(await it(Ne(le,"users",kt.id),{[`unreadDms.${e}.count`]:Ui(1),[`unreadDms.${e}.lastMessageAt`]:ht(),[`unreadDms.${e}.text`]:p.trim().substring(0,50)}).catch(Rt=>console.error("Error updating unread DM count:",Rt)),fetch("/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUserIds:[kt.id],title:`New Message from ${a?.displayName}`,body:p.trim().substring(0,100),data:{dmId:e}})}).catch(Rt=>console.error("Failed to send push for DM:",Rt)))}y(""),f&&f()}catch($e){console.error("Error sending message:",$e),te("Failed to send message")}finally{x(!1)}}};return c.jsxs("div",{className:"px-4 pb-6 relative",children:[h&&c.jsxs("div",{className:"mb-2 bg-dark-sidebar border-l-4 border-green-400 p-3 rounded flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"text-xs text-green-400 font-semibold mb-1",children:["Replying to ",u.find(Ee=>Ee.id===h.userId)?.displayName||"Unknown"]}),c.jsx("div",{className:"text-sm text-dark-muted truncate",children:h.text})]}),c.jsx("button",{onClick:f,className:"ml-2 text-dark-muted hover:text-dark-text transition-colors",title:"Cancel reply",children:c.jsx($n,{size:18})})]}),k&&c.jsx("div",{className:"absolute bottom-full left-4 right-4 mb-2 bg-dark-sidebar rounded-lg shadow-lg border border-dark-hover max-h-48 overflow-y-auto",children:He().map(Ee=>c.jsx("button",{onClick:()=>ct(Ee),className:"w-full px-4 py-2 text-left hover:bg-dark-hover transition-colors flex items-center gap-2",children:Ee.type==="special"||Ee.type==="role"?c.jsxs("span",{className:"text-dark-text font-medium",children:["@",Ee.displayName,Ee.type==="role"&&c.jsx("span",{className:"ml-2 text-xs text-dark-muted",children:"(role)"})]}):c.jsxs(c.Fragment,{children:[Ee.photoUrl?c.jsx("img",{src:Ee.photoUrl,alt:Ee.displayName,className:"w-8 h-8 rounded-full object-cover",onError:$e=>{$e.target.style.display="none",$e.target.nextSibling.style.display="flex"}}):null,c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold text-sm",style:{display:Ee.photoUrl?"none":"flex"},children:Ee.displayName[0].toUpperCase()}),c.jsxs("span",{className:"text-dark-text",children:["@",Ee.displayName]})]})},Ee.id))}),c.jsxs("form",{onSubmit:on,className:"relative",children:[j&&c.jsx(AU,{onSelect:fe,onClose:()=>O(!1)}),P.uploading&&c.jsxs("div",{className:"absolute -top-12 left-0 right-0 bg-dark-sidebar border border-dark-hover rounded-lg p-2 shadow-lg animate-fade-in-up z-50",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-dark-text mb-1",children:[c.jsx("span",{className:"font-semibold",children:"Uploading Image..."}),c.jsxs("span",{className:"text-dark-muted",children:[Math.round(P.progress),"%  ",P.speed]})]}),c.jsx("div",{className:"h-1.5 bg-dark-hover rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-brand-primary transition-all duration-200 ease-out",style:{width:`${P.progress}%`}})})]}),oe&&c.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-dark-bg border border-dark-hover rounded-lg shadow-2xl max-w-lg w-full overflow-hidden flex flex-col p-4",children:[c.jsxs("h3",{className:"text-dark-text font-semibold mb-4 flex items-center gap-2",children:[c.jsx(Wm,{className:"text-brand-primary"}),"Upload Attachment"]}),c.jsx("div",{className:"flex-1 w-full bg-black/50 rounded-lg overflow-hidden flex items-center justify-center mb-4 border border-dark-hover min-h-[200px] max-h-[400px]",children:Z?c.jsx("img",{src:Z,alt:"Preview",className:"max-w-full max-h-full object-contain"}):c.jsxs("div",{className:"flex flex-col items-center gap-2 text-dark-muted",children:[c.jsx("div",{className:"text-6xl",children:""}),c.jsx("div",{className:"text-sm font-medium text-dark-text max-w-xs truncate px-4",children:oe.name}),c.jsxs("div",{className:"text-xs",children:[(oe.size/1024/1024).toFixed(2)," MB"]})]})}),c.jsx("input",{type:"text",value:Se,onChange:Ee=>Le(Ee.target.value),placeholder:"Add a caption... (optional)",className:"w-full bg-dark-input text-dark-text px-4 py-2 rounded-lg border border-dark-hover focus:border-brand-primary outline-none mb-4",onKeyDown:Ee=>{Ee.key==="Enter"&&!P.uploading&&W()}}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("button",{onClick:xe,className:"px-4 py-2 text-dark-text hover:text-dark-muted transition-colors font-medium",disabled:P.uploading,children:"Cancel"}),c.jsx("button",{onClick:W,className:"px-6 py-2 bg-brand-primary hover:bg-brand-secondary text-white rounded-md transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",disabled:P.uploading,children:P.uploading?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading..."]}):c.jsxs(c.Fragment,{children:[c.jsx(pS,{size:18}),"Send"]})})]}),P.uploading&&c.jsxs("div",{className:"mt-4",children:[c.jsxs("div",{className:"flex justify-between text-xs text-dark-muted mb-1",children:[c.jsx("span",{children:P.speed}),c.jsxs("span",{children:[Math.round(P.progress),"%"]})]}),c.jsx("div",{className:"h-1 bg-dark-hover rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-brand-primary transition-all duration-200",style:{width:`${P.progress}%`}})})]})]})}),w&&c.jsxs("div",{className:"absolute bottom-full right-0 mb-4 w-[85vw] max-w-[400px] h-[450px] shadow-2xl rounded-lg z-50 animate-fade-in-up",children:[c.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>S(!1)}),c.jsx(jH,{onSelect:dt})]}),B&&c.jsxs("div",{className:"absolute bottom-full right-0 mb-4 w-[85vw] max-w-[400px] h-[450px] shadow-2xl rounded-lg z-50",children:[c.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>H(!1)}),c.jsx(RH,{onSelect:Re})]}),c.jsx("input",{ref:Te,type:"text",value:p,onChange:Ee=>y(Ee.target.value),onKeyDown:Ee=>{if(Ee.key==="Tab"&&k){Ee.preventDefault();const $e=He();$e.length>0&&ct($e[0])}},onPaste:async Ee=>{const $e=Ee.clipboardData.items;for(let lt=0;lt<$e.length;lt++)for(let yt=0;yt<$e.length;yt++)if($e[yt].kind==="file"){Ee.preventDefault(),Ve($e[yt].getAsFile());break}},placeholder:We?a?.isMuted?"You are muted":"Type a message...":ke,disabled:b||a?.isMuted||!We||oe!==null,className:`w-full bg-dark-input text-dark-text px-12 py-3 pr-48 rounded-lg
                     border border-transparent focus:border-brand-primary
                     outline-none transition-colors duration-200
                     placeholder:text-dark-muted
                     disabled:opacity-50 disabled:cursor-not-allowed select-text`}),$&&c.jsxs("div",{className:"fixed inset-0 z-[200] bg-brand-primary/90 flex flex-col items-center justify-center animate-fade-in pointer-events-none",children:[c.jsx("div",{className:"bg-white/10 p-8 rounded-full mb-6",children:c.jsx(mS,{size:64,className:"text-white animate-bounce"})}),c.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Drop your file here"}),c.jsx("p",{className:"text-white/80",children:"to upload instantly"})]}),c.jsxs("div",{className:"absolute left-3 top-0 bottom-0 flex items-center plus-menu-container",children:[" ",c.jsx("button",{type:"button",onClick:()=>D(!R),className:`text-dark-muted hover:text-brand-primary transition-colors flex items-center justify-center ${R?"text-brand-primary":""}`,title:"Add attachment",disabled:!We,children:c.jsx(mS,{size:26})}),R&&c.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-48 bg-dark-sidebar border border-dark-hover rounded-lg shadow-xl overflow-hidden z-50 animate-fade-in-up",children:[c.jsxs("button",{type:"button",onClick:()=>{he.current?.click(),D(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-hover text-left transition-colors",children:[c.jsx(Wm,{className:"text-green-400",size:20}),c.jsx("span",{className:"text-sm text-dark-text font-medium",children:"Upload File"})]}),c.jsxs("button",{type:"button",onClick:()=>{U(!0),D(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-hover text-left transition-colors",disabled:!t,children:[c.jsx(db,{className:"text-brand-primary",size:20}),c.jsx("span",{className:"text-sm text-dark-text font-medium",children:"Create Poll"})]})]})]}),c.jsx("input",{type:"file",ref:he,onChange:De,className:"hidden"}),c.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>H(!B),className:`text-dark-muted hover:text-brand-primary
                        transition-colors border-2 border-current rounded px-1 text-[10px] font-bold h-6 flex items-center justify-center mr-1`,title:"Add GIF",children:"GIF"}),vc(a)&&c.jsx("button",{type:"button",onClick:()=>S(!w),className:`transition-colors ${w?"text-brand-primary":"text-dark-muted hover:text-brand-primary"}`,title:"Premium Stickers",children:c.jsx(O7,{size:24})}),c.jsx("button",{type:"button",onClick:()=>O(!j),className:`text-dark-muted hover:text-brand-primary
                       transition-colors`,title:"Add emoji",children:c.jsx(fN,{size:24})}),c.jsx("button",{type:"submit",disabled:!p.trim()||b||a?.isMuted||!We,className:`text-dark-muted hover:text-brand-primary
                       transition-colors disabled:opacity-50 disabled:cursor-not-allowed ml-1`,children:c.jsx(pS,{size:24})})]})]}),L&&c.jsx(DH,{onSubmit:ye,onClose:()=>U(!1)})]})},lR=({messages:t,users:e,onResultClick:n})=>{const[r,a]=T.useState(""),[o,u]=T.useState([]),[h,f]=T.useState(!1),p=b=>{if(a(b),!b.trim()){u([]);return}const x=t.filter(k=>k.text.toLowerCase().includes(b.toLowerCase())).slice(0,20);u(x)},y=b=>e.find(x=>x.id===b)||{displayName:"Unknown"};return h?c.jsxs("div",{className:"relative flex-1 max-w-md",children:[c.jsx("input",{type:"text",value:r,onChange:b=>p(b.target.value),placeholder:"Search messages...",autoFocus:!0,className:`w-full bg-dark-input text-dark-text px-4 py-2 pr-10 rounded-lg
                   border border-transparent focus:border-brand-primary
                   outline-none transition-colors placeholder:text-dark-muted`}),c.jsx("button",{onClick:()=>{f(!1),a(""),u([])},className:"absolute right-2 top-1/2 -translate-y-1/2 text-dark-muted hover:text-dark-text",children:c.jsx($n,{size:20})}),o.length>0&&c.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-dark-sidebar border border-dark-hover rounded-lg shadow-xl max-h-96 overflow-y-auto z-50",children:o.map(b=>c.jsxs("button",{onClick:()=>{n&&n(b),f(!1),a(""),u([])},className:"w-full px-4 py-3 text-left hover:bg-dark-hover transition-colors border-b border-dark-hover last:border-b-0",children:[c.jsx("div",{className:"text-xs text-brand-primary font-semibold mb-1",children:y(b.userId).displayName}),c.jsx("div",{className:"text-sm text-dark-text line-clamp-2",children:b.text})]},b.id))})]}):c.jsx("button",{onClick:()=>f(!0),className:"p-2 hover:bg-dark-hover rounded transition-colors",title:"Search messages",children:c.jsx(cb,{size:20,className:"text-dark-muted"})})},LH=({messages:t,users:e,onClose:n,onJumpToMessage:r})=>{const a=t.filter(u=>u.pinned),o=u=>e.find(h=>h.id===u)||{displayName:"Unknown"};return a.length===0?c.jsxs("div",{className:"w-80 bg-dark-sidebar border-l border-dark-hover h-full flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-hover",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(mc,{className:"text-blue-400",size:20}),c.jsx("h3",{className:"font-semibold text-dark-text",children:"Pinned Messages"})]}),c.jsx("button",{onClick:n,className:"text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:20})})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center text-dark-muted text-sm",children:"No pinned messages"})]}):c.jsxs("div",{className:"w-80 bg-dark-sidebar border-l border-dark-hover h-full flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-hover",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(mc,{className:"text-blue-400",size:20}),c.jsx("h3",{className:"font-semibold text-dark-text",children:"Pinned Messages"}),c.jsxs("span",{className:"text-xs text-dark-muted",children:["(",a.length,")"]})]}),c.jsx("button",{onClick:n,className:"text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:20})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:a.map(u=>{const h=o(u.userId);return c.jsx("div",{onClick:()=>r(u.id),className:"bg-dark-bg p-3 rounded-lg cursor-pointer hover:bg-dark-hover transition-colors border border-transparent hover:border-brand-primary",children:c.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[h.photoUrl?c.jsx("img",{src:h.photoUrl,alt:h.displayName,className:"w-8 h-8 rounded-full object-cover",onError:f=>{f.target.style.display="none",f.target.nextSibling.style.display="flex"}}):null,c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold text-sm",style:{display:h.photoUrl?"none":"flex"},children:h.displayName?.[0]?.toUpperCase()||"U"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-semibold text-dark-text text-sm",children:h.displayName}),c.jsx("span",{className:"text-xs text-dark-muted",children:zp(u.timestamp)})]}),c.jsx("div",{className:"text-dark-text text-sm mt-1 line-clamp-3",children:c.jsx(NA,{children:u.text})}),u.pinnedBy&&c.jsxs("div",{className:"text-xs text-blue-400 mt-2 flex items-center gap-1",children:[c.jsx(mc,{size:12}),c.jsxs("span",{children:["Pinned by ",o(u.pinnedBy).displayName]})]})]})]})},u.id)})})]})},VH=({currentStatus:t,onStatusChange:e,onClose:n})=>{const[r,a]=T.useState(!1),[o,u]=T.useState(""),[h,f]=T.useState(""),p=x=>{e(x),n()},y=()=>{h.trim()&&(e({emoji:o,text:h.trim(),type:"custom"}),n())},b=()=>{e(null),n()};return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-dark-sidebar rounded-lg p-6 w-96 max-w-full mx-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-dark-text",children:"Set Status"}),c.jsx("button",{onClick:n,className:"text-dark-muted hover:text-dark-text transition-colors",children:c.jsx($n,{size:24})})]}),r?c.jsx(c.Fragment,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm text-dark-muted mb-2 block",children:"Emoji"}),c.jsx("input",{type:"text",value:o,onChange:x=>u(x.target.value.slice(0,2)),className:"w-full bg-dark-input text-dark-text px-4 py-2 rounded-lg text-2xl text-center",placeholder:"",maxLength:2})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm text-dark-muted mb-2 block",children:"Status Text"}),c.jsx("input",{type:"text",value:h,onChange:x=>f(x.target.value),className:"w-full bg-dark-input text-dark-text px-4 py-2 rounded-lg",placeholder:"What's on your mind?",maxLength:50,autoFocus:!0}),c.jsxs("div",{className:"text-xs text-dark-muted mt-1 text-right",children:[h.length,"/50"]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 rounded-lg bg-dark-bg hover:bg-dark-hover transition-colors text-dark-text",children:"Back"}),c.jsx("button",{onClick:y,disabled:!h.trim(),className:"flex-1 px-4 py-2 rounded-lg bg-brand-primary hover:bg-brand-primary/80 transition-colors text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Set Status"})]})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"space-y-2 mb-4",children:qV.map(x=>c.jsxs("button",{onClick:()=>p(x),className:"w-full px-4 py-3 rounded-lg bg-dark-bg hover:bg-dark-hover transition-colors text-left flex items-center gap-3",children:[c.jsx("span",{className:"text-2xl",children:x.emoji}),c.jsx("span",{className:"text-dark-text",children:x.text})]},x.type))}),c.jsx("button",{onClick:()=>a(!0),className:"w-full px-4 py-3 rounded-lg bg-brand-primary hover:bg-brand-primary/80 transition-colors text-white font-medium",children:" Custom Status"}),t&&c.jsx("button",{onClick:b,className:"w-full mt-2 px-4 py-2 rounded-lg bg-dark-bg hover:bg-dark-hover transition-colors text-admin text-sm",children:"Clear Status"})]})]})})},UH=()=>{const t=[{name:"Screen Sharing",free:"",premium:"1080p 60fps"},{name:"Profile Badge",free:"",premium:""},{name:"Custom Backgrounds",free:"",premium:""},{name:"Upload Limit",free:"10MB",premium:"200MB"},{name:"GIF Avatar",free:"",premium:""},{name:"Animated Banner",free:"",premium:""},{name:"Profile Themes",free:"",premium:""},{name:"Exclusive Stickers",free:"",premium:""},{name:"Soundboard",free:"",premium:""}];return c.jsxs("div",{className:"bg-dark-sidebar/50 rounded-xl overflow-hidden border border-dark-hover",children:[c.jsxs("div",{className:"grid grid-cols-3 bg-dark-hover/50 p-4 text-sm font-bold text-dark-text uppercase tracking-wider",children:[c.jsx("div",{children:"Feature"}),c.jsx("div",{className:"text-center text-dark-muted",children:"Free"}),c.jsx("div",{className:"text-center text-brand-primary",children:"Premium"})]}),c.jsx("div",{className:"divide-y divide-dark-hover",children:t.map((e,n)=>c.jsxs("div",{className:"grid grid-cols-3 p-4 text-sm hover:bg-white/5 transition-colors",children:[c.jsx("div",{className:"font-medium text-dark-text",children:e.name}),c.jsx("div",{className:"text-center text-dark-muted",children:e.free}),c.jsx("div",{className:"text-center font-bold text-white",children:e.premium})]},n))})]})},zH=({question:t,answer:e})=>{const[n,r]=T.useState(!1);return c.jsxs("div",{className:"",children:[c.jsxs("button",{className:"w-full flex items-center justify-between p-5 text-left font-medium text-dark-text hover:text-white transition-colors",onClick:()=>r(!n),children:[c.jsx("span",{children:t}),c.jsx(j7,{className:`transform transition-transform duration-300 ${n?"rotate-180":""}`,size:20})]}),c.jsx("div",{className:`overflow-hidden transition-all duration-300 ${n?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:c.jsx("p",{className:"text-sm text-dark-muted leading-relaxed px-5 pb-5 pt-0",children:e})})]})},BH=()=>{const{info:t}=Fr(),e=[{icon:Qm,title:"HD Screen Sharing",description:"Share your screen in 1080p 60fps quality with friends.",color:"text-blue-400",bg:"bg-blue-400/10"},{icon:z7,title:"Exclusive Profile Badge",description:"Stand out with the shiny Premium badge on your profile.",color:"text-purple-400",bg:"bg-purple-400/10"},{icon:W7,title:"Custom Profile Backgrounds",description:"Personalize your profile with custom banner images.",color:"text-yellow-400",bg:"bg-yellow-400/10"},{icon:fN,title:"Exclusive Stickers",description:"Access a library of premium stickers and custom emojis.",color:"text-orange-400",bg:"bg-orange-400/10"},{icon:Xm,title:"Soundboard",description:"Play fun sound effects in voice channels.",color:"text-pink-400",bg:"bg-pink-400/10"},{icon:q7,title:"Priority Support",description:"Get faster responses for all your support tickets.",color:"text-green-400",bg:"bg-green-400/10"}],n=[{q:"Can I cancel anytime?",a:"Yes, you can cancel your subscription at any time from your account settings. Your benefits will continue until the end of the billing period."},{q:"Is payment secure?",a:"Absolutely. We use Stripe for payment processing, which is the industry standard for security. We never store your card details."},{q:"Do benefits apply to all servers?",a:"Yes! Your Premium benefits travel with you to any server you join on Lumo Chat."}];return c.jsxs("div",{className:"animate-fade-in pb-10",children:[c.jsx("style",{children:`
        @keyframes shine {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }
        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
        .shine-effect::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 50%;
          height: 100%;
          background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent);
          transform: skewX(-20deg) translateX(-150%);
          animation: shine 3s infinite;
        }
        .float-animation {
          animation: float 6s ease-in-out infinite;
        }
      `}),c.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-8 text-white shadow-2xl transform transition-all hover:scale-[1.005] mb-8",children:[c.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-80 h-80 rounded-full bg-white/10 blur-3xl animate-pulse"}),c.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-64 h-64 rounded-full bg-black/20 blur-3xl animate-pulse",style:{animationDelay:"1s"}}),c.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center gap-6",children:[c.jsx("div",{className:"float-animation p-5 bg-white/10 backdrop-blur-md rounded-full shadow-inner ring-4 ring-white/20 shrink-0",children:c.jsx(Zo,{size:56,className:"text-white drop-shadow-[0_0_15px_rgba(255,255,255,0.5)]"})}),c.jsxs("div",{className:"text-center md:text-left",children:[c.jsxs("h1",{className:"text-4xl font-extrabold tracking-tight mb-2 drop-shadow-md",children:["Release the ",c.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-orange-300",children:"Boost!"})]}),c.jsx("p",{className:"text-indigo-100 font-medium text-lg leading-relaxed max-w-2xl",children:"Unlock the full potential of Lumo Chat. Get special perks, enhanced quality, and support the development."})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-bold text-dark-text mb-6 flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-6 bg-brand-primary rounded-full box-shadow-glow"}),"Premium Perks"]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.map((r,a)=>c.jsxs("div",{className:"group relative overflow-hidden p-5 rounded-xl bg-dark-sidebar border border-dark-hover hover:border-brand-primary/50 transition-all duration-300 hover:shadow-xl hover:shadow-brand-primary/10 hover:-translate-y-1",style:{animationDelay:`${a*100}ms`},children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700 ease-in-out pointer-events-none"}),c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:`p-3 rounded-lg ${r.bg} group-hover:scale-110 transition-transform duration-300`,children:c.jsx(r.icon,{size:28,className:`${r.color} drop-shadow-sm`})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-dark-text mb-1 group-hover:text-white transition-colors text-lg",children:r.title}),c.jsx("p",{className:"text-sm text-dark-muted leading-relaxed group-hover:text-gray-300",children:r.description})]})]})]},a))})]}),c.jsxs("div",{className:"bg-dark-bg rounded-2xl p-1 border-2 border-brand-primary/30 group hover:border-brand-primary/60 transition-colors relative overflow-hidden shadow-2xl",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 opacity-20 group-hover:opacity-40 transition-opacity"}),c.jsxs("div",{className:"bg-dark-sidebar/90 backdrop-blur-xl rounded-xl p-8 flex flex-col sm:flex-row items-center justify-between gap-6 relative z-10",children:[c.jsxs("div",{children:[c.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-gradient-to-r from-indigo-500 to-pink-500 text-[10px] font-bold text-white uppercase tracking-widest mb-3 shadow-lg",children:"BEST VALUE"}),c.jsx("h3",{className:"text-3xl font-bold text-white mb-2",children:"Monthly"}),c.jsxs("p",{className:"text-dark-muted text-sm flex items-center gap-2",children:[c.jsx(el,{size:16,className:"text-green-500"})," Secure payment"]})]}),c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsxs("div",{className:"text-4xl font-extrabold text-white",children:["$4.99",c.jsx("span",{className:"text-sm text-dark-muted font-normal ml-1",children:"/mo"})]}),c.jsx("button",{className:"relative overflow-hidden px-10 py-4 bg-gradient-to-r from-indigo-600 to-pink-600 hover:from-indigo-500 hover:to-pink-500 rounded-xl text-white font-bold shadow-lg transform transition-all hover:scale-105 active:scale-95 shine-effect whitespace-nowrap",onClick:()=>t("deme sistemi u anda bakmda."),children:c.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:["Subscribe Now ",c.jsx(Zo,{})]})})]})]})]})]}),c.jsx("div",{className:"space-y-8",children:c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-bold text-dark-text mb-6 flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-6 bg-purple-500 rounded-full box-shadow-glow"}),"Why Go Premium?"]}),c.jsx(UH,{})]})})]}),c.jsxs("div",{className:"mt-12",children:[c.jsxs("h2",{className:"text-xl font-bold text-dark-text mb-6 flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-6 bg-gray-500 rounded-full"}),"Common Questions"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((r,a)=>c.jsx("div",{className:"bg-dark-sidebar rounded-xl border border-dark-hover overflow-hidden",children:c.jsx(zH,{question:r.q,answer:r.a})},a))})]})]})},cR=T.createContext(),uR=()=>{const t=T.useContext(cR);if(!t)throw new Error("useHotkeys must be used within HotkeyProvider");return t},FH=({children:t})=>{const[e,n]=T.useState(()=>{const u=localStorage.getItem("user_hotkeys");return u?JSON.parse(u):{toggleMute:"",toggleDeafen:""}});T.useEffect(()=>{localStorage.setItem("user_hotkeys",JSON.stringify(e))},[e]);const o={hotkeys:e,updateHotkey:(u,h)=>{n(f=>({...f,[u]:h}))},resetToDefaults:()=>{n({toggleMute:"",toggleDeafen:""})}};return c.jsx(cR.Provider,{value:o,children:t})},L4=({label:t,currentValue:e,onChange:n})=>{const[r,a]=T.useState(!1),[o,u]=T.useState(new Set),h=T.useRef(null);T.useEffect(()=>{if(!r)return;const p=b=>{b.preventDefault(),b.stopPropagation();const x=b.key;u(k=>{const I=new Set(k);return I.add(x),I})},y=b=>{r&&(b.preventDefault(),b.stopPropagation())};return window.addEventListener("keydown",p),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",y)}},[r]);const f=()=>{a(!0),u(new Set)};return T.useEffect(()=>{if(!r)return;const p=y=>{if(y.preventDefault(),y.stopPropagation(),y.key==="Escape"){a(!1);return}if(["Control","Shift","Alt","Meta"].includes(y.key))return;const x=[];y.ctrlKey&&x.push("Control"),y.shiftKey&&x.push("Shift"),y.altKey&&x.push("Alt"),y.metaKey&&x.push("Meta");let k=y.key;k.length===1&&(k=k.toUpperCase()),x.push(k);const I=x.join("+");n(I),a(!1)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[r,n]),c.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-sidebar rounded-lg border border-dark-hover",children:[c.jsx("span",{className:"text-dark-text font-medium",children:t}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{ref:h,onClick:f,className:`
               min-w-[120px] px-4 py-2 rounded-lg font-mono text-sm border transition-colors
               ${r?"bg-brand-primary text-white border-brand-primary animate-pulse":"bg-dark-input text-dark-text border-dark-hover hover:border-dark-muted"}
             `,children:r?"Press Keys...":e||"No Keybind"}),e&&c.jsx("button",{onClick:()=>n(""),className:"p-2 text-dark-muted hover:text-red-400 transition-colors",title:"Clear Keybind",children:c.jsx($n,{size:20})})]})]})},HH=({currentUser:t})=>{const[e,n]=T.useState(!1),[r,a]=T.useState(null),[o,u]=T.useState(null),h="https://lumobuild.vercel.app/api/sso-token",f=async()=>{n(!0),a(null),u(null);try{if(!t)throw new Error("No user logged in");console.log(" Testing SSO Backend..."),console.log("User:",t.email);const p=await t.getIdToken();console.log(" Google ID Token obtained"),console.log(" Sending request to:",h);const y=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({googleIdToken:p,email:t.email})});console.log(" Response status:",y.status);const b=await y.json();if(console.log(" Response data:",b),b.success)a({success:!0,customToken:b.customToken,user:b.user,googleIdToken:p});else throw new Error(b.message||b.error||"Unknown error")}catch(p){console.error(" Test failed:",p),u(p.message)}finally{n(!1)}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-dark-muted text-sm mb-3",children:"Test the SSO backend to verify it's working correctly."}),c.jsx(st,{onClick:f,disabled:!t||e,variant:"primary",children:e?c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Testing..."]}):" Test SSO Backend"})]}),r&&c.jsxs("div",{className:"bg-green-900/20 border border-green-500 rounded-lg p-4",children:[c.jsx("h4",{className:"text-green-500 font-semibold mb-3",children:" Backend Working!"}),c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-dark-muted mb-1",children:"User Info:"}),c.jsx("pre",{className:"bg-dark-sidebar p-3 rounded text-xs text-dark-text overflow-x-auto",children:JSON.stringify(r.user,null,2)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-dark-muted mb-1",children:"Custom Token:"}),c.jsxs("pre",{className:"bg-dark-sidebar p-3 rounded text-xs text-dark-text overflow-x-auto break-all",children:[r.customToken.substring(0,100),"..."]})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-green-500/30",children:[c.jsx("p",{className:"text-dark-muted mb-2",children:" SSO Test URL (for MeydanApp testing):"}),c.jsxs("div",{className:"bg-dark-sidebar p-3 rounded text-xs",children:[c.jsx("p",{className:"text-dark-text font-mono break-all mb-2",children:`${window.location.origin}/?sso_token=${r.googleIdToken}`}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/?sso_token=${r.googleIdToken}`),alert("SSO URL copied to clipboard!")},className:"text-green-500 hover:text-green-400 text-xs underline",children:" Copy URL"})]})]})]})]}),o&&c.jsxs("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-4",children:[c.jsx("h4",{className:"text-red-500 font-semibold mb-2",children:" Test Failed"}),c.jsx("p",{className:"text-dark-text text-sm mb-3",children:o}),c.jsxs("div",{className:"bg-red-900/30 p-3 rounded text-xs text-dark-muted",children:[c.jsx("p",{className:"font-medium mb-1",children:"Possible issues:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Environment variables not set in Vercel"}),c.jsx("li",{children:"Backend not deployed"}),c.jsx("li",{children:"CORS configuration issue"})]})]})]}),c.jsxs("div",{className:"bg-dark-sidebar rounded p-3 text-xs",children:[c.jsx("p",{className:"text-dark-muted mb-1",children:"API Endpoint:"}),c.jsx("p",{className:"text-dark-text font-mono break-all",children:h})]})]})},$H=[{id:"premium",label:"Premium",icon:Zo,category:"User Settings"},{id:"account",label:"My Account",icon:X7,category:"User Settings"},{id:"keybinds",label:"Keybinds",icon:D7,category:"App Settings"},{id:"security",label:"Privacy & Security",icon:P7,category:"User Settings"},{id:"about",label:"About",icon:Km,category:"App Settings"},{id:"debug",label:" Debug",icon:Km,category:"Developer"}],qH=({isOpen:t,onClose:e})=>{const{currentUser:n,userProfile:r}=yn(),{success:a,error:o,info:u}=Fr(),[h,f]=T.useState("account"),[p,y]=T.useState(r?.photoUrl||""),[b,x]=T.useState(r?.bannerUrl||""),[k,I]=T.useState(r?.themeColor||"#6366f1"),[A,N]=T.useState(r?.bio||""),[V,F]=T.useState(!1),[j,O]=T.useState(!1),[B,H]=T.useState({progress:0,speed:""}),[w,S]=T.useState(!1),[R,D]=T.useState({progress:0,speed:""}),L=T.useRef(null),U=T.useRef(null),[P,ne]=T.useState(!1),[oe,G]=T.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Z,J]=T.useState(!1),{hotkeys:Se,updateHotkey:Le,resetToDefaults:$}=uR(),X=vc(r);T.useEffect(()=>{y(r?.photoUrl||""),x(r?.bannerUrl||""),I(r?.themeColor||"#6366f1"),N(r?.bio||"")},[r]),T.useEffect(()=>{const W=He=>{He.key==="Escape"&&t&&e()};return t&&(document.addEventListener("keydown",W),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",W),document.body.style.overflow="unset"}},[t,e]);const[re,he]=T.useState(r?.displayName||""),[Te,Ue]=T.useState(!1),[te,Oe]=T.useState(""),[Ie,We]=T.useState(!1);T.useEffect(()=>{r?.displayName&&he(r.displayName)},[r]),T.useEffect(()=>{if(!Te||re===r?.displayName){Oe("");return}const He=setTimeout(async()=>{if(!re){Oe("");return}if(re.length<3){Oe("Username must be at least 3 characters");return}if(!/^[a-zA-Z0-9-_]+$/.test(re)){Oe("Only letters, numbers, hyphens (-) and underscores (_) allowed");return}We(!0);try{const ct=_t(le,"users"),on=zr(ct,Vi("displayName","==",re)),Ee=await di(ct);let $e=!1;const lt=re.toLowerCase();Ee.forEach(yt=>{if(yt.id===n.uid)return;const Vt=yt.data().displayName;Vt&&Vt.toLowerCase()===lt&&($e=!0)}),Oe($e?"This username is already taken":"")}catch(ct){console.error("Error checking username:",ct)}finally{We(!1)}},500);return()=>clearTimeout(He)},[re,Te,r,n]);const ke=async()=>{if(!(!n||te||Ie)){if(re===r?.displayName){Ue(!1);return}F(!0);try{tN(()=>Promise.resolve().then(()=>iD),void 0,import.meta.url).then(async({updateProfile:W})=>{await W(n,{displayName:re})}),await it(Ne(le,"users",n.uid),{displayName:re}),a("Username updated successfully"),Ue(!1)}catch(W){console.error("Error updating username:",W),o("Failed to update username")}finally{F(!1)}}},fe=async W=>{if(!(!W||!n)){if(!W.type.startsWith("image/")){o("Please select an image file");return}if(W.type==="image/gif"&&!X){o("Animated GIF avatars are for Premium members only!");return}if(W.size>10*1024*1024){o("Image size must be less than 10MB");return}O(!0);try{const He=await Hd(W,(ct,on)=>{H({progress:ct,speed:on})});await it(Ne(le,"users",n.uid),{photoUrl:He}),y(He),a("Profile photo updated successfully!")}catch(He){console.error("Error uploading photo:",He),o("Failed to upload photo")}finally{O(!1),H({progress:0,speed:""}),L.current&&(L.current.value="")}}},Re=async W=>{if(!(!W||!n)){if(!X){u("Custom banners are a Premium feature. Upgrade to unlock!");return}if(!W.type.startsWith("image/")){o("Please select an image file");return}if(W.size>10*1024*1024){o("Image size must be less than 10MB");return}S(!0);try{const He=await Hd(W,(ct,on)=>{D({progress:ct,speed:on})});await it(Ne(le,"users",n.uid),{bannerUrl:He}),x(He),a("Banner updated successfully!")}catch(He){console.error("Error uploading banner:",He),o("Failed to upload banner")}finally{S(!1),D({progress:0,speed:""}),U.current&&(U.current.value="")}}},dt=async W=>{const He=W.target.value;I(He)},ye=async()=>{if(n){if(!X){u("Custom themes are a Premium feature!"),I(r?.themeColor||"#6366f1");return}F(!0);try{await it(Ne(le,"users",n.uid),{themeColor:k}),a("Appearance updated!")}catch(W){console.error("Error updating appearance:",W),o("Failed to update appearance")}finally{F(!1)}}},Ve=async()=>{if(n){F(!0);try{await it(Ne(le,"users",n.uid),{bio:A.trim()}),a("Bio updated successfully")}catch(W){console.error("Error updating bio:",W),o("Failed to update bio")}finally{F(!1)}}},De=async()=>{if(!(!n||!n.email)){if(!oe.currentPassword||!oe.newPassword||!oe.confirmPassword){o("Please fill in all password fields");return}if(oe.newPassword.length<6){o("New password must be at least 6 characters");return}if(oe.newPassword!==oe.confirmPassword){o("New passwords do not match");return}J(!0);try{const W=sa.credential(n.email,oe.currentPassword);await i1(n,W),await KT(n,oe.newPassword),a("Password changed successfully"),G({currentPassword:"",newPassword:"",confirmPassword:""})}catch(W){console.error("Error changing password:",W),W.code==="auth/wrong-password"?o("Current password is incorrect"):W.code==="auth/weak-password"?o("New password is too weak"):o("Failed to change password")}finally{J(!1)}}},K=async W=>{if(n)try{await it(Ne(le,"users",n.uid),{status:W}),a(W?"Status updated":"Status cleared")}catch(He){console.error("Error updating status:",He),o("Failed to update status")}},ue=async W=>{if(n)try{await it(Ne(le,"users",n.uid),{presence:W}),a(`Status set to ${W}`)}catch{o("Failed to update status")}};if(!t)return null;const je=r?.role==="admin",Ae=$H.filter(W=>W.id==="debug"?je:!0).reduce((W,He)=>(W[He.category]||(W[He.category]=[]),W[He.category].push(He),W),{}),xe=()=>{switch(h){case"premium":return c.jsx(BH,{});case"account":return c.jsxs("div",{className:"space-y-8",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"My Account"}),c.jsxs("div",{className:"rounded-lg overflow-hidden border border-dark-hover relative min-h-[300px]",style:{borderColor:k},children:[c.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-colors",style:{backgroundColor:k,backgroundImage:b?`url(${b})`:`linear-gradient(to bottom right, ${k}, #000)`}}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"}),b?.endsWith(".gif")&&c.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm font-bold z-10",children:"GIF"}),c.jsxs("div",{className:"relative z-10 p-6 flex flex-col items-center justify-end h-full min-h-[300px] text-center mt-auto",children:[c.jsxs("div",{className:"relative group mb-4",children:[p?c.jsx("img",{src:p,alt:"Profile",className:"w-28 h-28 rounded-full object-cover border-4",style:{borderColor:k},onError:W=>{W.target.style.display="none",W.target.nextSibling.style.display="flex"}},p):null,c.jsx("div",{className:"w-28 h-28 rounded-full flex items-center justify-center text-white font-bold text-4xl border-4",style:{display:p?"none":"flex",backgroundColor:k,borderColor:k},children:r?.displayName?.[0]?.toUpperCase()||"U"}),c.jsx("div",{className:"absolute inset-0 rounded-full bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer border-4 border-transparent",onClick:()=>L.current?.click(),children:c.jsx(Wm,{className:"text-white",size:32})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center justify-center gap-2 shadow-black drop-shadow-md",children:[r?.displayName,X&&c.jsx(Zo,{className:"text-brand-primary",title:"Premium Member"})]}),c.jsx("p",{className:"text-gray-200 text-sm font-medium shadow-black drop-shadow-md",children:n?.email}),c.jsx("div",{className:"flex justify-center gap-2 mt-3",children:c.jsx("span",{className:"text-xs px-3 py-1 rounded-full bg-black/40 backdrop-blur-md border border-white/20 text-white capitalize font-medium",children:r?.role||"member"})})]})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Profile Photo"}),c.jsx("input",{type:"file",ref:L,onChange:W=>fe(W.target.files?.[0]),accept:"image/*",className:"hidden"}),c.jsx("div",{className:"flex gap-3 mb-4",children:c.jsx("button",{onClick:()=>L.current?.click(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-dark-sidebar hover:bg-dark-hover border border-dark-hover text-dark-text rounded-lg transition-colors disabled:opacity-50",disabled:j,children:j?c.jsxs("span",{className:"text-sm",children:["Uploading ",Math.round(B.progress),"%..."]}):c.jsxs(c.Fragment,{children:[c.jsx(_y,{size:20}),"Upload New Photo"]})})})]}),c.jsxs("div",{className:`rounded-lg p-4 relative ${X?"bg-dark-bg":"bg-dark-bg/50"}`,children:[!X&&c.jsxs("div",{className:"absolute inset-0 z-10 bg-black/60 backdrop-blur-[1px] rounded-lg flex flex-col items-center justify-center text-center p-4",children:[c.jsx(Zo,{size:32,className:"text-brand-primary mb-2 animate-bounce"}),c.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Unlock Profile Appearance"}),c.jsx("p",{className:"text-sm text-dark-muted mb-4 max-w-xs",children:"Customize your banner, theme colors, and use animated GIFs with Premium."}),c.jsx(st,{variant:"primary",onClick:()=>f("premium"),children:"View Premium Plans"})]}),c.jsxs("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-6 flex items-center gap-2",children:[c.jsx(V7,{})," Profile Appearance ",c.jsx("span",{className:"text-xs normal-case px-2 py-0.5 bg-brand-primary/20 text-brand-primary rounded",children:"Premium"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-dark-text mb-2",children:"Profile Banner"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"file",ref:U,onChange:W=>Re(W.target.files?.[0]),accept:"image/*",className:"hidden"}),c.jsx("button",{onClick:()=>U.current?.click(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-8 border-2 border-dashed border-dark-hover hover:border-brand-primary rounded-lg text-dark-muted hover:text-brand-primary transition-colors disabled:opacity-50",disabled:w,children:w?c.jsxs("span",{children:["Uploading ",Math.round(R.progress),"%..."]}):c.jsxs("div",{className:"text-center",children:[c.jsx(Wm,{size:24,className:"mx-auto mb-1"}),c.jsx("div",{children:"Upload Banner Image"}),c.jsx("div",{className:"text-xs opacity-70",children:"JPG, PNG, GIF"})]})}),b&&c.jsxs("div",{className:"w-32 h-24 rounded-lg overflow-hidden relative group shrink-0",children:[c.jsx("img",{src:b,className:"w-full h-full object-cover"}),c.jsx("button",{onClick:()=>{x(""),it(Ne(le,"users",n.uid),{bannerUrl:""})},className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-red-500 font-bold",children:"Remove"})]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-dark-text mb-2",children:"Theme Color"}),c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsx("input",{type:"color",value:k,onChange:dt,className:"w-16 h-16 rounded-lg cursor-pointer bg-transparent border-0 p-0"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-dark-text font-mono bg-dark-input px-3 py-1 rounded border border-dark-hover",children:k}),c.jsx("div",{className:"text-xs text-dark-muted mt-1",children:"Select a color to accent your profile."})]}),c.jsx("div",{className:"flex-1 text-right",children:c.jsx(st,{onClick:ye,disabled:k===r?.themeColor,children:"Save Color"})})]})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Online Status"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[{key:"online",label:"Online",color:"bg-green-500",desc:"Visible"},{key:"idle",label:"Idle",color:"bg-yellow-500",desc:"Away"},{key:"dnd",label:"Do Not Disturb",color:"bg-red-500",desc:"No notifications"},{key:"invisible",label:"Invisible",color:"bg-gray-500",desc:"Hidden"}].map(W=>c.jsxs("button",{onClick:()=>ue(W.key),className:`p-3 rounded-lg border transition-all text-left flex items-center gap-3 ${r?.presence===W.key||!r?.presence&&W.key==="online"?"border-brand-primary bg-brand-primary/10":"border-dark-hover hover:border-dark-muted bg-dark-sidebar"}`,children:[c.jsx("span",{className:`w-3 h-3 rounded-full ${W.color}`}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-dark-text",children:W.label}),c.jsx("div",{className:"text-[10px] text-dark-muted",children:W.desc})]})]},W.key))})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Custom Status"}),r?.status?c.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-sidebar rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-2xl",children:r.status.emoji}),c.jsx("span",{className:"text-dark-text",children:r.status.text})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:()=>ne(!0),children:"Edit"}),c.jsx(st,{variant:"danger",onClick:()=>K(null),children:"Clear"})]})]}):c.jsxs("div",{className:"text-center py-4 border border-dashed border-dark-hover rounded-lg",children:[c.jsx("p",{className:"text-dark-muted text-sm mb-3",children:"No custom status set"}),c.jsx(st,{variant:"primary",size:"sm",onClick:()=>ne(!0),children:"Set a Status"})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"About Me"}),c.jsx("textarea",{placeholder:"Tell others about yourself...",value:A,onChange:W=>N(W.target.value),maxLength:190,rows:4,className:`w-full bg-dark-input text-dark-text px-4 py-3 rounded-lg
                           border border-transparent focus:border-brand-primary
                           outline-none transition-colors duration-200
                           placeholder:text-dark-muted resize-none`}),c.jsxs("div",{className:"flex justify-between items-center mt-2",children:[c.jsxs("span",{className:"text-xs text-dark-muted",children:[A.length,"/190"]}),c.jsx(st,{variant:"primary",onClick:Ve,disabled:V||A===r?.bio,children:V?"Updating...":"Save"})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Account Info"}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex justify-between items-center py-2 border-b border-dark-hover",children:c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"text-xs text-dark-muted uppercase mb-1",children:"Display Name"}),Te?c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx(bn,{value:re,onChange:W=>he(W.target.value),placeholder:"Enter new username",className:te?"!border-red-500":Ie?"!border-yellow-500":"!border-green-500"}),te&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:te}),!te&&re&&re!==r?.displayName&&!Ie&&c.jsx("p",{className:"text-xs text-green-500 mt-1",children:" Username available"}),Ie&&c.jsx("p",{className:"text-xs text-yellow-500 mt-1",children:"Checking availability..."})]}),c.jsxs("div",{className:"flex gap-1 mt-1",children:[c.jsx(st,{size:"sm",variant:"primary",onClick:ke,disabled:!!te||Ie||!re||V,children:"Save"}),c.jsx(st,{size:"sm",variant:"secondary",onClick:()=>{Ue(!1),he(r?.displayName||""),Oe("")},children:"Cancel"})]})]}):c.jsxs("div",{className:"flex justify-between items-center group",children:[c.jsx("div",{className:"text-dark-text font-medium text-lg",children:r?.displayName}),c.jsx(st,{size:"sm",variant:"secondary",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>Ue(!0),children:"Edit"})]})]})}),c.jsx("div",{className:"flex justify-between items-center py-2 border-b border-dark-hover",children:c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-dark-muted uppercase",children:"Email"}),c.jsx("div",{className:"text-dark-text font-medium",children:n?.email})]})}),c.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-dark-hover",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-dark-text font-medium",children:"Desktop Notifications"}),c.jsx("div",{className:"text-xs text-dark-muted",children:"Show popup notifications on desktop"})]}),c.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[c.jsx("input",{type:"checkbox",className:"sr-only peer",checked:r?.settings?.notificationsEnabled!==!1,onChange:async W=>{const He=W.target.checked;try{await it(Ne(le,"users",n.uid),{"settings.notificationsEnabled":He})}catch(ct){console.error("Failed to update notification settings",ct)}}}),c.jsx("div",{className:"w-11 h-6 bg-dark-input peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-brand-primary"})]})]}),c.jsx("div",{className:"flex justify-between items-center py-2 border-b border-dark-hover",children:c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-dark-muted uppercase",children:"Role"}),c.jsx("div",{className:"text-dark-text font-medium capitalize",children:r?.role})]})}),c.jsx("div",{className:"flex justify-between items-center py-2",children:c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-dark-muted uppercase",children:"Role"}),c.jsx("div",{className:"text-dark-text font-medium capitalize",children:r?.role||"member"})]})})]})]})]});case"keybinds":return c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Keybinds"}),c.jsx(st,{variant:"secondary",size:"sm",onClick:$,children:"Reset Defaults"})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 space-y-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-2",children:"Voice & Video"}),c.jsx(L4,{label:"Toggle Mute",currentValue:Se.toggleMute,onChange:W=>Le("toggleMute",W)}),c.jsx(L4,{label:"Toggle Deafen",currentValue:Se.toggleDeafen,onChange:W=>Le("toggleDeafen",W)}),c.jsx("p",{className:"text-xs text-dark-muted mt-4",children:"Keybinds are active while the application window is focused."})]})]});case"security":return c.jsxs("div",{className:"space-y-8",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Privacy & Security"}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Change Password"}),c.jsxs("div",{className:"space-y-4 max-w-md",children:[c.jsx(bn,{label:"Current Password",type:"password",placeholder:"Enter current password",value:oe.currentPassword,onChange:W=>G({...oe,currentPassword:W.target.value})}),c.jsx(bn,{label:"New Password",type:"password",placeholder:"Enter new password (min 6 characters)",value:oe.newPassword,onChange:W=>G({...oe,newPassword:W.target.value})}),c.jsx(bn,{label:"Confirm New Password",type:"password",placeholder:"Confirm new password",value:oe.confirmPassword,onChange:W=>G({...oe,confirmPassword:W.target.value})}),c.jsx(st,{variant:"primary",onClick:De,disabled:Z||!oe.currentPassword||!oe.newPassword||!oe.confirmPassword,children:Z?"Changing Password...":"Change Password"})]})]})]});case"about":return c.jsxs("div",{className:"space-y-8",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"About"}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-6",children:[c.jsx("h2",{className:"text-xl font-bold text-dark-text mb-2",children:"Lumo Chat"}),c.jsxs("div",{className:"space-y-4 text-dark-muted text-sm",children:[c.jsx("p",{children:"A modern real-time chat application built for seamless communication."}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-dark-text",children:"Version"}),c.jsx("div",{children:"2.0.17"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-dark-text",children:"Developer"}),c.jsx("div",{children:"Dazlakss"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-dark-text",children:"Tech Stack"}),c.jsx("div",{children:"React, Firebase, TailwindCSS, Electron"})]})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Acknowledgments"}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center gap-4 p-3 bg-dark-sidebar rounded-lg border border-dark-hover",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"text-dark-text font-medium",children:"GIPHY"}),c.jsx("div",{className:"text-xs text-dark-muted",children:"We use GIPHY for finding and sharing GIFs."}),c.jsx("a",{href:"https://giphy.com",target:"_blank",rel:"noopener noreferrer",className:"mt-2 text-sm font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500 block w-fit hover:opacity-80 transition-opacity",children:"Powered by GIPHY"})]})}),c.jsx("div",{className:"flex items-center gap-4 p-3 bg-dark-sidebar rounded-lg border border-dark-hover",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"text-dark-text font-medium",children:"Cloudinary"}),c.jsx("div",{className:"text-xs text-dark-muted",children:"Robust cloud storage and delivery for images and files."}),c.jsx("a",{href:"https://cloudinary.com",target:"_blank",rel:"noopener noreferrer",className:"mt-2 text-sm font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-sky-400 block w-fit hover:opacity-80 transition-opacity",children:"Powered by Cloudinary"})]})}),c.jsx("div",{className:"flex items-center gap-4 p-3 bg-dark-sidebar rounded-lg border border-dark-hover",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"text-dark-text font-medium",children:"ImgBB"}),c.jsx("div",{className:"text-xs text-dark-muted",children:"Simple and fast image hosting service."}),c.jsx("a",{href:"https://imgbb.com",target:"_blank",rel:"noopener noreferrer",className:"mt-2 text-sm font-bold text-transparent bg-clip-text bg-gradient-to-r from-gray-200 to-gray-400 block w-fit hover:opacity-80 transition-opacity",children:"Powered by ImgBB"})]})})]})]})]});case"debug":return c.jsxs("div",{className:"space-y-8",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:" Debug Tools"}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-dark-text mb-4",children:"SSO Backend Test"}),c.jsx(HH,{currentUser:n})]})]});default:return null}};return c.jsxs("div",{className:"fixed inset-0 bg-black/80 z-50 flex flex-col md:flex-row pt-safe-top md:pt-0",role:"dialog","aria-modal":"true",children:[c.jsx("div",{className:"w-full md:w-56 bg-dark-sidebar flex flex-col shrink-0 border-b md:border-b-0 md:border-r border-dark-hover",children:c.jsx("div",{className:"flex md:flex-col overflow-x-auto md:overflow-y-auto py-2 md:py-4 px-2 gap-2 md:gap-0 no-scrollbar",children:Object.entries(Ae).map(([W,He])=>c.jsxs("div",{className:"mb-0 md:mb-4 flex md:block gap-2 md:gap-0 shrink-0",children:[c.jsx("div",{className:"hidden md:block px-3 py-2 text-xs font-semibold text-dark-muted uppercase tracking-wide",children:W}),He.map(ct=>{const on=ct.icon;return c.jsxs("button",{onClick:()=>f(ct.id),className:`whitespace-nowrap flex items-center gap-2 md:gap-3 px-3 py-2 rounded-md text-left transition-colors ${h===ct.id?"bg-dark-hover text-dark-text":"text-dark-muted hover:text-dark-text hover:bg-dark-hover/50"}`,children:[c.jsx(on,{size:18}),c.jsx("span",{className:"text-sm",children:ct.label})]},ct.id)})]},W))})}),c.jsxs("div",{className:"flex-1 flex flex-col bg-dark-bg overflow-hidden min-w-0",children:[c.jsx("div",{className:"flex justify-end p-4 shrink-0",children:c.jsx("button",{onClick:e,className:"p-2 hover:bg-dark-hover rounded-full transition-colors group",title:"Close",children:c.jsx($n,{size:24,className:"text-dark-muted group-hover:text-dark-text"})})}),c.jsx("div",{className:"flex-1 overflow-y-auto px-4 md:px-10 pb-10",children:c.jsx("div",{className:h==="premium"?"w-full":"max-w-2xl mx-auto md:mx-0",children:xe()})})]}),P&&c.jsx(VH,{currentStatus:r?.status,onStatusChange:K,onClose:()=>ne(!1)})]})},GH=()=>{const[t,e]=T.useState([]),{channels:n}=aa();T.useEffect(()=>{const a=zr(_t(le,"adminLogs"),Hm("timestamp","desc"),gy(100));return Sr(a,u=>{const h=[];u.forEach(f=>{h.push({id:f.id,...f.data()})}),e(h)})},[]);const r=a=>{const o=n.find(u=>u.id===a);return o?`#${o.name}`:"Unknown Channel"};return c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-bold text-dark-text mb-6",children:"Admin Logs"}),c.jsx("div",{className:"space-y-3 max-h-[520px] overflow-y-auto pr-2",children:t.length===0?c.jsx("div",{className:"text-center text-dark-muted py-8",children:"No logs yet"}):t.map(a=>c.jsxs("div",{className:"bg-dark-bg p-5 rounded-xl hover:bg-dark-hover transition-colors",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("div",{className:"flex items-center gap-2",children:a.type==="message_delete"?c.jsxs(c.Fragment,{children:[c.jsx(Ki,{className:"text-admin",size:20}),c.jsx("span",{className:"font-semibold text-dark-text",children:"Message Deleted"})]}):a.type==="message_edit"?c.jsxs(c.Fragment,{children:[c.jsx(pc,{className:"text-blue-400",size:20}),c.jsx("span",{className:"font-semibold text-dark-text",children:"Message Edited"})]}):c.jsx("span",{className:"font-semibold text-dark-text",children:a.type})}),c.jsx("span",{className:"text-xs text-dark-muted",children:a.timestamp&&zp(a.timestamp)})]}),c.jsxs("div",{className:"space-y-1 text-sm",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("span",{className:"text-dark-muted",children:"Channel:"}),c.jsx("span",{className:"text-dark-text font-medium",children:r(a.channelId)})]}),a.type==="message_delete"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("span",{className:"text-dark-muted",children:"Original Author:"}),c.jsx("span",{className:"text-dark-text",children:a.originalAuthorName||a.originalUserName||"Unknown"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("span",{className:"text-dark-muted",children:"Message:"}),c.jsxs("span",{className:"text-dark-text italic",children:['"',a.messageText||a.deletedText||"(empty message)",'"']})]})]}),a.type==="message_edit"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("span",{className:"text-dark-muted",children:"Before:"}),c.jsxs("span",{className:"text-dark-text italic",children:['"',a.originalText,'"']})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("span",{className:"text-dark-muted",children:"After:"}),c.jsxs("span",{className:"text-blue-400 italic",children:['"',a.newText,'"']})]})]})]})]},a.id))})]})},YH=[{id:"users",label:"Users",icon:ub,category:"Moderation"},{id:"roles",label:"Roles",icon:dN,category:"Moderation"},{id:"channels",label:"Channels",icon:Bp,category:"Server Settings"},{id:"server",label:"Overview",icon:Km,category:"Server Settings"},{id:"logs",label:"Audit Log",icon:g7,category:"Server Settings"},{id:"notifications",label:"Notifications",icon:K7,category:"Maintenance"},{id:"cleanup",label:"Cleanup",icon:U7,category:"Maintenance"}],KH=({isOpen:t,onClose:e})=>{const{userProfile:n}=yn(),{users:r,channels:a,server:o,currentServer:u}=aa(),[h,f]=T.useState("users"),[p,y]=T.useState(null),[b,x]=T.useState(""),[k,I]=T.useState(""),[A,N]=T.useState("text"),[V,F]=T.useState(null),[j,O]=T.useState([]),[B,H]=T.useState(null),[w,S]=T.useState({name:"",color:"#5865f2"}),[R,D]=T.useState(null),[L,U]=T.useState(null),{success:P,error:ne}=Fr(),[oe,G]=T.useState(0),[Z,J]=T.useState(!1),[Se,Le]=T.useState(null);T.useEffect(()=>{const K=ue=>{ue.key==="Escape"&&t&&e()};return t&&(document.addEventListener("keydown",K),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",K),document.body.style.overflow="unset"}},[t,e]),T.useEffect(()=>{if(!u||u==="home")return;const K=zr(_t(le,"servers",u,"roles"));return Sr(K,je=>{const me=[];je.forEach(Ae=>{me.push({id:Ae.id,...Ae.data()})}),O(me)})},[u]),T.useEffect(()=>{if(h!=="cleanup")return;(async()=>{try{const ue=await di(_t(le,"inviteCodes")),je=new Date;let me=0;ue.forEach(Ae=>{const xe=Ae.data(),W=xe.expiresAt?.toDate()<je,He=!xe.isActive||xe.uses>=xe.maxUses;(W||He)&&me++}),G(me)}catch(ue){console.error("Error fetching cleanup stats:",ue)}})()},[h]);const $=async()=>{J(!0);try{const K=await di(_t(le,"inviteCodes")),ue=new Date,je=ZE(le);let me=0;K.forEach(Ae=>{const xe=Ae.data(),W=xe.expiresAt?.toDate()<ue,He=!xe.isActive||xe.uses>=xe.maxUses;(W||He)&&(je.delete(Ne(le,"inviteCodes",Ae.id)),me++)}),me>0?(await je.commit(),P(`${me} expired invite code(s) deleted`),G(0)):P("No expired invite codes to delete")}catch(K){console.error("Error cleaning invite codes:",K),ne("Failed to clean invite codes")}finally{J(!1),Le(null)}};if(!t||n?.role!=="admin")return null;const X=async(K,ue)=>{try{await it(Ne(le,"users",K),{role:ue}),u&&await it(Ne(le,"servers",u,"members",K),{role:ue}),P(`Role updated to ${ue}`),y(null)}catch(je){console.error("Error updating user role:",je),ne(`Failed to update role: ${je.message}`)}},re=async(K,ue)=>{try{await it(Ne(le,"users",K),{isMuted:!ue})}catch(je){console.error("Error toggling mute:",je)}},he=async(K,ue)=>{try{await it(Ne(le,"users",K),{isBanned:!ue})}catch(je){console.error("Error toggling ban:",je)}},Te=async()=>{if(!(!b.trim()||!u))try{await Kn(_t(le,"servers",u,"channels"),{name:b.trim(),type:A,description:A==="text"?k.trim():"",position:a.length,createdAt:ht()}),x(""),I(""),N("text"),P(`${A==="voice"?"Sesli":"Yaz"} kanal oluturuldu!`)}catch(K){console.error("Error creating channel:",K),ne("Kanal oluturulamad")}},Ue=async(K,ue)=>{try{await it(Ne(le,"servers",u,"channels",K),ue),F(null)}catch(je){console.error("Error updating channel:",je)}},te=async()=>{if(!(!L?.data||!u))try{await ts(Ne(le,"servers",u,"channels",L.data))}catch(K){console.error("Error deleting channel:",K)}},Oe=async(K,ue)=>{if(u)try{await it(Ne(le,"servers",u,"channels",K),{locked:!ue})}catch(je){console.error("Error toggling channel lock:",je)}},Ie=async()=>{if(w.name.trim())try{const K=j.reduce((ue,je)=>Math.max(ue,je.position||0),0);u&&await Kn(_t(le,"servers",u,"roles"),{name:w.name.trim(),color:w.color,position:K+1,createdAt:ht()}),S({name:"",color:"#5865f2"})}catch(K){console.error("Error creating role:",K)}},We=async(K,ue)=>{if(u)try{await it(Ne(le,"servers",u,"roles",K),ue),H(null)}catch(je){console.error("Error updating role:",je)}},ke=async()=>{if(!L?.data)return;const K=L.data;try{const ue=j.find(xe=>xe.id===K);if(!ue)return;const je=ue.name,me=ZE(le),Ae=r.filter(xe=>(xe.serverRole||xe.role)===je);if(Ae.forEach(xe=>{if(xe.role===je){const W=Ne(le,"users",xe.id);me.update(W,{role:"member"})}if(u){const W=Ne(le,"servers",u,"members",xe.id);me.update(W,{role:"member"})}}),u){const xe=Ne(le,"servers",u,"roles",K);me.delete(xe),await me.commit(),P(`Role '${je}' deleted and ${Ae.length} users reassigned to Member`)}}catch(ue){console.error("Error deleting role:",ue),ne(`Failed to delete role: ${ue.message}`)}},fe=[{id:"admin",name:"admin",color:"#f23f42",isDefault:!0,position:-3},{id:"moderator",name:"moderator",color:"#faa81a",isDefault:!0,position:-2},{id:"member",name:"member",color:"#80848e",isDefault:!0,position:-1},...j].sort((K,ue)=>(K.position??999)-(ue.position??999)),Re=(K,ue)=>{D(ue),K.dataTransfer.effectAllowed="move"},dt=K=>{K.preventDefault(),K.dataTransfer.dropEffect="move"},ye=async(K,ue)=>{if(K.preventDefault(),!R||R===ue){D(null);return}const je=fe.find(Ae=>Ae.id===R),me=fe.find(Ae=>Ae.id===ue);if(je?.isDefault||me?.isDefault){D(null);return}try{const Ae=je.position??0,xe=me.position??0;u&&(await it(Ne(le,"servers",u,"roles",R),{position:xe}),await it(Ne(le,"servers",u,"roles",ue),{position:Ae}))}catch(Ae){console.error("Error reordering roles:",Ae)}D(null)},Ve=YH.reduce((K,ue)=>(K[ue.category]||(K[ue.category]=[]),K[ue.category].push(ue),K),{}),De=()=>{switch(h){case"users":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"User Management"}),c.jsx("p",{className:"text-dark-muted",children:"Manage server members, assign roles, and moderate users."}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsxs("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:["Members  ",r.length]}),c.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:r.map(K=>c.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-dark-hover transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary flex items-center justify-center text-white font-semibold",children:K.displayName?.[0]?.toUpperCase()||"U"}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-medium text-dark-text",children:K.displayName}),c.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{backgroundColor:`${fe.find(ue=>ue.name===(K.serverRole||K.role))?.color}20`,color:fe.find(ue=>ue.name===(K.serverRole||K.role))?.color},children:K.serverRole||K.role}),K.isMuted&&c.jsx("span",{className:"text-xs text-yellow-500",children:"MUTED"}),K.isBanned&&c.jsx("span",{className:"text-xs text-red-500",children:"BANNED"})]}),c.jsx("div",{className:"text-sm text-dark-muted",children:K.email})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(st,{size:"sm",variant:K.isMuted?"warning":"secondary",onClick:()=>re(K.id,K.isMuted),children:K.isMuted?"Unmute":"Mute"}),c.jsx(st,{size:"sm",variant:K.isBanned?"danger":"secondary",onClick:()=>he(K.id,K.isBanned),children:K.isBanned?"Unban":"Ban"}),c.jsx(st,{size:"sm",variant:"ghost",onClick:()=>y(K),children:c.jsx(pc,{size:16})})]})]},K.id))})]})]});case"roles":return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Roles"}),c.jsx("p",{className:"text-dark-muted mt-1",children:"Use roles to organize your members and customize permissions."})]}),c.jsxs("div",{className:"bg-dark-bg rounded-xl p-6 border border-dark-hover",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary/20 flex items-center justify-center",children:c.jsx(Yo,{className:"text-brand-primary",size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-dark-text",children:"Create New Role"}),c.jsx("p",{className:"text-sm text-dark-muted",children:"Add a custom role with a unique color"})]})]}),c.jsxs("div",{className:"flex gap-4 items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-xs font-medium text-dark-muted uppercase tracking-wide mb-2",children:"Role Name"}),c.jsx(bn,{placeholder:"e.g. VIP, Helper, Supporter...",value:w.name,onChange:K=>S({...w,name:K.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-dark-muted uppercase tracking-wide mb-2",children:"Color"}),c.jsx("div",{className:"relative",children:c.jsx("input",{type:"color",value:w.color,onChange:K=>S({...w,color:K.target.value}),className:"w-14 h-10 rounded-lg cursor-pointer border-2 border-dark-hover hover:border-brand-primary transition-colors",style:{backgroundColor:w.color}})})]}),c.jsxs(st,{onClick:Ie,disabled:!w.name.trim(),className:"px-6",children:[c.jsx(Yo,{size:18,className:"mr-1"}),"Create Role"]})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-xl border border-dark-hover overflow-hidden",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-dark-hover flex items-center justify-between",children:[c.jsxs("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide",children:["Roles  ",fe.length]}),c.jsx("span",{className:"text-xs text-dark-muted",children:"Drag custom roles to reorder hierarchy"})]}),c.jsxs("div",{className:"divide-y divide-dark-hover",children:[fe.map((K,ue)=>c.jsxs("div",{draggable:!K.isDefault,onDragStart:je=>Re(je,K.id),onDragOver:dt,onDrop:je=>ye(je,K.id),className:Ht("group flex items-center justify-between px-6 py-4 transition-colors",!K.isDefault&&"cursor-grab active:cursor-grabbing hover:bg-dark-sidebar/50",K.isDefault&&"opacity-70",R===K.id&&"opacity-50 bg-brand-primary/10"),children:[c.jsxs("div",{className:"flex items-center gap-4",children:[!K.isDefault&&c.jsx("div",{className:"text-dark-muted opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(A7,{size:20})}),c.jsx("div",{className:"w-5 h-5 rounded-full ring-2 ring-offset-2 ring-offset-dark-bg",style:{backgroundColor:K.color,ringColor:K.color}}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-semibold text-dark-text",style:{color:K.color},children:K.name}),K.isDefault&&c.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-dark-hover text-dark-muted rounded-full uppercase font-medium",children:"System"})]}),c.jsx("p",{className:"text-xs text-dark-muted mt-0.5",children:K.isDefault?"Default system role":`Position: ${K.position??0}`})]})]}),!K.isDefault&&c.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>H(K),className:"p-2 rounded-lg hover:bg-dark-hover text-dark-muted hover:text-brand-primary transition-colors",title:"Edit Role",children:c.jsx(pc,{size:18})}),c.jsx("button",{onClick:()=>U({type:"role",data:K.id,name:K.name}),className:"p-2 rounded-lg hover:bg-red-500/20 text-dark-muted hover:text-red-500 transition-colors",title:"Delete Role",children:c.jsx(Ki,{size:18})})]})]},K.id)),fe.length===0&&c.jsxs("div",{className:"px-6 py-12 text-center",children:[c.jsx(dN,{className:"mx-auto text-dark-muted mb-3",size:40}),c.jsx("p",{className:"text-dark-muted",children:"No roles created yet"}),c.jsx("p",{className:"text-xs text-dark-muted mt-1",children:"Create your first role above!"})]})]})]})]});case"channels":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Channels"}),c.jsx("p",{className:"text-dark-muted",children:"Create and manage server channels."}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:"Create New Channel"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("div",{className:"flex-1 space-y-2",children:[c.jsxs("div",{className:"flex gap-2 mb-2",children:[c.jsx("button",{onClick:()=>N("text"),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${A==="text"?"border-brand-primary bg-brand-primary/20 text-brand-primary":"border-dark-hover text-dark-muted hover:border-dark-muted"}`,children:"# Yaz Kanal"}),c.jsx("button",{onClick:()=>N("voice"),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${A==="voice"?"border-green-500 bg-green-500/20 text-green-500":"border-dark-hover text-dark-muted hover:border-dark-muted"}`,children:" Sesli Kanal"})]}),c.jsx(bn,{placeholder:"Channel name",value:b,onChange:K=>x(K.target.value)}),A==="text"&&c.jsx(bn,{placeholder:"Channel topic/description (Optional)",value:k,onChange:K=>I(K.target.value)})]}),c.jsxs(st,{onClick:Te,className:"h-fit mt-auto",children:[c.jsx(Yo,{size:20}),"Create"]})]})]}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[c.jsxs("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide mb-4",children:["Text Channels  ",a.length]}),c.jsx("div",{className:"space-y-2",children:a.map(K=>c.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-dark-hover transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Bp,{className:"text-dark-muted"}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-medium text-dark-text",children:K.name}),K.description&&c.jsx("span",{className:"text-xs text-dark-muted ml-2 truncate max-w-[200px]",children:K.description}),K.locked&&c.jsxs("span",{className:"text-xs px-2 py-0.5 rounded bg-yellow-500/20 text-yellow-500 flex items-center gap-1",children:[c.jsx(Up,{size:12}),"LOCKED"]})]}),c.jsx("div",{className:"text-xs text-dark-muted",children:K.locked?"Only admins can send messages":"Everyone can send messages"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(st,{size:"sm",variant:"ghost",onClick:()=>F(K),children:c.jsx(pc,{size:16})}),c.jsx(st,{size:"sm",variant:K.locked?"warning":"secondary",onClick:()=>Oe(K.id,K.locked),children:K.locked?"Unlock":"Lock"}),c.jsx(st,{size:"sm",variant:"danger",onClick:()=>U({type:"channel",data:K.id,name:K.name}),children:c.jsx(Ki,{size:16})})]})]},K.id))})]})]});case"server":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Server Overview"}),c.jsx("p",{className:"text-dark-muted",children:"View server statistics and information."}),c.jsxs("div",{className:"bg-dark-bg rounded-lg p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"text-xs text-dark-muted uppercase tracking-wide mb-1",children:"Server Name"}),c.jsx("div",{className:"text-2xl font-bold text-dark-text",children:o?.name||"Unknown"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-dark-sidebar p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-brand-primary mb-1",children:r.length}),c.jsx("div",{className:"text-sm text-dark-muted",children:"Members"})]}),c.jsxs("div",{className:"bg-dark-sidebar p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-green-500 mb-1",children:a.length}),c.jsx("div",{className:"text-sm text-dark-muted",children:"Channels"})]}),c.jsxs("div",{className:"bg-dark-sidebar p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-purple-500 mb-1",children:fe.length}),c.jsx("div",{className:"text-sm text-dark-muted",children:"Roles"})]})]})]})]});case"logs":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Audit Log"}),c.jsx("p",{className:"text-dark-muted",children:"View server activity and moderation history."}),c.jsx(GH,{})]});case"notifications":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Push Notifications"}),c.jsx("p",{className:"text-dark-muted",children:"View and copy user FCM tokens for manual testing."}),c.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-hover overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-dark-hover",children:c.jsxs("h3",{className:"text-sm font-semibold text-dark-muted uppercase tracking-wide",children:["Registered Devices  ",r.filter(K=>K.fcmTokens).length," / ",r.length]})}),c.jsx("div",{className:"divide-y divide-dark-hover max-h-[600px] overflow-y-auto",children:r.map(K=>c.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-dark-sidebar/50 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary flex items-center justify-center text-white shrink-0",children:K.displayName?.[0]?.toUpperCase()||"U"}),c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("div",{className:"font-medium text-dark-text truncate",children:K.displayName}),c.jsx("div",{className:"text-xs font-mono text-dark-muted truncate max-w-[400px]",children:K.fcmTokens||"No token registered"})]})]}),c.jsx("div",{className:"flex items-center gap-2",children:K.fcmTokens?c.jsxs(st,{size:"sm",variant:"secondary",onClick:()=>{navigator.clipboard.writeText(K.fcmTokens),P("Token copied to clipboard!")},children:[c.jsx(uN,{size:16,className:"mr-1"}),"Copy"]}):c.jsx("span",{className:"text-xs text-dark-muted italic px-2",children:"Offline/No Device"})})]},K.id))})]})]});case"cleanup":return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Database Cleanup"}),c.jsx("p",{className:"text-dark-muted",children:"Remove unused data to keep your database clean and reduce storage costs."}),c.jsx("div",{className:"grid gap-4",children:c.jsxs("div",{className:"bg-dark-bg rounded-lg p-6 border border-dark-hover",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-dark-text",children:"Expired Invite Codes"}),c.jsx("p",{className:"text-sm text-dark-muted mt-1",children:"Expired, used, or deactivated invite codes that are no longer valid."})]}),c.jsx("div",{className:"text-3xl font-bold text-yellow-500",children:oe})]}),c.jsxs(st,{variant:"warning",onClick:()=>Le("invites"),disabled:oe===0||Z,className:"w-full",children:[c.jsx(Ki,{size:20}),Z?"Cleaning...":"Clean Invite Codes"]})]})}),c.jsxs("div",{className:"text-xs text-dark-muted bg-dark-sidebar p-4 rounded-lg",children:[c.jsx("strong",{children:"Note:"})," These actions are irreversible. Deleted data cannot be recovered. Running cleanup periodically helps keep your Firestore quota usage low."]})]});default:return null}};return c.jsxs("div",{className:"fixed inset-0 bg-black/80 z-[100] flex flex-col md:flex-row pt-safe-top md:pt-0",children:[c.jsx("div",{className:"w-full md:w-56 bg-dark-sidebar flex flex-col shrink-0 border-b md:border-b-0 md:border-r border-dark-hover",children:c.jsx("div",{className:"flex md:flex-col overflow-x-auto md:overflow-y-auto py-2 md:py-4 px-2 gap-2 md:gap-0 no-scrollbar",children:Object.entries(Ve).map(([K,ue])=>c.jsxs("div",{className:"mb-0 md:mb-4 flex md:block gap-2 md:gap-0 shrink-0",children:[c.jsx("div",{className:"hidden md:block px-3 py-2 text-xs font-semibold text-dark-muted uppercase tracking-wide",children:K}),ue.map(je=>{const me=je.icon;return c.jsxs("button",{onClick:()=>f(je.id),className:Ht("whitespace-nowrap flex items-center gap-2 md:gap-3 px-3 py-2 rounded-md text-left transition-colors",h===je.id?"bg-dark-hover text-dark-text":"text-dark-muted hover:text-dark-text hover:bg-dark-hover/50"),children:[c.jsx(me,{size:18}),c.jsx("span",{className:"text-sm",children:je.label})]},je.id)})]},K))})}),c.jsxs("div",{className:"flex-1 flex flex-col bg-dark-bg overflow-hidden min-w-0",children:[c.jsx("div",{className:"flex justify-end p-4 shrink-0",children:c.jsx("button",{onClick:e,className:"p-2 hover:bg-dark-hover rounded-full transition-colors group",title:"Close (ESC)",children:c.jsx($n,{size:24,className:"text-dark-muted group-hover:text-dark-text"})})}),c.jsx("div",{className:"flex-1 overflow-y-auto px-4 md:px-10 pb-10",children:c.jsx("div",{className:"max-w-3xl mx-auto md:mx-0",children:De()})})]}),p&&(()=>{const K=r.find(ue=>ue.id===p.id)||p;return c.jsx(Ds,{isOpen:!!p,onClose:()=>y(null),title:"Edit User Role",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-dark-muted mb-1",children:"User"}),c.jsx("div",{className:"font-medium text-dark-text",children:K.displayName})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-dark-muted mb-2",children:"Select Role"}),c.jsx("div",{className:"space-y-2",children:fe.map(ue=>c.jsxs("button",{onClick:()=>X(p.id,ue.name),className:Ht("w-full px-3 py-2 rounded-lg border text-left transition-all flex items-center gap-3",(K.serverRole||K.role)===ue.name?"border-brand-primary bg-brand-primary/20":"border-dark-hover hover:bg-dark-hover"),children:[c.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ue.color}}),c.jsx("span",{className:"text-dark-text",children:ue.name})]},ue.id))})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-dark-muted mb-2",children:"Badges"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.values(pb).map(ue=>{const je=K.badges?.includes(ue.id),me=ue.icon;return c.jsxs("button",{onClick:async()=>{try{await it(Ne(le,"users",p.id),{badges:je?Vd(ue.id):uh(ue.id)}),P(je?`${ue.label} badge removed`:`${ue.label} badge granted`)}catch{ne("Failed to update badge")}},className:Ht("flex items-center gap-2 px-3 py-2 rounded-lg border text-left transition-all",je?"border-brand-primary bg-brand-primary/20":"border-dark-hover hover:bg-dark-hover"),children:[c.jsx(me,{size:16,style:{color:ue.color}}),c.jsx("span",{className:"text-dark-text text-sm",children:ue.label})]},ue.id)})})]})]})})})(),B&&c.jsx(Ds,{isOpen:!!B,onClose:()=>H(null),title:"Edit Role",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx(bn,{label:"Role Name",value:B.name,onChange:K=>H({...B,name:K.target.value})}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-dark-text mb-2 block",children:"Role Color"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"color",value:B.color,onChange:K=>H({...B,color:K.target.value}),className:"w-14 h-10 rounded cursor-pointer"}),c.jsx(bn,{value:B.color,onChange:K=>H({...B,color:K.target.value}),className:"flex-1"})]})]}),c.jsx(st,{variant:"primary",className:"w-full",onClick:()=>We(B.id,{name:B.name,color:B.color}),children:"Save Changes"})]})}),V&&c.jsx(Ds,{isOpen:!!V,onClose:()=>F(null),title:"Edit Channel",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx(bn,{label:"Channel Name",value:V.name,onChange:K=>F({...V,name:K.target.value})}),c.jsx(bn,{label:"Channel Topic / Description",value:V.description||"",onChange:K=>F({...V,description:K.target.value})}),c.jsx(st,{variant:"primary",className:"w-full",onClick:()=>Ue(V.id,{name:V.name,description:V.description}),children:"Save Changes"})]})}),c.jsx(Ac,{isOpen:!!L,onClose:()=>U(null),onConfirm:L?.type==="channel"?te:ke,title:`Delete ${L?.type==="channel"?"Channel":"Role"}`,message:`Are you sure you want to delete "${L?.name}"? This cannot be undone.`,confirmText:"Delete",variant:"danger"}),c.jsx(Ac,{isOpen:!!Se,onClose:()=>Le(null),onConfirm:$,title:"Clean Invite Codes",message:`Are you sure you want to delete ${oe} expired/used invite code(s)? This action cannot be undone.`,confirmText:"Clean",variant:"danger"})]})},QH=({isOpen:t,onClose:e,userId:n,onSuccess:r})=>{const[a,o]=T.useState(""),[u,h]=T.useState(null),[f,p]=T.useState(null),[y,b]=T.useState(!1),[x,k]=T.useState({progress:0,speed:""}),I=T.useRef(null),{success:A,error:N}=Fr(),V=j=>{const O=j.target.files?.[0];if(O){if(!O.type.startsWith("image/")){N("Please select an image file");return}if(O.size>10*1024*1024){N("Image size must be less than 10MB");return}h(O),p(URL.createObjectURL(O))}},F=async()=>{if(!a.trim()){N("Server name is required");return}b(!0);try{let j=null;u&&(j=await Hd(u,(B,H)=>{k({progress:B,speed:H})}));const O=await Kn(_t(le,"servers"),{name:a.trim(),icon:j,ownerId:n,createdAt:ht(),isDefault:!1,memberCount:1});await Xn(Ne(le,"servers",O.id,"members",n),{userId:n,joinedAt:ht(),role:"admin"}),await Kn(_t(le,"servers",O.id,"channels"),{name:"general",type:"text",description:"General discussion",position:0,createdAt:ht()}),await it(Ne(le,"users",n),{servers:uh(O.id),currentServer:O.id}),A("Server created successfully!"),o(""),h(null),f&&URL.revokeObjectURL(f),p(null),r&&r(O.id),e()}catch(j){console.error("Error creating server:",j),N("Failed to create server")}finally{b(!1),k({progress:0,speed:""})}};return c.jsx(Ds,{isOpen:t,onClose:e,title:"Create Server",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("input",{type:"file",ref:I,onChange:V,accept:"image/*",className:"hidden"}),c.jsx("button",{onClick:()=>I.current?.click(),className:"w-20 h-20 rounded-full bg-dark-hover border-2 border-dashed border-dark-muted hover:border-brand-primary flex items-center justify-center transition-colors overflow-hidden",children:f?c.jsx("img",{src:f,alt:"Preview",className:"w-full h-full object-cover"}):c.jsx(M7,{size:32,className:"text-dark-muted"})}),c.jsx("span",{className:"text-xs text-dark-muted mt-2",children:"Server Icon (Optional)"})]}),y&&u&&x.progress>0&&c.jsxs("div",{className:"text-xs text-dark-muted text-center",children:["Uploading icon: ",Math.round(x.progress),"% (",x.speed,")"]}),c.jsx(bn,{label:"Server Name",placeholder:"My Awesome Server",value:a,onChange:j=>o(j.target.value),maxLength:50,autoFocus:!0}),c.jsxs("div",{className:"text-xs text-dark-muted",children:[a.length,"/50 characters"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:e,className:"flex-1",children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:F,disabled:!a.trim()||y,className:"flex-1",children:y?"Creating...":"Create Server"})]})]})})},XH=({isOpen:t,onClose:e,userId:n,onSuccess:r})=>{const[a,o]=T.useState(""),[u,h]=T.useState(!1),{success:f,error:p}=Fr(),y=async()=>{if(!a.trim()){p("Invite code is required");return}h(!0);try{const b=a.trim().toUpperCase(),x=Ne(le,"inviteCodes",b),k=await Jo(x);if(!k.exists()){p("Invalid invite code");return}const I=k.data();if(!I.isActive){p("This invite code has already been used");return}const A=I.isUnlimited===!0||I.maxUses===-1;if(!A&&I.uses>=I.maxUses){p("This invite code has reached its usage limit");return}if(I.expiresAt.toDate()<new Date){p("This invite code has expired");return}await Xn(Ne(le,"servers",I.serverId,"members",n),{userId:n,joinedAt:ht(),role:"member"}),await it(Ne(le,"users",n),{servers:uh(I.serverId),currentServer:I.serverId});const N={uses:Ui(1)};A||(N.isActive=!1),await it(x,N),await it(Ne(le,"servers",I.serverId),{memberCount:Ui(1)}),f("Successfully joined server!"),o(""),r&&r(I.serverId),e()}catch(b){console.error("Error joining server:",b),console.error("Error code:",b.code),console.error("Error message:",b.message),b.code!=="permission-denied"?b.code==="not-found"?p("Server not found"):p(`Failed to join server: ${b.message}`):e()}finally{h(!1)}};return c.jsx(Ds,{isOpen:t,onClose:e,title:"Join Server",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx(bn,{label:"Invite Code",placeholder:"ABC12XYZ",value:a,onChange:b=>o(b.target.value.toUpperCase()),maxLength:8,autoFocus:!0}),c.jsx("div",{className:"text-xs text-dark-muted",children:"Enter the 8-character invite code"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(st,{variant:"secondary",onClick:e,className:"flex-1",children:"Cancel"}),c.jsx(st,{variant:"primary",onClick:y,disabled:a.length!==8||u,className:"flex-1",children:u?"Joining...":"Join Server"})]})]})})},WH=({isOpen:t,onClose:e})=>{const{availableDevices:n,selectedMicId:r,setSelectedMicId:a,selectedCameraId:o,setSelectedCameraId:u}=Qc();return t?c.jsx("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center animate-fade-in",children:c.jsxs("div",{className:"bg-dark-elem w-full max-w-md rounded-2xl shadow-2xl border border-dark-hover overflow-hidden p-6 relative",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[c.jsx(Up,{size:28,className:"text-brand-primary"}),"Device Settings"]}),c.jsx("button",{onClick:e,className:"p-1 hover:bg-dark-hover rounded-full transition-colors text-dark-muted hover:text-white",children:c.jsx($n,{size:24})})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs font-bold text-dark-muted uppercase tracking-wider mb-2 flex items-center gap-2",children:[c.jsx(by,{size:16})," Microphone"]}),c.jsxs("select",{className:"w-full bg-dark-input border border-dark-hover rounded-lg p-3 text-white focus:ring-2 focus:ring-brand-primary outline-none transition-all",value:r,onChange:h=>a(h.target.value),children:[n.audioInputs.map(h=>c.jsx("option",{value:h.deviceId,children:h.label||`Microphone ${h.deviceId.slice(0,5)}...`},h.deviceId)),n.audioInputs.length===0&&c.jsx("option",{value:"",children:"No microphone found"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs font-bold text-dark-muted uppercase tracking-wider mb-2 flex items-center gap-2",children:[c.jsx(Ud,{size:16})," Camera"]}),c.jsxs("select",{className:"w-full bg-dark-input border border-dark-hover rounded-lg p-3 text-white focus:ring-2 focus:ring-brand-primary outline-none transition-all",value:o,onChange:h=>u(h.target.value),children:[n.videoInputs.map(h=>c.jsx("option",{value:h.deviceId,children:h.label||`Camera ${h.deviceId.slice(0,5)}...`},h.deviceId)),n.videoInputs.length===0&&c.jsx("option",{value:"",children:"No camera found"})]})]}),c.jsx("div",{className:"pt-4 border-t border-dark-hover flex justify-end",children:c.jsx(st,{variant:"primary",onClick:e,children:"Done"})})]})]})}):null};var sd={exports:{}},U0={},z0={exports:{}},B0,V4;function JH(){if(V4)return B0;V4=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return B0=t,B0}var F0,U4;function ZH(){if(U4)return F0;U4=1;var t=JH();function e(){}function n(){}return n.resetWarningCache=e,F0=function(){function r(u,h,f,p,y,b){if(b!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:e};return o.PropTypes=o,o},F0}var z4;function dR(){return z4||(z4=1,z0.exports=ZH()()),z0.exports}var Zf={exports:{}},B4;function e$(){if(B4)return Zf.exports;B4=1;function t(n){var r,a,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n)){var u=n.length;for(r=0;r<u;r++)n[r]&&(a=t(n[r]))&&(o&&(o+=" "),o+=a)}else for(a in n)n[a]&&(o&&(o+=" "),o+=a);return o}function e(){for(var n,r,a=0,o="",u=arguments.length;a<u;a++)(n=arguments[a])&&(r=t(n))&&(o&&(o+=" "),o+=r);return o}return Zf.exports=e,Zf.exports.clsx=e,Zf.exports}var Nn={},Ba={},F4;function eg(){if(F4)return Ba;F4=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.dontSetMe=a,Ba.findInArray=t,Ba.int=r,Ba.isFunction=e,Ba.isNum=n;function t(o,u){for(let h=0,f=o.length;h<f;h++)if(u.apply(u,[o[h],h,o]))return o[h]}function e(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Function]"}function n(o){return typeof o=="number"&&!isNaN(o)}function r(o){return parseInt(o,10)}function a(o,u,h){if(o[u])return new Error(`Invalid prop ${u} passed to ${h} - do not set this, set it on the child.`)}return Ba}var Fa={},H4;function t$(){if(H4)return Fa;H4=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.browserPrefixToKey=n,Fa.browserPrefixToStyle=r,Fa.default=void 0,Fa.getPrefix=e;const t=["Moz","Webkit","O","ms"];function e(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const u=window.document?.documentElement?.style;if(!u||o in u)return"";for(let h=0;h<t.length;h++)if(n(o,t[h])in u)return t[h];return""}function n(o,u){return u?`${u}${a(o)}`:o}function r(o,u){return u?`-${u.toLowerCase()}-${o}`:o}function a(o){let u="",h=!0;for(let f=0;f<o.length;f++)h?(u+=o[f].toUpperCase(),h=!1):o[f]==="-"?h=!0:u+=o[f];return u}return Fa.default=e(),Fa}var $4;function $b(){if($4)return Nn;$4=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.addClassName=B,Nn.addEvent=u,Nn.addUserSelectStyles=F,Nn.createCSSTransform=k,Nn.createSVGTransform=I,Nn.getTouch=N,Nn.getTouchIdentifier=V,Nn.getTranslation=A,Nn.innerHeight=y,Nn.innerWidth=b,Nn.matchesSelector=a,Nn.matchesSelectorAndParentsTo=o,Nn.offsetXYFromParent=x,Nn.outerHeight=f,Nn.outerWidth=p,Nn.removeClassName=H,Nn.removeEvent=h,Nn.scheduleRemoveUserSelectStyles=j;var t=eg(),e=n(t$());function n(w,S){if(typeof WeakMap=="function")var R=new WeakMap,D=new WeakMap;return(n=function(L,U){if(!U&&L&&L.__esModule)return L;var P,ne,oe={__proto__:null,default:L};if(L===null||typeof L!="object"&&typeof L!="function")return oe;if(P=U?D:R){if(P.has(L))return P.get(L);P.set(L,oe)}for(const G in L)G!=="default"&&{}.hasOwnProperty.call(L,G)&&((ne=(P=Object.defineProperty)&&Object.getOwnPropertyDescriptor(L,G))&&(ne.get||ne.set)?P(oe,G,ne):oe[G]=L[G]);return oe})(w,S)}let r="";function a(w,S){return r||(r=(0,t.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(R){return(0,t.isFunction)(w[R])})),(0,t.isFunction)(w[r])?w[r](S):!1}function o(w,S,R){let D=w;do{if(a(D,S))return!0;if(D===R)return!1;D=D.parentNode}while(D);return!1}function u(w,S,R,D){if(!w)return;const L={capture:!0,...D};w.addEventListener?w.addEventListener(S,R,L):w.attachEvent?w.attachEvent("on"+S,R):w["on"+S]=R}function h(w,S,R,D){if(!w)return;const L={capture:!0,...D};w.removeEventListener?w.removeEventListener(S,R,L):w.detachEvent?w.detachEvent("on"+S,R):w["on"+S]=null}function f(w){let S=w.clientHeight;const R=w.ownerDocument.defaultView.getComputedStyle(w);return S+=(0,t.int)(R.borderTopWidth),S+=(0,t.int)(R.borderBottomWidth),S}function p(w){let S=w.clientWidth;const R=w.ownerDocument.defaultView.getComputedStyle(w);return S+=(0,t.int)(R.borderLeftWidth),S+=(0,t.int)(R.borderRightWidth),S}function y(w){let S=w.clientHeight;const R=w.ownerDocument.defaultView.getComputedStyle(w);return S-=(0,t.int)(R.paddingTop),S-=(0,t.int)(R.paddingBottom),S}function b(w){let S=w.clientWidth;const R=w.ownerDocument.defaultView.getComputedStyle(w);return S-=(0,t.int)(R.paddingLeft),S-=(0,t.int)(R.paddingRight),S}function x(w,S,R){const L=S===S.ownerDocument.body?{left:0,top:0}:S.getBoundingClientRect(),U=(w.clientX+S.scrollLeft-L.left)/R,P=(w.clientY+S.scrollTop-L.top)/R;return{x:U,y:P}}function k(w,S){const R=A(w,S,"px");return{[(0,e.browserPrefixToKey)("transform",e.default)]:R}}function I(w,S){return A(w,S,"")}function A(w,S,R){let{x:D,y:L}=w,U=`translate(${D}${R},${L}${R})`;if(S){const P=`${typeof S.x=="string"?S.x:S.x+R}`,ne=`${typeof S.y=="string"?S.y:S.y+R}`;U=`translate(${P}, ${ne})`+U}return U}function N(w,S){return w.targetTouches&&(0,t.findInArray)(w.targetTouches,R=>S===R.identifier)||w.changedTouches&&(0,t.findInArray)(w.changedTouches,R=>S===R.identifier)}function V(w){if(w.targetTouches&&w.targetTouches[0])return w.targetTouches[0].identifier;if(w.changedTouches&&w.changedTouches[0])return w.changedTouches[0].identifier}function F(w){if(!w)return;let S=w.getElementById("react-draggable-style-el");S||(S=w.createElement("style"),S.type="text/css",S.id="react-draggable-style-el",S.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,S.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,w.getElementsByTagName("head")[0].appendChild(S)),w.body&&B(w.body,"react-draggable-transparent-selection")}function j(w){window.requestAnimationFrame?window.requestAnimationFrame(()=>{O(w)}):O(w)}function O(w){if(w)try{if(w.body&&H(w.body,"react-draggable-transparent-selection"),w.selection)w.selection.empty();else{const S=(w.defaultView||window).getSelection();S&&S.type!=="Caret"&&S.removeAllRanges()}}catch{}}function B(w,S){w.classList?w.classList.add(S):w.className.match(new RegExp(`(?:^|\\s)${S}(?!\\S)`))||(w.className+=` ${S}`)}function H(w,S){w.classList?w.classList.remove(S):w.className=w.className.replace(new RegExp(`(?:^|\\s)${S}(?!\\S)`,"g"),"")}return Nn}var Zs={},q4;function hR(){if(q4)return Zs;q4=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.canDragX=a,Zs.canDragY=o,Zs.createCoreData=h,Zs.createDraggableData=f,Zs.getBoundPosition=n,Zs.getControlPosition=u,Zs.snapToGrid=r;var t=eg(),e=$b();function n(b,x,k){if(!b.props.bounds)return[x,k];let{bounds:I}=b.props;I=typeof I=="string"?I:p(I);const A=y(b);if(typeof I=="string"){const{ownerDocument:N}=A,V=N.defaultView;let F;if(I==="parent"?F=A.parentNode:F=A.getRootNode().querySelector(I),!(F instanceof V.HTMLElement))throw new Error('Bounds selector "'+I+'" could not find an element.');const j=F,O=V.getComputedStyle(A),B=V.getComputedStyle(j);I={left:-A.offsetLeft+(0,t.int)(B.paddingLeft)+(0,t.int)(O.marginLeft),top:-A.offsetTop+(0,t.int)(B.paddingTop)+(0,t.int)(O.marginTop),right:(0,e.innerWidth)(j)-(0,e.outerWidth)(A)-A.offsetLeft+(0,t.int)(B.paddingRight)-(0,t.int)(O.marginRight),bottom:(0,e.innerHeight)(j)-(0,e.outerHeight)(A)-A.offsetTop+(0,t.int)(B.paddingBottom)-(0,t.int)(O.marginBottom)}}return(0,t.isNum)(I.right)&&(x=Math.min(x,I.right)),(0,t.isNum)(I.bottom)&&(k=Math.min(k,I.bottom)),(0,t.isNum)(I.left)&&(x=Math.max(x,I.left)),(0,t.isNum)(I.top)&&(k=Math.max(k,I.top)),[x,k]}function r(b,x,k){const I=Math.round(x/b[0])*b[0],A=Math.round(k/b[1])*b[1];return[I,A]}function a(b){return b.props.axis==="both"||b.props.axis==="x"}function o(b){return b.props.axis==="both"||b.props.axis==="y"}function u(b,x,k){const I=typeof x=="number"?(0,e.getTouch)(b,x):null;if(typeof x=="number"&&!I)return null;const A=y(k),N=k.props.offsetParent||A.offsetParent||A.ownerDocument.body;return(0,e.offsetXYFromParent)(I||b,N,k.props.scale)}function h(b,x,k){const I=!(0,t.isNum)(b.lastX),A=y(b);return I?{node:A,deltaX:0,deltaY:0,lastX:x,lastY:k,x,y:k}:{node:A,deltaX:x-b.lastX,deltaY:k-b.lastY,lastX:b.lastX,lastY:b.lastY,x,y:k}}function f(b,x){const k=b.props.scale;return{node:x.node,x:b.state.x+x.deltaX/k,y:b.state.y+x.deltaY/k,deltaX:x.deltaX/k,deltaY:x.deltaY/k,lastX:b.state.x,lastY:b.state.y}}function p(b){return{left:b.left,top:b.top,right:b.right,bottom:b.bottom}}function y(b){const x=b.findDOMNode();if(!x)throw new Error("<DraggableCore>: Unmounted during event!");return x}return Zs}var id={},em={},G4;function fR(){if(G4)return em;G4=1,Object.defineProperty(em,"__esModule",{value:!0}),em.default=t;function t(){}return em}var Y4;function n$(){if(Y4)return id;Y4=1,Object.defineProperty(id,"__esModule",{value:!0}),id.default=void 0;var t=f(lo()),e=h(dR()),n=h(Gy()),r=$b(),a=hR(),o=eg(),u=h(fR());function h(A){return A&&A.__esModule?A:{default:A}}function f(A,N){if(typeof WeakMap=="function")var V=new WeakMap,F=new WeakMap;return(f=function(j,O){if(!O&&j&&j.__esModule)return j;var B,H,w={__proto__:null,default:j};if(j===null||typeof j!="object"&&typeof j!="function")return w;if(B=O?F:V){if(B.has(j))return B.get(j);B.set(j,w)}for(const S in j)S!=="default"&&{}.hasOwnProperty.call(j,S)&&((H=(B=Object.defineProperty)&&Object.getOwnPropertyDescriptor(j,S))&&(H.get||H.set)?B(w,S,H):w[S]=j[S]);return w})(A,N)}function p(A,N,V){return(N=y(N))in A?Object.defineProperty(A,N,{value:V,enumerable:!0,configurable:!0,writable:!0}):A[N]=V,A}function y(A){var N=b(A,"string");return typeof N=="symbol"?N:N+""}function b(A,N){if(typeof A!="object"||!A)return A;var V=A[Symbol.toPrimitive];if(V!==void 0){var F=V.call(A,N);if(typeof F!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(N==="string"?String:Number)(A)}const x={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let k=x.mouse,I=class extends t.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",N=>{if(this.props.onMouseDown(N),!this.props.allowAnyClick&&typeof N.button=="number"&&N.button!==0)return!1;const V=this.findDOMNode();if(!V||!V.ownerDocument||!V.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:F}=V;if(this.props.disabled||!(N.target instanceof F.defaultView.Node)||this.props.handle&&!(0,r.matchesSelectorAndParentsTo)(N.target,this.props.handle,V)||this.props.cancel&&(0,r.matchesSelectorAndParentsTo)(N.target,this.props.cancel,V))return;N.type==="touchstart"&&!this.props.allowMobileScroll&&N.preventDefault();const j=(0,r.getTouchIdentifier)(N);this.touchIdentifier=j;const O=(0,a.getControlPosition)(N,j,this);if(O==null)return;const{x:B,y:H}=O,w=(0,a.createCoreData)(this,B,H);(0,u.default)("DraggableCore: handleDragStart: %j",w),(0,u.default)("calling",this.props.onStart),!(this.props.onStart(N,w)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,r.addUserSelectStyles)(F),this.dragging=!0,this.lastX=B,this.lastY=H,(0,r.addEvent)(F,k.move,this.handleDrag),(0,r.addEvent)(F,k.stop,this.handleDragStop))}),p(this,"handleDrag",N=>{const V=(0,a.getControlPosition)(N,this.touchIdentifier,this);if(V==null)return;let{x:F,y:j}=V;if(Array.isArray(this.props.grid)){let H=F-this.lastX,w=j-this.lastY;if([H,w]=(0,a.snapToGrid)(this.props.grid,H,w),!H&&!w)return;F=this.lastX+H,j=this.lastY+w}const O=(0,a.createCoreData)(this,F,j);if((0,u.default)("DraggableCore: handleDrag: %j",O),this.props.onDrag(N,O)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const w=document.createEvent("MouseEvents");w.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(w)}return}this.lastX=F,this.lastY=j}),p(this,"handleDragStop",N=>{if(!this.dragging)return;const V=(0,a.getControlPosition)(N,this.touchIdentifier,this);if(V==null)return;let{x:F,y:j}=V;if(Array.isArray(this.props.grid)){let w=F-this.lastX||0,S=j-this.lastY||0;[w,S]=(0,a.snapToGrid)(this.props.grid,w,S),F=this.lastX+w,j=this.lastY+S}const O=(0,a.createCoreData)(this,F,j);if(this.props.onStop(N,O)===!1||this.mounted===!1)return!1;const H=this.findDOMNode();H&&this.props.enableUserSelectHack&&(0,r.scheduleRemoveUserSelectStyles)(H.ownerDocument),(0,u.default)("DraggableCore: handleDragStop: %j",O),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,H&&((0,u.default)("DraggableCore: Removing handlers"),(0,r.removeEvent)(H.ownerDocument,k.move,this.handleDrag),(0,r.removeEvent)(H.ownerDocument,k.stop,this.handleDragStop))}),p(this,"onMouseDown",N=>(k=x.mouse,this.handleDragStart(N))),p(this,"onMouseUp",N=>(k=x.mouse,this.handleDragStop(N))),p(this,"onTouchStart",N=>(k=x.touch,this.handleDragStart(N))),p(this,"onTouchEnd",N=>(k=x.touch,this.handleDragStop(N)))}componentDidMount(){this.mounted=!0;const N=this.findDOMNode();N&&(0,r.addEvent)(N,x.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const N=this.findDOMNode();if(N){const{ownerDocument:V}=N;(0,r.removeEvent)(V,x.mouse.move,this.handleDrag),(0,r.removeEvent)(V,x.touch.move,this.handleDrag),(0,r.removeEvent)(V,x.mouse.stop,this.handleDragStop),(0,r.removeEvent)(V,x.touch.stop,this.handleDragStop),(0,r.removeEvent)(N,x.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,r.scheduleRemoveUserSelectStyles)(V)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:n.default.findDOMNode(this)}render(){return t.cloneElement(t.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return id.default=I,p(I,"displayName","DraggableCore"),p(I,"propTypes",{allowAnyClick:e.default.bool,allowMobileScroll:e.default.bool,children:e.default.node.isRequired,disabled:e.default.bool,enableUserSelectHack:e.default.bool,offsetParent:function(A,N){if(A[N]&&A[N].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:e.default.arrayOf(e.default.number),handle:e.default.string,cancel:e.default.string,nodeRef:e.default.object,onStart:e.default.func,onDrag:e.default.func,onStop:e.default.func,onMouseDown:e.default.func,scale:e.default.number,className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),p(I,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),id}var K4;function r$(){return K4||(K4=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return f.default}}),t.default=void 0;var e=b(lo()),n=y(dR()),r=y(Gy()),a=e$(),o=$b(),u=hR(),h=eg(),f=y(n$()),p=y(fR());function y(V){return V&&V.__esModule?V:{default:V}}function b(V,F){if(typeof WeakMap=="function")var j=new WeakMap,O=new WeakMap;return(b=function(B,H){if(!H&&B&&B.__esModule)return B;var w,S,R={__proto__:null,default:B};if(B===null||typeof B!="object"&&typeof B!="function")return R;if(w=H?O:j){if(w.has(B))return w.get(B);w.set(B,R)}for(const D in B)D!=="default"&&{}.hasOwnProperty.call(B,D)&&((S=(w=Object.defineProperty)&&Object.getOwnPropertyDescriptor(B,D))&&(S.get||S.set)?w(R,D,S):R[D]=B[D]);return R})(V,F)}function x(){return x=Object.assign?Object.assign.bind():function(V){for(var F=1;F<arguments.length;F++){var j=arguments[F];for(var O in j)({}).hasOwnProperty.call(j,O)&&(V[O]=j[O])}return V},x.apply(null,arguments)}function k(V,F,j){return(F=I(F))in V?Object.defineProperty(V,F,{value:j,enumerable:!0,configurable:!0,writable:!0}):V[F]=j,V}function I(V){var F=A(V,"string");return typeof F=="symbol"?F:F+""}function A(V,F){if(typeof V!="object"||!V)return V;var j=V[Symbol.toPrimitive];if(j!==void 0){var O=j.call(V,F);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(V)}class N extends e.Component{static getDerivedStateFromProps(F,j){let{position:O}=F,{prevPropsPosition:B}=j;return O&&(!B||O.x!==B.x||O.y!==B.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:O,prevPropsPosition:B}),{x:O.x,y:O.y,prevPropsPosition:{...O}}):null}constructor(F){super(F),k(this,"onDragStart",(j,O)=>{if((0,p.default)("Draggable: onDragStart: %j",O),this.props.onStart(j,(0,u.createDraggableData)(this,O))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),k(this,"onDrag",(j,O)=>{if(!this.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",O);const B=(0,u.createDraggableData)(this,O),H={x:B.x,y:B.y,slackX:0,slackY:0};if(this.props.bounds){const{x:S,y:R}=H;H.x+=this.state.slackX,H.y+=this.state.slackY;const[D,L]=(0,u.getBoundPosition)(this,H.x,H.y);H.x=D,H.y=L,H.slackX=this.state.slackX+(S-H.x),H.slackY=this.state.slackY+(R-H.y),B.x=H.x,B.y=H.y,B.deltaX=H.x-this.state.x,B.deltaY=H.y-this.state.y}if(this.props.onDrag(j,B)===!1)return!1;this.setState(H)}),k(this,"onDragStop",(j,O)=>{if(!this.state.dragging||this.props.onStop(j,(0,u.createDraggableData)(this,O))===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",O);const H={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:S,y:R}=this.props.position;H.x=S,H.y=R}this.setState(H)}),this.state={dragging:!1,dragged:!1,x:F.position?F.position.x:F.defaultPosition.x,y:F.position?F.position.y:F.defaultPosition.y,prevPropsPosition:{...F.position},slackX:0,slackY:0,isElementSVG:!1},F.position&&!(F.onDrag||F.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??r.default.findDOMNode(this)}render(){const{axis:F,bounds:j,children:O,defaultPosition:B,defaultClassName:H,defaultClassNameDragging:w,defaultClassNameDragged:S,position:R,positionOffset:D,scale:L,...U}=this.props;let P={},ne=null;const G=!!!R||this.state.dragging,Z=R||B,J={x:(0,u.canDragX)(this)&&G?this.state.x:Z.x,y:(0,u.canDragY)(this)&&G?this.state.y:Z.y};this.state.isElementSVG?ne=(0,o.createSVGTransform)(J,D):P=(0,o.createCSSTransform)(J,D);const Se=(0,a.clsx)(O.props.className||"",H,{[w]:this.state.dragging,[S]:this.state.dragged});return e.createElement(f.default,x({},U,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(O),{className:Se,style:{...O.props.style,...P},transform:ne}))}}t.default=N,k(N,"displayName","Draggable"),k(N,"propTypes",{...f.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:h.dontSetMe,style:h.dontSetMe,transform:h.dontSetMe}),k(N,"defaultProps",{...f.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(U0)),U0}var Q4;function s$(){if(Q4)return sd.exports;Q4=1;const{default:t,DraggableCore:e}=r$();return sd.exports=t,sd.exports.default=t,sd.exports.DraggableCore=e,sd.exports}var i$=s$();const mR=Kd(i$),a$=()=>{const{callStatus:t,incomingCall:e,outgoingCallUser:n,answerCall:r,endCall:a,localStream:o,remoteStream:u,toggleAudio:h,toggleVideo:f,isMuted:p,isVideoOff:y,activeCall:b,isScreenSharing:x,toggleScreenShare:k,availableDevices:I,selectedMicId:A,selectedCameraId:N,setSelectedMicId:V,setSelectedCameraId:F,playSound:j,customSounds:O,addSound:B,removeSound:H}=Qc(),w=T.useRef(null),S=T.useRef(null),R=T.useRef(null),[D,L]=T.useState(!1),[U,P]=T.useState(!1),[ne,oe]=T.useState(100),[G,Z]=T.useState(!1),[J,Se]=T.useState(!1),[Le,$]=T.useState(!1),[X,re]=T.useState(!1),[he,Te]=T.useState(!1),{userProfile:Ue}=yn(),te=vc(Ue),Oe=xA(Ue,qi.SCREEN_SHARE),Ie=T.useRef(null),We=async Re=>{const dt=Re.target.files[0];if(!dt)return;const ye=dt.name.split(".")[0].slice(0,10);await B(ye,dt),Ie.current&&(Ie.current.value="")},[ke,fe]=T.useState(!1);return T.useEffect(()=>{w.current&&o&&(w.current.srcObject=o)},[o,t]),T.useEffect(()=>{S.current&&u&&(S.current.srcObject=u)},[u,t]),T.useEffect(()=>{if(u){const Re=u.getVideoTracks()[0];if(Re){const dt=!Re.muted&&Re.readyState==="live";fe(dt);const ye=()=>fe(!1),Ve=()=>fe(!0),De=()=>fe(!1);return Re.addEventListener("mute",ye),Re.addEventListener("unmute",Ve),Re.addEventListener("ended",De),()=>{Re.removeEventListener("mute",ye),Re.removeEventListener("unmute",Ve),Re.removeEventListener("ended",De)}}else fe(!1)}else fe(!1)},[u]),T.useEffect(()=>{S.current&&(S.current.volume=ne/100)},[ne,u]),T.useEffect(()=>{t==="idle"&&(L(!1),Te(!1),Se(!1),re(!1),Z(!1),$(!1))},[t]),t==="idle"?null:t==="incoming"?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fade-in",role:"dialog","aria-modal":"true",children:c.jsxs("div",{className:"bg-dark-sidebar p-6 rounded-2xl shadow-2xl w-80 text-center border border-dark-hover",children:[c.jsxs("div",{className:"w-24 h-24 mx-auto mb-4 relative",children:[e?.callerPhotoUrl?c.jsx("img",{src:e.callerPhotoUrl,alt:"Caller",className:"w-full h-full rounded-full object-cover border-4 border-dark-bg"}):c.jsx("div",{className:"w-full h-full rounded-full bg-brand-primary flex items-center justify-center text-3xl font-bold text-white border-4 border-dark-bg",children:e?.callerName?.[0]?.toUpperCase()}),c.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-2 animate-bounce",children:c.jsx(TS,{size:16,className:"text-white"})})]}),c.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:e?.callerName}),c.jsxs("p",{className:"text-dark-muted mb-6",children:["Incoming ",e?.type," call..."]}),c.jsxs("div",{className:"flex gap-4 justify-center",children:[c.jsx("button",{onClick:()=>a(!0),className:"w-12 h-12 rounded-full bg-red-500 flex items-center justify-center text-white hover:bg-red-600 transition-colors",children:c.jsx(w0,{size:24})}),c.jsx("button",{onClick:r,className:"w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white hover:bg-green-600 transition-colors",children:c.jsx(TS,{size:20})})]})]})}):c.jsx(mR,{nodeRef:R,disabled:!D,bounds:"body",onStart:()=>P(!0),onStop:()=>P(!1),children:c.jsxs("div",{role:"dialog","aria-modal":"true",ref:R,style:D?void 0:{transform:"none !important"},className:Ht("fixed z-[100] bg-gray-900 shadow-2xl overflow-hidden border border-gray-700 group",!U&&"transition-all duration-300",D?"bottom-4 right-4 w-64 h-48 rounded-lg cursor-move":"inset-0 flex flex-col !transform-none"),children:[c.jsxs("div",{className:Ht("absolute top-0 left-0 right-0 p-4 z-50 flex justify-between items-start bg-gradient-to-b from-black/80 to-transparent transition-opacity duration-200 opacity-100"),children:[c.jsx("div",{className:"flex gap-2",children:c.jsxs("div",{className:"bg-black/40 backdrop-blur px-3 py-1 rounded-full flex items-center gap-2",children:[c.jsx("span",{className:Ht("w-2 h-2 rounded-full",b?"bg-green-500":"bg-yellow-500 animate-pulse")}),c.jsx("span",{className:"text-xs text-white font-medium",children:b?"Connected":"Calling..."})]})}),c.jsx("button",{onClick:()=>L(!D),className:"p-2 rounded-full bg-black/40 hover:bg-white/10 text-white backdrop-blur transition-colors",title:D?"Maximize":"Minimize",children:D?c.jsx(F7,{size:20}):c.jsx(B7,{size:20})})]}),c.jsxs("div",{className:"relative flex-1 bg-black flex items-center justify-center w-full h-full",children:[c.jsx("video",{ref:S,autoPlay:!0,playsInline:!0,className:Ht("w-full h-full object-contain",(!u||!ke)&&"hidden")}),(!u||!ke)&&c.jsxs("div",{className:"text-center absolute inset-0 flex flex-col items-center justify-center z-10",children:[c.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full bg-gray-800 flex items-center justify-center text-6xl font-bold text-gray-500 animate-pulse",children:n?.displayName?.[0]||b?.metadata?.name?.[0]||"?"}),c.jsx("p",{className:"text-xl text-white font-medium",children:t==="outgoing"?"Calling...":t==="connected"?"No Video / Audio Only":"Connecting..."}),c.jsx("p",{className:"text-gray-400 text-sm mt-1",children:n?.displayName})]}),!D&&o&&c.jsx(o$,{})]}),c.jsxs("div",{className:Ht("absolute bottom-4 md:bottom-8 left-1/2 -translate-x-1/2 z-50 flex flex-wrap justify-center items-center gap-2 md:gap-4 p-2 md:p-3 bg-gray-900/80 backdrop-blur-md rounded-xl md:rounded-2xl border border-gray-700 shadow-xl transition-opacity duration-300 hover:opacity-100 w-[95%] md:w-auto max-w-screen-sm",D&&"hidden"),children:[c.jsx("button",{onClick:h,className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95",p?"bg-red-500/20 text-red-500":"bg-gray-700/50 text-white hover:bg-gray-600"),title:p?"Unmute":"Mute",children:p?c.jsx(yy,{size:22}):c.jsx(by,{size:22})}),c.jsx("button",{onClick:f,className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95",y?"bg-red-500/20 text-red-500":"bg-gray-700/50 text-white hover:bg-gray-600"),title:y?"Turn Video On":"Turn Video Off",children:y?c.jsx(xy,{size:22}):c.jsx(Ud,{size:22})}),!ta.isNativePlatform()&&c.jsxs("div",{className:"relative",onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),children:[c.jsx("button",{onClick:()=>{x?k():re(!0)},disabled:!b||!Oe,className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",x?"bg-green-500 text-white":Oe?"bg-gray-700/50 text-white hover:bg-gray-600":"bg-gray-800 text-gray-500 cursor-not-allowed"),title:Oe?x?"Stop Sharing":"Share Screen":void 0,children:x?c.jsx(k7,{size:22}):c.jsx(Qm,{size:22})}),!Oe&&c.jsxs("div",{className:Ht("absolute bottom-full mb-2 left-1/2 -translate-x-1/2 px-2 py-1 bg-black text-rose-500 text-xs font-bold rounded shadow-lg whitespace-nowrap transition-opacity pointer-events-none z-50",Le?"opacity-100":"opacity-0"),children:["Requires Premium ",c.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-black"})]})]}),c.jsx("div",{className:"w-px h-8 bg-gray-700 mx-2"}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Z(!G),onDoubleClick:()=>oe(ne>0?0:100),className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95",ne===0?"bg-red-500/20 text-red-500":"bg-gray-700/50 text-white hover:bg-gray-600"),title:`Volume: ${ne}% (click to show slider, double-click to mute)`,children:ne===0?c.jsx(hS,{size:22}):ne<50?c.jsx(E7,{size:22}):c.jsx(fS,{size:22})}),G&&c.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 p-3 bg-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700 shadow-xl",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsxs("span",{className:"text-xs text-gray-400 font-medium",children:[ne,"%"]}),c.jsx("input",{type:"range",min:"0",max:"100",value:ne,onChange:Re=>oe(Number(Re.target.value)),className:`w-24 h-2 appearance-none bg-gray-700 rounded-full cursor-pointer accent-brand-primary
                     [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 
                     [&::-webkit-slider-thumb]:bg-brand-primary [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer
                     [&::-webkit-slider-thumb]:shadow-lg [&::-webkit-slider-thumb]:hover:scale-110 [&::-webkit-slider-thumb]:transition-transform`,style:{background:`linear-gradient(to right, rgb(88, 101, 242) ${ne}%, rgb(55, 65, 81) ${ne}%)`}}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"Remote Volume"})]})})]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Te(!he),className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95",he?"bg-brand-primary/20 text-brand-primary":"bg-gray-700/50 text-white hover:bg-gray-600"),title:"Soundboard",children:c.jsx(Xm,{size:22})}),he&&c.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 w-64 bg-gray-900/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-2xl p-4 animate-fade-in-up z-50",children:[c.jsxs("h4",{className:"text-white text-sm font-semibold mb-3 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Xm,{className:"text-brand-primary"}),"Soundboard"]}),c.jsxs("span",{className:"text-[10px] text-gray-400",children:[O.length,"/10"]})]}),c.jsxs("div",{className:"flex flex-col gap-1 mb-3 max-h-48 overflow-y-auto custom-scrollbar",children:[O.length===0&&c.jsx("div",{className:"text-center text-gray-500 text-xs py-4 italic",children:"No sounds added yet."}),O.map(Re=>c.jsxs("div",{className:"relative group flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>{te&&j(Re.id)},className:"flex-1 bg-gray-800 hover:bg-gray-700 text-white text-xs py-2 px-3 rounded-lg transition-colors border border-gray-700 hover:border-brand-primary flex items-center gap-3 active:scale-95",children:[c.jsx("span",{className:"text-sm",children:""}),c.jsx("span",{className:"text-xs font-medium truncate flex-1 text-left",children:Re.name})]}),c.jsx("button",{onClick:dt=>{dt.stopPropagation(),H(Re.id)},className:"bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white rounded-lg p-2 transition-colors opacity-0 group-hover:opacity-100",title:"Remove sound",children:c.jsx(Ki,{size:14})})]},Re.id))]}),O.length<10&&c.jsxs("button",{onClick:()=>Ie.current?.click(),className:"w-full py-2 border border-dashed border-gray-600 text-gray-400 rounded-lg hover:border-brand-primary hover:text-brand-primary transition-colors flex items-center justify-center gap-2 text-xs",children:[c.jsx(Yo,{size:14})," Add Sound (MP3/WAV)"]}),c.jsx("input",{type:"file",ref:Ie,className:"hidden",accept:"audio/mp3,audio/wav,audio/mpeg",onChange:We}),!te&&c.jsx("div",{className:"absolute inset-0 bg-black/80 flex items-center justify-center rounded-xl p-4 text-center",children:c.jsxs("div",{children:[c.jsx("p",{className:"text-brand-primary font-bold mb-1",children:"Premium Only"}),c.jsx("p",{className:"text-white text-xs",children:"Unlock Soundboard with Premium!"})]})})]})]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Se(!J),className:Ht("p-3 rounded-xl transition-all hover:scale-110 active:scale-95",J?"bg-brand-primary/20 text-brand-primary":"bg-gray-700/50 text-white hover:bg-gray-600"),title:"Audio/Video Settings",children:c.jsx(Up,{size:22})}),J&&c.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 p-4 bg-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700 shadow-xl w-64",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Device Settings"}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Microphone"}),c.jsx("select",{value:A,onChange:Re=>V(Re.target.value),className:"w-full bg-gray-800 text-white text-sm rounded-lg px-3 py-2 border border-gray-700 focus:border-brand-primary outline-none cursor-pointer",children:I.audioInputs.map(Re=>c.jsx("option",{value:Re.deviceId,children:Re.label||`Microphone ${Re.deviceId.slice(0,8)}...`},Re.deviceId))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Camera"}),c.jsx("select",{value:N,onChange:Re=>F(Re.target.value),className:"w-full bg-gray-800 text-white text-sm rounded-lg px-3 py-2 border border-gray-700 focus:border-brand-primary outline-none cursor-pointer",children:I.videoInputs.map(Re=>c.jsx("option",{value:Re.deviceId,children:Re.label||`Camera ${Re.deviceId.slice(0,8)}...`},Re.deviceId))})]}),c.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"Changes apply on next call"})]})})]}),c.jsx("div",{className:"w-px h-8 bg-gray-700 mx-2"}),c.jsx("button",{onClick:()=>a(!0),className:"p-3 rounded-xl bg-red-600 text-white hover:bg-red-700 transition-all hover:scale-110 active:scale-95 shadow-lg shadow-red-900/20",title:"End Call",children:c.jsx(w0,{size:24})})]}),D&&c.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 flex justify-center gap-2 bg-gradient-to-t from-black/90 to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-50",children:[c.jsx("button",{onMouseDown:Re=>Re.stopPropagation(),onClick:h,className:Ht("p-1.5 rounded-full text-white hover:bg-white/20",p&&"bg-red-500/50 text-red-100"),title:"Mute",children:p?c.jsx(yy,{size:16}):c.jsx(by,{size:16})}),c.jsx("button",{onMouseDown:Re=>Re.stopPropagation(),onClick:f,className:Ht("p-1.5 rounded-full text-white hover:bg-white/20",y&&"bg-red-500/50 text-red-100"),title:"Camera",children:y?c.jsx(xy,{size:16}):c.jsx(Ud,{size:16})}),c.jsx("button",{onMouseDown:Re=>Re.stopPropagation(),onClick:()=>oe(ne===0?100:0),className:Ht("p-1.5 rounded-full text-white hover:bg-white/20",ne===0&&"bg-red-500/50 text-red-100"),title:"Volume Toggle",children:ne===0?c.jsx(hS,{size:16}):c.jsx(fS,{size:16})}),c.jsx("button",{onMouseDown:Re=>Re.stopPropagation(),onClick:()=>a(!0),className:"p-1.5 rounded-full bg-red-600/80 text-white hover:bg-red-600",title:"End Call",children:c.jsx(w0,{size:16})})]}),J&&c.jsx(WH,{isOpen:J,onClose:()=>Se(!1)}),c.jsx(kA,{isOpen:X,onClose:()=>re(!1),onConfirm:Re=>k(Re)})]})})},o$=()=>{const t=T.useRef(null),{localStream:e,isMuted:n,isVideoOff:r}=Qc(),a=T.useRef(null);return T.useEffect(()=>{a.current&&e&&(a.current.srcObject=e)},[e]),c.jsx(mR,{bounds:"parent",nodeRef:t,children:c.jsxs("div",{ref:t,className:"absolute bottom-24 right-4 w-48 h-36 bg-gray-800 rounded-lg overflow-hidden shadow-lg border border-gray-700 cursor-move hover:scale-105 transition-transform z-50",children:[c.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),c.jsxs("div",{className:"absolute bottom-2 left-2 flex gap-1",children:[n&&c.jsx("div",{className:"bg-red-500/80 p-1 rounded",children:c.jsx(yy,{size:12,className:"text-white"})}),r&&c.jsx("div",{className:"bg-red-500/80 p-1 rounded",children:c.jsx(xy,{size:12,className:"text-white"})})]})]})})},l$=()=>{const{currentUser:t,logout:e,resendVerification:n}=yn(),[r,a]=T.useState(!1),[o,u]=T.useState(""),h=async()=>{a(!0);try{await n(),u("Verification email sent! Check your inbox.")}catch(p){u("Error sending email: "+p.message)}finally{a(!1)}},f=async()=>{a(!0);try{await t.reload(),t.emailVerified?window.location.reload():u("Email is not verified yet. Please check your inbox.")}catch(p){console.error(p)}finally{a(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:c.jsxs("div",{className:"w-full max-w-md bg-dark-sidebar rounded-lg shadow-2xl p-8 text-center space-y-6",children:[c.jsx("div",{className:"bg-brand-primary/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto text-3xl",children:""}),c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Verify Your Email"}),c.jsxs("p",{className:"text-dark-muted",children:["We've sent a verification email to ",c.jsx("br",{}),c.jsx("span",{className:"font-semibold text-white",children:t?.email})]}),c.jsxs("div",{className:"bg-yellow-500/10 text-yellow-500 p-3 rounded-md text-sm",children:[" Please check your ",c.jsx("b",{children:"Spam/Junk"})," folder if you don't see the email in your inbox."]}),c.jsx("p",{className:"text-sm text-dark-muted",children:"You must verify your email address to access Lumo. To prevent spam, unverified accounts are restricted."}),o&&c.jsx("div",{className:"p-3 bg-brand-primary/20 text-brand-primary rounded-md text-sm",children:o}),c.jsxs("div",{className:"space-y-3 pt-4",children:[c.jsx(st,{onClick:f,className:"w-full",disabled:r,children:"I've Verified My Email"}),c.jsx(st,{onClick:h,variant:"secondary",className:"w-full",disabled:r,children:"Resend Verification Email"}),c.jsx("button",{onClick:e,className:"text-sm text-dark-muted hover:text-dark-text underline mt-4",children:"Logout"})]})]})})},c$=()=>{const{unreadMentions:t,unreadDms:e}=aa(),{userProfile:n}=yn(),{info:r}=Fr(),a=T.useRef({}),o=T.useRef({}),u=T.useRef(!1);T.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[]);const h=()=>n?.settings?.notificationsEnabled!==!1,f=(p,y)=>{if(h()&&(r(`${p}: ${y}`),"Notification"in window))if(Notification.permission==="granted"){const b=()=>{try{new Notification(p,{body:y,icon:"/vite.svg"})}catch(x){console.error("Notification trigger failed:",x)}};document.hidden,b()}else console.log("Notification permission not granted:",Notification.permission)};return T.useEffect(()=>{if(!u.current){a.current=t||{},o.current=e||{},u.current=!0;return}t&&(Object.keys(t).forEach(p=>{const y=a.current[p]?.count||0;(t[p]?.count||0)>y&&f("New Mention","You were mentioned in a channel.")}),a.current=t),e&&(Object.keys(e).forEach(p=>{const y=o.current[p]?.count||0;(e[p]?.count||0)>y&&f("New Message","You received a direct message.")}),o.current=e)},[t,e]),null},u$=({dmId:t,dms:e})=>{const{currentUser:n,userProfile:r}=yn(),{users:a}=aa(),{startCall:o}=Qc(),[u,h]=T.useState(null),[f,p]=T.useState(null),[y,b]=T.useState([]),x=e.find(A=>A.id===t),k=x?.participants.find(A=>A!==n?.uid);T.useEffect(()=>{(async()=>{if(k)try{const N=await Jo(Ne(le,"users",k));N.exists()&&h({id:N.id,...N.data()})}catch(N){console.error("Error fetching DM user:",N)}})()},[k]);const I=T.useMemo(()=>[{id:n.uid,displayName:n.displayName||r?.displayName||"User",photoUrl:n.photoURL||r?.photoUrl,role:r?.role},u].filter(Boolean),[n,r,u]);return x?c.jsxs("div",{className:"flex-1 flex flex-col h-full bg-dark-bg",children:[c.jsxs("div",{className:"h-12 px-4 flex items-center justify-between border-b border-dark-hover shadow-sm bg-dark-bg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"relative",children:u?.photoUrl?c.jsx("img",{src:u.photoUrl,alt:u.displayName,className:"w-8 h-8 rounded-full object-cover"}):c.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-white text-sm font-bold",children:u?.displayName?.[0]?.toUpperCase()||"?"})}),c.jsx("span",{className:"font-semibold text-dark-text",children:u?.displayName||"Loading..."})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:()=>o(u,"voice"),className:"text-dark-muted hover:text-dark-text transition-colors p-1 rounded hover:bg-dark-hover",title:"Start Voice Call",disabled:!u,children:c.jsx(S7,{size:22})}),c.jsx("button",{onClick:()=>o(u,"video"),className:"text-dark-muted hover:text-dark-text transition-colors p-1 rounded hover:bg-dark-hover",title:"Start Video Call",disabled:!u,children:c.jsx(Ud,{size:22})}),c.jsx("div",{className:"w-px h-6 bg-dark-hover mx-1"}),c.jsx(lR,{messages:y,users:I,onResultClick:A=>document.getElementById(`message-${A.id}`)?.scrollIntoView({behavior:"smooth",block:"center"})})]})]}),c.jsx(PA,{serverId:null,channelId:t,users:I,currentUserId:n?.uid,userRole:r?.role,onReply:p,onMessagesChange:b}),c.jsx(oR,{serverId:null,channelId:t,channel:{id:t,name:u?.displayName},userId:n?.uid,userProfile:r,userRole:r?.role,users:I,replyingTo:f,onCancelReply:()=>p(null)})]}):c.jsx("div",{className:"flex-1 flex items-center justify-center text-dark-muted",children:"Select a conversation"})},d$="lumo",h$="2.0.17",f$="module",m$="electron/main.cjs",p$={dev:"vite",build:"vite build",lint:"eslint .",preview:"vite preview",predeploy:"npm run build",deploy:"gh-pages -d dist","electron:dev":'concurrently -k "npm run dev" "wait-on tcp:3000 && electron ."',"electron:build":"vite build && electron-builder","build:electron":"npm run electron:build"},g$={"@capacitor-community/safe-area":"^7.0.0-beta.8","@capacitor-firebase/authentication":"^8.0.1","@capacitor/android":"^8.0.0","@capacitor/cli":"^8.0.0","@capacitor/core":"^8.0.0","@capacitor/push-notifications":"^8.0.0","@capacitor/status-bar":"^8.0.0","@codetrix-studio/capacitor-google-auth":"^3.4.0-rc.4","@giphy/js-fetch-api":"^5.7.0","@giphy/react-components":"^10.1.0",clsx:"^2.1.1","date-fns":"^4.1.0","electron-log":"^5.4.3","electron-updater":"^6.6.2","emoji-picker-react":"^4.16.1",firebase:"^12.6.0","firebase-admin":"^13.6.0",peerjs:"^1.5.5",react:"^19.2.3","react-color":"^2.19.3","react-dom":"^19.2.3","react-draggable":"^4.5.0","react-icons":"^5.5.0","simple-peer":"^9.11.1","string-similarity":"^4.0.4","styled-components":"^6.3.8","tailwind-merge":"^3.4.0","vosk-browser":"^0.0.8"},v$="Lumo - Modern Chat Application",y$="Hasan",b$={appId:"com.hasan.lumoapp",productName:"Lumo",files:["dist/**/*","electron/**/*","public/**/*"],directories:{output:"dist"},win:{target:"nsis",icon:"public/lumo-logo.png",artifactName:"LumoSetup_win-${version}.${ext}"},mac:{target:"dmg",icon:"public/lumo-logo.png",category:"public.app-category.social-networking",extendInfo:{NSCameraUsageDescription:"Lumo needs access to your camera for video calls.",NSMicrophoneUsageDescription:"Lumo needs access to your microphone for voice and video calls.",NSScreenCaptureUsageDescription:"Lumo needs access to share your screen."},artifactName:"LumoSetup_mac-${version}.${ext}"},linux:{target:"AppImage",icon:"public/lumo-logo.png",category:"Network",artifactName:"LumoSetup_linux-${version}.${ext}"},publish:[{provider:"github",owner:"opsdazlakss",repo:"lumobuild"}]},x$={type:"git",url:"https://github.com/opsdazlakss/lumobuild.git"},_$={"@capacitor/assets":"^3.0.5","@eslint/js":"^9.39.1","@types/react":"^19.2.5","@types/react-dom":"^19.2.3","@vitejs/plugin-react":"^5.1.1",autoprefixer:"^10.4.22","baseline-browser-mapping":"^2.9.19",concurrently:"^9.2.1",electron:"^39.2.6","electron-builder":"^26.0.12",eslint:"^9.39.1","eslint-plugin-react-hooks":"^7.0.1","eslint-plugin-react-refresh":"^0.4.24","gh-pages":"^6.3.0",globals:"^16.5.0",postcss:"^8.5.6",tailwindcss:"^3.4.18",typescript:"^5.9.3",vite:"^7.2.4","wait-on":"^9.0.3"},H0={name:d$,private:!0,version:h$,type:f$,main:m$,scripts:p$,dependencies:g$,description:v$,author:y$,build:b$,repository:x$,devDependencies:_$},w$=({isOpen:t,onClose:e,version:n,downloadUrl:r,forceUpdate:a})=>c.jsx(Ds,{isOpen:t,onClose:a?()=>{}:e,title:"Update Available",size:"sm",children:c.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-brand-primary/20 rounded-full flex items-center justify-center animate-bounce",children:c.jsx(G7,{size:32,className:"text-brand-primary"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-white",children:["New Version ",n," Available!"]}),c.jsx("p",{className:"text-dark-muted text-sm mt-2",children:"A new version of Lumo is available. Please update to get the latest features and fixes."})]}),c.jsxs("div",{className:"w-full space-y-2 pt-2",children:[c.jsxs(st,{variant:"primary",className:"w-full flex items-center justify-center gap-2",onClick:()=>{window.open(r,"_system")},children:[c.jsx(lN,{size:20}),"Download Update"]}),!a&&c.jsx(st,{variant:"secondary",className:"w-full",onClick:e,children:"Update Later"})]})]})}),E$=()=>{const{hotkeys:t}=uR(),{toggleAudio:e,toggleDeafen:n,callStatus:r}=Qc(),{toggleMute:a,toggleDeafen:o,currentVoiceChannel:u}=Xc();return T.useEffect(()=>{const h=f=>{["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName)||document.activeElement?.contentEditable,f.ctrlKey||f.altKey||f.metaKey;const p=[];f.ctrlKey&&p.push("Control"),f.shiftKey&&p.push("Shift"),f.altKey&&p.push("Alt"),f.metaKey&&p.push("Meta");let y=f.key;y.length===1&&(y=y.toUpperCase()),["Control","Shift","Alt","Meta"].includes(y)||p.push(y);const b=[...new Set(p)].join("+"),x=b===t.toggleMute,k=b===t.toggleDeafen;if(x||k){const I=["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName)||document.activeElement?.contentEditable==="true",A=f.ctrlKey||f.altKey||f.metaKey;(!I||A)&&f.preventDefault(),x?u?a():e():u?o():n()}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,e,n,a,o,u]),null},S$=()=>{const{currentUser:t,userProfile:e,logout:n}=yn(),{users:r,channels:a,server:o,servers:u,currentServer:h,setCurrentServer:f,unreadMentions:p,unreadDms:y,dms:b}=aa();eV(),FV(t?.uid);const[x,k]=T.useState(null),[I,A]=T.useState(null),[N,V]=T.useState(!1),[F,j]=T.useState(!1),[O,B]=T.useState(!1),[H,w]=T.useState(!1),[S,R]=T.useState(!1),D=ZL({onSwipeLeft:()=>{if(H){w(!1);return}h!=="home"&&R(!0)},onSwipeRight:()=>{if(S){R(!1);return}w(!0)}}),[L,U]=T.useState(!1),[P,ne]=T.useState(!1),[oe,G]=T.useState(null),[Z,J]=T.useState([]),[Se,Le]=T.useState(!1),[$,X]=T.useState(null),[re,he]=T.useState("idle");T.useEffect(()=>{if(!ta.isNativePlatform())return;(async()=>{he("checking");const Oe=Date.now();try{const Ie=Ne(le,"system","app_version"),We=await Jo(Ie);let ke=!1,fe=null;if(We.exists()){const dt=We.data(),ye=H0.version,Ve=dt.android;if(Ve&&Ve!==ye){const De=ye.split(".").map(Number),K=Ve.split(".").map(Number);for(let ue=0;ue<Math.max(De.length,K.length);ue++){const je=De[ue]||0,me=K[ue]||0;if(me>je){ke=!0;break}else if(me<je)break}ke&&(fe={version:Ve,downloadUrl:dt.downloadUrl,forceUpdate:dt.forceUpdate||!1})}}const Re=Date.now()-Oe;Re<1500&&await new Promise(dt=>setTimeout(dt,1500-Re)),ke?(X(fe),he("available"),Le(!0)):(he("uptodate"),setTimeout(()=>{he("idle")},1500))}catch(Ie){console.error("Failed to check for updates:",Ie),he("idle")}})()},[]),T.useEffect(()=>{!t||!h||!p||p[h]?.count>0&&it(Ne(le,"users",t.uid),{[`unreadMentions.${h}`]:JE()}).catch(te=>{console.error("Error clearing unread mentions:",te)})},[h,t,p]),T.useEffect(()=>{!t||!I||!y||y[I.id]?.count>0&&it(Ne(le,"users",t.uid),{[`unreadDms.${I.id}`]:JE()}).catch(te=>{console.error("Error clearing unread DM count:",te)})},[I,t,y]),T.useEffect(()=>{const te=()=>{window.innerWidth<768&&!x&&!I&&w(!0)};return window.innerWidth<768&&w(!0),window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[x,I]),T.useEffect(()=>{a.length>0?k(a[0]):k(null)},[h,a]);const Te=async te=>{if(f(te),t)try{await it(Ne(le,"users",t.uid),{currentServer:te})}catch(Oe){console.error("Failed to persist server selection:",Oe)}},Ue=async te=>{if(!(!t||!te))try{let Oe=b.find(Ie=>Ie.participants.includes(te.id)&&Ie.participants.includes(t.uid));if(!Oe){const Ie=zr(_t(le,"dms"),Vi("participants","array-contains",t.uid)),ke=(await di(Ie)).docs.find(fe=>fe.data().participants.includes(te.id));ke&&(Oe={id:ke.id,...ke.data()})}if(Oe)Oe.hiddenFor?.includes(t.uid)&&await it(Ne(le,"dms",Oe.id),{hiddenFor:Oe.hiddenFor.filter(Ie=>Ie!==t.uid)}),A(Oe);else{const Ie={participants:[t.uid,te.id],createdAt:ht(),updatedAt:ht(),lastMessage:null,hiddenFor:[]},We=await Kn(_t(le,"dms"),Ie);A({id:We.id,...Ie})}Te("home")}catch(Oe){console.error("Error starting DM:",Oe)}};return t&&t.email&&!t.emailVerified?c.jsx(l$,{}):c.jsx(UV,{children:c.jsx(QV,{children:c.jsx(FH,{children:c.jsxs(zV,{children:[c.jsx(E$,{}),c.jsx(c$,{}),c.jsxs("div",{className:"flex h-screen bg-dark-bg overflow-hidden",...D,children:[c.jsxs("div",{className:"hidden md:flex h-full",children:[c.jsx(FS,{servers:u,currentServerId:h,onServerChange:Te,onCreateServer:()=>U(!0),onJoinServer:()=>ne(!0),userRole:e?.role,userId:t?.uid,unreadMentions:p,unreadDms:y}),c.jsx(BS,{server:o,channels:a,selectedChannel:x,onSelectChannel:k,onOpenSettings:()=>V(!0),onOpenAdmin:()=>j(!0),onLogout:n,userProfile:e,serverId:h,userRole:e?.role,userId:t?.uid,dms:b,unreadDms:y,selectedDm:I,onSelectDm:A})]}),H&&c.jsxs("div",{className:"fixed inset-0 z-50 flex md:hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>w(!1)}),c.jsxs("div",{className:"relative flex h-full animate-slide-in-left bg-dark-bg",children:[c.jsx(FS,{servers:u,currentServerId:h,onServerChange:te=>Te(te),onCreateServer:()=>U(!0),onJoinServer:()=>ne(!0),userRole:e?.role,userId:t?.uid,unreadMentions:p,unreadDms:y}),c.jsx(BS,{server:o,channels:a,selectedChannel:x,onSelectChannel:te=>{k(te),w(!1)},onOpenSettings:()=>{V(!0),w(!1)},onOpenAdmin:()=>{j(!0),w(!1)},onLogout:n,userProfile:e,serverId:h,userRole:e?.role,userId:t?.uid,dms:b,unreadDms:y,selectedDm:I,onSelectDm:te=>{A(te),w(!1)}}),c.jsx("button",{onClick:()=>w(!1),className:"absolute top-2 right-2 p-2 bg-dark-bg/50 rounded-full text-white md:hidden",style:{right:"-3rem"},children:c.jsx($n,{size:24})})]})]}),c.jsx("div",{className:"flex-1 flex flex-col",children:h==="home"?I?c.jsx(u$,{dmId:I.id,dms:b}):c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-dark-muted relative",children:[c.jsx("button",{onClick:()=>w(!0),className:"absolute top-4 left-4 md:hidden p-2 text-dark-muted hover:text-dark-text",children:c.jsx(gS,{size:32})}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"mb-2 text-lg",children:" Welcome!"}),c.jsx("p",{children:"Select a conversation to start chatting"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-12 md:h-12 pt-safe-top md:pt-0 px-4 flex items-center justify-between border-b border-dark-hover shadow-sm bg-dark-bg box-content",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[c.jsx("button",{onClick:()=>w(!0),className:"md:hidden p-1 mr-1 text-dark-muted hover:text-dark-text",children:c.jsx(gS,{size:24})}),c.jsx(Bp,{className:"text-dark-muted flex-shrink-0"}),c.jsxs("h2",{className:"font-semibold text-dark-text flex items-center min-w-0",children:[c.jsx("span",{className:"truncate",children:x?.name||"Select a channel"}),x?.description&&c.jsx("span",{className:"hidden md:block ml-4 text-sm text-dark-muted font-normal border-l border-dark-muted/30 pl-4 truncate max-w-md",children:x.description})]})]}),c.jsx("div",{className:"flex items-center gap-3",children:x&&c.jsxs(c.Fragment,{children:[Z.filter(te=>te.pinned).length>0&&c.jsxs("button",{onClick:()=>B(!O),className:`hidden sm:flex items-center gap-2 px-3 py-1.5 rounded transition-colors ${O?"bg-brand-primary text-white":"bg-dark-hover text-dark-text hover:bg-dark-input"}`,children:[c.jsx(mc,{size:16}),c.jsxs("span",{className:"text-sm font-medium",children:[Z.filter(te=>te.pinned).length," Pinned"]})]}),c.jsx("div",{className:"hidden sm:block",children:c.jsx(lR,{messages:Z,users:r,onResultClick:te=>console.log("Scroll to:",te)})}),h!=="home"&&c.jsx("button",{onClick:()=>R(!0),className:"lg:hidden p-2 text-dark-muted hover:text-dark-text",children:c.jsx(ub,{size:24})})]})})]}),x?c.jsxs(c.Fragment,{children:[c.jsx(PA,{serverId:h,channelId:x.id,users:r,currentUserId:t?.uid,userRole:e?.role,onReply:G,onMessagesChange:J}),c.jsx(oR,{serverId:h,channelId:x.id,channel:x,userId:t?.uid,userProfile:e,userRole:e?.role,users:r,replyingTo:oe,onCancelReply:()=>G(null)})]}):c.jsx("div",{className:"flex-1 flex items-center justify-center text-dark-muted",children:"Select a channel to start chatting"})]})}),c.jsx("div",{className:"hidden lg:block h-full",children:h!=="home"&&c.jsx(HS,{users:r,currentUserId:t?.uid,onStartDm:Ue})}),S&&h!=="home"&&c.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end lg:hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>R(!1)}),c.jsxs("div",{className:"relative h-full bg-dark-sidebar shadow-xl w-64 animate-slide-in-right pt-safe-top",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-hover",children:[c.jsx("h3",{className:"font-semibold text-dark-text",children:"Members"}),c.jsx("button",{onClick:()=>R(!1),children:c.jsx($n,{size:24,className:"text-dark-muted"})})]}),c.jsx("div",{className:"h-[calc(100%-60px)]",children:c.jsx(HS,{users:r,currentUserId:t?.uid,onStartDm:te=>{Ue(te),R(!1)}})})]})]}),O&&x&&c.jsx(LH,{messages:Z,users:r,onClose:()=>B(!1),onJumpToMessage:te=>{const Oe=document.getElementById(`message-${te}`);Oe&&(Oe.scrollIntoView({behavior:"smooth",block:"center"}),Oe.classList.add("bg-brand-primary/10"),setTimeout(()=>{Oe.classList.remove("bg-brand-primary/10")},2e3)),B(!1)}}),c.jsx(a$,{}),c.jsx(qH,{isOpen:N,onClose:()=>V(!1),onOpenAdmin:()=>j(!0)}),c.jsx(KH,{isOpen:F,onClose:()=>j(!1)}),c.jsx(QH,{isOpen:L,onClose:()=>U(!1),userId:t?.uid,onSuccess:te=>f(te)}),c.jsx(XH,{isOpen:P,onClose:()=>ne(!1),userId:t?.uid,onSuccess:te=>f(te)}),Se&&c.jsx(w$,{isOpen:Se,onClose:()=>!$?.forceUpdate&&Le(!1),version:$?.version,downloadUrl:$?.downloadUrl,forceUpdate:$?.forceUpdate}),["checking","uptodate"].includes(re)&&c.jsxs("div",{className:"fixed inset-0 z-[60] bg-dark-bg flex flex-col items-center justify-center text-white transition-opacity duration-300",children:[re==="checking"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary mb-6"}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Checking for updates..."}),c.jsxs("p",{className:"text-dark-muted font-mono text-sm",children:["v",H0.version]})]}),re==="uptodate"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"rounded-full bg-green-500/20 p-4 mb-6",children:c.jsx(lN,{size:48,className:"text-green-500"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2 text-green-400",children:"You are up to date!"}),c.jsxs("p",{className:"text-dark-muted font-mono text-sm",children:["v",H0.version]})]})]})]})]})})})})},T$=()=>{const{currentUser:t,userProfile:e,logout:n}=yn(),[r,a]=T.useState(e?.displayName||""),[o,u]=T.useState(!1),[h,f]=T.useState(""),[p,y]=T.useState(!1),[b,x]=T.useState(!1);T.useEffect(()=>{const A=setTimeout(async()=>{if(!r||r.length<3){x(!1),f("");return}if(!/^[a-zA-Z0-9-_]+$/.test(r)){f("Only letters, numbers, hyphens (-) and underscores (_) allowed"),x(!1);return}y(!0),f("");try{const N=_t(le,"users"),V=await di(N);let F=!1;const j=r.toLowerCase();V.forEach(O=>{if(O.id===t.uid)return;const B=O.data().displayName;B&&B.toLowerCase()===j&&(F=!0)}),F?(f("This username is already taken"),x(!1)):x(!0)}catch(N){console.error(N),f("Error checking username availability")}finally{y(!1)}},500);return()=>clearTimeout(A)},[r,t]);const k=async I=>{if(I.preventDefault(),!(!b||h||o)){u(!0);try{await YT(t,{displayName:r}),await it(Ne(le,"users",t.uid),{displayName:r,isUsernameSet:!0})}catch(A){console.error(A),f("Failed to save username")}finally{u(!1)}}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg p-4",children:c.jsxs("div",{className:"w-full max-w-md bg-dark-sidebar rounded-lg shadow-2xl p-8 space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-2xl font-bold text-dark-text",children:"Choose Your Username"}),c.jsx("p",{className:"text-dark-muted mt-2",children:"Welcome to Lumo! Please choose a unique username found across the platform."})]}),c.jsxs("form",{onSubmit:k,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(bn,{label:"Username",value:r,onChange:I=>a(I.target.value),placeholder:"e.g. awesome_user",className:h?"!border-red-500":b?"!border-green-500":""}),p&&c.jsx("p",{className:"text-xs text-yellow-500 mt-1",children:"Checking availability..."}),h&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:h}),!h&&b&&!p&&c.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Username available!"})]}),c.jsx(st,{type:"submit",className:"w-full",disabled:o||!b||!!h||p,children:o?"Setting up...":"Start Using Lumo"})]}),c.jsx("div",{className:"text-center",children:c.jsx("button",{onClick:n,className:"text-sm text-dark-muted hover:text-white transition-colors",children:"Logout"})})]})})};function C$(){const{currentUser:t,userProfile:e,loading:n}=yn();nL();const[r,a]=T.useState("login");return T.useEffect(()=>{const o=new URLSearchParams(window.location.search);(o.get("sso")||o.get("sso_token"))&&!t&&a("sso-login")},[t]),n?c.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center",children:c.jsx("div",{className:"text-dark-text text-xl",children:"Loading..."})}):t&&e?.isBanned?c.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-dark-sidebar p-8 rounded-xl max-w-md w-full text-center border border-admin",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h1",{className:"text-2xl font-bold text-dark-text mb-2",children:"Account Banned"}),c.jsx("p",{className:"text-dark-muted mb-6",children:"Your account has been banned from this server. Please contact an administrator if you believe this is a mistake."}),c.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-brand-primary text-white rounded-lg hover:bg-brand-hover transition-colors",children:"Refresh"})]})}):t&&e&&e.isUsernameSet===!1?(console.log("[AuthRouter] Redirecting to UsernameSetupScreen"),c.jsx(T$,{})):t&&!e?c.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center",children:c.jsx("div",{className:"text-dark-text text-xl",children:"Loading Profile..."})}):t?c.jsx(i7,{children:c.jsx(S$,{})}):c.jsxs(c.Fragment,{children:[r==="login"&&c.jsx(KL,{onSwitchToRegister:()=>a("register"),onSwitchToReset:()=>a("reset"),onSwitchToSSOTest:()=>a("sso-test")}),r==="register"&&c.jsx(QL,{onSwitchToLogin:()=>a("login")}),r==="reset"&&c.jsx(XL,{onSwitchToLogin:()=>a("login")}),r==="sso-test"&&c.jsx(WL,{onBack:()=>a("login")}),r==="sso-login"&&c.jsx(JL,{onBackToLogin:()=>a("login")})]})}function k$(){return c.jsx(J7,{children:c.jsx(tL,{children:c.jsx(n7,{children:c.jsx(C$,{})})})})}ta.isNativePlatform()&&nN.initialize({clientId:"267697346186-ortie4deqdkbqvrj4q6an18gv8idtnbj.apps.googleusercontent.com",scopes:["profile","email"],grantOfflineAccess:!0});t5.createRoot(document.getElementById("root")).render(c.jsx(T.StrictMode,{children:c.jsx(k$,{})}));export{lb as W};
